<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å…³äºæˆ‘</title>
    <url>/2021/11/20/about-me/</url>
    <content><![CDATA[<p><img src="https://api.xecades.xyz/api?bg=255%2C255%2C255%2C1&amp;date=2022-04-04&amp;str=JSOI2022&amp;quote=&amp;img=1&amp;codeforces=yaoxi&amp;luogu=yaoxi&amp;github=yaoxi-std&amp;email=yaoxi20061225%40126.com&amp;site=yaoxi-std.github.io" alt=""></p>
<p><a href="https://www.luogu.com.cn/user/141573"><img src="https://luogu-card-qinyihao.vercel.app/about?id=141573&amp;card_width=800" alt="luogu-info"></a></p>
<p><a href="https://www.luogu.com.cn/user/141573"><img src="https://statcard.vercel.app/practice?id=141573&amp;card_width=800" alt="luogu-solved"></a></p>
<p><a href="https://www.luogu.com.cn/user/141573"><img src="https://statcard.vercel.app/shield?id=141573" alt="luogu"></a></p>
<p><a href="https://atcoder.jp/users/yaoxi_std"><img src="https://zym.pages.dev/at/yaoxi_std" alt="atcoder"></a></p>
<p><a href="https://codeforces.com/profile/yaoxi"><img src="https://codeforces-status.yaoxi-std.workers.dev/shields?handle=yaoxi" alt="codeforces"></a></p>
]]></content>
  </entry>
  <entry>
    <title>ä»»åŠ¡è®¡åˆ’</title>
    <url>/2021/11/20/missions/</url>
    <content><![CDATA[<h3 id="2021-11-20-Sat"><a href="#2021-11-20-Sat" class="headerlink" title="2021.11.20 (Sat)"></a>2021.11.20 (Sat)</h3><p><del><a href="/2021/11/25/sol-p3715/" title="P3715">P3715</a></del></p>
<p><del><a href="/2021/11/22/sol-cf702f/" title="CF702F">CF702F</a></del> <del><a href="/2021/11/22/sol-cf710f/" title="CF710F">CF710F</a></del></p>
<p><del><a href="/2021/11/22/sol-p4632/" title="P4632">P4632</a></del></p>
<p><del><a href="/2021/11/23/sol-p6144/" title="P6144">P6144</a></del></p>
<p><del><a href="/2021/11/24/sol-cf575a/" title="CF575A">CF575A</a></del></p>
<p><del><a href="/2021/11/25/sol-p7154/" title="P7154">P7154</a></del> <del><a href="/2021/11/26/sol-p7155/" title="P7155">P7155</a></del></p>
<p><del><a href="/2021/11/26/sol-bzoj2720/" title="BZOJ2720">BZOJ2720</a></del></p>
<h3 id="2021-11-27-Sat"><a href="#2021-11-27-Sat" class="headerlink" title="2021.11.27 (Sat)"></a>2021.11.27 (Sat)</h3><p><del><a href="/2021/11/27/sol-p2495/" title="P2495">P2495</a></del> <del><a href="/2021/11/27/sol-p3233/" title="P3233">P3233</a></del></p>
<p><del><a href="/2021/11/28/sol-p3803/" title="P3803">P3803</a></del></p>
<p><del><a href="/2021/11/29/sol-p4606/" title="P4606">P4606</a></del></p>
<p><del><a href="/2021/12/05/sol-p4238/" title="P4238">P4238</a></del></p>
<p><del><a href="/2021/12/01/sol-cf1320e/" title="CF1320E">CF1320E</a></del></p>
<p><del><a href="/2021/12/03/sol-cf639f/" title="CF639F">CF639F</a></del></p>
<p>LOJ6184</p>
<h3 id="2021-12-4-Sat"><a href="#2021-12-4-Sat" class="headerlink" title="2021.12.4 (Sat)"></a>2021.12.4 (Sat)</h3><p><del><a href="/2021/12/04/sol-cf526g/" title="CF526G">CF526G</a></del> <del><a href="/2021/11/28/sol-p3803/" title="P3803">P3803</a></del></p>
<p><del><a href="/2021/12/05/sol-p4721/" title="P4721">P4721</a></del> <del><a href="/2021/12/05/sol-cf632e/" title="CF632E">CF632E</a></del> <del><a href="/2021/12/05/sol-p4245/" title="P4245">P4245</a></del></p>
<p><del><a href="/2021/12/06/sol-at2064/" title="AT2064">AT2064</a></del></p>
<p><del><a href="/2021/12/08/sol-cf1096g/" title="CF1096G">CF1096G</a></del></p>
<p><del><a href="/2021/12/10/sol-p2664/" title="P2664">P2664</a></del> <del><a href="/2021/12/10/sol-p6329/" title="P6329">P6329</a></del></p>
<h3 id="2021-12-15-Wed"><a href="#2021-12-15-Wed" class="headerlink" title="2021.12.15 (Wed)"></a>2021.12.15 (Wed)</h3><p>å› ä¸ºæœˆè€ƒæ‰€ä»¥ğŸ¦ğŸ¦ğŸ¦äº†å‡ å¤©ï¼Œä½†æœˆè€ƒè€ƒçš„å¾ˆçƒ‚</p>
<p><del><a href="/2021/12/15/sol-p2056/" title="P2056">P2056</a></del></p>
<p><del><a href="/2021/12/16/sol-p3809/" title="P3809">P3809</a></del></p>
<p><del><a href="/2021/12/17/sol-p2408/" title="P2408">P2408</a></del> <del><a href="/2021/12/17/sol-p4051/" title="P4051">P4051</a></del> <del><a href="/2021/12/17/sol-p4248/" title="P4248">P4248</a></del></p>
<h3 id="2021-12-19-Sun"><a href="#2021-12-19-Sun" class="headerlink" title="2021.12.19 (Sun)"></a>2021.12.19 (Sun)</h3><p><del><a href="/2021/12/19/sol-p3181/" title="P3181">P3181</a></del></p>
<p><del><a href="/2021/12/20/sol-p2756/" title="P2756">P2756</a></del> <del><a href="/2021/12/20/sol-p2761/" title="P2761">P2761</a></del></p>
<p><del><a href="/2021/12/21/sol-p4011/" title="P4011">P4011</a></del> <del><a href="/2021/12/21/sol-p4016/" title="P4016">P4016</a></del></p>
<p><del><a href="/2021/12/22/sol-p1251/" title="P1251">P1251</a></del> <del><a href="/2021/12/22/sol-p2754/" title="P2754">P2754</a></del> <del><a href="/2021/12/22/sol-p2762/" title="P2762">P2762</a></del></p>
<p><del><a href="/2021/12/23/sol-p2763/" title="P2763">P2763</a></del></p>
<p><del><a href="/2021/12/24/sol-p2764/" title="P2764">P2764</a></del> <del><a href="/2021/12/24/sol-p2765/" title="P2765">P2765</a></del> <del><a href="/2021/12/24/sol-p2766/" title="P2766">P2766</a></del> <del><a href="/2021/12/24/sol-p2770/" title="P2770">P2770</a></del></p>
<p><del><a href="/2021/12/25/sol-p4716/" title="P4716">P4716</a></del> <del><a href="/2021/12/25/sol-p2774/" title="P2774">P2774</a></del> <del><a href="/2021/12/25/sol-p3254/" title="P3254">P3254</a></del> <del><a href="/2021/12/25/sol-p3355/" title="P3355">P3355</a></del></p>
<h3 id="2021-12-26-Sun"><a href="#2021-12-26-Sun" class="headerlink" title="2021.12.26 (Sun)"></a>2021.12.26 (Sun)</h3><p><del><a href="/2021/12/27/sol-p3356/" title="P3356">P3356</a></del> <del><a href="/2021/12/27/sol-p3357/" title="P3357">P3357</a></del> <del><a href="/2021/12/27/sol-p3358/" title="P3358">P3358</a></del></p>
<p><del><a href="/2021/12/30/sol-p4012/" title="P4012">P4012</a></del> <del><a href="/2021/12/30/sol-p4013/" title="P4013">P4013</a></del> <del><a href="/2021/12/30/sol-p4014/" title="P4014">P4014</a></del> <del><a href="/2021/12/30/sol-p4015/" title="P4015">P4015</a></del></p>
<p><del><a href="/2021/12/31/sol-p4009/" title="P4009">P4009</a></del></p>
<h3 id="2022-1-1-Sat"><a href="#2022-1-1-Sat" class="headerlink" title="2022.1.1 (Sat)"></a>2022.1.1 (Sat)</h3><p><del><a href="/2022/01/02/sol-cf986d/" title="CF986D">CF986D</a></del></p>
<p><del><a href="/2022/01/03/sol-cf1613f/" title="CF1613F">CF1613F</a></del></p>
<p><del><a href="/2022/01/03/sol-cf755g/" title="CF755G">CF755G</a></del></p>
<p><del><a href="/2022/01/05/sol-cf623e/" title="CF623E">CF623E</a></del></p>
<p><del><a href="/2022/01/07/sol-cf773f/" title="CF773F">CF773F</a></del></p>
<h3 id="2022-1-9-Sun"><a href="#2022-1-9-Sun" class="headerlink" title="2022.1.9 (Sun)"></a>2022.1.9 (Sun)</h3><p><del><a href="/2022/01/09/sol-cf553e/" title="CF553E">CF553E</a></del></p>
<h3 id="2022-1-18-Tue"><a href="#2022-1-18-Tue" class="headerlink" title="2022.1.18 (Tue)"></a>2022.1.18 (Tue)</h3><p>æˆ‘éƒ½ğŸ¦äº†å¤šä¹…äº†</p>
<p><del><a href="/2022/01/18/sol-p4725/" title="P4725">P4725</a></del> <del><a href="/2022/01/18/sol-p4726/" title="P4726">P4726</a></del></p>
<p><del><a href="/2022/01/17/sol-p4002/" title="P4002">P4002</a></del> <del><a href="/2022/01/20/sol-p5850/" title="P5850">P5850</a></del> <del><a href="/2022/01/20/sol-p4223/" title="P4223">P4223</a></del></p>
<p><del><a href="/2022/01/21/sol-cf297e/" title="CF297E">CF297E</a></del> <del><a href="/2022/01/23/sol-p3690/" title="P3690">P3690</a></del> <del><a href="/2022/01/23/sol-p1501/" title="P1501">P1501</a></del> <del><a href="/2022/01/25/sol-p4491/" title="P4491">P4491</a></del></p>
<h3 id="2022-1-26-Wed"><a href="#2022-1-26-Wed" class="headerlink" title="2022.1.26 (Wed)"></a>2022.1.26 (Wed)</h3><p><del><a href="/2022/01/26/sol-uva11107/" title="UVA11107">UVA11107</a></del></p>
<h3 id="2022-2-2-Wed"><a href="#2022-2-2-Wed" class="headerlink" title="2022.2.2 (Wed)"></a>2022.2.2 (Wed)</h3><p><del><a href="/2022/02/02/sol-p2336/" title="P2336">P2336</a></del> <del><a href="/2022/02/02/sol-p3649/" title="P3649">P3649</a></del></p>
<p><del><a href="/2022/02/03/sol-p4341/" title="P4341">P4341</a></del> <del><a href="/2022/02/03/sol-p4070/" title="P4070">P4070</a></del> <del><a href="/2022/02/03/sol-p5028/" title="P5028">P5028</a></del> <del><a href="/2022/02/03/sol-p4081/" title="P4081">P4081</a></del> è¾¹åšçº¸ç³Šèˆ¹è¾¹è¡¥é­”ç¦ï¼Œå¤šæ˜¯ä»¶ç¾äº‹å•Š</p>
<p><del><a href="/2022/02/04/sol-p4094/" title="P4094">P4094</a></del> <del><a href="/2022/02/04/sol-p1117/" title="P1117">P1117</a></del></p>
<p><del><a href="/2022/02/05/sol-p3900/" title="P3900">P3900</a></del> <del><a href="/2022/02/05/sol-p6095/" title="P6095">P6095</a></del></p>
<p><del><a href="/2022/02/05/sol-p4770/" title="P4770">P4770</a></del> <del><a href="/2022/02/06/sol-cf986e/" title="CF986E">CF986E</a></del></p>
<p><del><a href="/2022/02/07/sol-p3203/" title="P3203">P3203</a></del></p>
<p><del><a href="/2022/02/08/sol-p4719/" title="P4719">P4719</a></del></p>
<h3 id="2022-3-3-Thur"><a href="#2022-3-3-Thur" class="headerlink" title="2022.3.3 (Thur)"></a>2022.3.3 (Thur)</h3><p>å·²ç»$(1+1)\times 4+5+1+4$å¤©æ²¡æ›´æ–°äº†</p>
<p>è¿™ä¸¤å¤©åœ¨å­¦æ ¡é›†è®­ï¼Œæ¨¡æ‹Ÿèµ›+ä¸“é¢˜çš„æ¨¡å¼ï¼Œæ‰¾æ—¶é—´å¾—æŠŠæ¯”èµ›æ€»ç»“è¿è¿‡æ¥äº†ã€‚</p>
<h3 id="2022-3-20-Sun"><a href="#2022-3-20-Sun" class="headerlink" title="2022.3.20 (Sun)"></a>2022.3.20 (Sun)</h3><font color="white">å› ä¸ºæ²¡é¢˜åšæ‰€ä»¥å¼€å§‹åˆ· ynoi åŠ›ï¼</font>

<p><del><a href="/2022/03/20/sol-p5610/" title="P5610">P5610</a></del> <del><a href="/2022/03/20/sol-p5309/" title="P5309">P5309</a></del> <del><a href="/2022/03/20/sol-p5355/" title="P5355">P5355</a></del> <del><a href="/2022/03/20/sol-p5607/" title="P5607">P5607</a></del></p>
<font color="white">æ‹¿åˆ°æ–°é¢˜ç›®åŠ›ï¼</font>

<p><del><a href="/2022/03/21/sol-p6018/" title="P6018">P6018</a></del> <del><a href="/2022/03/21/sol-p4189/" title="P4189">P4189</a></del></p>
<p><del><a href="/2022/03/23/sol-p1912/" title="P1912">P1912</a></del></p>
<p><del><a href="/2022/03/28/sol-p5861/" title="P5861">P5861</a></del></p>
<h3 id="å¾…å†™çš„é¢˜è§£"><a href="#å¾…å†™çš„é¢˜è§£" class="headerlink" title="å¾…å†™çš„é¢˜è§£"></a>å¾…å†™çš„é¢˜è§£</h3>]]></content>
      <tags>
        <tag>schedules</tag>
      </tags>
  </entry>
  <entry>
    <title>SBé”™è¯¯</title>
    <url>/2021/11/20/sb-mistakes/</url>
    <content><![CDATA[<blockquote>
<p>æ•°ç»„å¼€å¤ªå°ï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</p>
<p>å†…å­˜å¼€å¤ªå¤§ï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</p>
<p>å¤šæµ‹ä¸æ¸…ç©ºï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</p>
<p><code>cin</code> å…³åŒæ­¥ï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</p>
<p>ç‰¹åˆ¤ä¸å–æ¨¡ï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</p>
<p>å·ç§¯ä¸æ¸…ç©ºï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</p>
<p>æ–œç‡é™¤ä»¥é›¶ï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</p>
<p>æµ®ç‚¹ä¸¢ç²¾åº¦ï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª</p>
</blockquote>
<span id="more"></span>
<h2 id="ä¸€äº›sbçš„é”™è¯¯æ±‡æ€»"><a href="#ä¸€äº›sbçš„é”™è¯¯æ±‡æ€»" class="headerlink" title="ä¸€äº›sbçš„é”™è¯¯æ±‡æ€»"></a>ä¸€äº›sbçš„é”™è¯¯æ±‡æ€»</h2><ul>
<li>ACè‡ªåŠ¨æœºåœ¨åšå¤šæ¨¡å¼åŒ¹é…çš„æ—¶å€™<strong>ä¸€å®šè¦è·³failæŒ‡é’ˆ</strong>ä¸ç„¶ä¼š<strong>æ¼éå†å¾ˆå¤šä¸œè¥¿</strong>ï¼ˆACè‡ªåŠ¨æœºç™½å­¦äº†ï¼‰ï¼ï¼ï¼(2021.11.20, P3715)</li>
<li>å†™çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–dpï¼ˆå°¤å…¶æ˜¯dp[i]ä¾èµ–äºdp[i-2]è¿™ç§ï¼‰çš„æ—¶å€™ä¸€å®šè¦ç®—å¥½ï¼Œä¸èƒ½é‡å¤åŠ äº†(2021.11.20, P3715)</li>
<li>å–æ¨¡çš„é¢˜ç›®é‡åˆ°<strong>ç‰¹åˆ¤</strong>ä¸€å®šè®°å¾—è¾“å‡º<strong>å–æ¨¡</strong>ï¼Œä¸ç„¶ç­‰ç€è¢«hackå§ã€‚ã€‚ã€‚(2021.11.24, CF575A)</li>
<li>æ¢æ ¹$dp$ä¸è¦åœ¨ç»Ÿè®¡$pre$å’Œ$nxt$æ•°ç»„æ—¶å°±å†™$dfs$!!!æ•°ç»„æ•´ä¸ªæ”¹å˜!!!ä¸ç„¶ä¼šæ­»å¾—å¾ˆæƒ¨ï¼ˆæŒ‡å¯¹ç€n=1000,m=100çš„å¤§æ ·ä¾‹è°ƒ1hï¼‰(2021.11.27, P3233)</li>
<li>å¤šæµ‹ä¸æ¸…ç©ºï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª/kk å¤šæµ‹<code>dfn</code>æ•°ç»„è®°å¾—æ¸…ç©ºå•Š (2021.11.29, P4606)</li>
<li><code>(0 - 1) / x + 1 == 1</code>ï¼Œè¦ç‰¹åˆ¤æˆ–è€…å†™æˆ<code>(? + x - 1) / x</code> (2021.12.1 CF1320E)</li>
<li><code>priority_queue&lt;_Tp&gt;</code>é»˜è®¤æ˜¯<code>less&lt;_Tp&gt;</code>ï¼Œè‡ªå®šä¹‰ç±»å‹è¦ä¹ˆæŒ‰ç…§$\gt$çš„é€»è¾‘é‡è½½<code>operator&lt;()</code>ï¼Œè¦ä¹ˆæŒ‰ç…§$\gt$çš„é€»è¾‘é‡è½½<code>operator&gt;()</code>å¹¶ä¸”ä¿®æ”¹é»˜è®¤å‚æ•°ï¼ˆè¿™ä¸ªå¥½åƒé”™äº†ä¸æ­¢ä¸€æ¬¡äº†ï¼‰(2021.12.1 CF1320E)</li>
<li>å¼€<code>vector</code>å½“åŠ¨æ€å¼€ç‚¹æ ‘çŠ¶æ•°ç»„<code>resize</code>æ—¶æ²¡æœ‰$+1$ (2021.12.10, P6329)</li>
<li>è´¹ç”¨æµéœ€è¦æ³¨æ„çš„åœ°æ–¹è§<a href="/2021/12/17/top-networkflow/" title="è¿™é‡Œ">è¿™é‡Œ</a> (2021.12.21, P4016)</li>
<li>è´¹ç”¨æµä¸èƒ½åœ¨æ®‹ä½™ç½‘ç»œä¸ŠåŠ è¾¹é‡æ–°è·‘ï¼Œå¦åˆ™æ— æ³•ä¿è¯æœ€å¤§/æœ€å°è´¹ç”¨ (2021.12.30, P4013)</li>
<li>FFTä¸ä»…è¦å¼€<strong>ä¸¤å€</strong>é•¿æ•°ç»„ï¼ŒåŸå‡½æ•°åŒºé—´$[n,2n)$å†…çš„ç³»æ•°è¿˜è¦<strong>æ¸…ç©º</strong>ï¼Œä¸è¦ä»¥ä¸º$\ge n$æˆ–è€…$\ge 2n$çš„ç³»æ•°ä¼šè¢«å¿½ç•¥ï¼Œå®ƒä»¬ä¼šè¢«è®¡ç®—åˆ°DFTçš„ç‚¹å€¼è¡¨è¾¾å¼ä¸­å»ï¼Œå¹¶ä¸”åœ¨IDFTæ—¶è¢«é”™è¯¯åœ°ç®—å›$\lt n$æˆ–è€…$\lt 2n$ç³»æ•°çš„è´¡çŒ®ä¸­ (2022.1.8, CF773F)</li>
<li>å¤šé¡¹å¼æ±‚é€†å‰è®°å¾—æ¸…ç©ºansæ•°ç»„å•Šï¼Œå¹¶ä¸”è¦æ¸…ç©º$len \times 2$ (2022.1.19, P4726)</li>
</ul>
]]></content>
      <tags>
        <tag>important</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸“é¢˜æ±‡æ€»</title>
    <url>/2022/01/27/topics/</url>
    <content><![CDATA[<h2 id="ä¸“é¢˜æ±‡æ€»"><a href="#ä¸“é¢˜æ±‡æ€»" class="headerlink" title="ä¸“é¢˜æ±‡æ€»"></a>ä¸“é¢˜æ±‡æ€»</h2><span id="more"></span>
<a href="/2021/12/17/top-virtualtree/" title="ã€ä¸“é¢˜ã€‘è™šæ ‘">ã€ä¸“é¢˜ã€‘è™šæ ‘</a> </br>

<a href="/2021/12/17/top-poly/" title="ã€ä¸“é¢˜ã€‘å¤šé¡¹å¼">ã€ä¸“é¢˜ã€‘å¤šé¡¹å¼</a> </br>

<a href="/2021/12/17/top-suffixarray/" title="ã€ä¸“é¢˜ã€‘åç¼€æ•°ç»„ SA">ã€ä¸“é¢˜ã€‘åç¼€æ•°ç»„ SA</a> </br>

<a href="/2021/12/17/top-networkflow/" title="ã€ä¸“é¢˜ã€‘ç½‘ç»œæµ">ã€ä¸“é¢˜ã€‘ç½‘ç»œæµ</a> </br>

<a href="/2022/03/20/top-ynoi/" title="ã€ä¸“é¢˜ã€‘å¡å¸¸æ•°">ã€ä¸“é¢˜ã€‘å¡å¸¸æ•°</a>]]></content>
      <categories>
        <category>ä¸“é¢˜</category>
      </categories>
  </entry>
  <entry>
    <title>ä¸€äº›tips</title>
    <url>/2021/11/20/some-tips/</url>
    <content><![CDATA[<h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><span id="more"></span>
<ul>
<li>ACè‡ªåŠ¨æœºbuildä»¥åå¯ä»¥å…ˆæŠŠcntæ•°ç»„é¢„å¤„ç†å‡ºæ¥ï¼Œè¿™æ ·å°±ä¸ç”¨æ¯æ¬¡éƒ½è·³failæŒ‡é’ˆäº†ï¼ˆä¹Ÿä¸çŸ¥é“ç®—å¡å¸¸è¿˜æ˜¯è¯´ä¸é¢„å¤„ç†å¤æ‚åº¦å°±ä¸å¯¹ï¼Œåæ­£æˆ‘çš„<a href="/2021/11/22/sol-cf710f/" title="CF710F">CF710F</a>å°±æ˜¯åŠ äº†è¿™ä¸ªä¼˜åŒ–æ‰è¿‡äº†çš„ï¼‰(2021.11.22, CF710F)</li>
<li>è®¡ç®—æ ‘ä¸Šæœ€é•¿è·¯å¾„å’Œå¯ä»¥ç”¨<strong><a href="/2021/12/04/sol-cf526g/" title="é•¿é“¾å‰–åˆ†çš„å¥‡å¦™æ€§è´¨">é•¿é“¾å‰–åˆ†çš„å¥‡å¦™æ€§è´¨</a></strong>æ¥ç»´æŠ¤ (2021.12.4, CF526G)</li>
<li><strong>ä¸è¦</strong>ç”¨å˜é‡<code>M_PI</code>!!! <strong>è¦</strong>ç”¨<code>acos(-1)</code>!!! (2021.12.5, P4245)</li>
<li><code>scanf(&quot;%[^\n]&quot;, buf)</code>å¯ä»¥è¯»å…¥æ•´è¡Œï¼Œå…¶ä¸­<code>buf</code>æ˜¯<code>char</code>æ•°ç»„ã€‚ (2021.12.22, P2762)</li>
</ul>
]]></content>
      <tags>
        <tag>important</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¸¸è®°ï¼ˆå¯„ï¼‰</title>
    <url>/2022/01/27/trips/</url>
    <content><![CDATA[<h2 id="æ¸¸è®°ï¼ˆå¯„ï¼‰"><a href="#æ¸¸è®°ï¼ˆå¯„ï¼‰" class="headerlink" title="æ¸¸è®°ï¼ˆå¯„ï¼‰"></a>æ¸¸è®°ï¼ˆå¯„ï¼‰</h2><span id="more"></span>
<a href="/2022/01/27/trip-wc2022/" title="WC2022æ¸¸å¯„">WC2022æ¸¸å¯„</a>
<p>èœœèœ‚å¤ªå¥½ç©äº†ï¼ˆbushi</p>
<p><img src="bee.png" alt="bee"></p>
]]></content>
      <categories>
        <category>æ¸¸è®°</category>
      </categories>
  </entry>
  <entry>
    <title>NOIç³»åˆ—æ¯”èµ›è·å¥–è®°å½•</title>
    <url>/2021/11/20/noi-records/</url>
    <content><![CDATA[<h2 id="è·å¥–è®°å½•"><a href="#è·å¥–è®°å½•" class="headerlink" title="è·å¥–è®°å½•"></a>è·å¥–è®°å½•</h2><span id="more"></span>
<p><del>åˆä¸‰æ‰æ‹¿TG1=çš„å±‘</del></p>
]]></content>
      <tags>
        <tag>records</tag>
      </tags>
  </entry>
  <entry>
    <title>Important dates</title>
    <url>/2021/11/20/date-records/</url>
    <content><![CDATA[<h2 id="ä¸€äº›åœ¨OIä¸­å¯¹æˆ‘æ¥è¯´æ¯”è¾ƒé‡è¦çš„æ—¶åˆ»"><a href="#ä¸€äº›åœ¨OIä¸­å¯¹æˆ‘æ¥è¯´æ¯”è¾ƒé‡è¦çš„æ—¶åˆ»" class="headerlink" title="ä¸€äº›åœ¨OIä¸­å¯¹æˆ‘æ¥è¯´æ¯”è¾ƒé‡è¦çš„æ—¶åˆ»"></a>ä¸€äº›åœ¨OIä¸­å¯¹æˆ‘æ¥è¯´æ¯”è¾ƒé‡è¦çš„æ—¶åˆ»</h2><span id="more"></span>
]]></content>
      <tags>
        <tag>records</tag>
      </tags>
  </entry>
  <entry>
    <title>æ ¡å†…è®­ç»ƒ</title>
    <url>/2021/11/21/school-contests/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">
  <script id="hbeData" type="hbeData" data-hmacdigest="b0da9b9159d797cefe77041fb1938ed766ca1779b9e0b188ba2dddc5defa1794">67362a200d4bb0b1cd1ef5f7bb774ffb58a2089a15905f15111606287b2ae8c1fda5908825b78d3bd9f0460dd575aac087b0d3ae30eb047be42cd4b539c67f53c4b0f1311d9282a9c8b625c10d8f227bb3e45c44d3465d3d9ccdb76fbaf5e7da61e6ccede5c1bb855f6e2762bdfca6feb6e75183f2cffc09751eb47da6c6b50245203ea78cdff71016778372e2d02893ce3e664baf7d6d4fafab9e7e9c3196f94ab5d902ab2b40a06a1bdf81c8ebdf267fc4477c6a065c62e4c809a6f76717cd6ec52ac9d845b1482f73c75a1f6dade9ff8a27e8259d75bac83c26563bbf6d3c0d4dc012fd22a3fe8d8790ea2223d29d9b9b879d935a27bf031b5fa4a8fe32c72bc6e631d8f922ed47c78270ad6561a4</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>school</tag>
      </tags>
  </entry>
  <entry>
    <title>AtCoder æ¯”èµ›è®°å½•</title>
    <url>/2021/11/20/atcoder-records/</url>
    <content><![CDATA[<p><a href="https://atcoder.jp/users/yaoxi_std"><img src="https://zym.pages.dev/at/yaoxi_std" alt="atcoder"></a></p>
<span id="more"></span>
<h2 id="AtCoder-ä¸Šçš„æ¯”èµ›è®°å½•"><a href="#AtCoder-ä¸Šçš„æ¯”èµ›è®°å½•" class="headerlink" title="AtCoder ä¸Šçš„æ¯”èµ›è®°å½•"></a>AtCoder ä¸Šçš„æ¯”èµ›è®°å½•</h2><h3 id="2021-11-21-ARC129"><a href="#2021-11-21-ARC129" class="headerlink" title="2021.11.21 ARC129"></a>2021.11.21 ARC129</h3><p>è¢«ä¹‹å‰ä¸¤é“DSé¢˜æå¾—æœ‰ç‚¹å¤´æ™•ï¼Œçœ‹äº†ä¸‹é¢˜æ„Ÿè§‰<del>åªä¼šåšA</del>æŒºæ€ç»´çš„ï¼Œäºæ˜¯åˆ‡äº†ä¸‹Aé¢˜å°±å»ç»§ç»­åš<a href="/2021/11/20/missions/" title="ä»»åŠ¡è®¡åˆ’">ä»»åŠ¡è®¡åˆ’</a>äº†ã€‚<br>update 2021.11.22 ï¼ˆæœ¬ä»¥ä¸ºè‚¯å®šè¦æ‰å¥½å¤šåˆ†ï¼Œç»“æœåˆ†æ•°<del>ä¸å‡åå¢</del>ï¼‰</p>
]]></content>
      <tags>
        <tag>records</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces æ¯”èµ›è®°å½•</title>
    <url>/2021/11/20/codeforces-records/</url>
    <content><![CDATA[<style type="text/css">
.rated-user {
    font-family: helvetica neue,Helvetica,Arial,sans-serif;
    text-decoration: none!important;
    font-weight: 700;
    display: inline-block;
}
.legendary-user-first-letter {
    color: #000!important
}
.user-legendary {
    color: red!important
}
.user-red {
    color: red!important
}
.user-orange {
    color: #ff8c00!important
}
.user-violet {
    color: #a0a!important
}
.user-blue {
    color: blue!important
}
.user-cyan {
    color: #03a89e!important
}
.user-green {
    color: green!important
}
.user-gray {
    color: gray!important
}
</style>

<p><a href="https://codeforces.com/profile/yaoxi"><img src="https://codeforces-status.yaoxi-std.workers.dev/shields?handle=yaoxi" alt="codeforces"></a></p>
<span id="more"></span>
<h2 id="CodeForces-ä¸Šçš„æ¯”èµ›è®°å½•"><a href="#CodeForces-ä¸Šçš„æ¯”èµ›è®°å½•" class="headerlink" title="CodeForces ä¸Šçš„æ¯”èµ›è®°å½•"></a>CodeForces ä¸Šçš„æ¯”èµ›è®°å½•</h2><h3 id="2021-11-22-CF1612"><a href="#2021-11-22-CF1612" class="headerlink" title="2021.11.22 CF1612"></a>2021.11.22 CF1612</h3><p>æ²¡ç®—å¥½æ°é¥­çš„æ—¶é—´ï¼Œ<del>ä»¥åä¸æ‰“ä¸‹åˆ5ç‚¹çš„CFäº†</del></p>
<p>ä¸€æ ·æ˜¯åˆ‡äº†ABCDï¼Œçœ‹äº†çœ¼EFGèµ°äºº<del>ï¼ˆå¤ªä¸ä¸“å¿ƒäº†ï¼Œä¹Ÿä¸çŸ¥é“æ‰å¤šå°‘åˆ†ï¼‰</del><br><del>éš¾é“å­¦æ ¡ä»Šå¤©å¼€å®¶é•¿ä¼šå°±æ˜¯ä¸ºäº†è®©æˆ‘ä»¬æ‰“ä¸‹åˆçš„Codeforcesçš„ã€‚ã€‚ã€‚</del></p>
<h3 id="2022-1-3-CF1621"><a href="#2022-1-3-CF1621" class="headerlink" title="2022.1.3 CF1621"></a>2022.1.3 CF1621</h3><font class="rated-user user-blue">yaoxi</font>
$\to$
<font class="rated-user user-violet">yaoxi</font>

<p>æ—¶éš”å¤š<del>å¹´</del>æ—¥å†æ¬¡æ¡èµ·Codeforces</p>
<p>æ²¡æƒ³åˆ°Dé¢˜æ­£è§£ç«Ÿå¦‚æ­¤ç¦»è°±ï¼Œç›´æ¥å–$8$ä¸ªç‚¹çš„$\min$å°±Aäº†ã€‚</p>
]]></content>
      <tags>
        <tag>records</tag>
      </tags>
  </entry>
  <entry>
    <title>P5861 [IOI2015] teams åˆ†ç»„</title>
    <url>/2022/03/28/sol-p5861/</url>
    <content><![CDATA[<h2 id="P5861-IOI2015-teams-åˆ†ç»„"><a href="#P5861-IOI2015-teams-åˆ†ç»„" class="headerlink" title="P5861 [IOI2015] teams åˆ†ç»„"></a>P5861 [IOI2015] teams åˆ†ç»„</h2><span id="more"></span>
<p>æŒ‚çš„æœ€æƒ¨çš„ä¸€æ¬¡æ¨¡æ‹Ÿèµ›äº†æ²¡æœ‰ä¹‹ä¸€ï¼ˆ$200$æŒ‚åˆ°$13$çš„é‚£ä¸ªå°±æ˜¯æˆ‘ï¼‰</p>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="http://www.nfls.com.cn:20034/contest/483/problem/2">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>è¿™æ˜¯ä¸€ä¸ª $O(N \log N + S \log^2 N)$ çš„æ–¹æ³•ï¼Œå¯èƒ½éœ€è¦å¡å¡å¸¸æ‰èƒ½è¿‡ã€‚<strong>ä¸éœ€è¦ä¸»å¸­æ ‘</strong><del>åªéœ€è¦çº¿æ®µæ ‘å¥— vector å†è¿›è¡Œä¸€å †å¥‡æ€ªçš„æ“ä½œ</del></p>
<p>å®¹æ˜“æƒ³åˆ°è´ªå¿ƒæ€è·¯ï¼šå…ˆå°† $K[i]$ ä»å°åˆ°å¤§æ’åºï¼Œæ¯æ¬¡å– $B[j]$ æœ€å°çš„ $K[i]$ ä¸ªï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯æœ€ä¼˜çš„ã€‚</p>
<p>æ‰€ä»¥å¯ä»¥å¯¹äºæ¯ä¸ªå­¦ç”Ÿï¼Œåœ¨çº¿æ®µæ ‘çš„ $B[i]$ å¤„æ’å…¥ä¸€ä¸ªæ•° $A[i]$ã€‚åœ¨å¤„ç† $K[i]$ æ—¶ï¼Œåœ¨çº¿æ®µæ ‘ä¸ŠäºŒåˆ†å‡ºæœ€å°çš„ $r$ ä½¿å¾—æœ‰ $\ge K$ ä¸ª $A[i] \le K \le B[i] \le r$ï¼Œç„¶åå°†å¯¹åº”çš„ $K$ ä¸ªå­¦ç”Ÿåˆ é™¤ã€‚</p>
<p>æ€è·¯å¾ˆç®€å•ï¼Œä¸‹é¢æ˜¯å®ç°ã€‚å› ä¸ºåœ¨è¯¢é—®è¿‡ç¨‹ä¸­ä¸éœ€è¦å¯¹å­¦ç”Ÿè¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥å°±å¯ä»¥åœ¨é¢„å¤„ç†é˜¶æ®µå°±æ„å»ºå‡ºè¿™ä¸ªçº¿æ®µæ ‘å¥— vector å¹¶æ’å¥½åºã€‚</p>
<p>è€ƒè™‘å¦‚ä½•åœ¨çº¿æ®µæ ‘ä¸ŠäºŒåˆ†ï¼Œè¿™ä¸ªå¾ˆå¥—è·¯ï¼Œé¦–å…ˆç”±äº $K[i]$ é€’å¢ï¼Œæ‰€ä»¥ $B[i] &lt; K$ çš„å·²ç»æ²¡æœ‰ç”¨äº†ï¼Œå…¨éƒ¨åˆ å»ã€‚ç„¶åå°±è€ƒè™‘çš„æ˜¯ä¸€ä¸ªæœ€å°çš„å‰ç¼€ $r$ ä½¿æœ‰ $\ge K$ ä¸ª $A[i] \le K$ å¹¶ä¸” $B[i] \le R$ï¼Œç›´æ¥æ™®é€šçš„çº¿æ®µæ ‘äºŒåˆ†å³å¯ã€‚ç”±äºè¿˜éœ€è¦åœ¨ vector ä¸Šå†æ¬¡äºŒåˆ†ï¼Œæ‰€ä»¥ä¸€æ¬¡æ“ä½œä¸º $O(\log^2 N)$ã€‚</p>
<p>ç„¶åè€ƒè™‘åˆ é™¤ï¼Œæ˜¾ç„¶å¯¹äºçº¿æ®µæ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹ï¼Œåˆ é™¤æ‰çš„éƒ½æ˜¯ vector ä¸­çš„ä¸€æ®µå‰ç¼€ï¼Œäºæ˜¯æƒ³åˆ°å¯¹æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ª $pos$ è¡¨ç¤ºå·²ç»åˆ æ‰äº†å‰ $pos$ ä¸ªï¼Œè¿™æ ·å°±å¯ä»¥å¯¹æ¯ä¸ªèŠ‚ç‚¹å¿«é€Ÿåˆ é™¤äº†ï¼Œåªéœ€è¦åœ¨çº¿æ®µæ ‘ä¸Šæ‰¾åˆ°å¯¹åº”çš„åŒºé—´å¹¶æ›´æ–° $pos$ å°±è¡Œã€‚</p>
<p>æœ€ååœ¨åšå®Œä¸€æ¬¡è¯¢é—®éœ€è¦æ¸…ç©ºã€‚æ˜¾ç„¶æ¸…ç©ºå°±æ˜¯å°†æ‰€æœ‰çš„ $pos$ èµ‹æˆ $0$ï¼Œç»´æŠ¤ä¸€ä¸ªæ˜¯å¦æ¸…ç©ºçš„æ ‡è®° $cls$ å¹¶ pushdown å³å¯ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           teams.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P5861</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">namespace</span> fastio &#123;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXBUF = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="type">char</span> buf[MAXBUF], *p1 = buf, *p2 = buf;</span><br><span class="line"><span class="type">char</span> pbuf[MAXBUF], *pp = pbuf;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">getc</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (p1 == p2) &amp;&amp; (p2 = (p1 = buf) + <span class="built_in">fread</span>(buf, <span class="number">1</span>, MAXBUF, stdin)), *p1++; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">putc</span><span class="params">(<span class="type">char</span> c)</span> </span>&#123; (pp == pbuf + MAXBUF) &amp;&amp; (<span class="built_in">fwrite</span>(pbuf, <span class="number">1</span>, MAXBUF, stdout), pp = pbuf), *pp++ = c; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">print_final</span><span class="params">()</span> </span>&#123; <span class="built_in">fwrite</span>(pbuf, <span class="number">1</span>, pp - pbuf, stdout), pp = pbuf; &#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace fastio</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> fastio;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>; <span class="type">char</span> ch = <span class="built_in">getc</span>();</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getc</span>()) sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getc</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">putc</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putc</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span> &#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> li (i &lt;&lt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> ri (i &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> lson li, l, mid</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> rson ri, mid + 1, r</span></span><br><span class="line">    <span class="type">int</span> pos[MAXN * <span class="number">4</span>];           <span class="comment">// å·²ç»åˆ æ‰å‡ ä¸ªæ•°äº†</span></span><br><span class="line">    <span class="type">bool</span> cls[MAXN * <span class="number">4</span>];          <span class="comment">// æ˜¯å¦è¦æ¸…ç©ºçš„æ ‡è®°</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; vec[MAXN * <span class="number">4</span>];   <span class="comment">// å¯¹åº” vector</span></span><br><span class="line">    <span class="comment">// ä¸ºäº†æ’åº</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        pos[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">sort</span>(vec[i].<span class="built_in">begin</span>(), vec[i].<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">build</span>(lson), <span class="built_in">build</span>(rson);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ’å…¥ï¼Œå…¨éƒ¨çš„æ’å…¥æ“ä½œç»“æŸåéœ€è¦ build æ¥æ’åº</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> q, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        vec[i].<span class="built_in">emplace_back</span>(v);</span><br><span class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        q &lt;= mid ? <span class="built_in">insert</span>(lson, q, v) : <span class="built_in">insert</span>(rson, q, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// èŠ‚ç‚¹ i ä¸­æœªè¢«åˆ é™¤çš„ &lt;=p çš„æ•°å­—æ•°é‡</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">count</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">upper_bound</span>(vec[i].<span class="built_in">begin</span>(), vec[i].<span class="built_in">end</span>(), p) - vec[i].<span class="built_in">begin</span>() - pos[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä¸‹ä¼ æ ‡è®°</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å¦‚æœéœ€è¦æ¸…ç©ºå°±ç›´æ¥æ¸…ç©º</span></span><br><span class="line">        <span class="keyword">if</span> (cls[i]) cls[i] = <span class="number">0</span>, cls[li] = cls[ri] = <span class="number">1</span>, pos[li] = pos[ri] = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// ä¸éœ€è¦ä¸‹ä¼ </span></span><br><span class="line">        <span class="keyword">if</span> (pos[i] == pos[li] + pos[ri]) <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// ç”±äºåˆ æ‰çš„ä¸€å®šæ˜¯å‰ pos[i] ä¸ªï¼Œæ‰€ä»¥å„¿å­èŠ‚ç‚¹ä¸­å°äº vec[i][pos[i]-1] </span></span><br><span class="line">        <span class="comment">// çš„ä¸€å®šå·²ç»è¦è¢«åˆ æ‰ï¼Œå‰©ä¸‹çš„ç­‰äº vec[i][pos[i]-1] çš„å°±ä¼˜å…ˆåˆ é™¤ B[i] </span></span><br><span class="line">        <span class="comment">// æ›´å°çš„ä¹Ÿå°±æ˜¯å·¦å„¿å­ä¸­çš„ã€‚</span></span><br><span class="line">        <span class="type">int</span> x = vec[i][pos[i] - <span class="number">1</span>];</span><br><span class="line">        pos[li] += <span class="built_in">count</span>(li, x - <span class="number">1</span>), pos[ri] += <span class="built_in">count</span>(ri, x - <span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> p = pos[i] - pos[li] - pos[ri], t = <span class="built_in">count</span>(li, x);</span><br><span class="line">        (p &lt;= t) ? (pos[li] += p) : (pos[li] += t, pos[ri] += p - t);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ B[i] åœ¨åŒºé—´ [ql,qr] çš„å­¦ç”Ÿä¸­è¿˜æœ‰å¤šå°‘ä¸ª A[i]&lt;=p çš„</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &gt; qr) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> <span class="built_in">count</span>(i, p);</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = <span class="number">0</span>; <span class="built_in">pushdown</span>(i);</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid) ret += <span class="built_in">query</span>(lson, ql, qr, p);</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid) ret += <span class="built_in">query</span>(rson, ql, qr, p);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// äºŒåˆ†å‡ºæœ€å°çš„ R ä½¿å¾—æœ‰ &gt;=k ä¸ª A[i]&lt;=p ä¸” B[i]&lt;=R</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œæ˜¯æŠŠ äºŒåˆ† å’Œ åˆ é™¤ æ”¾åˆ°ä¸€ä¸ªå‡½æ•°é‡Œäº†ï¼Œåº”è¯¥çœ‹å¾—æ‡‚å§</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">bound</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> p, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span> pos[i] += k, l;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; <span class="built_in">pushdown</span>(i);</span><br><span class="line">        <span class="type">int</span> tmp = <span class="built_in">count</span>(li, p), ret;</span><br><span class="line">        <span class="keyword">if</span> (k &lt;= tmp) ret = <span class="built_in">bound</span>(lson, p, k);</span><br><span class="line">        <span class="keyword">else</span> pos[li] += tmp, ret = <span class="built_in">bound</span>(rson, p, k - tmp);</span><br><span class="line">        <span class="keyword">return</span> pos[i] = pos[li] + pos[ri], ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sgt;</span><br><span class="line"><span class="type">int</span> n, q, m, a[MAXN], b[MAXN], k[MAXN];</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">resetIO</span>(teams);</span><br><span class="line">    <span class="comment">// debug(&quot;Mem %.5lfMB.&quot;, fabs(&amp;m_ed - &amp;m_be) / 1048576);</span></span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]), <span class="built_in">read</span>(b[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        sgt.<span class="built_in">insert</span>(<span class="number">1</span>, <span class="number">1</span>, n, b[i], a[i]);</span><br><span class="line">    sgt.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">bool</span> ans = <span class="number">1</span>; ll sum = <span class="number">0</span>; <span class="built_in">read</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">read</span>(k[i]), sum += k[i];</span><br><span class="line">        <span class="keyword">if</span> (sum &gt; n) &#123; <span class="built_in">putc</span>(<span class="string">&#x27;0&#x27;</span>), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>); <span class="keyword">continue</span>; &#125;</span><br><span class="line">        <span class="built_in">sort</span>(k + <span class="number">1</span>, k + m + <span class="number">1</span>);</span><br><span class="line">        sgt.cls[<span class="number">1</span>] = <span class="number">1</span>, sgt.pos[<span class="number">1</span>] = <span class="number">0</span>; <span class="comment">// è®°å¾—æ‰“ä¸Šæ¸…ç©ºçš„æ ‡è®°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">            <span class="comment">// B[i] &lt; K[i] çš„ä¸å†æœ‰ç”¨ï¼Œå¯ä»¥ç›´æ¥åˆ æ‰</span></span><br><span class="line">            <span class="type">int</span> rem = k[i] + sgt.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, k[i] - <span class="number">1</span>, k[i]);</span><br><span class="line">            <span class="keyword">if</span> (sgt.<span class="built_in">count</span>(<span class="number">1</span>, k[i]) &lt; rem) &#123; ans = <span class="number">0</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">            sgt.<span class="built_in">bound</span>(<span class="number">1</span>, <span class="number">1</span>, n, k[i], rem);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">putc</span>(ans ? <span class="string">&#x27;1&#x27;</span> : <span class="string">&#x27;0&#x27;</span>), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">print_final</span>(), <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P1912 [NOI2009] è¯—äººå°G</title>
    <url>/2022/03/23/sol-p1912/</url>
    <content><![CDATA[<h2 id="P1912-NOI2009-è¯—äººå°G"><a href="#P1912-NOI2009-è¯—äººå°G" class="headerlink" title="P1912 [NOI2009] è¯—äººå°G"></a>P1912 [NOI2009] è¯—äººå°G</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P1912">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¦–å…ˆæœ‰æ˜¾ç„¶çš„ dp æ–¹ç¨‹å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
dp[i] = \min_{j=0}^{i-1} dp[j] + |sum[i] - sum[j] - 1 - L|^P</script><p>å…¶ä¸­ $sum[i] = i + \sum\limits_{j=1}^i len[j]$ï¼Œè¡¨ç¤ºå‰ $i$ ä¸ªä¸²é•¿åº¦çš„å‰ç¼€å’Œï¼ˆåŒ…æ‹¬åé¢çš„ç©ºæ ¼ï¼‰ã€‚</p>
<p>å‘ç°æ–¹ç¨‹åé¢é‚£ä¸€å¨æ˜¯ä¸€ä¸ªå¯¹ç§°çš„å‡½æ•°ï¼Œè€Œä¸”è¿™ä¸ªå‡½æ•°ä¼¼ä¹å…·æœ‰å†³ç­–å•è°ƒæ€§ã€‚æ‰€ä»¥ï¼ˆæˆ–è®¸ï¼‰å¯ä»¥ç”¨åˆ†æ²»å¥—å†³ç­–å•è°ƒæ€§å¤§åŠ›æäº†ï¼ˆ$O(n\log^2 n)$ï¼‰ã€‚</p>
<p>ä¼¼ä¹è¿™é‡Œæœ‰å• $\log$ çš„åšæ³•ã€‚ç”±äºå‘ç° $sum[i]$ æ˜¯é€’å¢çš„ï¼Œè€Œå†³ç­–ç‚¹ä¹Ÿåœ¨é€’å¢ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•ç”¨å•è°ƒé˜Ÿåˆ—æ¥ç»´æŠ¤å†³ç­–å•è°ƒæ€§ã€‚å…·ä½“åœ°ï¼Œå¯¹æ¯ä¸ªå†³ç­–ç‚¹ç»´æŠ¤ä¸‰å…ƒç»„ $(p,l,r)$ è¡¨ç¤º$i \in [l,r]$ çš„æœ€ä¼˜å†³ç­–ç‚¹ä¸º $p$ã€‚</p>
<p>åœ¨è®¡ç®— $dp[i]$ æ—¶ï¼Œåˆ¤æ–­é˜Ÿé¦–çš„åŒºé—´å¦‚æœ $r &lt; i$ å°±å¼¹å‡ºï¼Œæ˜¾ç„¶æ­¤æ—¶çš„é˜Ÿé¦–å°±æ˜¯æœ€ä¼˜å†³ç­–ç‚¹ï¼Œæ˜¯ $O(1)$ çš„è½¬ç§»ã€‚</p>
<p>è€ƒè™‘å°†å†³ç­–ç‚¹ $i$ å¡å…¥é˜Ÿåˆ—ã€‚åˆ¤æ–­æ˜¯å¦è¦å¼¹å‡ºé˜Ÿå°¾ã€‚å‡è®¾é˜Ÿå°¾çš„ä¸‰å…ƒç»„ä¸º $(p,l,r)$ï¼Œå¦‚æœé˜Ÿå°¾åœ¨ $l$ å¤„çš„ dp å€¼ $\ge i$ åœ¨ $l$ å¤„çš„ dp å€¼ï¼Œé‚£è‚¯å®šæ˜¯è¦å¼¹å‡ºçš„ã€‚é‡å¤ä¸Šè¿°æ“ä½œï¼Œç›´åˆ°æ— æ³•å†å¼¹å‡ºä¸ºæ­¢ã€‚æ­¤æ—¶åªéœ€è¦äºŒåˆ†å‡ºæ–°çš„å†³ç­–ç‚¹å³å¯ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(n \log n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P1912.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P1912</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>; <span class="type">char</span> ch = <span class="built_in">getchar</span>(); <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> ld = <span class="type">long</span> <span class="type">double</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">35</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, L, P, pre[MAXN];</span><br><span class="line"><span class="type">char</span> str[MAXN][MAXM];</span><br><span class="line">ll sum[MAXN];</span><br><span class="line">ld dp[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123; <span class="type">int</span> p, l, r; &#125; que[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ld <span class="title">qpow</span><span class="params">(ld x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    ld ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x *= x) <span class="keyword">if</span> (y &amp; <span class="number">1</span>) ret *= x;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ld <span class="title">calc</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dp[p] + <span class="built_in">qpow</span>(<span class="built_in">abs</span>(sum[i] - sum[p] - <span class="number">1</span> - L), P);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">bound</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> p, <span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = r + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">calc</span>(p, mid) &gt;= <span class="built_in">calc</span>(i, mid)) r = mid - <span class="number">1</span>, ret = mid;</span><br><span class="line">        <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// debug(&quot;Mem %.5lfMB.&quot;, fabs(&amp;m_ed - &amp;m_be) / 1024 / 1024);</span></span><br><span class="line">    <span class="type">int</span> cas; <span class="built_in">read</span>(cas);</span><br><span class="line">    <span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">        <span class="built_in">read</span>(n), <span class="built_in">read</span>(L), <span class="built_in">read</span>(P);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str[i]);</span><br><span class="line">            sum[i] = sum[i - <span class="number">1</span>] + <span class="built_in">strlen</span>(str[i]) + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> fr = <span class="number">1</span>, bk = <span class="number">0</span>; que[++bk] = &#123;<span class="number">0</span>, <span class="number">1</span>, n&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">while</span> (fr &lt; bk &amp;&amp; que[fr].r &lt; i) ++fr;</span><br><span class="line">            que[fr].l = i + <span class="number">1</span>;</span><br><span class="line">            dp[i] = <span class="built_in">calc</span>(que[fr].p, i), pre[i] = que[fr].p;</span><br><span class="line">            <span class="keyword">while</span> (fr &lt; bk &amp;&amp; <span class="built_in">calc</span>(que[bk].p, que[bk].l) &gt;= <span class="built_in">calc</span>(i, que[bk].l)) --bk;</span><br><span class="line">            <span class="type">int</span> t = <span class="built_in">bound</span>(que[bk].l, que[bk].r, que[bk].p, i);</span><br><span class="line">            <span class="keyword">if</span> (t &lt;= n) que[bk].r = t - <span class="number">1</span>, que[++bk] = &#123;i, t, n&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dp[n] &gt; <span class="number">1e18</span>) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Too hard to arrange&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.0Lf\n&quot;</span>, <span class="built_in">round</span>(dp[n]));</span><br><span class="line">            vector&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = n; i; i = pre[i]) vec.<span class="built_in">push_back</span>(i);</span><br><span class="line">            <span class="built_in">reverse</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>());</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> i : vec)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = pre[i] + <span class="number">1</span>; j &lt;= i; ++j)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%s%c&quot;</span>, str[j], <span class="string">&quot; \n&quot;</span>[j == i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4189 [CTSC2010] æ˜Ÿé™…æ—…è¡Œ</title>
    <url>/2022/03/21/sol-p4189/</url>
    <content><![CDATA[<h2 id="P4189-CTSC2010-æ˜Ÿé™…æ—…è¡Œ"><a href="#P4189-CTSC2010-æ˜Ÿé™…æ—…è¡Œ" class="headerlink" title="P4189 [CTSC2010] æ˜Ÿé™…æ—…è¡Œ"></a>P4189 [CTSC2010] æ˜Ÿé™…æ—…è¡Œ</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4189">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¢˜è§£ä¸­èŠ‚ç‚¹ä» $1$ å¼€å§‹ç¼–å·ã€‚</p>
<p>é¦–å…ˆçœ‹åˆ° $H_i &gt; deg_i$ çš„æ¡ä»¶ä»¥åä¸éš¾æƒ³åˆ°å¯ä»¥ä» $1$ å¼€å§‹åšä¸€é $dfs$ è·‘åˆ°æ‰€æœ‰èŠ‚ç‚¹å¹¶å›åˆ° $1$ï¼Œç„¶åæ¯ä¸ª $H_i \leftarrow H_i - deg_i$ã€‚è¿™æ ·åšå®Œä»¥åï¼Œåªéœ€è¦æ‰¾åˆ°è‹¥å¹²è¾¹ $(u,v)$ ä¿è¯ $H_u &gt; 0, H_v &gt; 0$ ç„¶åæ›´æ–°ç­”æ¡ˆå³å¯æ±‚å‡º $Ans_1$ã€‚</p>
<p>æ¥ä¸‹æ¥è¿˜è¦ä» $1$ èµ°åˆ° $i$ã€‚ä¸å¦¨è¯•è¯•ä» $1$ å†æ¬¡ $dfs$ æ›´æ–°ç­”æ¡ˆã€‚ä» $Ans_{fa_u}$ æ›´æ–° $Ans_u$ æ—¶å…±æœ‰ä»¥ä¸‹ $3$ ç§æƒ…å†µï¼š</p>
<ul>
<li>$H<em>{fa_u} &gt; 0$ï¼Œè¿™æ—¶æ˜¾ç„¶ç›´æ¥è®© $H</em>{fa<em>u} \leftarrow H</em>{fa<em>u} - 1$ï¼Œå¹¶ä¸” $Ans_u \leftarrow Ans</em>{fa_u} + 1$ å³å¯ã€‚</li>
<li>$H<em>{fa_u} = 0$ï¼Œæ­¤æ—¶ä¸å¾—ä¸é€€æ‰ç¬¬ä¸€é $dfs$ æ—¶èµ°åˆ°çš„ $(fa_u,u)$ å’Œ $(u,fa_u)$ ä¸¤æ¡è¾¹ï¼Œç„¶åé‡æ–°èµ°ä¸€æ¬¡ $(fa_u,u)$ï¼Œæ‰€ä»¥å°† $H_u \leftarrow H_u + 1$ï¼Œå¹¶ä¸” $Ans_u \leftarrow Ans</em>{fa_u} - 1$ã€‚</li>
<li>åœ¨æ‰§è¡Œå®Œç¬¬äºŒç§æ“ä½œåï¼Œå¯èƒ½ä¼šå‡ºç° $H_u &gt; 0$ å¹¶ä¸”å­˜åœ¨ $u$ çš„å„¿å­ $v$ ä½¿å¾— $H_v &gt; 0$ çš„æƒ…å†µï¼Œè¿™æ—¶å†èµ°ä¸€é $(u,v)$ å’Œ $(v,u)$ ä¿è¯æ²¡æœ‰å‰©ä½™å³å¯å¹¶æ›´æ–° $H_u,H_v$ï¼Œç„¶åè®© $Ans_u \leftarrow Ans_u + 1$ã€‚</li>
</ul>
<p>å®é™…ä¸Šï¼Œç¬¬ä¸€é $dfs$ çš„ä½œç”¨å°±æ˜¯æ‰¾åˆ° $Ans_1$ çš„åŒæ—¶ä¿è¯å¯¹äºæ¯æ¡è¾¹ $(u,v)$ éƒ½å·²ç»èµ°è¿‡ä¸€é $(u,v)$ å’Œ $(v,u)$ï¼Œè¿™æ ·ç¬¬äºŒæ¬¡ $dfs$ æ—¶å°±å¯ä»¥é€€æµäº†ã€‚</p>
<p>ç»¼ä¸Šï¼Œæ—¶é—´å¤æ‚åº¦ $O(n)$ï¼Œä»£ç æå¥½å†™ï¼ˆç”šè‡³ä¸åƒä¸€é“é»‘é¢˜çš„ä»£ç é‡ï¼‰ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4189.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4189</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>; <span class="type">char</span> ch = <span class="built_in">getchar</span>(); <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, cnt[MAXN], deg[MAXN], ans[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">        <span class="type">int</span> t = <span class="built_in">min</span>(cnt[u], cnt[v]);</span><br><span class="line">        cnt[u] -= t, cnt[v] -= t, ans[<span class="number">1</span>] += t + t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cnt[f]) &#123;</span><br><span class="line">        --cnt[f], ans[u] = ans[f] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) <span class="keyword">if</span> (v != f) <span class="built_in">dfs2</span>(v, u);</span><br><span class="line">        ++cnt[f];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">int</span> nxt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) <span class="keyword">if</span> (cnt[v]) nxt = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (nxt) --cnt[nxt], ans[u] = ans[f] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> ++cnt[u], ans[u] = ans[f] - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) <span class="keyword">if</span> (v != f) <span class="built_in">dfs2</span>(v, u);</span><br><span class="line">        <span class="keyword">if</span> (nxt) ++cnt[nxt];</span><br><span class="line">        <span class="keyword">else</span> --cnt[u];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// debug(&quot;Mem %.5lfMB.&quot;, fabs(&amp;m_ed - &amp;m_be) / 1024 / 1024);</span></span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(cnt[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v; ++<span class="built_in">read</span>(u), ++<span class="built_in">read</span>(v);</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(v), g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">        ++deg[u], ++deg[v];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) cnt[i] -= deg[i], ans[<span class="number">1</span>] += deg[i];</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> x : g[<span class="number">1</span>]) <span class="built_in">dfs2</span>(x, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">write</span>(ans[i]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P6018 [Ynoi2010] Fusion tree</title>
    <url>/2022/03/21/sol-p6018/</url>
    <content><![CDATA[<h2 id="P6018-Ynoi2010-Fusion-tree"><a href="#P6018-Ynoi2010-Fusion-tree" class="headerlink" title="P6018 [Ynoi2010] Fusion tree"></a>P6018 [Ynoi2010] Fusion tree</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P6018">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä»¥åçœ‹åˆ°é¢˜ç›®è¦æ±‚çš„ä¿®æ”¹æ“ä½œé‡Œæ—¢éœ€è¦ $+1$ åˆéœ€è¦æŸ¥è¯¢ $\oplus$ å’Œï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥åå‘å»ºç«‹ $01\,trie$ã€‚</p>
<p>é¦–å…ˆæ˜¯å¦‚ä½•ä¿®æ”¹å’Œ $x$ ç›¸é‚»çš„èŠ‚ç‚¹ã€‚ç”±äºç»™å®šçš„ä¸€æ£µæ ‘ï¼Œæ‰€ä»¥å°†çˆ¶äº²ä¸å„¿å­åˆ†å¼€è€ƒè™‘ã€‚å¯¹æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤è‡ªèº«çš„å€¼ $val[x]$ ä»¥åŠå„¿å­çš„æ ‡è®° $tag[x]$ å³å¯ã€‚å¯¹ $x$ ç›¸é‚»èŠ‚ç‚¹ $+v$ å°±å°† $val[fa_x] + v$ å¹¶ä¸” $tag[x] + v$ï¼›å¯¹ $x$ æœ¬èº« $+v$ åˆ™ç›´æ¥è®© $val[x] + v$ã€‚</p>
<p>ä¹‹åè€ƒè™‘ç»´æŠ¤å„¿å­çš„å¼‚æˆ–å’Œï¼Œæ˜¾ç„¶æ˜¯å¯ä»¥ç”¨ $01\,trie$ ç»´æŠ¤çš„ã€‚å¯¹äºå•ç‚¹ä¿®æ”¹ï¼Œç›´æ¥åˆ é™¤å¹¶é‡æ–°æ’å…¥ã€‚å¯¹äºæ•´ä¸ª $trie$ çš„ $+1$ æ“ä½œï¼Œå¯ä»¥åå‘å»ºç«‹ $01\,trie$ï¼Œå¤§è‡´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">addone</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">swap</span>(ch[u][<span class="number">0</span>], ch[u][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (ch[u][<span class="number">0</span>]) <span class="built_in">addone</span>(ch[u][<span class="number">0</span>], k - <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">pushup</span>(u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜å°±ç»“æŸäº†ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P6018.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P6018</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>; <span class="type">char</span> ch = <span class="built_in">getchar</span>(); <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">2e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, q, a[MAXN], fa[MAXN], tag[MAXN];</span><br><span class="line"><span class="type">int</span> tot, rt[MAXM], siz[MAXM], sum[MAXM], ch[MAXM][<span class="number">2</span>];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    siz[u] = siz[ch[u][<span class="number">0</span>]] ^ siz[ch[u][<span class="number">1</span>]];</span><br><span class="line">    sum[u] = ((sum[ch[u][<span class="number">0</span>]] ^ sum[ch[u][<span class="number">1</span>]]) &lt;&lt; <span class="number">1</span>) ^ siz[ch[u][<span class="number">1</span>]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> p, <span class="type">int</span> k = <span class="number">30</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">-1</span>) <span class="keyword">return</span> <span class="built_in">void</span>(siz[u] ^= <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (!ch[u][p &amp; <span class="number">1</span>]) ch[u][p &amp; <span class="number">1</span>] = ++tot;</span><br><span class="line">    <span class="built_in">insert</span>(ch[u][p &amp; <span class="number">1</span>], p &gt;&gt; <span class="number">1</span>, k - <span class="number">1</span>), <span class="built_in">pushup</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addone</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> k = <span class="number">30</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">-1</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">swap</span>(ch[u][<span class="number">0</span>], ch[u][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (ch[u][<span class="number">0</span>]) <span class="built_in">addone</span>(ch[u][<span class="number">0</span>], k - <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">pushup</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    fa[u] = f, rt[u] = ++tot;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">build</span>(v, u), <span class="built_in">insert</span>(rt[u], a[v]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> a[x] + tag[fa[x]]; &#125;</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// debug(&quot;Mem %.5lfMB.&quot;, fabs(&amp;m_ed - &amp;m_be) / 1024 / 1024);</span></span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v; <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(v), g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>), <span class="built_in">insert</span>(rt[<span class="number">0</span>] = ++tot, a[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> op, x, v;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">addone</span>(rt[x]), ++tag[x];</span><br><span class="line">            <span class="keyword">if</span> (<span class="type">int</span> f = fa[x])</span><br><span class="line">                <span class="built_in">insert</span>(rt[fa[f]], <span class="built_in">get</span>(f)), ++a[f], <span class="built_in">insert</span>(rt[fa[f]], <span class="built_in">get</span>(f));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="built_in">read</span>(v);</span><br><span class="line">            <span class="built_in">insert</span>(rt[fa[x]], <span class="built_in">get</span>(x)), a[x] -= v, <span class="built_in">insert</span>(rt[fa[x]], <span class="built_in">get</span>(x));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> ans = sum[rt[x]];</span><br><span class="line">            <span class="keyword">if</span> (fa[x]) ans ^= <span class="built_in">get</span>(fa[x]);</span><br><span class="line">            <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P5607 [Ynoi2013] æ— åŠ›å›å¤© NOI2017</title>
    <url>/2022/03/20/sol-p5607/</url>
    <content><![CDATA[<h2 id="P5607-Ynoi2013-æ— åŠ›å›å¤©-NOI2017"><a href="#P5607-Ynoi2013-æ— åŠ›å›å¤©-NOI2017" class="headerlink" title="P5607 [Ynoi2013] æ— åŠ›å›å¤© NOI2017"></a>P5607 [Ynoi2013] æ— åŠ›å›å¤© NOI2017</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P5607">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¦–å…ˆæˆ‘ä»¬æœ‰ä¸€ä¸ªé”™è¯¯çš„æƒ³æ³•ï¼Œåƒæ™®é€šçš„åŒºé—´ä¿®æ”¹åŒºé—´å’Œçº¿æ®µæ ‘ä¸€æ ·ç»™çº¿æ€§åŸºç»´æŠ¤æ‡’æ ‡è®°ã€‚ä½†æ˜¯ä»”ç»†æƒ³æƒ³å‘ç°æ— æ³•åŒºé—´ä¿®æ”¹çº¿æ€§åŸºã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¸Œæœ›èƒ½å°†åŒºé—´ä¿®æ”¹è½¬åŒ–æˆè‹¥å¹²çš„å•ç‚¹ä¿®æ”¹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ç§æƒ…å†µéœ€è¦ä½¿ç”¨å·®åˆ†ã€‚è®¾æ•°ç»„ $b$ ä¸º $a$ çš„å·®åˆ†æ•°ç»„ã€‚</p>
<p>æ³¨æ„åˆ° $a<em>l, a</em>{l+1}, \cdots, a<em>r$ çš„çº¿æ€§åŸºå°±ç­‰äº $a_l, b</em>{l+1}, \cdots, b<em>r$ çš„çº¿æ€§åŸºã€‚æ‰€ä»¥æ±‚å‡º $b</em>{l+1 \cdots r}$ çš„çº¿æ€§åŸºåæ’å…¥ $a_l$ï¼Œå†åœ¨å…¶ä¸­æŸ¥è¯¢ $\oplus v$ çš„æœ€å¤§å€¼å³å¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ä¸º $O(n \log^2 m)$ï¼Œéš¾å¾—ä¸éœ€è¦å¡å¸¸ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P5607.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P5607</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>; <span class="type">char</span> ch = <span class="built_in">getchar</span>(); <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">31</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, q, a[MAXN], c[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LinearBase</span> &#123;</span><br><span class="line">    <span class="type">int</span> bs[MAXK];</span><br><span class="line">    <span class="built_in">LinearBase</span>() &#123; <span class="built_in">memset</span>(bs, <span class="number">0</span>, <span class="built_in">sizeof</span>(bs)); &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; <span class="built_in">memset</span>(bs, <span class="number">0</span>, <span class="built_in">sizeof</span>(bs)); &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = MAXK - <span class="number">1</span>; ~i; --i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!((x &gt;&gt; i) &amp; <span class="number">1</span>)) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (!bs[i]) <span class="keyword">return</span> <span class="built_in">void</span>(bs[i] = x);</span><br><span class="line">            x ^= bs[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = MAXK - <span class="number">1</span>; ~i; --i)</span><br><span class="line">            <span class="keyword">if</span> ((x ^ bs[i]) &gt; x) x ^= bs[i];</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    LinearBase <span class="keyword">operator</span>^(<span class="type">const</span> LinearBase&amp; o) <span class="type">const</span> &#123;</span><br><span class="line">        LinearBase ret;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; MAXK; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (bs[i]) ret.<span class="built_in">insert</span>(bs[i]);</span><br><span class="line">            <span class="keyword">if</span> (o.bs[i]) ret.<span class="built_in">insert</span>(o.bs[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span> &#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> li (i &lt;&lt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> ri (i &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> lson li, l, mid</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> rson ri, mid + 1, r</span></span><br><span class="line">    LinearBase sum[MAXN * <span class="number">4</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123; sum[i] = sum[li] ^ sum[ri]; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span> sum[i].<span class="built_in">insert</span>(a[l]);</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; <span class="built_in">build</span>(lson), <span class="built_in">build</span>(rson), <span class="built_in">pushup</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> q, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; MAXK; ++j)</span><br><span class="line">                <span class="keyword">if</span> (sum[i].bs[j]) <span class="keyword">return</span> <span class="built_in">void</span>(sum[i].bs[j] ^= v);</span><br><span class="line">            <span class="keyword">return</span> sum[i].<span class="built_in">insert</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        q &lt;= mid ? <span class="built_in">update</span>(lson, q, v) : <span class="built_in">update</span>(rson, q, v), <span class="built_in">pushup</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">LinearBase <span class="title">query</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &gt; qr) <span class="keyword">return</span> <span class="built_in">LinearBase</span>();</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr) <span class="keyword">return</span> sum[i];</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (qr &lt;= mid) <span class="keyword">return</span> <span class="built_in">query</span>(lson, ql, qr);</span><br><span class="line">        <span class="keyword">if</span> (ql &gt; mid) <span class="keyword">return</span> <span class="built_in">query</span>(rson, ql, qr);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(lson, ql, qr) ^ <span class="built_in">query</span>(rson, ql, qr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sgt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> v)</span> </span>&#123; <span class="keyword">for</span> (; i &lt;= n; i += (i &amp; -i)) c[i] ^= v; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123; <span class="type">int</span> s = <span class="number">0</span>; <span class="keyword">for</span> (; i; i -= (i &amp; -i)) s ^= c[i]; <span class="keyword">return</span> s; &#125;</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// debug(&quot;Mem %.5lfMB.&quot;, fabs(&amp;m_ed - &amp;m_be) / 1024 / 1024);</span></span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i) a[i] ^= a[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">add</span>(i, a[i]);</span><br><span class="line">    sgt.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> op, l, r, v;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(l), <span class="built_in">read</span>(r), <span class="built_in">read</span>(v);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            sgt.<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, l, v), <span class="built_in">add</span>(l, v);</span><br><span class="line">            <span class="keyword">if</span> (r != n) sgt.<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, r + <span class="number">1</span>, v), <span class="built_in">add</span>(r + <span class="number">1</span>, v);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            LinearBase lb = sgt.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, l + <span class="number">1</span>, r);</span><br><span class="line">            lb.<span class="built_in">insert</span>(<span class="built_in">sum</span>(l));</span><br><span class="line">            <span class="built_in">write</span>(lb.<span class="built_in">query</span>(v)), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P5355 [Ynoi2017] ç”±ä¹ƒçš„ç‰ç±³ç”°</title>
    <url>/2022/03/20/sol-p5355/</url>
    <content><![CDATA[<h2 id="P5355-Ynoi2017-ç”±ä¹ƒçš„ç‰ç±³ç”°"><a href="#P5355-Ynoi2017-ç”±ä¹ƒçš„ç‰ç±³ç”°" class="headerlink" title="P5355 [Ynoi2017] ç”±ä¹ƒçš„ç‰ç±³ç”°"></a>P5355 [Ynoi2017] ç”±ä¹ƒçš„ç‰ç±³ç”°</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P5355">é¢˜ç›®é“¾æ¥</a></p>
<p><a href="https://www.luogu.com.cn/problem/P3674">å¼±åŒ–ç‰ˆ</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å…ˆæŠŠå¼±åŒ–ç‰ˆåšäº†ï¼Œè¿˜æ˜¯æŒºç®€å•ï¼Œæ‹¿ä¸ªè«é˜Ÿç»´æŠ¤ bitset ç„¶å and ä¸€ä¸‹å°±å‡ºæ¥äº†ï¼ˆåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆèƒ½è¿‡ï¼Œåæ­£å°±æ˜¯èƒ½è¿‡ï¼‰ã€‚</p>
<p>è€ƒè™‘åŠ å¼ºç‰ˆæ€ä¹ˆåšã€‚é¦–å…ˆå¯¹äº $x &gt; \sqrt{10^5}$ çš„ï¼Œæå‡ºæ¥ bitset ä»¥åå°±å¯ä»¥ç›´æ¥æšä¸¾ $i$ å’Œ $i \times x$ï¼Œæ¯æ¬¡çš„è¯¢é—®éƒ½æ˜¯ $O(\sqrt{m})$ çš„ã€‚</p>
<p>å¯¹äº $x \le \sqrt{10^5}$ çš„è¯¢é—®æ˜¾ç„¶ $x$ åªæœ‰ $O(\sqrt{m})$ ç§ï¼Œä¸å¦¨æšä¸¾ $x$ï¼Œä»å¤´åˆ°å°¾æ‰«ä¸€éåºåˆ—ï¼Œç»´æŠ¤æ¯ä¸ªå€¼ä¸Šæ¬¡å‡ºç°çš„ä½ç½® $lst[i]$ï¼Œè¿™æ ·æ›´æ–°æ—¶å°±ç›´æ¥æ›´æ–° $a[i] \times x$ ä»¥åŠ $\frac{a[i]}{x}$ï¼Œæ±‚å‡º $pre[x][i]$ è¡¨ç¤º $i$ ä¹‹å‰çš„æœ€åä¸€æ¬¡å‡ºç°å•†ä¸º $x$ çš„ä½ç½®ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P5355.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P5355</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>; <span class="type">char</span> ch = <span class="built_in">getchar</span>(); <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXB = <span class="number">320</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m, q, blk, vblk, a[MAXN], cnt[MAXN], lst[MAXN], pre[MAXB][MAXN];</span><br><span class="line"><span class="type">bool</span> ans[MAXN];</span><br><span class="line">bitset&lt;MAXN&gt; bs1, bs2;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Query</span> &#123; <span class="type">int</span> op, l, r, x, i; &#125; qr[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; !cnt[x]++ &amp;&amp; (bs1[x] = bs2[m - x] = <span class="number">1</span>); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dec</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; !--cnt[x] &amp;&amp; (bs1[x] = bs2[m - x] = <span class="number">0</span>); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">chkmax</span><span class="params">(<span class="type">int</span>&amp; x, <span class="type">int</span> y)</span> </span>&#123; (x &lt; y) &amp;&amp; (x = y); &#125;</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// debug(&quot;Mem %.5lfMB.&quot;, fabs(&amp;m_ed - &amp;m_be) / 1024 / 1024);</span></span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q), m = <span class="number">1e5</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> op, l, r, x;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(l), <span class="built_in">read</span>(r), <span class="built_in">read</span>(x);</span><br><span class="line">        qr[i] = &#123;op, l, r, x, i&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    blk = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(n)), vblk = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(m));</span><br><span class="line">    <span class="built_in">sort</span>(qr + <span class="number">1</span>, qr + q + <span class="number">1</span>, [&amp;](<span class="type">const</span> Query&amp; x, <span class="type">const</span> Query&amp; y) &#123;</span><br><span class="line">        <span class="type">int</span> bx = (x.l - <span class="number">1</span>) / blk, by = (y.l - <span class="number">1</span>) / blk;</span><br><span class="line">        <span class="keyword">return</span> bx &lt; by || (bx == by &amp;&amp; ((bx &amp; <span class="number">1</span>) ? x.r &lt; y.r : x.r &gt; y.r));</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= vblk; ++i) &#123;</span><br><span class="line">        <span class="built_in">fill</span>(lst + <span class="number">1</span>, lst + m + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            lst[a[j]] = j;</span><br><span class="line">            pre[i][j] = pre[i][j - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (a[j] * i &lt;= m &amp;&amp; lst[a[j] * i]) <span class="built_in">chkmax</span>(pre[i][j], lst[a[j] * i]);</span><br><span class="line">            <span class="keyword">if</span> (a[j] % i == <span class="number">0</span> &amp;&amp; lst[a[j] / i]) <span class="built_in">chkmax</span>(pre[i][j], lst[a[j] / i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>; bs1.<span class="built_in">reset</span>(), bs2.<span class="built_in">reset</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &gt; qr[i].l) <span class="built_in">add</span>(a[--l]);</span><br><span class="line">        <span class="keyword">while</span> (r &lt; qr[i].r) <span class="built_in">add</span>(a[++r]);</span><br><span class="line">        <span class="keyword">while</span> (l &lt; qr[i].l) <span class="built_in">dec</span>(a[l++]);</span><br><span class="line">        <span class="keyword">while</span> (r &gt; qr[i].r) <span class="built_in">dec</span>(a[r--]);</span><br><span class="line">        <span class="keyword">if</span> (qr[i].op == <span class="number">1</span>) &#123;</span><br><span class="line">            ans[qr[i].i] = (bs1 &amp; (bs1 &lt;&lt; qr[i].x)).<span class="built_in">any</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (qr[i].op == <span class="number">2</span>) &#123;</span><br><span class="line">            ans[qr[i].i] = (bs1 &amp; (bs2 &gt;&gt; (m - qr[i].x))).<span class="built_in">any</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (qr[i].op == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j * j &lt;= qr[i].x; ++j)</span><br><span class="line">                <span class="keyword">if</span> (qr[i].x % j == <span class="number">0</span>) ans[qr[i].i] |= bs1[j] &amp;&amp; bs1[qr[i].x / j];</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (qr[i].x &gt; vblk) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j * qr[i].x &lt;= m; ++j)</span><br><span class="line">                ans[qr[i].i] |= bs1[j] &amp;&amp; bs1[j * qr[i].x];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ans[qr[i].i] = pre[qr[i].x][qr[i].r] &gt;= qr[i].l;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i) <span class="built_in">puts</span>(ans[i] ? <span class="string">&quot;yuno&quot;</span> : <span class="string">&quot;yumi&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P5309 [Ynoi2011] åˆå§‹åŒ–</title>
    <url>/2022/03/20/sol-p5309/</url>
    <content><![CDATA[<h2 id="P5309-Ynoi2011-åˆå§‹åŒ–"><a href="#P5309-Ynoi2011-åˆå§‹åŒ–" class="headerlink" title="P5309 [Ynoi2011] åˆå§‹åŒ–"></a>P5309 [Ynoi2011] åˆå§‹åŒ–</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P5309">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å®¹æ˜“æƒ³åˆ°å¯¹ $x$ çš„å¤§å°è¿›è¡Œåˆ†æ²»ï¼Œå¦‚æœ $x \le \sqrt{2\times 10^5}$ å°±æ‰“æ ‡è®°ï¼Œå¦åˆ™æš´åŠ›æ›´æ–°ã€‚æŸ¥è¯¢ä¹Ÿå¾ˆç®€å•ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P5309.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P5309</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>; <span class="type">char</span> ch = <span class="built_in">getchar</span>(); <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXB = <span class="number">450</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, a[MAXN];</span><br><span class="line"><span class="type">int</span> blk, bn, bl[MAXB], br[MAXB], pos[MAXN];</span><br><span class="line"><span class="type">int</span> bsum[MAXB], psum[MAXN], sum[MAXB][MAXB];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span>&amp; x, <span class="type">int</span> y)</span> </span>&#123; (x += y), (x &gt;= MOD) &amp;&amp; (x -= MOD); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">vadd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">return</span> x += y, x &gt;= MOD ? x - MOD : x; &#125;</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// debug(&quot;Mem %.5lfMB.&quot;, fabs(&amp;m_ed - &amp;m_be) / 1024 / 1024);</span></span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    blk = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(n));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>; l &lt;= n; l += blk) &#123;</span><br><span class="line">        <span class="type">int</span> r = <span class="built_in">min</span>(n, l + blk - <span class="number">1</span>);</span><br><span class="line">        ++bn, bl[bn] = l, br[bn] = r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = l; i &lt;= r; ++i) pos[i] = bn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">add</span>(psum[i], a[i]), <span class="built_in">add</span>(bsum[pos[i]], a[i]);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> op;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">read</span>(op) == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> x, y, z; <span class="built_in">read</span>(x), <span class="built_in">read</span>(y), <span class="built_in">read</span>(z), <span class="built_in">add</span>(z, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (x &lt;= blk) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = y; i &lt;= x; ++i) <span class="built_in">add</span>(sum[x][i], z);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = y; i &lt;= n; i += x) <span class="built_in">add</span>(psum[i], z), <span class="built_in">add</span>(bsum[pos[i]], z);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> l, r, ans = <span class="number">0</span>; <span class="built_in">read</span>(l), <span class="built_in">read</span>(r);</span><br><span class="line">            <span class="keyword">if</span> (pos[l] == pos[r]) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = l; i &lt;= r; ++i) <span class="built_in">add</span>(ans, psum[i]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = l; i &lt;= br[pos[l]]; ++i) <span class="built_in">add</span>(ans, psum[i]);</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = bl[pos[r]]; i &lt;= r; ++i) <span class="built_in">add</span>(ans, psum[i]);</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = pos[l] + <span class="number">1</span>; i &lt; pos[r]; ++i) <span class="built_in">add</span>(ans, bsum[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= blk; ++i) &#123;</span><br><span class="line">                <span class="type">int</span> bl = (l - <span class="number">1</span>) / i + <span class="number">1</span>, br = (r - <span class="number">1</span>) / i + <span class="number">1</span>;</span><br><span class="line">                <span class="type">int</span> pl = (l - <span class="number">1</span>) % i + <span class="number">1</span>, pr = (r - <span class="number">1</span>) % i + <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">add</span>(ans, <span class="built_in">vadd</span>(sum[i][pr], MOD - sum[i][pl - <span class="number">1</span>]));</span><br><span class="line">                <span class="keyword">if</span> (bl != br) <span class="built_in">add</span>(ans, <span class="number">1ll</span> * (br - bl) * sum[i][i] % MOD);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ä¸“é¢˜ã€‘å¡å¸¸æ•°</title>
    <url>/2022/03/20/top-ynoi/</url>
    <content><![CDATA[<h2 id="ã€ä¸“é¢˜ã€‘å¡å¸¸æ•°-YNOI"><a href="#ã€ä¸“é¢˜ã€‘å¡å¸¸æ•°-YNOI" class="headerlink" title="ã€ä¸“é¢˜ã€‘å¡å¸¸æ•° YNOI"></a>ã€ä¸“é¢˜ã€‘<del>å¡å¸¸æ•°</del> YNOI</h2><p>lxl æ¯’ç˜¤æ•°æ®ç»“æ„é¢˜çš„ç»Ÿç§°ã€‚</p>
<span id="more"></span>
<p><img src="bing.png" alt="bing"></p>
<p><del>çœŸä¸çŸ¥é“ yuno å“ªé‡Œå¯çˆ±äº†</del></p>
<p><del>åæ­£æˆ‘ä¸å¤ªå–œæ¬¢æœªæ¥æ—¥è®°çš„ç”»é£</del></p>
<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><a href="/2022/03/20/sol-p5610/" title="P5610 [Ynoi2013] å¤§å­¦">P5610 [Ynoi2013] å¤§å­¦</a> </br>

<a href="/2022/03/20/sol-p5309/" title="P5309 [Ynoi2011] åˆå§‹åŒ–">P5309 [Ynoi2011] åˆå§‹åŒ–</a> </br>

<a href="/2022/03/20/sol-p5355/" title="P5355 [Ynoi2017] ç”±ä¹ƒçš„ç‰ç±³ç”°">P5355 [Ynoi2017] ç”±ä¹ƒçš„ç‰ç±³ç”°</a> </br>

<a href="/2022/03/20/sol-p5607/" title="P5607 [Ynoi2013] æ— åŠ›å›å¤© NOI2017">P5607 [Ynoi2013] æ— åŠ›å›å¤© NOI2017</a> </br>

<a href="/2022/03/21/sol-p6018/" title="P6018 [Ynoi2010] Fusion tree">P6018 [Ynoi2010] Fusion tree</a>
]]></content>
      <categories>
        <category>ä¸“é¢˜</category>
      </categories>
      <tags>
        <tag>topics</tag>
      </tags>
  </entry>
  <entry>
    <title>P5610 [Ynoi2013] å¤§å­¦</title>
    <url>/2022/03/20/sol-p5610/</url>
    <content><![CDATA[<h2 id="P5610-Ynoi2013-å¤§å­¦"><a href="#P5610-Ynoi2013-å¤§å­¦" class="headerlink" title="P5610 [Ynoi2013] å¤§å­¦"></a>P5610 [Ynoi2013] å¤§å­¦</h2><span id="more"></span>
<p>å¡äº†ä¸€æ™šä¸Šå¸¸æ•°æ‰å¡è¿‡å»ã€‚</p>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P5610">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä¸€å…±åªæœ‰ $O(n \log a)$ æ¬¡æœ‰æ•ˆçš„é™¤æ³•æ“ä½œã€‚</p>
<p>å¯¹äºæ¯ä¸ªå› æ•° $i$ï¼Œç»´æŠ¤å…¶å€æ•°çš„ä¸‹æ ‡é›†åˆ $S_i$ï¼Œå³ $\forall j \in S_i, \, i \mid a_j$ã€‚</p>
<p>ä¸ºäº†å¿«é€Ÿæ‰¾åˆ°éœ€è¦æ“ä½œçš„æ•°ï¼Œä¸å¦¨å¯¹äºé›†åˆä¸­æ¯ä¸ªæ•°ç»´æŠ¤ä¸‹ä¸€ä¸ªè¿˜èƒ½è¿›è¡Œæ“ä½œçš„æ•°ï¼Œå¯ä»¥ç”¨å¹¶æŸ¥é›†ç»´æŠ¤ã€‚</p>
<p>äºæ˜¯è¿™é¢˜çš„åŸºæœ¬åšæ³•å°±å½¢æˆäº†ï¼šé¦–å…ˆé¢„å¤„ç†å‡ºæ¯ä¸ªå› æ•°çš„é›†åˆ $S_i$ï¼ˆéœ€è¦ç”¨è°ƒå’Œçº§æ•°çš„æ–¹æ³•æ‰«å‡ºæ¥ï¼‰ï¼Œå»ºç«‹å¹¶æŸ¥é›†ï¼Œå¯¹ä¿®æ”¹æ“ä½œæš´åŠ›è·³å¹¶æŸ¥é›†ï¼Œå•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢ç›´æ¥ä¸Šæ ‘çŠ¶æ•°ç»„ã€‚æ—¶é—´å¤æ‚åº¦ $O(n \log a \log n + m d(a) \alpha(n))$ã€‚</p>
<h3 id="å¡å¸¸"><a href="#å¡å¸¸" class="headerlink" title="å¡å¸¸"></a>å¡å¸¸</h3><p>é¦–å…ˆè¦æ³¨æ„å¯¹äº $x=1$ ç›´æ¥è·³è¿‡ï¼Œä¸ç„¶æ•´ä¸ªå¤æ‚åº¦éƒ½å‡æ‰äº†ã€‚ç„¶åä½ è·å¾—äº† $26pts$ çš„å¥½æˆç»©ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å‘ç°ç”¨ <code>vector</code> å‚¨å­˜æ¯ä¸ªæ•°å‡ºç°çš„ä½ç½®å’Œå¹¶æŸ¥é›†éå¸¸æµªè´¹è€Œä¸”å¸¸æ•°æå¤§ï¼Œæ‰€ä»¥æ”¹ä¸ºæ‰‹å†™å†…å­˜æ± +é“¾å¼å‰å‘æ˜Ÿï¼Œå¼€å¤§æ¦‚ $2.5\times 10^7$ å°±å¤Ÿäº†ã€‚ç„¶åä½ è·å¾—äº† $46pts$ çš„å¥½æˆç»©ã€‚</p>
<p>æ¥ä¸‹æ¥å‘ç°å¦‚æœç”¨é“¾å¼å‰å‘æ˜Ÿå°±ä¼šå¢åŠ å¾ˆå¤šä¸è¿ç»­çš„å†…å­˜è®¿é—®ã€‚æ‰€ä»¥å…ˆå°† $a$ æ•°ç»„å¤åˆ¶å¹¶æ’åºï¼Œè¿™æ ·æ¯ä¸ªæ•°çš„å‡ºç°ä½ç½®å°±æ˜¯è¿ç»­çš„äº†ï¼Œå°±ä¸éœ€è¦é“¾å¼å‰å‘æ˜Ÿå†å‚¨å­˜æ¯ä¸ªæ•°çš„å‡ºç°ä½ç½®äº†ã€‚ç„¶åä½ è·å¾—äº† $48pts$ çš„å¥½æˆç»©ã€‚</p>
<p>è€ƒè™‘æ­¤ç®—æ³•çš„å¤æ‚åº¦ç“¶é¢ˆåœ¨ä½•å¤„ï¼Œè‡ªç„¶æ˜¯æ¯æ¬¡è®¿é—®å¹¶æŸ¥é›†éƒ½éœ€è¦è¿›è¡Œçš„å–æ¨¡æ“ä½œï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦è¿˜èƒ½æ“ä½œã€‚è€Œå–æ¨¡æ“ä½œå¾ˆæ…¢ã€‚è¿™æ—¶æˆ‘çªå‘å¥‡æƒ³æŠŠåˆ¤æ–­ <code>a[i] % x == 0</code> æ¢æˆ <code>a[i] &gt;= x &amp;&amp; a[i] % x == 0</code>ï¼Œ<code>a[i] % x != 0</code> æ¢æˆ <code>a[i] &lt; x || a[i] % x != 0</code>ï¼Œç„¶åå°±è·å¾—äº† $98pts$ çš„å¥½æˆç»©ã€‚</p>
<p>æœ€åçš„ $2pts$ï¼Œå¦‚æœå·²ç»åˆ¤æ–­è¿‡è¿™ä¸ªæ•°ä¸èƒ½æ“ä½œäº†ï¼Œå°±ä¿®æ”¹å¹¶æŸ¥é›†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (a[k] &gt;= x &amp;&amp; a[k] % x == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="type">int</span> t = a[k]; a[k] /= x; <span class="built_in">add</span>(k, a[k] - t);</span><br><span class="line">    (a[k] &lt; x || a[k] % x != <span class="number">0</span>) &amp;&amp; (fa[x][p] = <span class="built_in">getfa</span>(x, p + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åé¢åŠ ä¸Š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    fa[x][p] = <span class="built_in">getfa</span>(x, p + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯å°±å¿«ä¹åœ° AC å•¦ï¼</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P5610.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P5610</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">namespace</span> fastio &#123;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXBUF = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">char</span> buf[MAXBUF], *p1 = buf, *p2 = buf;</span><br><span class="line"><span class="type">char</span> pbuf[MAXBUF], *pp = pbuf;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">getc</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (p1 == p2) &amp;&amp; (p2 = (p1 = buf) + <span class="built_in">fread</span>(buf, <span class="number">1</span>, MAXBUF, stdin)), *p1++; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">putc</span><span class="params">(<span class="type">char</span> c)</span> </span>&#123; (pp == pbuf + MAXBUF) &amp;&amp; (<span class="built_in">fwrite</span>(pbuf, <span class="number">1</span>, MAXBUF, stdout), pp = pbuf), *pp++ = c; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">print_final</span><span class="params">()</span> </span>&#123; <span class="built_in">fwrite</span>(pbuf, <span class="number">1</span>, pp - pbuf, stdout), pp = pbuf; &#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace fastio</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> fastio;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>; <span class="type">char</span> ch = <span class="built_in">getc</span>(); <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getc</span>()) sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getc</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putc</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXP = <span class="number">2.5e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m, q, a[MAXN], b[MAXN], cnt[MAXM], fr[MAXM], bk[MAXM], num[MAXM];</span><br><span class="line"><span class="type">int</span> pool_id[MAXP], pool_fa[MAXP], *cur_id, *cur_fa, *id[MAXM], *fa[MAXM];</span><br><span class="line"><span class="type">bool</span> vis[MAXM]; ll c[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getfa</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> !fa[k][x] ? x : fa[k][x] = <span class="built_in">getfa</span>(k, fa[k][x]); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> v)</span> </span>&#123; <span class="keyword">for</span> (; i &lt;= n; i += (i &amp; -i)) c[i] += v; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">sum</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123; ll s = <span class="number">0</span>; <span class="keyword">for</span> (; i; i -= (i &amp; -i)) s += c[i]; <span class="keyword">return</span> s; &#125;</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// debug(&quot;Mem %.5lfMB.&quot;, fabs(&amp;m_ed - &amp;m_be) / 1048576);</span></span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q), m = <span class="number">5e5</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]), b[i] = i, ++num[a[i]];</span><br><span class="line">    <span class="built_in">sort</span>(b + <span class="number">1</span>, b + n + <span class="number">1</span>, [&amp;](<span class="type">int</span> x, <span class="type">int</span> y) &#123; <span class="keyword">return</span> a[x] &lt; a[y] || (a[x] == a[y] &amp;&amp; x &lt; y); &#125;);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) (a[b[i]] != a[b[i - <span class="number">1</span>]]) &amp;&amp; (fr[a[b[i]]] = i), bk[a[b[i]]] = i;</span><br><span class="line">    cur_id = pool_id, cur_fa = pool_fa;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">add</span>(i, a[i]);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> op; ll l, r, x;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">read</span>(op) == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">read</span>(l), <span class="built_in">read</span>(r), <span class="built_in">read</span>(x);</span><br><span class="line">            l ^= ans, r ^= ans, x ^= ans;</span><br><span class="line">            <span class="keyword">if</span> (x == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (!vis[x]) &#123;</span><br><span class="line">                <span class="type">bool</span> sorted = <span class="number">1</span>;</span><br><span class="line">                id[x] = cur_id, fa[x] = cur_fa;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = x; j &lt;= m; j += x)</span><br><span class="line">                    <span class="keyword">if</span> (num[j]) &#123;</span><br><span class="line">                        <span class="built_in">copy</span>(b + fr[j], b + bk[j] + <span class="number">1</span>, id[x] + cnt[x] + <span class="number">1</span>);</span><br><span class="line">                        <span class="keyword">if</span> (cnt[x] &amp;&amp; id[x][cnt[x]] &gt; id[x][cnt[x] + <span class="number">1</span>]) sorted = <span class="number">0</span>;</span><br><span class="line">                        cnt[x] += num[j];</span><br><span class="line">                    &#125;</span><br><span class="line">                id[x][cnt[x] + <span class="number">1</span>] = n + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (!sorted) <span class="built_in">sort</span>(id[x] + <span class="number">1</span>, id[x] + cnt[x] + <span class="number">1</span>);</span><br><span class="line">                cur_id += cnt[x] + <span class="number">1</span>, cur_fa += cnt[x] + <span class="number">1</span>, vis[x] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!cnt[x]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> p = <span class="built_in">lower_bound</span>(id[x] + <span class="number">1</span>, id[x] + cnt[x] + <span class="number">2</span>, l) - id[x];</span><br><span class="line">            <span class="keyword">for</span> (; id[x][p = <span class="built_in">getfa</span>(x, p)] &lt;= r; ++p) &#123;</span><br><span class="line">                <span class="type">int</span> k = id[x][p];</span><br><span class="line">                <span class="keyword">if</span> (a[k] &gt;= x &amp;&amp; a[k] % x == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="type">int</span> t = a[k]; a[k] /= x; <span class="built_in">add</span>(k, a[k] - t);</span><br><span class="line">                    (a[k] &lt; x || a[k] % x != <span class="number">0</span>) &amp;&amp; (fa[x][p] = <span class="built_in">getfa</span>(x, p + <span class="number">1</span>));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    fa[x][p] = <span class="built_in">getfa</span>(x, p + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">read</span>(l), <span class="built_in">read</span>(r);</span><br><span class="line">            l ^= ans, r ^= ans;</span><br><span class="line">            ans = <span class="built_in">sum</span>(r) - <span class="built_in">sum</span>(l - <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">write</span>(ans), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">print_final</span>(), <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘è¯¾åŸºæœ¬æ“ä½œ</title>
    <url>/2022/03/18/extra-live2d-online-class/</url>
    <content><![CDATA[<p>$2022$ å¹´çš„æ˜¥å¤©ï¼Œç–«æƒ…å¤å‘ï¼Œä¸å¾—ä¸åœ¨å®¶é‡Œä¸Šç½‘è¯¾ï¼ˆå°½ç®¡æˆ‘ä»æ˜¯åœè¯¾çš„çŠ¶æ€ï¼‰</p>
<span id="more"></span>
<p>ç½‘è¯¾çœŸæ˜¯ä»¶æ— èŠçš„äº‹æƒ…ï½</p>
<p>å¦‚æœèƒ½æ•´ç‚¹æœ‰æ„æ€çš„æ´»å°±å¥½åŠ›ï¼</p>
<p>å¶å°”ç¿»ç¿»è…¾è®¯ä¼šè®®çš„â€œåå¥½è®¾ç½®â€ï¼Œå‘ç°äº†â€œè™šæ‹ŸèƒŒæ™¯â€è¿™ä¸ªä¸œè¥¿ã€‚</p>
<p><img src="virtual-background.png" alt="virtual-background"></p>
<p>å¥½åƒè¿˜èƒ½æ”¯æŒè§†é¢‘ï¼Ÿæœ‰æ„æ€æœ‰æ„æ€ï¼é‚£å²‚ä¸æ˜¯æä¸ªå¾ªç¯æ’­æ”¾çš„è§†é¢‘å°±å¯ä»¥å¿«ä¹åˆ’æ°´äº†ï¼Ÿ</p>
<p>ä¸è¿‡ç°å®æ€»æ˜¯æ®‹é…·çš„ã€‚å¦‚æœæ‘„åƒå¤´æ£€æµ‹åˆ°ä½ çš„å¤´éƒ¨ï¼Œå°±ä¼šæŠŠä½ çš„å¤´éƒ¨ä¹Ÿç»™æ”¾ä¸Šå»ï¼Œè¿™æ ·å°±ç©¿å¸®äº†ã€‚</p>
<p>å¦‚æœä½ èƒ½å¤Ÿå°†æ‘„åƒå¤´å¯¹åˆ°æ—è¾¹ï¼Œé‚£æ— ç–‘æ˜¯ä¸ªä¸é”™çš„è§£å†³æ–¹æ¡ˆã€‚ä½†æ˜¯æˆ‘ä»¬ä¸è¦è¿™ç§æ®‹ç¼ºçš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬è¿½æ±‚å®Œç¾ã€‚</p>
<h2 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h2><p>é¦–å…ˆæ”¾å‡ºæˆ‘çš„ç³»ç»Ÿä¿¡æ¯ï¼š <code>macOS Monterey 12.1, Apple M1</code>ã€‚</p>
<p>è¿™æ—¶æˆ‘å‘ç°äº†ä¸€ä¸ªå«åš OBS Studio çš„å¥½ä¸œè¥¿ï¼Œå®ƒæ”¯æŒè™šæ‹Ÿæ‘„åƒå¤´ï¼ï¼ï¼</p>
<p>äºæ˜¯æˆ‘æŒ‰ç…§ç½‘ä¸Šçš„æ•™ç¨‹ï¼Œå°†è¿™ä¸ªç¥å™¨ä¸‹è½½ä¸‹æ¥é…ç½®å¥½ï¼Œæ‰“å¼€äº†TXä¼šè®®ï¼Œç¥å¥‡çš„ä¸€å¹• â€”â€” å¹¶æ²¡æœ‰å‡ºç°ï¼Œå› ä¸ºæ²¡æœ‰è¯†åˆ«åˆ°è™šæ‹Ÿæ‘„åƒå¤´ã€‚</p>
<p>è¿™ä¸‹å‡ºå¤§é—®é¢˜ã€‚æˆ‘åœ¨OBSå®˜ç½‘è®ºå›ä¸Šå»æ‰¾è§£å†³æ–¹æ¡ˆï¼Œå‘ç°è¿™ä¸ªè™šæ‹Ÿæ‘„åƒå¤´ä¸æ”¯æŒ macOS çš„ TXä¼šè®®ã€‚</p>
<p>ä¸æ­¤åŒæ—¶ï¼Œæˆ‘è¿˜çœ‹åˆ°æœ‰äººè¯„è®ºè¯´ macOS æ‰“å¼€ SIP å°±å¯ä»¥ç”¨ï¼ˆéœ€è¦åœ¨ recovery æ¨¡å¼ä¸‹è¾“å…¥ï¼‰ï¼š</p>
<p><strong>DO AT YOUR OWN RISK!!!</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">csrutil <span class="built_in">enable</span> --without fs</span><br></pre></td></tr></table></figure>
<p>é‡å¯ Mac å°±èƒ½åœ¨ TXä¼šè®®ä¸­æ­£ç¡®è¯†åˆ«å‡º OBS è™šæ‹Ÿæ‘„åƒå¤´å•¦ï¼</p>
<p>å…·ä½“çš„ OBS æ“ä½œå°±å’Œ Windows ä¸€æ ·æ»´ï¼Œç½‘ä¸Šæ•™ç¨‹ä¸€å¤§å †ï¼Œæˆ‘å°±ä¸è¯´äº†ã€‚</p>
<p>æ•ˆæœï¼ˆæŒ‡ä¸Šåˆç›´æ’­æ‰“æ¨¡æ‹Ÿèµ› <del>å¹¶æ²¡æœ‰AK</del> ï¼‰ï¼š</p>
<p><img src="contest-live.png" alt="contest-live"></p>
<h2 id="åŸºåŸºæœ¬æ“ä½œ"><a href="#åŸºåŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºåŸºæœ¬æ“ä½œ"></a>åŸºåŸºæœ¬æ“ä½œ</h2><p>å½“ç„¶ï¼Œä¸ä»…å¯ä»¥ç›´æ’­<del>æš´é›¶</del>ï¼Œè¿˜å¯ä»¥ç›´æ’­<del>é¢“åºŸ generals.io</del>ã€‚ä¸è¿‡è¿™éƒ½æ˜¯äº›å°å„¿ç§‘ã€‚å½“æˆ‘åœ¨bç«™ä¸Šé—²é€›ï¼Œçªç„¶çœ‹åˆ°æœ‰ç¥ä»™ç”¨OBåœ¨ç½‘è¯¾è¿›è¡Œvtuber!!</p>
<p>æœä¸€æœå‘ç°å°±æ˜¯OBSå¥—äº†ä¸ªLive2Dï¼Œä¹Ÿè›®ç®€å•çš„ã€‚é¦–å…ˆä½ è¦æ‰“å¼€ Steamã€‚</p>
<p><img src="steam.png" alt="steam"></p>
<p>å¹¶ä½¿ç”¨â€œé’èƒ½åŠ›â€ã€‚</p>
<p>ç„¶åå°±å¯ä»¥è·å¾—è‡ªå¸¦é¢éƒ¨æ•æ‰åŠŸèƒ½çš„ Live2dViewerExã€‚</p>
<p>æ—¢ç„¶æœ‰äº†é¢éƒ¨æ•æ‰ï¼Œè¯¥å¦‚ä½•ç”¨å°±ä¸ç”¨æˆ‘å¤šè¯´äº†å§ï¼</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>è¿˜æ˜¯ç»™ä¸ªæ•™ç¨‹çš„<a href="https://blog.csdn.net/zydxn1350/article/details/113604991">é“¾æ¥</a>å§</p>
]]></content>
  </entry>
  <entry>
    <title>NFLSOJ-462B</title>
    <url>/2022/03/08/sol-nflsoj462b/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">
  <script id="hbeData" type="hbeData" data-hmacdigest="f21649ba3774732302fbb7ded578c4f71b597d361300eb697ebfdde4de1501e6">67362a200d4bb0b1cd1ef5f7bb774ffb58a2089a15905f15111606287b2ae8c19b6668ae2d02e3577879f20663963a41e4fbe72418f0211fcd23e7e1785a045e4d2f3e127447547a106a9e1bee950c7a4ad185f279117a87a303a67c392e914db959952cd4d5bc39a7aea68187ee9d7e75f48968e0bc254836481cab72d26da4682a6b7741841cde225e3955c38d410800cec09a934992bc3d5be7bc44056603282b0b61d489b57c840e0deebc303b8f45f1672da5aa523641fe1867bbb220283b6f71446f5435d9fe1bba3e02eb240493d8c3939e902f4c7448003acc2690d0d3e8e069826e42bb3b62ac8fb2a8cc1964241b876de8dcfaeade073576b4424e4d6c45726386baa28937adc199a39732467f2a51214eaa6585ee12657c8ee8b1e1637a1d1484958ce91e7825b8b806983ac4a988a7cf635ce06a09629ee729d5d9fefbf2a22a830477d35dcf022fd6f56f957acc6c3284d202f06959d2831e8aef1e1781960e3abf597cec2b962debcd963682cff872bb65fc0e81364803288eb3fd8a1eb41bd84f2a0eec75cb4db477c3a1a987fcaaee5745026ec3f0d5ed7639ef3b044ddefe05e0e69fff6c1b3460169b5e3633650708791ebe16ce77865d629a7858d3f02d0cff566ddd7c0523cc612d5f5759708cdd22c52775f320aed769a244cf77f01f91bc187aaa76056340a33e0a0905ed1bf429af16b90b22db99c10730cdcabcfdc167eb288b388008f4eead18bb6419554920ea97dcd572d0b99b5b39dc811a0ff8144ca037dfb0e7ad829931330f91eda488feb249d1d075c5df17fa0881436eeed7ab98c6dff0f4bb922e5f88bf59f6529a4541bab09c5b58b8c78d13100859e16725836f2cefc4e9b44482e4d85e5bf3df36e097c3bb12a88a0c7da6db2645f8073a4e3bb4be9ac25fc55d3127f3b9f45ce27c83609037d64e33060e7626fd8b36924b2f3bc7d6c66b68812a72df7ea732a43e253024b721fdef53f69016cb2deedcc7814a8ab300a4ff85d126fff13cb0d8e1fc254d56853b31720d2bd91854d59c9015fd289a9761b08ec9b644e045ae78f3a9c31d5ab30ef2cbe09d3c1b613c24ef51d6713bed94b2946d92558c7c0910a0113805ba1f127fd35e0c0951a941f254f52800d444971627de7f88ba7aff35393ebc0be28631f19dc96762378cb7094ac7eebdaea048a1abac0381e53b81aab3a1c693f49424cb278149bf94106bef9b4756b70aa9968f229ab98a314369aab0b24d25d197ebbaf6b94c0f421db17b13353331fdcefe09072277786f0a8ddbba4d85f64d8865128ef59a2964f4318605261fb83aa86ad4b6a49eff0a8b424ddaa5841b177885315a77981a64617c6af3c85a44a4a7268e38fd0a93d37658ea7f8056dfa0a8cc6aef5bfbd7acb99bfb017cde604cc9b739b7fe90c6340e1033fd26f6b9afd6a68889f615a56d8d53be248e0280d6c954b4399acfe40d95102d754dd9fe0312e20b780aebf9ec067aaa9baa17b7820fffd12734e0a38b4f63b133962b07eda2c4b014455bdf3660a0bb3967aa5cc85ffe50d455bfb7ca356ca17327b4484f31301ab521f1b946bc703208560633e7f10fdb18f3374f2dd6176271fdb47f387f4164c107326030cf8ca55b1931d52a9be494773d965f19f0f85b1b3478a63a76a52cc8a093dd33ac8b4bbb6dfa351447cf457e46d23110579c94eb8f837ddc623bf2e11d14b1608badedb713024ab231555521e041ac6ad22083213ec89a93d718bdb9cee514c42e5dcc1190f2d4fec4e068cf2184c6e9a49f4b428288a3b6cc0dcff917ad45e6afc47c634c555d302c682fb49d5c9ea282cc81aa967a6224524aaca3850c517f3afa297b4b373d2529da0a571f42ecccb3655868e8e74b5c6ec5b733b0b5c57680ec8e6d3cc72914a2ffee0989e92b87e75f48f3c85d3a626f28c50c6e80617d60569c5c60cec656599b202e0c120fa621cd5832ab8df53d2282fc5551c1113184371b3d05e53fb3439168d55ad83d6fc8da3599f15fbcd9cdafe564d0ab2d722185321195aea70cda01e466d2a9a5bb840a98485863582e82bd2d55bee7ca47249ca9b9fabec854c5aad0ceb992c19532f32834b963e4d73f35d9ec895dd5b92d7d20bb8517600e852175939cc6aed1740da5a3dd08d6510e3bd332f905f1249cd3f87d804a4e36ed84bebe4a97908d5f92429b37aaec5ce2076d9f363c110dca8aed63174f977fcb07d0922f7a4e0757a8f74bc0abbad1a8c6bc62144ad2e9e3f6130c3d405e53fd98b1a3a0afd9c03793468b4e301a6a67583d2fc2ff72c4286f8503015383fd00f8c20c8213f0778c1a70d6a0c7e0cba63789c9633f323796903ca3c7e6b608d87a0a087f97c85266ae25e34f2e392eb721110d749d8fb3d3b93bbbe4afc29e760952a93734a3068adba2b04fc5b06cc03cdade16144f294a8716f13eb83c718e9e1f124112178dbda40956224a246bb3170006bc0770fa9000201cdb4f30d474853ee08b5d20cee3c0ac1add261e4d30f70e79829c735169fc10c4a819b337cccf691ee2cf5dbf5691aee411a7211ca1f070f688722a6273b99e5ef2884c5760a21555256f9d5bda529e4a4a3ad1597b2cba644c4fcad40f33799b2149aada1fa66b3d7df41fdcc224af4bca57b952c0ce1fb12b09a09045c9d69b7bee0c2f2545dc54cf39d6cbc15c50ecfdf15ebcd37638ec656506ded62dc6cc472f3a02093f3bda1fb5fb302f56f4ebd887a8c4aa7616ac80d9246687941dfa8625be67b9e3b0528a074481ec27bb5423e920b407ff21adc474e3cc36337a4f0ddb10973439630b2a7d837053fc6dfa389c59bd098896811decfd3b760f0d498d6036bc63d5c6cff93abc72e873d9f326645e4015953b6e669b89d56be8ad874afa60824ebb3e16816366bb2f269f3f29af2bcbf322369f90a3b90893ba98c664ac11ae77df70a4ff0c129410da15fd6925e431dd8a76fa3953c32f307170cd99c24e168e473dbeed05d116e80d31da2a47a3270889f66c1b5b46c82f2068ed8863a1b9aa34d16f3df9d0c99553984f250c21dc14f63a8eae41565af43bf5b183f2e483f64646b03abebf0c69d382952d33bf8c7b7c5a30e3d8d9a524518d4d7b26a8600a0cd1435d6e2356c5f0ae9d3f52c43d325f07c9ae40edfc82257c84e72fb4800d2fc01381b47d6217c4717cc2f5af463f1a81d528458aebf968fb761dc654484fba0f6cde116e1846187ebe1c584b97aadbeb6ffa611c26afd480f0a8645b1be7a3cb71119461adaed42e15cb1406cf20da702fe9ac3af1790953676096e1ce0c5d45589253195114d338f3d753aa761fff5c6a23caa83edc2f648f8960a8c2fd17b80f0052d6e67fbf5aaa9a1ac34365ffd80ec28cc08d25c49c82273e47b779b83da079c6873d731a413f33ff32d9aeb722c9abcf67bd4a142b804a98d3d593ebfd7d4746d56544746cfa9802780661541ea5745ad00b0e716e190e101d8071e0f74ce74385d80b9245f7239c011c1012c28acc25458d982662ccadf3abd00f50b478fdadf29e68ba23ed1a3e21c15f6a69ce7d2bf69dcbab9189a430fedde364009320c462bd2a779111bed2dae7802d530e510dea17ff83d9dc03719e9ce3c31c05445f81a2d28b39cd0f566b0545f66df3f93270e138fbf08ad47d6fb759c40dfec40ebb2ab12923f1d1685c52cfab6e8e14290a51d94ad395d6dfc818fc19010dc1c3b7ed21b72bbafa73d9a26332bd6a1c3cc601768902d20b9d68bf9ed53cfe35edeb99e4c349bea98e0f33e7a2f0c4dec7f78ef9747294806b6da4784fefa5bf332b523aaee390fadef24c213b70bea527116da1e4970e2fcd51bd04d3f2fe0bad6dc0d1f205301b6a14c21d8c0ec345c8fff84781702416eb94c4705aa539ca5dd3dd697718367a248616f54ddf41633edf87e2e5f003c86fd12b0359971d857751a36744cfd2cbfd1fed7472d40824187dc341dbe563ea74233100cd6ad60082a41865cd6c24e78ff70fdbb3cf73e0ee342a3454df7cef8d1ceb643147ad910233ba215ded13a4c4356790e5f4e8f40a1645aec047d490fcd37500d6fba8c171166196faa732bc48509efa103f2a92ba4f92bd704e33d4b6eee92ae88c69cb860fd594ea63ee92fff977978f3ba4a54e1d91ab3bae6b9259f3c52634459f791e3f842e8da4bc87e7b4f73ddf3842c7e91509997f317448683fe2b5c5f533fee154ed4badb5b6191c17e25a2c725b6863cb6b465da4d17f5878fd500532a6b1449a4bd4b6f7ba4db80a3f6f2b12ae4e185fd99ddd575c01ce861e0c0e48ecec4cdcdd6573acda1787cfd537af93380e6ef662b10fa3a5f5f85a018336e005534af4eeb730db17c8deedd91877150d0ef3214bcdba0024571e6aefed5283e9e95b310d1141700a830f99028c420fc9692606d855a7788ba92a8b379e2c23b8623744e8271b4974d6a4e98cb3592cb5c4c75ed2e9fbc5b448b64d3f1855385cc393beef64f1d990481fbfef3e1277c15a8af6bcc90d075fa9501cc5d5ec0550d4e68fe0012a0c174db4d4165dbb99297c9f0aa975a92eccb79abc733384ef96a8fea58c9a8b0b4269d2120a2cdd84df538cfe789c132660f71b874933fd5542bd263c3ce0b7445fc6bedb705f3e745e37b745626ab08b44ed2099c28a39635e0924f1fa5707f95bc16d97b2902f603c318fbecf65ce6626c3ace9bcfe7aecdfc2853ced25e8f240ccc2a5a9480f703541634d0a4f26dca859065076d4a5f54b1e1b56d3cf2d8764736eae352d1a62e1cd5901e93386562eaed2e2719e098a766d6c8fde281949e66d9f9d0b3fde5dac614f89cec2039a94be97d410f2b2a290e722a25e268b7d39d6ce571f6806c68ab2bc45446451fe182d0a7c7d2cbed4b0194a0ff1ba15a8399014fc30970fecdae85d4742ca5b7ab27d7c542dda6b404990d6d09c164ee1323a306897fe676d8c2b15ecfdfb710194bb883d6a174fd01acaaacf6c040e28a0438fb6f8d232621692b14fbb79d3d0a02a55dd2c42011e6b2e0c1f9719d71e6a6b78101709392634856ee0e04b83d6572c426c41aa0ad841264ad9098bec8dc911e78165d092fa8ead53d43ed64bcfb5d217b9088555c50a7b7916e6703d1cf1ad2756aba01b991f729e375e451d2005b4c50954620ae9e82d96c136cbd29a23ee05f86c0a035ec718339b500b649aa89f6192485011980f2e5e8e63926e71a9e99676a55259ccad22153de964e316d212c989ce3cab112336cd4fcea8dd4db0fbeb6494a5334162cbb59617b779f9b9b82fc5081b32e0ba32cdfc1357f48ebf2e3b06d92e0f2999587860580489996c1668bb17717286d518b67fa942ec4f8c3afe1d4ac67abfc083a2c3becda31f0bc112479d4ef7cb8c2f73b864883beb6e750922bff350ebbdd4078853e1cb221074df47f417e2b6db582d6baf3ebbbf1254037b6c5fbc9ac37394122289eb9d32395754f6cc202fde216444a6106ebd224c37f4992a1e10bd49671414af42af59e267d1987b23f9508107e289321fc893f2539f26028bcff45b589c4c6b1ca2e16abd6266707c7ed3d4c7da4f96754b7b951dd6715aa74b3fa9cf563e415217ca746ae6853ed33279789fea9b1d137107aa75f16f16faf78f6b17ac2c6890f3b086a7be8eefaa6a244c9e1e364a9850fd6693504cdff4392501af0face1ab501c76c26a826902682b750c65ebd44e133e275c407ea129aa9658fe2b3e59e6627a89192f7b50e5dcf5820ec21b32762b55b738259675e576cd0163fbc25d1443600bc6dd9a4c15a2aa2fe88980f7ea6e57b83ef1c4a0491214d8c202a067a8242656a2afdbec599b0dfe52c9357ca51db7f511936f91e3fb262354cf1acfc58f4da652f73b6ee3ea8b8f45523ed8af500f985ec558f62e02c9895ddcbfac8612b9d5e71d4d8d78b61f89e6a840f50f2568aa2b9c898ee89d9df315046d21389e56cff89e911bfe0439532453d909eb70e6552766fc761ebfc0b48aba2da7a9eb3b42239e190449ae96a71552c75a9984a51450f70b4a1c82fd64aaf0265a42e2d8abd9300553fd43a149adbe505d290a9e32ca5c9000d168b0efb239f9683de060c0622f28e74b9fce7e2b959a8d1e1ca2b8c9264aa0269a89200f5a27458f4ba0e18ae6076b5728021e493751e4a84f8e3ef921f29f9ac0a175827d9262d18dcdfafa6bfb8613b15723c8697acdb739b1b227772f016af4667a1344c49623bc6587eaa04df28dd9e7039d0d4463c933ffdb108628818e3f2ff34d972744413c6a43d217585e0f6078cc78a012de354d849d916a935bc7c73aa11f7cca13e54c721cc83879778df9865a4dd91f90aa385b4eeb24bcdb99bb71cf822af6f0d38c836ce3af3812d99894ba6d67b6dcff81c29cabc57399fd01cf0258793a77d1ab7406eda96d4b5518df4bca229427ed187bee6c19b5e59dcf9c29a8f6418a0ef6977719938f523871ede01e0745502e1c8b6b863132b46e0477e13790ca0dd97c8819a4ad4d8db4bc259688b8fb556a076e335508e35f9ca9e10815ac5f20c326fefe4845f35bcc98bb8cdcdef091a36be5acd517ba4f3766c5cedefa0dc9c74e619bb5cb2fb3ffd19aab97514cc823f911e8b58135e1527e2472b051c8ddd7560a149b7fc5f5a46c6fa7c4aa9db643facf47b5ab45e5a65f2b7f234f83991115ed3d3f7c22f62703383ba9243b3c90e8adb1823273921b81f0fd4e555c7bcb99358e80b6abcdf37847de6e60f47773be2088fdebd473b625e708d166eb022d262fdd82a8b387b1f2bc9c7efe2af8c234ea15a347ae3853957a7bb8c9c956735dbf29c8f6caa92ea4d088ac2da8f7c0bbc3dc9c0952f32761a11637f035b11dcd8b5d22ccb879d90cd3cc57ef2ec0d9a4a7a5e103c568ffd972c5d420e86707abc6280edf86016ee6e4b1989c20d06446a5dc76409a885c2ac90311a29094810db9116e7d35fe1023ad59aa7f40f04157e389aa37548f69bd29b3e246f35a268ff7a0c865f8cc39869bd450cd912f261f1d38031aa2a0ecccef003e7b4cf6599c927472fdf374a780f8c4da552c16069ee5364b20e2b00a616d3a6b3ad4b0b5ff3839048a70ae2c0524dc092c132114e76e3142b575effb40da9f0a457b0135038873e695e526c74233d6c63de675edf1d2b4c474106ec37d09e8556161b439f01c2a61bc226f8d5009ff353d620a9af4c2f6c7ad63ac7c494594fbca981bb63c985ba4b67c4a7fcbc44c560c38ed2f33b61bed4db74aa1bfbe9d24b9acae32376438b19eeb16700233c0b750d80cb1216e5653b47eee0b6b6af0da557d1f085d4bcda67dd53319b41822d1d3d6c71cfb90219f94e6c093b109e2325080d8aecdda1ab67d2fcbd893462257924bf5fb5ffad11cf6b13e7d00e7695cdb7fd84dd316cd84baae62e8cdd3bc3918a190515e279894daedc291b507c884c6401bfb25052f7baef45a4112693c4f16a30e200c2e0a8ce77b94ba3ef0640c30d064103bb8416a5feea278ca38cc4b1b536ab9d65268862da9c91f7025bd58d46a52efec8010cff08933a3225174d7e0e698dcd647371a4971c87586facf94453ce3e6770c408ba568f5f4ba73c639409cf2994f3150b8c5ecb1c2556eff6ec496732218a2fe81486c225179a0051af46d4bc6756ac670a9aade76fe1b2067d886771cfd2164a943ee47d468dbb7c4c597fb66c9347d2e6f71e237f074b1d6e05e5b217521354e086a26206dce13d62d488c9058f67f87e45cc4117b0ee023be9af807cf2de88ad33bb2c9b33f68067dfd683661328ee17d0e8c21cfb26964320acc02554b8b6f0d5b3877dce27ce13676720a6d59ff741d8d620eebd7f5614ba0ac3c8f5d655a2c2061aba2ef68356ffbe8bd5b61f0ebf8bf78ce1b2482a8a577c60067f75b33dc242064418461ad3d76ff7aeb77af5e73095af7763e81a01df42475b39371fe91857a4ba4c3333077fef3ed4c62875d00cc1b590068bf5c3d2d51d5b4e8fe18379370d1f64e3918355f8c86ad6b825a1061f84ae1c8bd7141eb536a4ffc6107b6412fcadab635254c352e42595afc388a89152c70cc3036829ea4239863cf3a03acb8ac663ca8ba14d8d6b647fa69268bb261045a09699023d28db574bf8de32c1ac5e9ea7f8bfab8b8b36ee4f79273eff5afb535c60e5461d8129a3416548abebc078e5207b835919628550011f9c7a93db21bb6144e4eab1baf79e78f69fd0b34494ca664eed8587294d4f3f76088d910c5f349adf9457084f09b9d111611c82199940fbf11ed9ce005487be7dc36038e14dab8945e08611ecb4de11fdbeb3c3a155922c569e9ceff45878e649c563b4e39ae085b2cf60a451aec422f3ecb69191a7382e239a3054e8aaad411c6084b5bf0264e15f328325f5330a1c0a9154c353a9ca918543807a6e1ae01b51b796280021b36345181905f030e3f45f7f490f68493a8e8dadcfce87b64eed202187f74262a8282a91cc5f98d81e707a615b00d4a7d4ccdac0d8dfdc0b831090b64396657367e39bfcffd9d9cb9887b5a9034c71c557834f3865ba21d6c4267a5c5ceaaf6efb1b3d111b8735c0a33b258b386121dacad17cd158344cb8043d30261eace5603eccaab63d4cc2f60af3fbca87fee87a68efe9aa876395ebdec366a438e8bd317b0c4aa660c58186e6a90b201c571424b7a815a25d82dda46de40c6599600e77da5c47dde3924f3906a702cf95d9e82e62b2ed57ea8b0f72e19604d687dfa25da198e109b467266ef9095784bf59f16b9c4170e343be342bc734faff293dda543d0b39fccfb2438e4fe194183cec095ba63232da6e34b336e3bbbccde2fc1529d7e339f3e80adfc8eb3ff44db10738f2dd5d42c2a60bda5dff5926b6258fdc29dfc324e619d79af22b05a2a7f04e7007e0a5ac1d9a4158921556a16c8909c8d9b6de4e112d1ad415495b1c239611b41077e88d53a761af7c7a1f80ef9e8bb5318ce29ef1c51a7a0afd2a28f0a12ed9f0600b787a76d0f815df29cc477603a6da17b48f59784c63cbe4075d79cbf1941fdba7dc3b1a28ce2f6a735d7dddd82cc0d7269e5071636e7427a17e9e485f87968ad178d379465ade272af15ca15723d5a51c1468ffc95254f842b1c7d25850297f24b3153f132345ca0e3933eab89abfb66b4cadd7274fb922410a07ae1643b4d64590c42f2eb12d01d93ea771fcb6eabc7777cb08a83a6fbc14cb70eda07b16d66219f8c24ac94ae58e3d5b12c57f32141b0218fc3b61bb1361d2c112b989734b841772e8aa5209f48c6d571842952f3b4c3a7a57fcb88ee2c91db74e34a4fba0fffd56923435280cf4a1a348a6847e79af4d3dc72964af6e02407d6ebbeb102a7bc6e886fe4ca9d0c4c2c1968e6c5d86f65eb84a2df8e0ed718f81baa830091c7045323fb8ce70fbdd9c6ecb4ab7b088ac1c8e594fb887ba0a30a05febac306286ded7e93653e84307682d6fd5f43f0099c803e091623c7c3477949ab40b828328228cce952bf0da48b870d65dc65a1b602201507e933ea7e36154568beb3825da530f31718935b5266860ac5396ed0fc8589b1633be098b90faef7b2920dcdf721d4380edfb725718b2570dfef28f9ed1824148b169cf1a708efdb8bb356868a8329a1ac176b4a785f0a5c566a35fcde2462db9bc4b1c1b9653145766beb60e9e7f996c4118375d80862c587290b8754fd26dc9a6bf70f708e7b0c4fe820c9dedb7c01be69afd1998eeb30cc80be04354f52cf1930553835d5e800c4b10c98f3b87e83076f971d7947832150fe28522bad8ab00f2ff3ba3a37ee9293190a64e8e41bd580a662f049f5dbbf46f1f6b4cad4e0858590fd1ce0bc42c88e794ae6e62b7204bb83504946701757969f73e1589c5742c4f9a19b3243670d155aef2d7d454a22d33ae87cd498f3ccd110ab4b781160ec2ee80f2b7cefaf2d2f0a6a314b4b0b78f9ac7531471c4de4380cf0d2c1c44008a300208e154d02ab735113490658454538de71b7ccd88d3e42e42d68a502962b5483b001856f888171fe5c5008955ab170e35c5eaf8ff709d27dc2adf2400fff30e947fa4d0096227adf61b886bbdc35b8518be8786fe96ffbe03ed677941856261825c28a9725d94e6ad8498d6f39d78984c83ba50fea7d8aed02e0d3cb35ed4f75ca8675a887b262db743b90d2a704da9e175588b5b7699c401ab38366eedb32b715e9af37b54106e71f7e67d9ca89703fcbda5b5d955b984142bb9780e24e86c0b261f94fd57090d49f5a38eb636b1b7ebd1cb1b810ab826325bd4d762be535c0bc9fdd04b99484077ce4a5ac748117000a707a13cceddbd394715270a52547a576f32d22a3db50383b8e36a26bc1d92136823d8e50231ff9090e2638d5f761baac20dbd7e4fc4eb18af535757e9da8a97ea763f9c00f2e5743337c54e201738e016ab2b1af44b827f510af8a756085b16ff2b882fb6425f4a10c26f6bc22240277318821c935966140febf61ee10d676b967f9c0dd8b20cd8b62267f0e9809727cc1623543053c01b8483b2e51bcbc6002b642a511346965f02469e3fb63a9bc396ac95e8e90da3df9e49851c05c81498d8c5a9758393cc492e8557c5e375239f4f3cac3f63f062aa16637c8e7ba4861709fc1d8e12472583bcd5681009ab22e4dd36a80e270949d1155d30a6b888a679e07249e73e024a6fe92642e1a2418e3e0662c64d6a83a45f5fe5f6d5fdfea3e8d5c98cef0553dadeb21992d2ced0baa7c0a80a896929c38403d25228094f8c1ccecd0be3f701703737fa7f9a82c6628f8ea8d6a2494be900473c5f637570f2b175f56644f6705023d0c63e15f3a8f8aa039acb4498798def3f9e4d6ed8b80dbd826472a216c0812d7fd10715db963d579b76e68d8f6548107040312b73b09c7324ce87cd81f03016210a6a8feb58f4f892c800ff188dabf2488a204437a543ed0f01ecdb6aab8dd994eb7573f2b750377c184cbe843fc7feea63783ca9bf01ef385853a46ff454c310ef60033e718c576e499caaf3923d3e71d85f52356bbadcbb71d7fd225196e4bbfe16010f9776928346f20f396a352a4f2e259befef2dca3cc5faf261e3a849704e90526115d46eaca5decd55a154cd82ae5caa9966fbf969e9569c1ad893a90ba35414241762d74ea8b453658e1dc34b11ed7d7092dada0f327a5303c86b59d6299782759419cdc3c06797e484600c4198bad747d00235204bbc57c468328849bf7d7a5a16af8bb3eb97e713c0b482b1f1481a7587b133ac4759e8ae9f6a60017f67678dc3e174e9a3087178f03e42c5284895e020875e54f5558c10cf74a34033ebadbf84baf4b456ae1b8a50f31cde2a3aff46141c59485ff41689ba04922cc8a3a09a1a267948f0147dd31a4681da00b73fc05d5bd05817e2c3743111fac91cc086732b3c8a44516adab1ad87bd9218d0724e0beded9870b5e62813237f161ba37d7c47bda5403528d1188627ca411f165f5bfa9b152c4249e2cbe820204365ccf922902ece8098937c9ef741040782787a55dd4072b1b501b2f7b9843367ee334d94178a6d00b997dd6eb74e48acda9f0f59780508739ec861f6cd6f7493045cd4bff6e0c3a401b5e114eeae132fec761613167317453925cd6d214c75cf7c621ceaaaa78d547f206b7ed2621076dac8e8634a71870b65a2822f6aec89417ed8d9d82daa954d2864c3ba4cc6682d8cf74fda162188c447fb59d4e4997d0b20afbee1a158057d25c445f86db74956a417b678644a3db9b3fc7b9333a27128eb00a49243eeb1abfb12b2cd576d864306599babc37cead39757b4cac72f3e80f2ea7c681e5218006aa2f1d1e23d9a12fc3c5254784948f13a274ab308264a4a2b39143e6030f0acb59ebaf1f4244b0bdb2680b8c7c1231c2e2f749e5a595611c6c0db0796b9f7f2972c5db9b160dfb1a10ecb90976964734bdc44a9bbff86013878227bc847689e66bfb4653d6d0607fcb2b00be7357e0e6a8da7810078dd45d9046b8745b51a6604bd2a799924b76f3442d9c464832dd499799429a3af15d2888814a282ec37cc9f9d825e5a82d249d30912f9ad2b5d5e31654b9cb1f53ae2e935e055504ca0a17b4d8b5f6d64d1cedeec87da9e03d2a22148f5ca1514b90a60f3b63e286924b8e06623751c935afee331313ad7ca9299d5af3235adb38b997601e3b825a1e08101a03002f3ffebe537e01eba127d28536d0cf38b311a3dd2cdb2ae4f64a37d97ffd653797149614a67c63cf06bc4dac51797bc3ee22eb0f396645356b58af70e2eca767b6cf5c25b29d525f100d16c5bf4344f439b0edcaed551137f862e4fa82da15a7a04a5b395e7c1a22df733519acb7c7460bee56f28a09f2093d88474cdd5090025e9dbd0167ecdbf437d0bef56247c1ff5d022d772c4eaa39ffbe607817147ef57b4941c70cc77111d398732d71088afc367e4453a4cbb943f1ceba15cfcdd93a79bfbf791b1878cf47803be9326336a4bfe0b95b693e86455469a0c8dbee4b52817ba658d11fbd221ab4bf0677efc990b9a8e67652830d685fac24648d5910bb500bfeac37bc65d7dafe67c151bcd48d04ac6c57c914b331635ddb7d2256ca48711f3e64453665d1b16bd63ba86b0b5c304797a1c75eff0d4f105cd0c763c286a3b3d0fa862ddc263e04da8a3c3e6715c48e3a8280f46a3fb1cef8e97a54e5199f84e734e26ed647ab09a83154046ee18734eef9f41f87bedad5419abc3e1976264f1ecf637678d2f66889ddb62337d586694621041fe9638e440d8d7b2d00ef9b3640e0446a6d0abf4fd79293c61bd605303f9a5ba3e7273a873ff5fd3ad93fbcc1ffa6b5cdf7631a85bfaf06f4fabab165bb2e3b17953cae792e2269b523bc0a706302e782e3dece3578d85b1222068a9e7928ace5d19dc9f123983d66cbe78a064522d1ddfeb051fa57381a24ec4bb139796202c1c401d4d7085aa2d8ce16dfb408fd1520c399b373fe555fe667ee44154b91717cb26568cae9b8a0096ad3323a65a9fa01c7174b87944c05badd72d22cbaef2b5c798b6bf027f14ca34f8fc014067c7982deabbacbd274872243b303af72b4c0c2345e5d711b62f588e1b72423b364e36e3c7df68e7920c96a376532f69fe9d79cc2a5c4f7868c26f9a13b8a7bf50ed389c70497b067564fa83b57593207cedcdd39852b2e5e93af62c51cead60f52854a1b8814d51911e39f24e24cbfb3c9984414a0fddc7a25951e178cb393fd2644eeee629751e3e428bd4d27d9d29d2668bd94bab4f24a6ab5ef78c3a1383c341af4340be96dc19ce7d460283e209927fbbcf8a725287d07c6e81192e846257c01a74855b65703523a810caf37e86b33da95f80f6912052d1f426760d8ae5a94323c15edd1f5f4541a483b46a4667a6ccb44ba1d960ab5f1dcc418637dbb00661fc1853988137b6d787bce9bb5edea8698e3c72699e5dbb03f3d27c578eb2d89cdb4e043e3fad2602c969e2e80be684b2315ec93386147a9d8ed4faeacdae7e70d6dbf42c9cc5f233e1172c39febc716fb311e69f677e624a0b989f0bfb5574e0a81384225cec4887be63205b7e1dca9ec37fb2d438b6d09738c838e81063663e8fccdd35d631abe04acaa72a307ed02c6587b42dc56f4b4100d13e6b50842eb9fc8af24b52ab3d4e829da9b9c61faef94e489b73ef64fae99f060a03a24c4d633c136c8dce74a6f55cfe0345bbdd3cb93af846c39e933167863af1e009131cb7cb290f3fdf55e8c4ac3e2f20cc64c8ccdf43c37b86e5f5dc91603cf2d170ca1e996aab8d9a72a4c5654a762165247ecbd8b29859bea1a385fee3cc15f6ef9102e3472ec8dc93141986c2ae9fb16b6e724e28e79ad0cb4d67ac68588d325bcbc9600687f3e75d6098dff91d8a77ea9e56466277f1c5630ccb641bfb3a6a89da7a473482791a1f1fc67518c4f03e0771b6995dfde407868d3b24905a789a62dcb5c78400fe88b353faf44843cce79baba0afb8a9058953a7ce2b5b62c22cf3a883227492fec476adfd7258bdb709aa773c292e0ac83463e1ec7cc2dff4083d7f5fc1b20c8e81a87e9172cccb0e3a1292cbe63d1353bef8d5204f347fbab45cde4613c65b779df13c9493319212be0f4eddbf43b94dc93b9af617a4f73edfa0788e1192cc450d2672e9c360f42e6d36ceeae50d8dda932c816c3466c1501bd923a10991d5d68eb20f248a13c9af8dd26d67e6535e8547e32d2df8c3515ca488005691e9e3a15775e678d8dd9d1c1b8f5e615be02f15456a7f7369fb77f1d6e2a75c36617b507d2dd27d4b212d7c0227838ad3a096214fe8029af86d88c3c8191810243188694a186e66779d7cf465cf340d81ec8d3aee29d6e838f8a23324fdd1fe3c02243cf1af99aa61eaa2176ac7389a00b1afdc50718f5707f3aa893f327e951b5e57fe865acf42192cb50cb926d3af8d9efd35815954ef60560b3f5fff0a3017f768034ce1444e77104df544bc43ffd087faefcb6c66dbce70abc064cd4419fdf9cbbea4f02b7b7d9d4cc521e439a98cb50fea069715c925fa027052ec9bd051c954dc42539a9289d1c0d27a7f9550be7cf205c209295796eb22423a285e1362b0b77fa3d33eb2c11e53493a2b31f416a0734450bbbe221bbb701b6eb29177caa902e3a57fbc34c771d501ce03a3c52fe1ae0495c1d713945a5670acaa4cc7aec03a3d4ba4c2af7ff78cf9e53d696201795f8b69ff1557907c376ff270b97d848182f34f4c5a9cb10637bb8e38873b1c38971efa2749b2ee9fdced8a110f3f15921290cbaee357c6569064ce589a9fe94fbd9d86b807dd7fbfdac6c0d500e36ef54a86913b07d3e2beb65cced930dd8d4552eb70942f1b8b31db655429809a2d7c02369f4f64e696f9b0040641b4fe93d92cbfb346c6709f5e44b411f1cb80a0b18b3aea0e0466bfaae83f2c2bb20a63cadad7a2f77cfbee24a6c8ebc0f25747e908882470da0f29b6ba0fd41203899b05b442b96f494de74eff5c2c71d92af7258d2b5e27c844658bec75c6fcde8c293bc3932fd5b82048f931336d168872f49d206bcab4f0eced1fef2d71c134dc9f7d6bde6d33d6fa3c136f2f11a6faeafe6df4b169b96b33eda52e7ab3675788fa41dafd527911c57c2f7d844b5b0a5f6088b32550565f50ef66c1705f588e5a70c1e7e475a11713840ee8490215f1462026823606167cbb81f0399478c9bdf19da9c3f056b7ff546b7960f77d428480c6c2e8d1acaefacdee60495eb48c4fa19a9860fd7f3a1a13c701d76d8041544d88c740d2bf371a8e55e4b21cdf0e71ff3246bc5f760feac63470cf52f44f2f29466883f160b6e21070f221a6069cf984bf22f765e3bb7c524c9288b37007a0a315b847e17df28baf542beec11808a59ef7342e6a4578611e5eef2f4cac09471f2a70222a47130be9dc014a05944f7add8ed3fbd45ddcef47ff940575125c0b44678e7e5f31ddadb027cf2e2825db72216d819bef0f0b4a2fdd1a85b3ebe75219bc6fb84271652077a7be39aa60acf341966dc589b009669832c66aa94dbb387bb9cce3cd5647472e4fa3c7bb1c5dd0cca874616073abdc2232fc0a3002cf8f1d50b5b6a4d6fe1ece4de6e6dc4b44bc4bd8bdc2db7a542b57d6c724e27349da043d00cff645580f20b9c8dc3385cf0277464f0fe8dbf644a5db42e0ea9af64b0322cc606e2d356784096630edb7c50ceed29c2ed4e459eb068f21fe99cf2257caa80c18d8350f81e650024488e1190c7d6c69e6d73819c54a4bf31aaa31ab8027567fb61034b4a96117b8c3fefa85fd9d2d503d2543666000fb3ba09fc49f698a753dc2e8f935ed1c0e74eac4dc90b6ac75b41516ab4e0551a170eae91517693a8a1f93ddab304561ddcf03e48d1a646ff7d741b48e68f7e5736925efe4ccb5547b7690dab82e6d1273865e9641936bf843da567f52d549f61289c70066feb94713a33b83a18d5fd145275d94e1f0e17d40872a1f630c5e1f3f60681c87811ce9420f837ac917d27cf1a6bebdabcd564d681503f1758d8b7e6944f2735f757052ef464407026b444b7d84313362239b10a0396f8697915b016906b0e658617637ac1a9af8de792c0cc626afa2e7b12fc7925644e52fcb96bf3c5e256a2d85ecee82a7165acb8109504e6f00e28882a402a3b9daf22d3f670545b38ba8b603daad2d7faeb198ab319080f9aa6d14e7925985a92c210f4e7fb6735272863d78462a3047bae4a1941e1d92ebbd503564605e3d40481ec43b7c8bdc097131f4c9fa4bde8bb4e9a36b0e67839b32d69a8d5eae6c1d5645478ef6123d83c70235b9aa0cbb80bf3b6473d87c38213526dfd421f686c8b58dad6d4cef767b7ae48089607e56d3d1771c5ff7d7253001ddbaefbf2a17b1157842af310ffea30d76ee542c7988d1b2c4180c17a7397a06c7e44631eefdb90df182ce9663a6f2f5b0aa40a1c415d1a812a173191125f1787923fb5f6b059ec6fa36cd7e6062cb7d9a8fc743c9f7a54adcdec2727c01579a0a0d77a3b4a032d725ee09968f86990d5a7450876ca77309bb62c44bbddb43b0d27b7b67e9ee83e2ca459f84a2297fe0db6bd390e40639c4955682ea8444169540b9e7b096c2c38869236b0fc5cb616e8673a14e6a9cd4c3b46d98a3d127b7c20a2088f5983910eca9725058ab57ae94b734d47b695d9f5f9d3461e326574d757c557f28ea46aa1f009b831717ce44d604db080518a5fc400c868e7b873d0523463306fca6b39682540b543eb2ac0f3b8421bcaf47c5ec0d3c8fe792de3b0d382feaec5a6a2ebf9602d381ec00c0a66c8766828649a40768f82139b69e29672761e0584ef600e62eabfc6db1ed16660b1dee0829229fdaa2428f912dfad7cd08344455edbd7ee23cf29fc1e65b93c5beef00e0fae06355ee12a89eabe8e913aab249b0cc4c64752c6896db3d7cf6c32c8ebb5ac35e2838fedab6670450328ba2191dd75995c84f490e934b6d53b84c09c185adaa8bdf56593b76caabe6b241f0d855d87d73e54b6784cf12db75b2b1b9ef5fe4513e4b2a92480339e534670b7067679fc0e9efa0ebedb422c190eb6ccc9c54179e09a1c866799b8ed61569511c204a8984648dc22962ca0482cd45733d43a4169413cc012dece828de1ee98f3b8345a31ab1742f02e0b90e638b5ea5297eebb428c6136b7f0ba4a9c0e96c59898d561045bca871663513b9d27a8b4dbb43d7b02e0babcc91d963092934de01117f18b4a0bb8d43d7a9e4b397a7265069caa401ca27c4f4d7ef3a66e56739e4c177493e64de6a041a48dd9419b046a1ff8826a760031fd38a581babf391e4027eac1097edfca75ad846d30357d5d92a53e60394c62df6f8702bcab848a198642d777b98d0bda44d62bb03ccb29f4735c2fb135e65756f59be3002072c69024af5fa1d8c14e989d705f059a7a0d7f4a45033d580bce4ecc45494d1d108101122b3cc83999749c201688fc5d049d9e548ba7419f32643d28345a67441ea92fccadf8d5f5b01b6ca2f575a283517e6e5e0a5df3e9212e41a47a394fce8464d338966ced06d39fc17decf80c27a958e07a31ed95bf0207438c0ebf8c2d6dc790dee6573d6bd778459448097093f45157b105fb18c1364064cfee78ae2edf88b797188078af30bd6df5ad29a53952f5807021322ec6a955131244e73bd625924c34abe8b759b1292253bfe3b829d379bad7cdaf2bdab96cb5cee1cc8b59d009afeab45af64cd5067fe909a0496bae4de9472d99d7137b2fc20e694a5eb7431dde0a607f73f16e8fdcec02f71ed3bbc347d28d7ab5006d4926bd508b045a7f133df285d8e55cda58455f38f1823f41862b71a6f57aa1f67fbd467bc8ca2a0022e563dd5da543d0a17f1ffdb0067a445c341e280607d8047ef4a5baeb43f0917fcdfe4af76417d57da649ca558a16a6395594e5b8be7b80e48508587b6ab45c42ddff82c825157f4e0249d61f8edfd07f120b55adfc3ee7ee673819f7e5b0e0659701a02b3378e5a724c304b7d7b1557b7ea813ed9cff2b29cedf72aea096b2ca590ab4cf99389c42e2cd82969d4b11680d4615c5bd097949c69cd43801c57309b8df98f00410d222e1353751458404ae16465ee3642da81d8b25a31cb812b7537fcf0d72d09830262a8863242c8defac11d4e3116c3d54e3389ca376d6df5ba5bf36c8b5ba615fc76448a3e4a864beb8cecc9d9614fb8b4d45c926afcbc9f4e1c4966933fc1cad3cffa02b77a7d78690fb66e931175128b04b12eff0ce10c92178ae6edb805c3664c0f620085be4ab4e2a8616fedc4ee7d7c4207f4a8cd9e6a28c76978bed85ba8debc6a9bb99af8530ea04796408da4b64a87528debea902718e26c2a106e1532338b0d477042551cccbbcbdfea31105fcec3abd2f281c33293dc8caaf192f01ddf922d832be3c663ad15b84372433d4978e849dd7e65380324e31e9f74c4f9367ce9a4f8718274132a2a4aae027f70c6e8190cab1b30e0c73ac04cdefed4f6f675dddc6e24080f887290bf44aeae24c805e23a7c9b995bd50710920557ccf72d001ee8ebb82d7eb6af1d1292e75fe866ad48add3094087f68440cb2183937e123471ad2a60dfe27b6473e5950355dedf1e831ee0c9d3b8005fae6cff8158959aa1d82fbc4593db923100290d20c4c2341a50da608c1f57302b6714e84a78840580bbf412a009b9d53d3e0cf88e21b5160b830ffc1e361eb6a33600d64669ecd1b0ee7d6151ebe984936bca0db57a2bfb0c9ad6598af4de4a1cf8539c8323faac2589a34409c8fcefdae6b49c86921bb236187a6d9ae18b3d5793a49a33d7e1f295e47b2a5b4bc1beddd1b3a4e5c6fb19a90a5be55f16a14b555f65cce9eacfe27c0d2ae089b11fd5b7d77c2b52523ec9e4865a3c0d4497b6ab71e63248c3c331c66ed31a97227d569c5f39bbde5789f92a963153fe448fc7157f853c4f4cbeeb7d9f8d98260aef9c13da7fc5148631de9238fc0c7b6e90bdd7624535a264e2e15be7b1f4754cc45bdf516a8a8e2da31bf52f8d00e18f6f0eb5d71980edbc282e0a287209bf901a5c9656b95f0cbfa370bb0aed6bb6839147e719aa1f319a2fa0154792d5b7972ac71c15ee3ca857dc3e5540f2de1dba7d527de7377f09b4e6f3253f1f782a0693fcab9806aacb7fb930ff6ea5a5de4cd9eb02e04a67508271e25f88799139626e5a9244c51ac4af5e3188e402f18d7703f532a584a13713cdf44d362b415caf5b5978839ca60df71a877e2f3d7d6b1cc18a44cd23a3e5b0ddf4aea037e1d1f0a2e9943bcdc2f14481f33ed999c5e25aacba4230e1eefd41392ff7477863268ec19a42a3fdb4c59adbe1bb16a65bfe7cc4ca186ee473907ecf54183ebffea08138d51c05999e352a29633b78a082dd203e2071c7f4851f8152910d0a1126be9fd9417d9efe6c1360f58913b8122883b2e25651506483c07e06d82f1ad61fbd5485cd9d1eac21db0e6d8a36dbc59a9d6bc914164914ee39529e2e3a84a3066e60ee0442d07647a95f917d080fb839ffa2922b33286318f82fca12eec57816923635a4cb81815dc783d0ea5a7bb2ad00ed916b83583767c8082f05b2e82a1c65c365da10946915af8fbb520882f67a5cf8a64c5b5bc494ab770a418895ce1008c0a79ac2b72c9f566b03efafc99824cc769b476d01097b99e012007117fbe6a6b0baa3dd1512eaae4fd81109e0a8c3f391a384c3c7d1ed24c0f5e0025a07c3a6ead5e79212808c96815763f94e7dba4c4239e61284fda9c9ea34aaab9f1223844162915a594098d718176935e33f28fe0347edcbc33a821a9fdccee37da782a262cc490cef35dfccc55f0c21e37d203cbf3bef68ee6f77b55caef17045e916802875bf631f546d867c23a50cf2be8e69c6cdcf57d52136c9281497478e1a8d20a0d77c936528fd674dce2496b3cd0c021e7c4a6d50c69aac06b6fccce476b329045011bc42a38aeca0030f110286b5d30947a121dae4d6f4580b1da46fbda2f225d9dd9c71eb78a5af2d01df025536a43b5fe317988fd33cb877cbbc202f14a3ad6c9d6068074796c402d02d407b5b5e4be13bf9626edb72178907b5db6518d444be1a71fee1efc3fc18d5c5adf02cecd8294ce7a7f7268bca35eeb04461b2dadfbbe7a5e3678fb89b9e66db44bf3a1b267021963e790883d5cf92cbfe488ab2725701130c72c25c13356f0f85573be3c52bb8a30e4a47c3a06dfc672054529b5c558ee19ad8697b75ae16af7ee8f5b0e799befc4f1e073c8588a32efd742c9b6ffe3867ee0fff5d79bf6e3919428437aeefdf734573d269f44232df7531e910dcc6097c21c13a675a6f299ddd924f3d3b77d547abf1e7f7f16db624cf986233ff128713d56c3de6e938112f71ea0663f3cf547ad645352409adb902d4a6c3bec8e938f12482a618fce7e120815eb93681b8a299fa5fd762fdb9b909e4d5a39297aea2750761cd4fa73ca79b68ccfab00133ee313fb537fb248ef21001eb0cd34c8a9aedac11e0cce645c98dd00c216c5cd255dae563ca94b6e83d89905af3004dd138edbd7676d1ae241d458c3e5f8275e8d0bc8d703dda5ec6335fefaf772987f1e5620640501663856b593f497ebed6d68f4df66adcad7ffd6135bd3b4a32fb41bbfaf4eeedb467feea28f88fce1127c98d7595433752fc83b557475d36bc4acb22e7e77ada585ad0c84c2ff0b29e28d68c3e81f7c4444101bc01b05c444c8055ddb56068eff77f4652e04d9479157f3c2f7794754305cde9aae1a53d36cc9dc0a87554cc4091e2cb8f0fa812274f9d463de50448d99088d6c70561f50ecef78309307ff2eb106aa3c624e982f2d10d9bdbc0d1c77d9a1892e2b8352fc2192249a522eb7cf339cd6db3c6e0533a5bbb5788db5c200134a8535db1d23e32375abe7f85fb97697b76f629d77acf505f6c913bbe283f5ecc4803a236969103c27f67b14b5738aa823329933f15343afb8177eac392eeb9500af97bb99b2f8bec382024b8a8552c98e9ebab500cfca49a139cbf47c400cef2f4637299aa57d7e2729991036c2972b613bbd9907024e38278b49e3735a56e133ff41d3c7d150c5da923c4fd7033c16d06772051498d28aa9961084f306de255f82b34372a473c8b54d7bd078ed99c99c6657145a79b078d745dee770349e89a3fb29ab1c5fd947ca518ccb8c7d626dfa1050e2e6c4feedf941a4cb22cea1cae58be9744b88db13c8f3c429b7e19b4c000776bace06d55a349ef09e25014e9297bf1318a81ac42dc2fdbb8069faa11838f6f0592938f9c0c523e5ee893cef23e4d42da8d6e6b21b024e4179c1210df5f7b725be679510a9fbb0f143cfedaef6cd0e1379b48dfe890cbfae90f673247d4d290b3a889a3b8aa79e0341b6ddb64a86bdf59ab5d35a2a4649d12c26126ccd36645bb0af57eef53da9a2d2677d626f66086a6c4b1e3600e714e251395bf76740176823bd549383d25aebd7c1bb80d5858668781caee84ad085f631ba7addaa4e18d7bf429052950ef118b64b7a4993b875b1071774142b480f07e69eb1b04458974e84c22fa6b066e1d2dccb53e08ffcf43b6967bbe3cc26d6350a40c119f815fdfee8e1e4fcf3e4a357cdfa2d92cae8b1cdad711716a96972de67eeb60ecfb8d7eb9ab06aa8b52877cd018a1d762fd48b3e97ab8b66737fb437096855528d347892f0f68580dcd6c76d307dbd3fdf50094152eaefa5998e71c599c83eb0e590155dfafd0b85f599693d572020526b135ab631d277909be6f50a806a61e3a84d0793f2196d6f41b85b5be2d4342d3c97bffb1ab92c003dad4efea5a8f3d0fa5485e157353a7ab963abb26eb2a4452a96d4a112fdd97ab01ef755559dd7463342244fc4f13abbbfe83981ad36c8ee79b546bc0f5febca8994a8c474d5f9f985318c86f813f6bdf5309ce42cf0f5f971ac5a976ce428a62ff2f639640b25c3d22988d9420aaddb9cde273db6ec88cefeb27bc2d127f3971b5737a3a7e7832a6ef4bfa9c374c9821120a18acc4e3c7876912fdd78e914e69d34a4582a74a4582777cadba896f247d34897a39a372c67f8d12de5ad91e08e0f3d57672b48719ff06105154acb0462f26452551d79eb3bac1eb68deb96b95fd81cae89b6f036a8e33023263fa15f36d5e7a4f07e3e46d2d8742f5533439e3aea2908fcac4eab4f6d20437dbcb9d0c7424eb64a84a6cd2ec488af5dbf1ffa9fe86a1ccbd0899f89443d34f59523f17eab6d0273a4d42685455aa574fa529ad5d88366fd5f3cf863855686af235a665e1bd781d111e889d2fab17c6b4267bee29125c40cdeaad21296cfda98727d994c83bbd21aca082e7f3867f0f2c36cc0811e9d088ccfb4418692302cd4ea6cb1e2299379ef8fef2ae255359744dc3ae0922f1db0be966fb7a54f4def3974038002262f7f518c65ee99c46521ee90a75dd450fde2b5d3f2383b34046282d2fa42ed8b97404c611237e9b03018639e3d42b74fbde650544113832e2a1214b000e5bbe63c3e9b6538d5c41378f6ceb0709638a6e9408d9a69ef30095123e96f10de0968608a959e3e6e07344fb621abab5c1c59bc0443d1736c88500d1ef72dffee3db9c69b0a87965ee15c18e6fcd5122509aa8f02155872b2ee46cdff60e528b085b2152db5e3448db589bfa5abb6da9bf82d1b76440950bb367efe3f52267e05a751281dcba639ea7d271507a7812bf4de48a3a6eb6275bfdb1e92fcf2ca400ee800dd663b6df9634070aeb71c46ddf8566ecd832d6f05102e9d538f251e79f753a001c07584ace6a4f55e92fba69d709a08e108a6711b1a1ca173d7cb8e61bf62a38618786c0d6ee3f88726c163d34f71dab19b17a9e4e74c7f66d032be998337344fa4c0bdf2dab6e417532a41cc0e8a08573847785c3858979cfd46eb2c854b967d7847250423145717b8584eee69d3a37e737958355f659d014553ec91372ecc325f721cfb2abdd6c79bc464919bc255edc38d9354a92fef143dc15853c04053c9c95b4f0be6b8c2efbb6215211fc4b2c90f9d006353f60f894641e765b12a7fb27b03362d5068d326e5506de4e57607a84b9e46454021857c68b6d35d7a611e2ade23bcca99accc0a4074539a55b94ea12676bdba4db27f5c2d564f3adf668d8b86d26de2b5df560d0372d005485a2840d79b4392decd531b84c15a6794d7bf95e3bc5a505434e806ab66b8500dbba9b20ef72d511f987aea98515ead0070a8bd90f065c7fe59525ee9fc78f779e6ce3c2d35d4920c83e1afc1a8ee82010813ca3d938a61ca0f9291943792e0f279dc84a42737ff08ce566db27a34818080ed9f1d41176ff8df8339cf43fab277638e9ef0ff6dd4703cbee77c76c4b858cf378149c22c3327f0451247a56b2ddd0c96aee783a58a1ce1cde33bccf23984ebdd80f91afca5d88e78f8478822b8a8c4aa6217c0e308c43e04d006d34b936553915ea3983bd2171ddc3e52627cbf1deae499b51cad18b9a293404274c87f3730f51aa5b93d11064b1a28b5eba4d2a959e77020ae0547bd4cf0deb5705a8bca00afaa8cd26da212f5199b246b0db2edb4531946de736971e411e46dca7b35b2fd32d225be147ab4870d05f465fd3c67cfc124ed7cb5db39e9601f9493cf017a8ab4f71971aa52d1765843d0ac806e5f8dd0ab81557144020a617b410040d830fe424251c6d5e938350a1894f0d37ec05603ae12eba4220453e4c00f7c778ec8f7d2dbc581a191a1a70241b88055cd0c2d2f8b30a8ca2570fd6f16118f3d0bd685433aaa9783635544cb78be286eeb6d6dded7eb0073d8fb2ef86adaf46bbc97bd80439b8bf42b17ce7bf2ca003dd5c86d1b2f6801e00f555b0e9c0bd0f4bb0a2c545c4d4cb52bfcf9615cb5218e379f3ef4180ffe9662ae3057756f57e2b8adb32576bea8ee27d03adbd5359adf546aabdd889c5643063e958fbd832a1b2d4ae5faf07d68c28f1a8b4881dd4cfdd1e0eb9a381dbf21eb620b6d0913768485d33b4ecd536128e90b60f3eee2a9756bff8a01015221585e4e79846fa526cea209e68871d9e78c8fd6707633e1e0c6c1637d1395a74a1ae6ee078bd05a5fbb979ef263030663a37dd76adceb682f6237d06ba0af1eeab98fe878cd631ade228c8a97f65412ee9a44e132a734fb93213173c1cc1c3a312e06ef5669a9fbfd2b8e30483b8402ceab7149faaebe3cd49923777bd720e19df04595f555c39801eb8c625fb0440baa9512a13ab0aee93a59ee44f064afcbecb595564dd3e7cfb029f1c9aaf8e1f794894ec139c60f63f06f858a12d2b6ccccc695309727b921a6d0d7415eab9e333ae4e1456090c315c7da6cf48d8b01d7daf020b1d833e3a91b90eec4ac6919089644bf5c2e186d525c3bc2d6e36f764c23d974079daa4ba096e1a327b3081caf9085f1a55096453f374f9297b58b6f5a96865e28e358899b6ccc8d0dad2a23e172c27f6ff3b0147c72c4c99220fd8c3cd111114f0ec6162a85bc32a6acb966d90c3bab9cf76c595f3a4285b1423096ca9081fc7d08ae504f22d89e015c011863216d5466dd2b945b8481193b17f8af9bca54c2421c63d8a1bf8bdf071480d9e888cd89d1fad5c63fb688461a7626a24997c87760ae46af7eb258a4b2ad64b023478fe8f953b35e3cf01bca50b142819d85b47e992019b2a307ebc463e3c7be4d61649d0e1ee40dea91f8cf783f01502739cb2aeabccd7c429e9539e4902d46948c6316082d7c6e3ba09a2f27463811091d30ac6a348acf054d17da36f93d49e0d8a6ef047a9adce8bf5b9d91df6f7fff7d3d3553a1910367e3bfba3f489d7b680ef3ee60e75a1253fbf1656e27706007cd17ce11f9dee3964a3c065576d5d142555eb8d559732ad9f8b4cccba3e9d42f732d5a9aeb7ec5c1022263fd9324391bb9d1dabc376b1f563fedea370fc57d076e97e2368281452d5ea47dd64233d7c8d8ec5bbd31c9df05600ad2968386a06f8a045e166683b059c19d3b22061b8e191b6dddce148cb55f8093a5d5e4f52998ecb048c31aacf8586ebd66b172358da9d32a99673ce7d3e288d6d101390bdf65a91730019df3f672d4c0d22784182f001a38861ee82e934dd8c458971af7c1330660854c16a3007ed6be217860ab4753a4d645236afe772f4471bd4ebaa26f3d0ccba545a4660120c1321ed90645f4290ba63154c0a449ed79c9f5c79684470162ff5657a0c293dadd6ad58bd0c49e5df3edf1f9ddf1e8f13c7cb1c1ab9eb132b9dd3d873672e1624f5541bd05254dcf2f5e5b4001c42fe68c1ae80b631ca9ad0505cbdc314058ce7292726d0d2e2c618b2fd31009b34a8601dbe538ca7be39e67bf38e8483ddb34b5c00ff1137771b01088c312f89b63c6e647095a7900eb9678887a6fd6a05cdd9f30b2a4483353a4c1c5bcdd68b48f78a239ed880aad8904da1514edb9732ef5ba11c24c467348003b6eb80b90d2c92ba403f7be1fefd37c2ead262b9e1d1f97ae11c78c794ac4809d4fb95089a4e2c5050b86d60a5f5f655ddc9eb460f1858742412554af15e155d12d28e45b4f391edab79ceb08c3f07f33e613e98d5ec732ba84d94f10e896b5a2943e885c91df144fac83ae7f512079191d853b77fc49916f98672090f1b3da5ab8f071fb7c9df780db8254bb67abf5bc8f8cfe7a7b66d66db77b8d4361d9ebb898f9f8d8367674c75d644e488d2c0f6a35743845c7e411cfc760feace50d1d75a65b180bcb325d775089700bce59f180c0315aa6b087bc52293b01ed7246d04150724d4c40db4a5b59b9fd9796b1c36fcfa51ee7186277d2e9e7a235fee811e8c1e8eb0c6585959c5f82533a1e14d865907f3e72de861c4ea1e5306d47ed5622c3421789654270d4f4c099b49ae28966196a4273ceb0b7aca313426adeaafc6a43715eae363a91e269c16ec681c2a8e988bf3bca2b5753239c3f04624896266614b2a5dd2e9b0a2f60841754b1bf5b1cce86d174d0969ec8c79e46cca88d3420b7bf68ca03ebed070b28e0f32697ae48711ab9a1921f68e9a3bc5f04f8d2c33d6f27d526973fea114468783b9864872f76df22b87a9e7f06564bd1fcc17bbe769b457981593405d8b3cad24238bdc536c0411d4ab383e2853453f8fff948b0cefd472e60acb8d46b52837b392421b02bef944aae79950ac9dcfdfbbb43c41ce0ac371d88c51cc4aa2479b2468033806d4062fa468ade21d3b466514b36aed7aeccf54c5cdf8c0ae14d913da3a3f80c77e81b6ca5d66498ada39b78dbec59b604d0c5d98351a2006c7adf31397e8b3844d57bc1ee7e15b4cadd85a3a48f30c050d2a629bd96412d848039a306cc15accc75a7954b16f8a93c3b1ceaf3dc518d84a463bfa197ca86bc122eeeaefbc392c1e4bd4aa70e14c54cefbb69089d066656eec7efb1eec28d568f522d557329538da218fda2605a1021600ef05dbd4b1a7d233a16f05bbdd577b3d74716b54595cc20a27ab92191fe6a039541ec10a0f1893cc915d73f12b7452af0599ba1c7f0bb0dbab80d00242fbba0bf9b0deda4fa43dd41de95adc65867b06c528197951597f80380974d47967b85db951d8f420bf2d29e277c9de1ef6575cfacf22821061f5a233fb5b00b07557da446fea435a0c89522a0b8fa72583d2ad42eb6065964ad89c8d79480b0d37c0c4ca25cc697f83586bc0862bfc0394b5356715f6f84bb9215ed43ea7a401eb49570ae9abc09d9f2dbe5a26b9a5d947ef74b83468c7050a2de94f9eacd269c1c741eec4b066e1cbdfa912723e62875ac00c2936d37fd49095f0d8ba6a8f02a3bcb5baa5fb439e88c41fac3d346178ff6724078673c5b6fca6494cea98f512e3381de01e749837f0733d608189395817b1ad460e97b57f6f964f98f1bd392d3e42869b4405deffadb4a5b5d7fdc1ce2658323d6509bf5726da6cd13742dca0a817d82d1f6502fd5e1d385b285ce7c2b95045747b09ec631d00e3d3b4539b3dfd42c12c5f71b4bf2189854f1729edc6a2791073c19c920685775143577e15fc783f2c6772669dfdaea41ddd058d09dfec057ce3df97c04216fdcb85e196c67bde8269996afd0e75e4b1ef97be6d2973fcfeb61dda4a4eca46193e3274f95a67c731b9f3be7e2b2f51be427b2644b735a01501e7d6096f834a7bdd55d81dd8cda996e1cd31877d1b6060d46efc8a17be07c8ba0539e64123fb1405b7737c9d61cdc9d096ac50ff0c6d64e7946b7505a18f06b844cf2bb93407f36ac51f233eefe5a2e70d06c87b694ff005e705f7e2cddf240bf33026e1d9f38c9a45acd41c11ec8a244598d6c7e0d5fb363e2cca29b1f01a973720fb50eea446991761fb4dc7473029f3ccd5c19e2c1fe2e7ff7065645d5b957d4b90b0ee95b99b00d5eb392a8675e5f45a4dca19074e14adc2b7e978b83545fa6f148507bf3a3009371a5be4e00ec00cb93efb87b5bc87be87412ade262c628cbe6588d7e3083c749f9214d685f2953791dbb40c33b89cb357adbb5b7e346c4dc9d33c83a04bc3863645360b8c013dec2f2b5517312146fddb41a7dca25deee847f1ccea14a082245c2703fd94a7af001f800dea0891c4b85725351027f19be87908a4057106ebb22ca5b585f9a4800513c1044b86d9d23c51a4223d7bc13687ef65f59f75abe9a69e97f9495a6797c9d4f7d38ce672650c94f6658e56978d80e3da1c36bfc16ac514768f74cfcd4c1a415ae0f8fefae40649a2444fc3dd3e2575a250c061c5ede25a35b4ce64126a5fc14022ab3c1c8d70711c66e0940929b11ac1b19235611162b554d3122c41e0b3c522fee5dbdba42744c8593d8b39fd3b18bd640950f4c999fe68cfb9becb1cccb8395936ece226a21bf2380e04eb1c4e8a9b17c6d0b652569daaa058b2c1336bec7acd055c5f19a39aa9892565a43f3de1f9128e2227e063273bfa7250045514e078a02ec0322c5abfe6620a6e3a3af57091ae89069e36c9c20b5d6f773120aa66521f6905a9b5e5bc0bbb61c5988a482bad86324ad3c8dc4569efbf7c0dbd5a6c371cd869d2ea5ef2b91e7df80b6bd6a65b1f77e16efbd97cdc55aed51ff42ba2c3a6dcf996a6bcfba320d95e2f40cb7ac5a60ded0a6b30f96faa40ecc5294883931a86027ce1a23796d6b2d223d416b1fcdda804b54eb290889ec776b3c873541993af60d48c005226d42c793b6581e05092483948162aa67dfb8eadcbbad9db2c7a2dbb682f10e526fa372e69e87bbec1734a758d59284b93b6081c835b5f84e26f388e7f576d3149cb5e97d89b0dd611d2826ce183b3650d01d15794877b49c95d3ba842410b91ca0d00503c8fd78b23e53a09c641810ef2f9dd53676a92afba22c0c96295fe5acb867b2296400bd11b488fcaee82a54eb862127a8a42a2f4147886676052b306f35611612df3687b082d9d03361cd8a5ac0f76de2a4b60031a054a6fd53ff5897bac942e256a0e8076d6d8975260ce3f8c89b7dbcf53114e023dbe8345d062d2fbb2ed6371accbea39957b87651979c623e0c3be0e4ffa41bbb93e231c37aa8be6d4cf5009443367fd785d450a030a82fd5f75f761cf0abdf77682c091d30be699814a054acfd42fe678cffa0736c095c9750b61bcc445032c73cbe99114d9ccd45dbd23b4640f5f1296a3f276fe0103822c94c056060aa9e87cb08b2ac9a66eb1c4cf370f4924c4e5bdfc4fa3dbd3f4472a4e0bf21c5bffa7f9f8746f01704926c1305962829199c8303470ede3dbddc5a560a2f64889bafba1c18cac2c4159e1c99b4a7c4f9856fdce6e7dd18a5c3a84c7262b45729019b79001c70438098207a31ae52655de9250ced460732699968da0e337074824df09682b9ee1b48c6391958ca35d90f52b88a5cbc3a3076931d19dd32f75007c9bb76c17072e3962183952e620fd8312666a9052897403466139c0f39646bf9b8455039a7120672315836b27534316d0c457c30ed9ac57e013ad8467803de6232456b0f1b2d77ad63a4b1be71b6511616364d8b541398c65b9174d1ef9f6f149ec7028d7bff3f4ba5471ff475148adf9d9f016fe9cc4b3ee512aa8ba0d9a8543e2db4d6296f7033f3a04b544fff8724de73df8766fb981311064d6ccf76bc840c5ada6dca67c376010c648cb0b502e40145cc723baf4a96c18f101903c03b02d53711f554d9303388937903be9cb001f767fc07f71c200fc492720af619cd608fc290400a388485aae2ff9d61f0407f487c404af72268f63a10bed5197238d828f589f3136fa2ced3af0158f58f5bb3226432cafe06262f2133fa7b34d43c08bd83adbfcf71797d67a43d8a9f7e4a63b3c4d6c29b7f4e67811e80af4b4a66fcec636f121f205b26406f63742ae007ad5c2b6603d9f93d4cd4cede33ef4a5fc532d6915c404eaae06d35a4eaeb532b98a2731e23e0c8557196304d6762e7487af1760cfbedf087cca58455b8c622e6ac59263f8f32e3456e5519f24674e71ba99121d4727efa6525260cb7d5f1eb67cfa61b19e92d816dcaf785bffc9b4d1301fc7c2417fae7aada2758b9d313fe484e12900ca901cddba47df6f6991d6d91265a87385c941d383d70ec6b53c5d0687a130cf16ba8576e19aa142d30146b83a12d45a182e1f8206fa15529e836699e91a7c9c6f7781144619a171df0b1bcb8b4f58538a8859b5b4ef9273af02327371a49e85caa2b60570b5ad33cf5388ccc5ac543ab13835170c3eec8fbced3dd6059369ea410e85bb282cd1597bcf7764b8017d4e6a9b2c7c810f3ada65ac99e3d366f3a715cc17380126a877acb46fbbfe1d03701c03d2b6d4a3ebf307ebdcf74db57bbc9877e6b6450fe5fd48b00ff09d05aa6d069ac9fc326bb083d6f250f631e370a34b10f284acf9d1cd0d3261a6f96108976080fb66c41d1a903396666a44bf84467cf2eae18bfb6c0998b69bb98c6265e4b4a743501a91b6713dee96ca4d96c62701d8b7be3a5d5523b65b87aee7e1b360fdff687875a63c0e6e780b174a30370a3d70b5362df27ea68761638f1ca597752a750d41a76bbf134776361afa783e73f46ee307870f7e42e233007026839514d4913f69603c4d1ed71ed62aaf0f2eb2525fc0fdd1d0952e02747b0b885f8daa594170d621e46b41b0909de15445922fa2167bf929f00600114940304a3cb3a2cabc8a1648ca20b8455824529f14b5bd9a0bd97228faaa06cb24440deb340eaaba4ef980228f60c9917ceb86ebef33e61da35707409173c2737118dafd98c57726f0e0ab96b5a3a2ecba8da98f26a831c2f6d15904a243c1101edb91c355dfe4c71a82925411e01bd76533f17b38cdd2f895d6623ead54c56804254c043a6eac93313a288f3364a3c63c37b8d821ab666f85263085e06c9f559bd441a46dac6fac105e250c05d264676f02579d8f7c96522535d1c956411342d059f0b8b048e3434683821f64a02b15bd7e239f410cd08b9b188c0e1c7034e5cf59de550bc461b63ae6e799ea0e1e64cc1a0795e8ec551f00d786281cf91387597db5ddb7a3dea7be8dd6fc2a6c159c293a3005182f69a7ad185b3acb8a2f9ba1ad124780cf7faa384c616e6579856482b87a082a5254d759f40571a6bbb4d5bb949fb1feceaba2ebb6a70572f6c394680a2882e891043909633e02d66f8846f87322e563363ac0688b8537dff75cafae7a317e28666e89af502065f42a02e1a3c277b1054ede777964dbb0590e34f94e5d15986bddf137113d94d2739e755bef681affa4c5370815ec37a4fcab9269dd009cde195679ba7efb290b38e12e2076c9b461b03fb3d98473e7020898f71f0975ca12c30cadf53d5f3464ecd39490234ea26fb68c7b312b41f0bfbe97fb6ddebe9908283409eba437f477b98614b7cb236559080a5d3705a9eca7fa04c74425cc06617b9c1fe60a48fdc796178485a5bf7767529786e7868a3fb7a1b27aad252c566c8cbe6f9503aa88c2034f1c4b684390e0f1653ce4caa1c5269eb071fc290684449ab8d1ba5ff01e6435baa29889ccfce6a2178a7a2ed7246ce9b234f47d4bc55fd3a1f5166039aefad5be396268e0c185e0f44270bd441817351a6f1790fd555ff775e0d74cf7e64da3a1b71db6f2c0baa8a1798327855adef35194ac9f58d38caa515545629073ee44e2ab0bd8e0f12f881076edb7fc751741d29f083fd82a9cc1e709d2c1d7e1b9bc28c04b1eb7bcad8edb5483631c366e06c7b21ae74dd1866460c7fc4bc1abc1031d5158ae95635621f50c9c08701792fe35e343b16e2b99f676f3bf8d5799e31f3eb166019d88a999e1fb5b5d78ccf85ebe36b14c50e457fb24d1731f86bc055cba8f91656a5a95e10fc5930a670ba430e58db2f6a22bc478baebae0f85f8b391f67102f2fb45142149fb8450b36cb9dbdfd70c56a3ba74a66fe2e11df5a829f813e46f322bc3f9b4fda02482562b6b01a64eb036d481f494057b1b24706e6ba4fb8e27584762af45768b447d3daca70882ce898c4e941158f014b7f31d2a45a837510bba674e6ef52365a625b5ab99e9d8898b542686833c1e63a109655151929e8b624aadde40d8452d8fcd771dc1e2dc39e672d3eab917692061683267cecd609f9cc6b89f9843d07991d419d56c92ce2d382a736372f4f0055733557a36c41080e5cde0141eec88b13f650144fbbc54b8ab76ef02b6fab947b0dedb56c9a55c2c228ed650444dd0f6892628ce9e3f6ae3ac06739d7459e78526584640e76e825ecbb9048c5b3e9479b2f8c6a25ece4bd4675765f3d3a0572e3a82bdbe286a302a881f30622a1b380f0a4def40b5768327a7fd07044abacf95cf6cb3f72c3a62d875c729f3ee8fffd8d7d54762c99b8dcae46306ad02fc920019bf28ce06517f67b7566a0e6d2004fc16589589ca3d05a03c4b51131de1c9279f5c8b5a63d79a44ce77f051475f34099cacae52664c0f6c88f3f362c4bc0c1c7b2cb3bce41cf52df380d7c409c28907dfe644b72a6a9d53912b728fa0b7e7beca3f893d480568ae244a559b67629f7388dd27a95cfbb2fc9197a8695c6f69f57df55e131f0657a364ae9fe9e13228d5f96610ffe6f859bc23c3a9aeed5487e88477fa5adebc00cacb5842865d3d2af8478d57c913894a52c25c2788edf1388e2b0fc86be6ffb04f3a8574efa76d64c5aaa714b22a5493585a7d0c0faf884f7655c1f18ef0580f047fb1d07d159fb9d4f4e06f703aacdaad2e491c2248b4d0c418087593d05ccbd35edb3c7113f83924c15fe4d7c1f31b6f1ac9956b36bcf19badd322199d1827fef3fed78ab8adeaefde539ebb6869753541cbf9c61238e02735126e5b2c7c933c3a51bd64d5c384d61ca637e970f252b7d11aed351efdc2d85cdfc20288c1c51fed7625c64c7dc230027f26a538d6339e608ad2f66f9857cbedf94130c0ee5af9c846fa7ed069266c8a681160bb5f7520aec5939c3dbe1c5ca18cf12e0718311cf940f64c6187a7022365986a9fe20a49e1c1967597e000424f5fedb9ee06b06db2f1ffefa5472e208fc55202ab5972b0676210c3f0dcba93b9a7e45a267dc5114c579fc1753a397ed63a6e878551a3d0759ebc0619d2e18e0a6d3a95ec813dbc625f31eee440d0fc82640073023c1d2b81d8ba220e3ec9fba4a74fa6b9fa634e1fed36bf839dd915aaaf5a0a8246ec6ade8c544474e0e16aa1dd7da63d92e2127b7bc854f478021749d30fb49bce8e5437caf6001de91fe781d667a0057f8e6aefa634390c3aced585039e8d3e128a45e5ef654ce9b684067d04089e420ff0116248f516dc3256817aa9fdbbc50539502fdc91e8502637661982d5b796cb5caf07ea8f4dbbbdad98a08082546bd6fcde91ae4549dac22310a5e0c8e64cd50c3c6ad988832bb2ed3f5305fc9a1633ef66da7046f44cd95bcf955c280c66ff3ab1e350d652b635d122fa72ff3e059774b8b29f5b7ce65be61dbf131d512df3f3b56ddf53e4e65e8d62a794875cad5b3362bcd53811e675777350f9927cc08fe5e98176a4449ddb5cf0e2251ad20a80c190b8eb30c4c120c78303256390af0776c07f58bcdfd65bbb7ee748fda109b79db5305a0af2419bde08466c7ed84032fe23ccfea20385dfad1c4daf625d831285b642b319e451d3b8087288c015035473cb70e01f41b176398b30486be1ce9a4ab9e28c3555516b770f3a1530de9cdc320d076872d4fb2192803cc547cf00d59485bdf9038e323dddd6fe9f38e16f4fafc09c9b187e6e6dad416524bc4a342f03f33cd83029cd6b625fbabc3786d0dffa8fc4aae384f94b9513f1458434c8ddade65a1a28cdc02170709bed59fccf71b3da643885130df05de154866906c6715d5a21f2ff9eccc1aff688cbf824698d087c1ff31f5042f859a11e0c098ae5c5c050dbc0896b536be883ecaab828b0e7750b652c97a3496f849587a4b2d5377b285bdd5e41391603b9bc4234c9edf42653fe741672b4d27773cec2b549656d91c49570748d952fa05962d412f793b2fa254c70764b22bb97e85e32046743974e27265dfcd611c0ff4e7c1ca178b02d50590c59c911658a58cdfb791a2a7072f7360f92e1048a12f33867fb5691fd53e88c0b64846d3dc803583e665f4a0982074e4b6f241ed8b8f8f77f592250c71f50c6f1d2cffeb818fff4737668570c23e61c673771debf1316a28d6757fa3e5421dd97b6ae6a1398954e61fb5ba4acf9742ee0b8c66380e2cd9ff33d751da25fe1694625342f60aae6f8bcf95466ad0e8c6f6ba46728d6f1c79b46bce110bad034fdea51c7130af91281c6b2414d00383c71b09ea5c57651421fbfe2b24fea203758d3203942da418efb988dfb4f1d90e282a2bbd394b15d664cf4061e9466dead1e2d06e6ffc1458568fa672fbe6876358b70b0bc7fd655a5e2842067ceae2857c63deb4d6d0cf206f151427f81cedbfe53c31520fb162f8e9fc892bc8d70bc03c58b19dd67f36ccb292b7528fe8b8299b2ebb920b5d4339599f5ab74906878a6656de67f4fe12e221df0e3bbf8a57ee0369e6591b8d3511ad4f127d8aed0f93ecddea2faea2c578409e30a043c44b799b1cd96d0c7973b2aff36b978b3aa238ff8a24af2e37cd4857d4e3235d9e17f93063b8b36e2a3754239f47e9c49227e79935dafa3db4e8ca102c53eec1d704b0c667fb9b7fa969aa92476cb014a7a014dfe20c3a1a7689fd82ced93417742e2cdd2627a098fc62deb27bd95cb1673a252d53c1097f98600aaae3212f76c2b4d08249b2ed5f287e76157bdddc50c8af06e39753fd6ae94cd10159a9ebafba3d21db553b4b4ee1e3a510d207c9a7ecedf43fee731ccb76926e2f0f028c62321379854a7b7b38913f8b1d015184a98d55082666bcbd4c524df2fedb185363f264026f6023d632941be05cfaf41e43faffec91df8417d1cef9561ced9d49d4beff6ea131e0a18114946b332d3ae105a6ca58d9b92930ed5fc35507c8e12c82073531e6d1f798531ed285b1f2ab127ea8c529454239bda0732b86021a4f179d2ad6de1eae77dfd6fb08cc82be1ae229eb2b02772860e51e26172f89d234c137e7d02cd3c96bd66f4fffc686d2721630e9c5dafce5ae61fc3585e89852175c00982bd8949456cbea8fbde6f3343ca6345e6588b63606fdc624cb94d49638b4c7ba5b9964e701e2c60f1221a1b32defbc67fd1d89dd4503bc74f8085fdaa3dc5fd56433d61f92e51f54c0b01760ca3fa6072034b193c61d1be1cf8e097d529d7e32ee58ae64750cf9d6129ad2f39137006f1f5b895e6621e2d707cf8922b45f2c6e0e48c7ac912f0e0edfe30ff2d1fa1431fd1951e2c337880486df26244cc573e9428f936f00c685c88e6ec58f144702e702ba5d5d19d575258b77d74aa203f7495bbe686727efc6e29f432af1d860619769b94a6265b8963244ef5fb2782093e6ebcbf1051b3ca9d057be608f822dc798de1c31de821296e214eaf5ed576ce0eab9c989a9b2cd6c5994addae0cbe6090477f5e7d193468666bba25ed0887a0eb3d4a5bffe538d55935b368b6d40a55c973ef50b263888e04980b1e2b90b2b5c23c199ff659f0b699d91312840e51021ee10e16f9d0b15790e5a4a90860c9c54eb150c71c3a093049de2fc4d2bb1640c6715a54b4ccf1ce737b0cdb53b895d209f46fc440f439b8f324ef3d8e0a6da905ed4950e8c8cc45ec87f861357e8241c1fc092ef74ec1c0e613b7515713c93cfebf3de53bdc7f33144609d5e45842018b032a65539c62e9a4090d31664ad092facab3e87589a5a2d182b53092e3b121c1890de3b3273bf4a50203c6bf4d29fe59758bf675622106fa4c9b7dc1bb6b14677e4f86dee27b0315c44569af3f11463d2a150b2ce5a3b6cd3b87aa7155afc69a59cfdd58bcc67facacc7b4110f322e5f0cd671feb1f59b531bcb35e7f7daeffe3e4a798ed3ab8861adecc536b6c2e75a0b7ef61f29f9d860a9aa6cf2277918f9938dee3f1ab7292fdf26a9c2d58794db8df13c9676e0fd5d9a05d1266c22d789f73b1372f90b72fc1ad3e8c23ede046950a6fffd0fa4538fb23ea23a9e314410fa4d1598d7843380f2ba49e5e659f3b655200916f9c468352ec3c32585c7a5d3d3a78040ed249ad3093f8007240bdd66e2ce25d5a8cd2a5caa34ff339a7a9426373333b9105448c786309cb3a7d4aaad1fd1bf94c5d1e726b57db26b63a522039e4fb2b35a592b8d5c7d5874ae3c16d7fe746bae892e98609df6f4f32ffd718dbe953b6d63ab25b4af4f1f6971beb909b261a400ca322c1caf2e7790ece7fcaf5cad8723fdf6195982a326979cee0e0c17e301b93a1bfd88361e5e53b92a1b5568000f28831d0ec2c3eeb59a0ecb372c889fdff3478fb7cdb21f6427e11f65194b34de862dd2792186e592cf471ca722d72b87c8ce45ef5d2aff10424984685f9df5c9a14bc0f17e08eafd296c9d02a69022a0f866312ddf4ef4026ad828f7c5585b35020c0c49c34b7b86732030cf6db3fb8f566c96a3f3d3c453ccd53425865a7b7a5381b467b62fe89312e5e5fef1b6ec055fead9954255336a6d7199d875df948fe4c584264bfc33dff13fd92d9bb46c5e76d0d1b21bdf88de174503bd01c3d56464c4aba0b6485207c44369689b63b89758be824bb5ecdd1f4d403f5e3ee6d0f994b0f8cb31eddd293bdcf94f262d220d363ca411326046b9bee22956cb24d40663013ce8f1fe4fb8f24890988d30782241b5ab48ed37b883152811ca2f1b2bdc5c3580ed49a96757dc69841e8d646cd5d7925818f410cad973d35bda9339d5a27f57f6a24a11b369a7a5264dbf5b6bc939a982c859c3b9eb01723c150eabddda58670eddc3162ad6902cb64a24def8a775c920916226dbfb27d40e7673b8e42f7ce2cde6ec252a3c81503fb185c14014938bed527c0cc5b04b7b854dfb55aefa3736cd3f23c4429e41f93ed165e4a4e80fcab35b4bf354fa3ab8912d4fad842df031429ef802d3d7d063b7736b29f7051e9d0c18df82c54fb5c724d508bc923f8657530e509baeb8d5204aff3a0b7b2e02bea3073534f64d2ded475ba5f0dec3c6aef2aba4030a7d6143c4c7c741a34bfb5210675ce0e7b3f24003dd1d4dcb6acb8e2c839f84238f9df88959f475ff0a7047dba5eb698dbbead45bd08e0f3248cbc2ea12e0939ebad18a499c866c9d3148d282be6a91ed9680bc58d39d667cd3abbee713335796ac875905eee082112c2de10b6069844607add0e8fc2fc8e7fb697a15641aa0df39f17103decb83023b0916f130501776f4737fb80deab9a565f39eefc8b5af96af1f1630d3f2465274530a2e8885ebb97b6d7cef386a08f6488777fa895aa1f50ffc5a0b92ebde9c219c61a2ce8fd72649b2ab02fb926d90c0af18bfa1a8c365a09f6ba562a2421e4524abd9575975edfcef3efde58788b70b65325e415db976378c66148fd79a976410158b8cb0723b352324eca93423e6b40cb3f3cae0c514904e402423933e25c9f5c8eef448416af786db0a33b3ceefa5bc8b55b0cf08b0025ea378a573c3cac71de5d81aea64dbb355ba3cb1086b05177efee6ab65e09f17353599794ff9eb33fc09f6e9888424618f0381878622b1d185a91563297b13063f3bdaff5f8c5de04c65d3f24bc9280133f9d1360261cad3a723b4c1756185524f34d2f34be21daf6b6324997c5bb06ff542088a4ccdc31ebac3ffb0160cbfec7373cb22bb7be99ef38fe911d8ebe554d7bfd501b488054da37cbf42d902800bf13b370100f3fc040ee7e9c7e83508e383430c9e09ca946a621fdc601afcbbad29793cd411c541d871454c72b8943ba698e0cd178a238291f423fff2675fadbbf5f2054864d80dcc5042ce2b35ef309ee12661f921aca8f449a4fd2a32b400f326adedd25206690c19105e5c24587ec159fcbe8d505bd47f59d19a172ae016284b77f8cf34a1f31a5cd6d24b85c7c20ff9ab686560008e507771fc273ab8ec5e5ef38fb9862ad583a74548b303151173fed145d23cc12be589b6f35b898682bbeb3e5fe9e65bfc2e3e4535937ea899115aec91fbb5da845581eea57bbd3985622ee8c3650e2be97241136ccfd1bd0aa9774a626e0069bbf9f73036853350fe7509a0b2da069f77c56c0e641774df268e2a19e2a6173c90335580b4e8d0effb931af1ab0dd27389f2a2cd6f2842c6968132bbbb25397d474042d801074e46e3685ff14e1bad17e1595b5394e60bd4793a457b68b6205ef9095f31c7133da26f39a9a5e2c9567f68d6872ce73fcd5bc158716c5074491e0d08242d6efaeb5f005c4b2394d39b2c712f87f00169dde906104d74e9ff209c35fc8b33c5f9a19bb4212d638c886d0d34d867bc0f96377fcd742c514ba10458edc21dc789e231eaa69961a5a03e6ea3b3c2915bfa34d06df35adafba512da60149cf07670b1476ed5fb98172c954b0f8b7b6d87802e09ea779e08ed0966da7bf2721bc98a8741b3c23b6c5562bbb4036e09b2d2fa85bf698d2c1721fde54806b2d59dfbe0677b91485aab6132d45fd96cfa17156d6c719ca08afbfc1ec76825d8a88b4f437e87fde5980b035c120bcfb62dbae0e42fd2c7a2b61ef33a5947fc11632d6b90d052ba758feb987ee48f32346f3d2a1b4d314345b067eddc1918d8c1f76d95de01ead74b4f1798e20bc3ddd3b87b03490c7a67419fe199cc2849b0d4eab3dd6210ee6d0554f292aa62858ee0a7caeebec8f9f2781634312f5405dd5ca4dbc5b925ef64be625f536ad51542c1ea9725f4ed894a550bec34a5321388a2375c26844a977bd8921ea9dd705606b18990e101a2df0d9bfdf8aa93c448e2b0684a6fec05e5d1bddbf9048f76fec6809dc4e23397e133a8ff78028df27938a0c0f36d5369f089d1db248e481df0b08cbc1af88e931c5d29540759c8134c61e7773fbe243c4f140dcb90af90fb987323e68261d205838c88019923d030d5fe09662eae6800473ca567054f466df6b721e702e7b984fd283d64c387bc7b01dc20e6e220702857557cdf1b51415bfa1ec1a82e301a0c0c6282578f8c260c23f47b7621ed4aac26cf7c07462c941198ec529a7e6c9f0e6bf4c1f43c9c58d4280f59c04278d102e5e30d3f22c82206bbdf058c9b1538da9ed5c8d5f2b6fac958b410dbf11e7dc300d70f7e0044394f6d12f13f10e3faf0a7ba243ba5edbdb999fc0cfad2485c32cec60e808266b0c85a6ddc0dc35f558c8bb58323479df1b890bb7c7df99ac753138e672acb84a719a2ac10c2f276a916308ebeec3dd03d7fa599f250b88db39c0128b85c7af554b053f3c12467ab1170e8db373b01e2cda67ffc83a6b429a3ec62246fc61e92346f17c2a708a2668951bf71866a2b6ad611cd192e7c0cbcf5bc86def93bb6d0ee547c2dcf206ff6e443a85b9aacba4c08a3af2d2fc2b21480799457255ea2b5e371963cbb899edf6f3937ce32051eed6247f680142e1357e87435847cc06583d695da875d4a148f2b2c8868614f18285ae57691e13c0f451e8a03e050352fc50e83479dc994395b3dc5dca6530022e6a7dad899d26e568b3156edfb85a5ce486d43f8b3ed41ac6e0af1a826ac982371027e07aa42a24af003dfd69571caf3cfbc17ff7454645ec39b1204b5703f7a52d142163f3ec428aabb569c9df68c57e76fccaa556ea9586fec0b8b865acde600dfd8aa0abd2122993689615ae93bd7af6642e53794378d8f470c05a5ac8d2108d3db753514179aa09cf35c0b859ecbae34ba5f9d12146783f048e71bd7fb894312d15e97c9a22c766e44f48cddb4ea9010ddbf0297a00fa5720bb5c949d4ba2bee3174e28660491ba23397c38ce89ee43c10159f1102f4c538de7385e340948cbb6e7a4bb26fa78c41f346cdbead46799ae47cf95695780ff4fc5898aa4153b716bce45b557e9a139adb65511aa600d2b710f28f350e33c6a450dd5f26fb4db69dd3cb4e22cc5d5cdb8df764918175f68be60167644dc5ca19c44f58bf3ecba8d4f4d728cd16c2ee2f409c15fd659aeabdc853dc3efbec0c39631cf3cfbc4df1d7413f54b556ee7f01ef84ff13855ba94385a61763325760140fb26c84d84368c29aaa42ec7ccbc5ee10dd82b80df7c387f65705940238dba5b65405f297dec3a347f7111ffe1aee270ff77ee364d80e63e0e5ccc0ba5ac49fb050ab7efa9693f48ffb4b9a7c80d1105bb868d5d0e8068aa69476311410fd36dd04179010650d4dea23fa3d3f57534fc243fdefaa38921be26bdaa93aa1f4fc0ba64cc3a6a8a5a671a135067a3366f00532aaa37510cf3b01296d44ddd525730bee53356888792c49d0c69807fbc8c7bb104c103f077b3a6a9fb312ace6b6fae6baa419601bf5d4314ed252fcc97b7f69be9ce044b7c47164f93efbd759c5b5fbc804f0ef362b4bfd19c4add54618d5139f9b5b979161bff098c7e046d9012f95764778fd2a321c75abf5ac331bf6cd6dcbe98635ce8d272941ad420dc8eea7f3b35d4afecf657df47deb8bcc168ee5479907031cdb31398ad19201d9019e1591650a2ceb34d9cb51275ff6f85891b7b65268dfe51152a196c5839de3cf2beb61ffc3bc08e16577fa1a12aeca79a0de7e824b36373085c2d40a328fb3b294fb546b50278262b02badb6da493823fd57543beeb935d195d67ded66ac3e5dc8f5665b16a583c0fa23e10a7147c1cba61c9a11a89653eca5bc44936744ee97da5ea8cfca10e3a643b8f39c13357dca77097f24144aef58676830f773f0ceddcf9c1b45812bd4d38fd5e32cc011b6abba3cbed04f31a9f25d7ce9c64a5550564f41c403d46c5048e70272a9dd8100626589cc9455e4171bc96ac67b69536633eedd8a2bd13bae4f03c85e000723e2c05aeb2d32aa92eab9a861a5d76323f8159dcdc72790f3074f6d1133f4ba46e85d1f5812c01d6cf97f5f93415a957ff5c42c4a0be70dc94b1269e642459a85bae79f7efac80420acfb00668af934d9236b9c02a53b09703b3561a0c3e32df0fffb87f5c7de2244b76ab920ab267567aab3b5694d1b2de6d56811569fa50a3a0cd3d0c809ca6dc4fab29c03df986452c4f020d5b09f15a8b5b0f0541d1f231760f541229a0a4d9eff662392295bee8f861e14a71d9df8c88c4726771ed5ec2ea74643e61b8461a61e3ef3475e483fb2e57eb0858c56ae3303e1cd0dcb6e572a854d98c8d16d84088eabaddaabd9aab6c7ad99b4a62772f6bfc9a641241f209b088b524c1a46d070532f3af935a202d6d0147923bd0b7cd7fa4caa53b48b63a500df4a95fcfbda463095c2079e88a380a0209e3c11b8626fa36c9d272f1d510342d7198f6226dc2a7c3becabdd65a4b546f123c45e044a1b7d3f9dd140de4e66a28a8d3f533a1a1d36b5158b56ea5f7949573ff8266c5b32d38c042856429cfcb200543210dd7e45128b97718581f4294d41c8f41a182fae4a47d9f9c4f61c884fe6bac61549a52b85c06d8c28bda2a40b50bc7dbec62cbc86e7ac8287a37bb1bedf02977e16f76270586853ec1e52146ca56a64a44c173be8649b4028bd309320a9e32b966d96467bf6ed5e22db830deb8f913e0e15b77695e9b44e62702594ed76418ba9ec36f941ba579f83e41c1544698189a64d8538b9e7032758c7df39d4ee822ea45be07c96e7cc907695acd0d19f7bc169d902e1ab76a7b7428a76c54393aeecc715b32f2526cef4687067aae8fab0d53bcb8e3a25cbfd91ea975ec498daae5b78eb52a5f0b9fe319bb04d00ecf75affbc90db20c20de44fcbfe936cc49746275488f73409505e57328a87453bec0cc50d38cfd63dc5802e536b70b11af00d33048e7422c992531495fc84a76ce06714b5dcde523dfa751d3e1fdbe2bf0a0b681f869a0c35c1cca5ecdb683545b448bbb68a94f997c53c9cf181aeaab7f3451c4d5dafa048fb898b0c7e5a542531ab835ee0b6f736eab67ed2af388bcbea2b18972de118e2cf8e82cb72ec9b9c7b247944b06958efd2e436a8f8d283daa016f93b982bbd2f0522fcab3c1cd325c9c329900453c397f29243e33ce6b182d767838798002ad79858a491b940169e27cc4e768e2c6dca9b6fdb8328ca7f73fbb01c1e6ebc34301a77e400e555d9c36d3e883aa2f13f7a0a367c23cb7571241d5a9ea58cef0104b27285f2f7e5cc6a63b9b17c819c4d32cd839b64f702ba368cc1399db78b3a8698987d1216e2dfd4925752cd8986d70bd0aafe1b4894bba805801557228e3c64da6d27e148b52f43adacd39913a7bf842592246488ac67e79ac941049b1b24cc09ce184f9e494dce1b48ed084ff3a7dc44ef4aa558c0fb260002908c686b4cbf3e0c9c323799a902388de6f67cd4d7638ca3a16a081f5b1fbe96a378f05cddd6be29adf4163a5096b318a5c84bc2b6373861a242d1fd14f89696d9f6af6df02712cff7e280a0e87f62720ad9ece19db7f08be63be90f8ca98204621222fea1ddb213fde435098935d70cc40f2e084743b7ba1f987e7f91c47cf5b881f480733fcbc788e57bd0c0596c027b5893aa156f09748ed78386b3522d84b4e06151fcd9f364a6c2082da90b19c0a640dccc41f18f728e9fb063c51fd49acadd0d7accb52f07003e9f5e8f7a0ef49e79899690750dd9968ff4b0692c2efdb5dcd0dc9fe801e96c9302c6043cbb800b455b9e215aac356a44cd80df5798d6535dd36135aafda46cdb0c979f084a3a796d844cfe13c5731d0d4b88fd0e80757b8eb3bace4b44f91a61f4e06282620f42ee0f7e8a87a0f98536bb96da64c8ecd7c6009d741bb6626da6f4aebc2fbae76f8b68bfe013f18d21cd4d3e7c06b8e06012cf6fc6f5df012adfd12b3ebe327796ea8840482cd7a4c70c0c7a6ce8845ec1f8f4836b1e6761be133914e6926a4efe390a40cced99e8b0e881d0ed59e8ec433fedceac7258ad6fd7e44c0be3559316dbeba7146c276a670ad3f79595be774e9f5a15f21de85bfa77bd746b3ff51899a6c4dffec8cb9567cf520a644d7f6b13c9ac25f95f7a79447bce6ab0f939791b3ed057924936613851dc7924575d2c71b7d2dee339b4ad37b1941c28561586d4c723f9c4f536ea128dcb05fda47985433e79b9b1ee3876b78beac21d00d9b3dc76cc512aa3b24fe6012828fcdcf91773921c2c7411015b7c1ba8af5a324e7feb7970c3cbb0ba7b2f53142472510942b3a1c666ffc8a70d6fe85b7f929d94f22fcbe497b2759b8ffda20451a56b4ebd06f25fd176ce770c30297a7c1c72b121c13cd735fd2e4bd4bfe0e0b6391595069e143bd5dec40e9fa256846e2cbed1d4c013f5cbe754787a6606176088e205119102815adb6ad1c3de4d66f7a5c1c0eb6f7a743fb9f0dd591806838df4d02a0fcea8be04c8e2ceceffe4e0047ab7de20481abfd60ac34ade5e3bad5f8eda54242f7b1c369a06297c773034f55396e34cbf49a82332f8f2e7accd18c513424de956143e2193279673e822ba410822430bae7c2db6bef108f90c422af0334f8a034aabbd482f5a1aff41c5d594c8411c7fedbc542066a57019e1a101d4fbdc2341ecb96d5523d46b58c87178048d2425e5431c5aa7dcb22a64e194a4eae7d261e2447cce81e510d341b5b33e0e7762296f21c4345b7898cfc6013ce7e50f8def1c7ac71bae9c7d72b03c8636ebc7a78529e7940ca8d0597f12d989ef4f25bcc2e6bdb1dfba1adb304c10fdf7ee8bf62f9cc24cdb3c6d901385518dd3af1755fce31c9aee097223d6ecb6f7036c4c0a9cdca90f1fa3516a85804a4b545e4c76b08bdc18037868370da56421804ac742a7f741ed074e1d40d802761a2756102eac38a9b9ab5c57d9b6f480894ae791e0fb3c886c33588344497231cf162fb18d787a3aee6d889a7ce05af646f46f2c705f65bab67c4443e8bb71d898c21099186317132fe82fc4f01270acf431e13afeeb2ad6190483072d0cca35e4c303d40cd884135b51bcea684c4c5e7cf63c3c0f816840cb8d2578901082e79f71fb9148b8bb72409e8ac11d64494da0fd71775e6f6eb7f93337ca57af6094a36bda30b65820842cd669e70e9f91059f9ecc09c3a95a8eafdba63e7b2ccc197015e75408f2b9ca737eca8ff529b5fee2665265b8a0a6aaf9600afaffd9a92fe0e89a8f52e703903f4e299a77fff68fe6ffdcd9413ddd5f89d2c6a2c9fc67081008d7a9161e530f63a73367258e60745f15a8bf1014f22eb66934c3365788c15b57bb82b97bca066721f7730a55964c956cfdf6e10e5a00af5b8a8d4c62220441d274619f6f63e058fe6ea43c3f95b895afa0c8fe374301c94225c9080662e8c55af357b10868a15864ecc1ff0faa3efa5cefd62e04b142a1f70c5799d789b382448d55d874642adca0d5f841472fffdadb2762d38a66283dbf46e1404eacccb7feeb385e40508770128a159106508361e30fb43b097417ae37d64d3393ee4fc0237f61ab8b75d3a4096c1e8fb2a0a7b59691f3549ec12c4c110c9e3442e0ed508816967cec5ecae12c337da296578cfc8955f30ee092312a0b8ea54a97b28def9a14e055cb481cbb6699ff10f331f087b7de4431ed5ab1c206ef58d13e360ec4af526fcaa9c3dedd49947de9467f98da7392ab5f495b1bef13fdbe2beebefb3fbcf4205492614dd68a11a1bdbda410c7aeb4f191db3132356477304386d1b8e1668143c93a763c7660f55a4b914e5a0a8d2d760bb3b60078790cb963c8d3d102e75643a6695ed68cc8b99868b0215a10537efbfcd3441b34fef4c490b1b54719c45fdc468dc31321f2741b025f7a9c2558c24c125e2e2f39d3c516e94ee71b193d552366bdf5e2c3b26cd480df921cb1a797af7f0f7cfca0c6d3fade9fe4bdae63f478891f9c6545527620915c4084716f46d3641b8b8823712f5fe0b663219d937caf2bbe11bd6a80dca1379d4986d1a2c60ff43153f452439dbdd86d0bcf63aaf433a297f2a8ddbaa576cb90cbc2c59b2e958309b7b272c793fe2533cad589c650db2cdfc25df302c9b61cd9d238377cd5199af9d9f4502ca6d2f4c60f5a2b6df0f1a8a0b7f8ea8be32df35bc90378306d3f9d0a5878d11c2a8b994ee416d5966aef3520139e4e8da08751d08944b2a1306c79ba8a41950263307fb60f517dcd2e0aa4f0a130785d2530b6e01b7a6d1114ee7c590f12cfb6dc3ba7f0f19543f51ada7df492d8fcc382b09ef6af6f40fe57c78d67fdefff2a465a81509957a17220cb635e4d488990544ee5ab91bea25f796359d0c224319dc8f7fe2a8fb39070aa3763e2f09d54ca27df3551074dff8acdeb5464cf5d2ad6dc3bab73ee6f810f287be81821bda1cab69e309a2e310075a5a3c7d8fbea5698cf10d6b7a4ca3971847fd2bed6d189be79e0671f23bd1ece7d83b7e574df16da7428a8b2e7fedaa217aedab50e2942a19e470b8016ab864b0ea6dbb6968e860ed5f7cdbb9da748c8926a01d517f4f53a0141e3b3cd1cc70634e7d17e2090e3a78f8629f7a0141d68fa6ba522810566095088e913db75f1890253a5d764476e4df65e6588f40c2d1ffca47d3a4dac3dc60274973beee79fc878976e5f614c5571d0f9618b70a08aeebf36eaa3a416393a52c46d0ce14f5c528b9175089a8d8b804c721fb94cfcbb64cf0be469403f3e51e274ea45538ffefea7b546e3b351bef562dba619750f9ccfbc3d67888ceeee2b372190b8bbea3844daf152daf07d909210c65a0c8027f8e8def386825420f5331f37d270830907703a8bbb64f4b02a2cd6bf99208dddb427b6c7c1b5e5e39679528b9267a75a1d89aee82174ae009b55d9a0ff0bc2ab1e3db4812eb3243eb857da21c8069dd86a47f9f7b0825dd01d9965513d81545cbe5f89f98bf2c71b3e7ad884380f5015ded25c9567255bc5c91e5dee3fe1d7bc0b351040eb05e97a6d8b1b7f6c128171c3f14f827aca1749a4b344243a3605578e53c0b7e1aa3a78887d834c219b8d8d63d628740c0e701162849a4f52597e7d3623f68158d6260d1a3eede9fbe6daff577d9fb8ee9da4841d78445b04e13028e8195450f6aa50dba5e8e0baf619ddd439874ff3bcd4cf95d69f0ddb8583e0ecb772cc9f7f1eecb1326d126c87144250860fa98285f41a8cf57461a84ae235be5697e70e7d3bc5a16d09c1f498f3e3068852dfa9aec1fc5fbbdcc9fa2a81be6ae4fbda2ae22b5f76aeec21981953e18a924b9ed2a799fe5380ac07abb9a060a7eae58ec747deb3d28d22fe3269275d200ccabc0f1eaa1ae403b03a0b36430ff14adbfae5e04ae65d1d76555e70ccdaaa9b84a719dc10d591cce479fc68305bec348c9a0327b3b5c1700db08557ef2d426e406070f69ebb91c253ff00970f318694ce39c668619e97cec829352da58619759724b01a9b8eb605ddf3b085cbf864eeba0e8eae759ea3a0877302ef158f0d0ef38018014001b3cc9aee07d7ebab1ee3cf0e6a8a5ed7c39100e86873d943844952de1406f7b733fb63edeccc7c442d24aefd0b47d4bc1820678ce37d7931eaa383c73a6523694d643823eb7ca3bb06f83d117463fe693c55f77293cb10b6312142a645f7a4c4e9b7b93e70a1163b02030b03cdca39de7301cbe3bbef9fa59002ee3305f8c85a5c0c3a2b6721d989427d6bf26b9c09085001bf67651e57cd6aac67fbcd296329b0bb1302d05170431cc6f58bea7653494169f8b5b6fd0cba46908844d49cc3bc9a73d3c663f5c1867cbc92d0a8a59d199c3f5feba2a27a831f4bc4bea69cf8efd78722b40f1f8a3700e31bbd02d5eadd096b3af166bb2e078052ca1f9ea93c6b63cdddf5d5b2e3a8bb851c5563a9b9d5c8fc31b2c737b5ccf085d8c906600e4571aaf8a09fea15e915306eebe41640be73b8a738091d51991a3a7998145fbd9499a325abf8bc7748feb798ac47f055ddb553204c0d91e52ba842fd0b778dc18589838e48e24ea547359c2a0341535e276c88f2419add62320cc3ea6b0d931291f29e53a5c06eb6e853c7de494caa7d9b7bca316f5789f9585aa5754a073cae2ae77916a09bb44425158c7c3a46c55d4df9fcbcde9629d9072377d67a42c81ed2d298e8688c7543fc1b9ade1eef12a32e03e1898de6382b55036cf3376b36330444d0902d418c8088bd453f0f213d6f5c0ef5dfaa22170e4cbfd65ededa309951c5cf61f559a324dfaeca5b8911bd7aaa3e7be2889a9b5758c8079de924fc364e515240807128c6dec1d8c9f4d98137e2202a0e72564257c1680567c7a1f6a7f1dbd3acda51d8e5163c07c77b8877e9be89565d5be5f9a162bc0238320bc3bde12c81aa96a7d23dcb304b1c26e111fb874506bff4660f47e7a5708624e875c2d6dbfd60b0e8f050e75af42506dcc03f93eabb0ddd928cca37f538b9f110b9b0048f8aad02cab460d17a3fa7d4bfa4f36abdd9eed2f2943f7f2ef3806713daf2758571e7127114bb162003035ce47c1573b85cd9b3de7ad648c599246a47478e26d8e1bb4a6e80058e164b825ec0018a89335cff402250f2c476fa23d7e449d3126d1531cf91e2bd76a0ba45a5b944838af0b32ccebcba063819a07d2340740a2cf84f8651670d0e7bcf2639bcd4243298a1d4d0d87aafbafe098c117d0c54d72da1ab8ed8a596dc0e6661c80df730fcbbb0d60014d1c397be595a3b1d5cebea860f142da6b6f83888451074480921fdca37c34a195123db021f33649a295118cc8eca9797443f38385568d8ad8d6a4096a6fa4b30ae5dde1379a8549947e8fa771ef75b5fe0fcaf4c7fbca18c84cc8c28251565df718c6b1e3fe35203c21310a6d15b9eb4b8df459e55b648fc1ce50732794af3b9f0fe0f9b0786cebd49b4798a442ae152fcc7bd5b25197a57c60876a2eed727fde84ba663d9389569736369b514cd045216715f541f01c1b21856ede3610a88dba2c92ed432822f2a0d0e5deeee82fc2137fe0418a7e6663d09ab8af839a88b34c5c53c1f09edfc0befc00ceabb6d91d31fa028819a267a356026fbdd3ed26fe05a5ad526abdc28c1f6c77b8dfab433e628272f286b12f17eefb70450358b66697b7c02736c71249c9b45c9495acdb4e89917e91c74454d43c6fe4765d3c87c1229d452f65d11bc8cc232a577e35dfe06f3459802ed2cbbceb3373b3f17ffdc1cce61d37b9972808d3c42738dd661fa4d6a5f385fa5d895f2a656da18a65f41b4c0bf6eb4e290f82bdcd553eb525933fd7e8297c2b3362a4fe774fd14d95d42124b3ad585d8825dd0421868b69a2c5b324f272e70113b80eae7125ce0b54a3d918db722c945c56f8ad7f0ca2233e6541bf56a4d4c08675434c4a77e4380ebae93ca191eb372dd547e61755f0807238d64843c40468f3b6b0d70725841dc9a5624b35d3e63064463cd05118aa605877c1456db6c0e3a043286c726c17b2b966162ecc0e8688e4a68813be5602e7ae0d528c478e17ea5dddb78aa0e9e9c4684def4cd150377158538ad1d203bb0ff8b19502769be90c17f73fc9b52289fa5ccc20feccafd60b391b83766280a79dba4f513fae8930a755e4dae7d42f9a6c414d68b2a5ad99b23175216dc62c205a96299d94639dcd71f1af581186a25373709e6ac0481a6e63e92e3cec838bd972d48fd616018536160c99a67b23d68687f11396687b6ec7dbc62ba39cdc3bc54a12bb741dcfa1abdef2f261cefd2b0b9892f0674cd2a1e9c6515d139f99ef44eae1ea2345fcab54ea9cfad4c8dfef0183713254fa419b425f954bc2485255e28e37a296de693b6393e528c68a440c459cbc40fb44e671409e3a98fc85d246d49054a4e6b34dc7c9649e3c848cb15b66d804fd8863f8c1cfd5d8dda4679c8babcc0d765a107b2fd8cd33e80b068c724fd4e404e13127234d8845012c4ade30c47534c4fcd49f0b13a442684c0f60beb0093a3d9335ecbaed2d4c83a4c5ae2c9dde99d9a5ec06cebfb241cf41105120cbcca6448bc299a9de40b417e5cdab2b0516eb91cbbe</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>school</tag>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>NFLSOJ-456C</title>
    <url>/2022/03/04/sol-nflsoj456c/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">
  <script id="hbeData" type="hbeData" data-hmacdigest="7ae56f63348b782245328fd86375e256b005d3304638ce5bf83c4d5b48477bbc">67362a200d4bb0b1cd1ef5f7bb774ffb58a2089a15905f15111606287b2ae8c12d30bf0335ad76d9716c43e012036833913efff5ccabeb8cd32097aef16d2fc79fa01a7fbeb018958e407d2d86b54759acefe130cfeca0b2c09028e3a266ec66d4d89da301c31534ba4cafe9893bcdd67bc1510aa49d129ff05423f2f5231ba705e1234d85617dc74b5a4eb832a9f91cfa157e11f393d556823e89e298d7d5b16a2feac375703002734078c3da65c70f29d39a109be6f32c6b19e28070c649e318a2317ebf8b2abe8d9d61c945006601c556a1822227a7d25950398010dbf39fc556e6572812fde86bc351e64e3df7919eac7222a417d2a3afd079b1e11105cb01fab1df14a60fddd3bc61fb47e59b681c36b51384ae1c5503c4521bec78f0c1d03b2e0f740aea158583c6eb3a498602dd11b31a6518b44c767887dcd48e62703df1df6d93aeaa0adf3cec102b17d2c23c2315a1a226a902c40902f20d53c145f42f885718f978ae2c82c4fa1d59e4e7505b63a19b5843f36b81020eb62e874b8e0eaabdc48b7af54452741a9b1ec3f1087a4057c9c746f481ce0d397c76c182a94659da4ca1c6f348d9483832584896f997c5549ec191c8831b509f16634e484dac6a4c93e5537eb61d2a15d61c2d81c8789ca72e185d2ff97b1654ae9305b2889a689167da1ea583165647f3791232a3f37bd3157bcaac2ff93b7de2fe776409f7952727b339b5040ed8e27eda799c8dd33c46f8f5d25e3f0efbff4ec2fb866596d7d852c8a8fdc3a4d2111c59d91e7f74e19f262edf8caf88ac50a7a1925e4b7a62361487a6947ff93fe9061389245770f41a1b28d0247b855e0f242c7683052968b5339ba4419ac8642930f041f6ab43bd0be6c69b920a54b5d7fdf72747d863bb3ffc676c4c5239c370dfe9f52002fe40fb1e23f4240e79e1efc40ba27c89ae9d67d4c453e3bcbc85c6567c79d51a6a5a5d01f02039170b44c2179c2877ce8bd2b09214c676b1f809f05b6c3578fbb6d70e3d8538a8706f6861411461bfad8130a5a576b333fbaa8222afefc3116465a160dd06829f5ae26d910c7743c901932000f3921494eadbbee8e752d383c2289a7a442eb384c22d1af4ccac9aa8266c9c099da575d68662ff6e9ee5f23788c49bbc5183374de3fa11d527b6b8c9c40257637eacf707655487af7b64a97f3d6d0b21a08f74721b28a39111e3acee6d6e28610358b38cbd42c5196b2cb4ef716705604b82b8e56db22f759c7e66c4a5bb5c8766f04d325c64b9f5025e1acf4d2fbc5f6135d76c1c01a8746f231be2041cad61a171c78e2038d78c4aae1386ec610bfabbe15e6aee027342dce43f0a0b2951e769eb8dd0e9ad8c64a7fabd1396e8d24e9ce1d499900873e735a79b3035d60cf4266d7bc8f24a0c20d46aeafe608d19a32799fb21cf4be864b44296a30a12d8acc844dc9b5ad5ac4bcc0483107b7423be595233b1ea98d1af1c4b8389edd33474b6305a520bbbed377106e2ead4bd1d00a7b159dc9822735ab4a7162606a01bbf0d3c332500687dd9e71b5249010adfe705a8f6e4dfed28c1e0b15af2565af3d531b1535bd9280f2f089dcc485b172b91979b7babb24d9fda4e0280741512dfcd3fba12ff6e7a3d115d5aa6d86ca1fcc2091e7143c006c6af2e1f42c0baa78e24250c543b870d356d288831f6c26a1518fdb9455c50b8204087ba994208b6aad1a990fe0fef2cdc0ab96c8e393b3bb105e5487bdfd5c2700c7af465b9ab9c1bfddd759162a7905d9cd9d63b9bd03bc261874ee335aa64ceca68860afc2d4b11688a190180bc2d65ae42de4f40a7772204fbcd9af11bae1215af5af518b268bab233392ed6faa78cb62990a831c621227437fe91d2727ae38afd8cadbdfd51cf456449cf78f25cc529bbf0a081b282a5bf78d4a21aa848e8a4f56b73da88f0b9c64c77e0c6df051411509c9126a31db2253727099801ff9b639d3cb3b9be9bc732ba83438a952c7c592fb0b35a03929f20f55ef70164ed78932e51669a2cbc259bf874fde3985f62d2562ba957632a44603ab44f078c6f4d95eb5ed56d386f8d6a21491ed4b808501911f792ef27d6f7a2ad1cd70bac5d7fb4e5b65f66ad93842ac1c674bd5dd9ca9d5421b3413913f42866514b185f175745c68c740179c1828ec5b678c80c4f736618674bc19badda4c14d8e522729d96bf21d867aa238dd170f5f7159d18a55a1edc58813807c6670d7f74d2d87ec33b6468ae320044259c8d6b9d65432a780ac7d82b735a1c4f3018da9fa6e671e057dd6eae8e7f4d709ea32672d6f93261b7ec375a368f09426d5995f29230074dc17bd232aeb2f228e9aff3d7add143e9a7d9a60bac074a2049f600e3efc2a7cd9f1372819c99e350f1e43569ca05d8bed405c83b02a338f50e740be650a460fe93098dbc70b7ccd884706a333218a455e37bd9cea39345bd9c55eaf5ab11c3a9c4eb15287d481e4f25b05fa1b9b61f11990a4244e88bc3138937157559678c7a11b46cea22400d3748669c2da63872db72cfbc9a25b1810be56dd80f4fd167e6c2d2251cb4533206452ef982a379d139433060f57d9ecf8c769bd7a2705afe5dd0411f92e9b3547c1581bce28b63289606803c8bd5f83d992abdad88fa705071a2f2d99175110e6af10daacc3c2b348b97341188b15e199386ce4014ba9e7995d0f234749eb65a0658f151d67b0c9d26b640973ef96e559a5a1c735e46bcbd5216b107c6eeac410b99b2948de0a1e7a451665a58903d745e8684f47321c08c4d87f2feb747f4968988f2fa6d033c427a87af735a854b8e5bdf81ef8e7090ec12e7c69ee31176ad05c94180daaffad722492af38bbe73633bfd085bf3816fffd59aa30b8205b8b8d91eba6f972a38625df03e5a0e89f0c378bdabfcade123f8d0669fa79e63909104348eb5effcdd4e28c2bff31bfe82c658d2b4c5cf30602f8e5618966602b05b46265ceff2a93ba45ad43ba0aa431e1231ee97f41561bc1382be2a0778c190b6badcd62cd016fa8e51b4c9449659041b042bd402a3dfdd88317119c37bd486fa13fa114d4801e4b09d044f87f07b39b857efdf0e3397671c5db8d3ef5c86d57ec8d5a0833a855fa5779599f74faa4ea0da429e204bcd5ac332d9403c30fb06881d525226c2fc9a6f064c5b06a91b87c89a31eff5c983d2104c2a1964ea742bacef0918c1454efb94cc0c49f906ed9d4dce65b119d6ab6d06b3f90557a224c039f5dc757de9b6afffc9d9ee128648793d4a0b67d47e794d5ee56f7df98c1c1314b8e4338cb0e07b96adf8af0201127d55c7f2bb7fa8c070f665a5d39574bdb60a2efc1b9efa990c2ab5c4609d33ce2ddf76b01c4c7c049538ea8b9e6ecf757ba6d4f8a5fba7ccdd9e1283118619cbe6145aee5209a90ce510a5cf82710f6188b8e2e81370eb7c47322c8b2d26c4b1b40e58b29679d8d5d7ed7154323ad2eec3c0a4adb3c21fb3a851ce1b34fac4a8f2e98fab438918ec3b0316412f327a410f803b8f1e7a91d3c575affa40fad2028467d2c17d9e5f5c3f8a449855fcbea00e96d7b5478f4233034b9d45946a93cb3fceb1936019c4d8fd41a3f4d7899f8f40ef89319d7280dd8dd35d77851ff3c04ef6551873569513c9dea2adb6e0dbae30dbf13d5ab026d5f020b94cb10330b6f043ece2405fadab23233135a74d4217b187b05579047a69c933c60cb1b51e77832777b3e4917d8a01b2a3ec0d29d399dfa3078c2527fdc9e430e1eb014948dbcb81f5a45f807668f8f8daf3d7a35b8c48f0a6e0c3cdc7d78d54aad630705fa4956de8ffbfa4d63c7f378f320925bc6785d8063c98cf224c8f4e27ffbdd1b3b870d13afc9e277d6476e900b76d18d499d1ea282f3610cf635c6e673ed7bac1f6a13e3b895caeed4b8d43841cd02d6df145f9bc0f51c3e827c961e1fd84660b9cf3505a78fc0b1397394777b9ed60e5cdaf07828947b6d363b5edccb83b4d4a3bb37a93783f29989f93a9de7592092e757e1892aa0398b7bce03b31ea253e62879e365d6ff1795449d7be7a8c6e5b8cbb82ff0cf861bcf208863e3de7c9a766e723380b41a8300e4bff9b4969ada75f7a3940246d81cc7ae1edefd55c4583e021cd1216fe7cffd72418f6157d20cfa804cdb6e187f461b4906a0c0380a7483fc72f86e143e532508eee3c98d732e6cdcbbffeff3cd625ce87cc3b3a5c423c452950e5c6924d81d166cf20427d2f696b0b466807ce84d2d8c13ed6e5bd43e5f7836e53863824df4885f8150362c108158c72b2499fefb7044b061e75c3e3b1b17277759b197573fd1e28c2d3d3dbc50a653cfbf8d48915b7a9d69c3bdaaef4cd5e526c5b08ed789389b9715fe1a7314866e84bec19b71b9fcacece1dc295df089b12ccaffc1e5ebd4fc74c939c1622827baad1a7daef1aca14130f33814c8221a53f5e5c1bd760e47d8ccabc89d6516db35b1b9a1bdf2a8d6f3bf51aee62873f928a41bc4fcf0f9423715eb8fd98874bd03b519bc916bd3eb1d8f7b2264b86227456b55a0238edfaee14ca50267bd4a2f7cd1b87c3795807236f3a4a94e17956dd79d735338fd41a72f3503f0749e2e21077732fd45df413686f4e8f6b05b265cecf48baab46f36a6f234c05066da394baaae1ecc48e4588b915e9c9e80e92fbdee43fe9941f31f98bd61dd87529b7a08158e96e2a13b9e3c55c1ee94fa4738968b55763bc3c81907cc9b3547c339112189812fa55f1f11f1e2b22775def1f3afa8d5423311ccda6a652297104186d5dfb3bbc7c48e9b9d74a33da53bc4e8ae85a843f0da57eb642c1bfd76d8b3c49de262514e5e88cfb40e1e6825d92887910c65a03d3b3ba502a5b57c586fc97bd40719b2e90d90c4a9306b3b2bef17d05c4d93af8a64431a773fa2451685125de26d1e1852737254dc0e8e918f9bb8f9d32f5bfab1f5331fa55416e4bad2e0aaa2bb34ad7e7ac4331e4b443f8bd9aa2927249b7215fbe58eed06c2a7c53fc48363a7fe43557f26634f544fe84ea9092686e5b1ccae21a8929f2bb14bf3bc321b0a7bb2df5345e6ab7c1231c4a5edf0d113ffb4a313aa15a39be1e8db367cba29bf853c710c722f1d05f68ddb8b964773546093910648f7d36bbbd96da53a7ad991add1d31bf19be81cdebc87ffdc46c0d4ee94801e01c8be36f9eb948693acab13dae28d695920c80c854e91eb9ed9f3bc578588af3aab0c8064b53ee28df0d1d8761ad4a3b0a57b21fcc2779252dbb363076004b2944cdc5cdc1ec9821c184e49dab872255d6ca8e2e03f9e262e703c3e0f4ee6dfa09c5a1fe5759b1a59a3d3f807fa9f2f6ec3a6c7028d70375df0e325f26528aa0d535860751da0d8359ec0181d673957581722aaa0c4283d67624af271094ac3dc0b52bcbf222da07929822e447d54d850fb9b86e92daad19938851a1fb92f7346e759333a9e1d2857e19d7eb6f3c347ec7447b792c5a877f737142244ba79d09e44b30f81a32da154be32a3f49309003ba36621f29780feaba881532411f7b953f12cc7f0b4c1f104032d08389ee846329310dc621c6d53e22d86c01a62f199999a97c073745c3c102b790b505d825981cc02be9d41ce3dc4d837bcd7b8b3015e2844bd30e54edd92fa4d4f82e33a91cfc27c5c1eae1dc78474fecfcd6731c6e35791ff72672b6fd0c2deea8123bb092a62569eba28b143bad41c68ab4fd489a05ad65ee3c2060f72e759a219163c6d8751475e029ac5bceca023dcf7f2384e616bac3ef1fd901204c6a2ab424ac7a793c876810768608405b9dde05c2b21ce48abbb6be147976140f9526d79c2094eb7d87c0fda1c85da510f28e19944a70ed500fed1fba4d49161b3e0a0c8fff8a94289ad20792cbe110c837d3a7ac5a5b8c3cf98d7ae6e840b999f83c24d1df69e73d5f9007de2e1d9cf61c2dd2beb50cb526891e634d81ea51bb463b5d3cd5c94df687db457800b48632b854db0a6dda6c4ccc122110e366515e5c9b69120e7356d29b665b1974cd170d0982b024e484b4c580a88dcfdbe0cf99651d171b8f39d4034f195107e91e602db07a57a2a66a4cd3f7a9f023f6f3dcb4b11fe37e6cf2206ed39a8f160fa47c5f07761a40870284ab8cf04143a1fd41f54901a53fd2ec202637d52f48d38ae2a06f1ca2bfb5928ec99f045838521f00c03988de9de6241499f31be23c91ec1f3c04432ce89ea72f602e2e8467014e75e6aceeaad037ed63d3b535e4bfe56e6c19b8daaca82f9a8a75538f2b27ad6f4ee4182f866a13670171724cbffd0574560ea10412f01fee4fbb6b66eebee11aeccb4765c61b212e8e912bb3dd6340e5d0b4a2b018e02fbe948e9933233dd5b867e830769b5263ec6efb99efe2db979eaf735e675bf9f24f6dd291d7561d33e4cda51205006accb2d9054edf005145105b79ec1cff2578fd7345468f84ffa95015d1644fdc3c2385a4c1eba857902f27ecc022942535bec67e799b1727a049da510b05646e77dbdf273c09b25f827890fabb7f49e870c063682748a5eaf6fdd3dc352123d8c596e8765b26e847ac71980b5dfcbb934c7688226b603660840c4988326e53ae5f16fa0d0377a912c5d698982e562fdb7df8d0831ef6c7e6e710edc249b81f5a87f2c65948fc8030394773e64714d08c05d748da7e0ce6699c2d5993aeb592681c1893aa23e340327041630b2e1054bac09b5353fe3f885e351c39992ea77c0c7dd8fa45adc892fbe843222463fe2102291b7b80f1982e29ed1f0c91251912949e86431b6c6d31fd790fe112fbece5f6c9008d9d8b57937a68bd4c23652a2842afaefb8fb200b36d81add1b4bd4ec9b6658a6ab607689e718e057a8880f6d12f9649b4b2c4dd137d328b83a76e3b2dd8952063ef5572c61dbbcd4f5be8ad11c61720eb71b2d4779bd23bcd373d98470474a8e1371bb807cc30517c43d055b5734021e5c620a5bd3bf32725af59b6d7abde35b9e026a37cf753aa658585170ef8bef8c70cb3e7a78474aa76592bba16dc49a9eaed567352b8b96259561baa56a79ad94fea26732eb24cc0cebf330b7034f82220bd66fc2c55831788fbc75f924a9743dd0572fde45c0bfdc58d109b8190a0a546f25c97161098a5f644b00c65a7265ad3ae39999259dd9a2d43d47c9c4743312abc1701f8a4c66239a682ad8112163fadb3d1bb2ffc0fe893a6714b3ad6fd4ed426ec861ebe7db9247cf300612c75cccd63f1f722bce6b3e7c6c425e7069efa62191903e41ea620b1c4ab6c9ed53631c101d036dd37347d69e2cb33d1128925377e47d42e4d8bf687f418addcafe428097f595dd6f808ae63da64a0e65a3fb9a20605934aeaabf354c363b33c473aa2e2167913a19d1b41d9bedcdd72d342f7ae34de857f2f68e15ede35fd6cd193c43bb1e6beb32e92b0753657eb5beed58b1ca74ff2e41259e086e94ce9ca246cda783c6cb13e110d8b701f6025e69072a4d33d3f2eaab2290ba9f82ca90beeb800b17aaf07d68d5bfdd43056715032d6e888c957f0581daf7c1e9e565f16705421e57a452701bdd9c6f4fe8be8bc22d8ad7982bd5ea12688263ba79778b0524f398a3fa5bc00b1453a8798d17cf7171b6e15bebd6c2fc8ee13146329ea1b1640ebc20dd153ad97975372f5959955735b576ed2eef931ca5c83828bb5236b0b73cf2060dd1b24f0ceb24220f9fe5da96ff6e3b3307c8d711cf917c9a5d877523c3f22830aa8b8a1f64d3af09805266c48d614981eeaa54cd84500cf31f831a96bdbde0753dc32798ab0d07afa79c9bd17335c50b8383915ebef6de57ab4abf43774e39e8f52ed469133d7c8775c481b10c2412464a2edccb1630ab30b56eae8e724ad62d05eff55cfdde224897598056613a5e5e5852a20461c35388e080c224a889c1015b5ec3db58fb80461df7c0f97bacf50f8af77ef3e6ca70a8c88589441b33356c1d3577dc6264d49628fb3e38dd5bf4a4801812a5e4fb12aab74f3f60ef03f5e4b0d39aa79cb8f2599730a5bcf6d4861bfc0ad95162ed68743c8adc16ea02eeeac45347ded987173b9ee2ad73b14bb054dd106f0af4cacff032b703543a19fd4146ab7046969348698f11f847401418392407b7ec053e5381e440c7be473277fe6faa84fb5700b98920bf9f7956d8123b1af18523daef47b9d091de91bc6c4fa3fbbc6c61e875ef6a32e2e823e73b964390d22f42c70f4ac9467eab7138514480b8202fa66d5c3411c5965feb2ccaf97cd2ce7706f2d18e4adad9ca230f057b62132afd356b1d2f43163a1e340f99cf714fec793eb76687928fa09cc2f07ed1a8fa74b9b81dab31660a385d63c1b15e3fa06d49c8a3bdeb2c366bd90a07ce633ae1f3cea8db83d48d150e7a5cee92494b32be0f226e41849da398b06c5ec328d2cbd92dd63c3c0fb81c278f55f17115139fcfce6fed0de63d4edbbe7ac32441877214f95c6942b3bbb3202f416a75985da8f471d9ecbd4f66f45327925af50af2b186283c1bc33c1cc33a80d301ec6826e948b13870f1fd92b3ab89be23f3081d838bcc9c96d80bb11c1eb8e327883353e03d76b436e79fc3fa5fca172ab6fd19ccfa776252c28bc08a8bca3f9f0a6510066148f3e673d0eab64ea2ac48ac8fd222c28228b8b4c18fdd464bd76687f83181d584ead97156a88da5eb99177892f0891359b4e9a92fe860ca528a976cd8cf2191540abd1c31b28b89c40263a2474fac2ab5da81691ccd555ac53cbc6ba98a809b7ab6f317ee50eda185909bf90c0aa48e6283fe22068c15153e9ce61bfae29310d734a654ac697cb69ec731dd7c79841ce4f05aa0757d731dd4f7b781e266eaea14b560b439905a09f6b2057d6a2571e19e489de8400712ea0b272a8cec89df77f25f4ebf503a1f8643cd1b595e6e33c783d6506483248cc799109e21e549521279b03c1967255161a2fe2de26c50b4bea6ed96b410a4b6ab8400eb793e4e5a0428a26e55d5e40c7560ad00a3eda2d251d429df1508fd252138d964a690ca02b4844f63ab740b9f86796c7fa6a16c0454187da0c5aad76c58bc8e8367d7bc1b37080818b6d578a79d68c3d6c40bda4ec2a79b3f8635c764c97ebc820447349bdcd8ef1100bbcb29530ea70e1c87922c25f005ff1b2f012fc52201448b12951fbf088ae000e124f407e60b2cc1a300d15cdde28d873c1c63c636d95d47c9ecf988bf898d4a33bde82f26d27bde73d40652fd96116335e589b1baabcad9b59e8d35035fff8df2a13be13be639cfe84f81af9d3b94a195c887eeeae466138aa4578458aaa6a08a11996b45a2fdca5a6aed244ed339d2a4883b9eebce6a47531b6c3cb88ea7ea416832716b784a273a31ca27fee1d037ea81a01ef64a628324fd3073b18951bae0e6c5a98af993888142e7c16082b7489600e639769c9c82471a39b16d6e160986204a6b8cfd5c74fb64e0cf38ab3e864026089c7ac614ff49938d22810fde6d56c2e4ae54dbe41cba7d02ee85e175ae904e76771f7812def65652e4a966daaf80af36cc36038c2edda865c6932854a34ba403446ab50e775ee5a86fd8f7c4ea8f841dd478560d9483c62d2c861b3f5338ad9dfc499e37637de5778f234a0c253a4a240f8ddda32fb4d5fd9497a4c114e93e5ededbd6bfc989e992dcd7e781eb9e4196336507497bf4559b68618d53f0a939724dfc98f057364f49cd83eb4af163e95e4ab2b39e6cbdf15549431f63280089a8497d6c6a74efdb1c71fcca0799878075b4761f867d4dbb485b7a6adcbda029a8308808f8ef5b711a9ef2bb1946cf151df1412a213249e567a5f44338672f5f0786e0232dac84c244679587b91ed7aeb8a491832acdadba206d77d889084e0e2379a70390ef16786bfdcb295b79fcb43ab992773322b72c9ec2335dc9ddd2842d39a06baade62867e06629627781bab0bcdecb7d16267801934349a0181dbf95ff9ee09d2b628840aca1a385e025b16c4420252f12ee9b956a691cde6f38a999aa19016e0b91707fd5573304ab674d88d193b8b8dbcb03e1a76de00dc82d46d8c399e1e48b50c987e138b804f3d35b2a7eeca1d086d2cf5ca195797d3e684f6f58b633e63ddc2584b781d112d4d1a5173d76c01f8eb870445388946961dab374c0153ce1e5479712b129df358a68c3a23ee34282e62280dc9e510b7a25ac24092dea498ae919e035007bac8397deeeabc6ff25f886838891349489b939c8988ca4f2609492cca9652c4889d75861a611c60eeeca75b6517e9d301f9fd41e27922020588573adbde26ff3b2b199dfa4c7a10dcc4610e4567864e55799c80e653876ffb0afbc141b71c69de4dda05d2bb44582b427d18bffaac80aa0b59798642444a989c07ab5c2aae37996761d8c6e9072e348b91ce50229deeb4e3be33f512a01c988043048b2903c7806f2121017ca83b812547598005dd43bd62109704d6bc7c2dfb1a864b0b84821d7fe9f8cf030152af507bec5a922298a22a6c9068a0d2f03ef4b64bcd08184a5a167debf8fde3c3e1859d40b68762c01b0119fd6cbecfa6d85dab196f1bf862ec1a6496bc1b25c6559039065ee4b179ce5db2da33b1a4f0df51340065f3c848d161e751af2ad740b60c88ef5eb1b43792984a93a452f909e1c0002c725fa2cd18df06729dc48948d1efe326fe98ef484c2b06c427b8b359be5430b30b149c262e564496fdc645e2e6ca82b4948b1f1cdf709d8296aafcf63dc23f34a064a139ee040edcde3ce5c8c413a1b0f71e3d890d22ba9b9fbc7fa667231297c7d862682f0914e028e47bab4ec768a20b77fc73c5e949846a81249eb230503b28e8908dd24bbaca1d1985d89e4d51623b3c665473f36790bb37fc314c287667d56efb568eb6dd238f409ec14e202b6f790109bfef414a504437b67f43e550d2c6fb3019eafd9efdbc78dc4dabab177fd415b00003612004fe7f67c7feb2750a298ed69983b8b92cbdf3043fe5825df37e6c17e02cdb591e2c5188142cb3e4600945d5f626bc92690eaedb854dae80adead5ee7d7d6aeb9b61b1e9c7e5a64fbcaca0142c52c676aaf7bbb9da92507aa78d45c9226973bbecec28044270cc98f1731ce44c7cfdc373bc8afaa10b191ea5581bd5d9886c69cda097a20c2701281e1b63f94e61ed5a0f8ee251ee37f363010e4d2688dc2a1081834b8f46e2e44b7df1f5c05212a6d7cbef45adefbf1d61d0b68b2cfc7b69fbd047341e17e60ad34090496c5d77b9c328484152b20ac16e042148299fb13f1fa00c836fa6ab2213c4c183827f48d168adc19350aeb88a6746b60d535ce6ab4adc60f758e156e75a7f631ec48a11ede865524478db909b06a5d879f06052fd97bce6eabd3528f8fb017066d23479bbee835964844cd43e2f1bcaee6b03b2bceafbb797519f8820b20210f951b29f6a7a25c03eb7b25a1322d911e2661bb9a06b30dc9f399b42bdc3e622738393634dd405d934a4b879b0623c15880b5d96ec55c00821ccf03595366fb1a0f0ff938b04ac0fc3e10ce7a241f8daf906ad317f76526e3f5a99d9b6d997b5dc4c04134e7ea5264ac7fc3d4f7947e1ff9f495308c9dd845f36bb14dee52cdae8ae1bfad525646a7b4fbb1cef2f5c9d933ad6387196bc74e717f1b5b4ff9454120e95f8d0e0c8422ac6a40bcea7f13322382bac52ad8c54a9f74106a9f619b75d988b436ff8e2720b7f8554157e3b6796663f7700b4ef1b8710c28c0b1dbbdd92e85932f2a63ab24f74baa07323fa6e20741bf5e3a63d1a97aa8c43b9bbf323f26425a1529b39cedac55c2a567174ac38518e0583da729d97f599b40c4d202bdcf0842ca2e7feda3744a178160d1ad36380c653ca346f9bc16cfc1fd1f7b0f6916f86c6119fdd082b831aee219a8f741cb8534dc9e15acb493ed66100c0d8c7308b47ab2a7ef4a61254f39b1280a3b420dbf895e12f40710117ce53cde282b589a23c9053066b83a5abc61f01415025bdbf95d4b20635a3dde3d4ebb588808c4b6631a5fc1766119693646e528f8305d46450f57e64b674c4897e8f28ef66db94956ac8abc0be1821e594860c945e04a514dd472169a861b626aa1914b20bb949528a08f640a377ed87f887b1cd5816db14623fdebddc62bba932c5c8459186313af933757da477a08fd6b983d901bf6ee7f6f3bd27449525cf05bb9f0a83aabf377eb95f4d3633d081410f3bf26d167a51f6ea77f6b1ac340c8a5b01a41f90c2a8af382c6c9891bb561ba160199c9b40ca849ac8fd75ff98c0f72d094e2ea56faecd40debd4df95887577a2322f60dd2add81d66e580b59489b90230c74357029696f18ec2809d46e3fef6b2af68873bf3abb18c9d037f50212a4c7a7d13112bfeaad063e342b9170deab534ccb40896dd77ef141775c67ca097afa3f1a1747a8cd926959970a7396aa28a2856b76c1ae5ee548e23a4d71af9c08acb7e514e24a717797a4891e3a5a9f1abd1dd90dc683da301e509b152241d48642603db1d64eb9d5fdd348b3746abc14e050c744747682c742b14660ffcab4a33dabeaa4474a5feb26b8ad6be50617f8a19625c2131cc8f9f1195fa7f8981154bbe174fb1ec03de9acc1bff7f54d6213570fc84d88e6a7451e6f733cbe305c4867a21443cb11e7649dd98df5cfd49a350acfa5acdcddb4a1340ef96068df0da0f62be8e2a3db88e0cd5d3ba036b98bf19c952478313ea56bebe80b93c78cb656d8868230a147bd1982800e03190b16837a06dbbd1d4d74b64448bcad874c78e61a42a8e1eda3efcb35f5e0f78e3509e876ef044c5a2131cf693fc09306234c275959c54e97b93369c661239bdbb966995e79e493ebffc0d0c2eb51432ba78c8dd82dd8fec623fc84cf235081d1d85f137337eb256072dad79945c896bfa9fc084a1c24ac2dd937a1b3be2f56fe6a8fdcde2c1637a1141dba9fe814dd4114ac8464810295ccb2763b789f2aabd847d1d53724885fdcd1d72a1f05380cf80a702a9f6981c2a7fb0869c0333291249aa0e99d1b39d833054f4aa5365250677a3dbbba1fc56b89584055f7482ae6a2df350d9cde99be14fdfd37ce2f553a231fd19604c50c5501d62939357a7ec08fe0f9a8b51fc09b7094e8fd466f8976fae83b0cb0ad668ebcf71771e2a67efeb985ff05fb0a141218c77f7ea5c595910f5ee83af2aa9843e40a1663c95323aef3be0532a92c4614b4a2dc8d5facaa0dc1920b9c9fda3fc370fa100851053f3690d62cd33bd949c27f9c71329bac971b13dba6526ef266ac487442d7c687c19e0f61f88a53b203c76feb1f0d3a43e424c36c3eef8d57854da72fa157da442653582ab05192965e17926040227589ba4518fef33f538e75eb6523252f31a1dbbc58031b05500109bcf87fe58245c96ee98f27b49bfc3e1815887aad4c30b2888638e958842da5a72a6408267d45f2c0405705b164b2db2ead9c368ff0fa262974f9afa1e3b3ecb3dd617d5dd42209d3c770535b400abe18864c930a98c6e866319f72d2238cd9d05638534c561912a04ce1f6f5e50e559eab87ceaec6d5931e9069a7e889731154fdc9fe1f0e7876f412ec5afeff278f3042a6fafd68854f84cb6be0fb938647aa21d95194dc08d3d681366cc5c4151364c9a0511ab1f0c40b959e27843a143e58c2bf8355515607f4fadbf93b8b006ca6db54371856bbcf2755a181728fdefd0eefce9ad6e11b28a5368fab4a5d1c1c6b223ba9f90d2f41dd57e022845a36cd3765a04de05876debbaff7584a781c28a627611a7ae69a318396310ce591484a0235a4b9cb3bba78565637fe40a82fb3ee378d5c752d3491a2d26ad0147317e728746a234d3ec4a1d677eb68a007a815bd2e541d29074423359028da8c4b736f7a80f63d1b56eae0786d0a01a3eb2cade2d2c1fd9ba92c9d847b043e14fb1dcb5e943c92519bf2d6d0e083ee843c77882dff07e125f347f79011a7eace0959b7cde132af3794cfd4fe00d6a548e1338be2e0c474ec38de12e63c72a0518ac6c2b0abdf1c71b01cb079deda0491c92a9cffbd59dce630f6f9f32f9c7b2ddc31869dd6f2d0511b98e7f3a48842b13b97569903ef37e5d6641f2823995a231b3d5dc656992ccc42abd8c9c7bb6ac92b42a75b93b83f4f88ee407edc4d224660bc8d4de54297255daf1b182d9c4c3798477dde1f9074725dd625330b1f748942a1b90eb378a2dda222dfe61c83e152e666367a74e49f4d0c210a4e04339b1b7b04ed7bfa3191697473bf4b5a26195d11189671f3bbaff5ff1faa05fffce3a6e89b81fb9bebaef94f78f0c2165241947a022164518f6a444905c91000329c2317073a869990c52d0fd6eeb91c5ad00b23a9312548e3d36b29bb6dd469363e1bb326f6ea010e1f84906518df5194be74f885ad355a059a75f13e50a2caa48a49818815b706026bc278ed462735444a11957b39cd732b480d8cc981ab71e0f332c920bb3bc338f12d83c5d70fc8459330190bb13dfa8c259f8cb5c108ec87c6f0766f75068343fb03ffb10d222417d60cfdcde9bc44f6e2afb8a9f4b73d7b58d45507824dd2d1722071cdb7686c3cf63bbb6958cc7a450bc675daff7af60e4b3c8a2e7ec50fdc6a27eae47aefb51b91b30e4943a1d801178ecff9d338a199bfc7d7c977a7e73a3207a1b66e42c266e2fe1eebb2c7104909ae0f76aa41895619eff6d3a366645086d6b199a6aec8cc5f1ce6f02fbc1db0c08e8c4b6b9e963a27f933aadf6969ee1cf4b284205b39dcd09f0bed54eaea6aa1911504f80ac05f7a919625a2ba6bedfb22e58cb0a1e8818e47f43425526d82241d01c65ac4d450cd8c9d7eeade92e891d9ba5d1400bae493e5e877a91c0e3a0d7c61143bbb4cbbec8efda02196aac38cd5623422f3a22cbbade0948b401068bb6fb5e466e0fad946f88ee07aa2e3797d4dabade319fb31f9cfca786cb07e7d3cbb4eec0bcf94ea26fe7b5cbc5a92ad11fd8ec5444c0e959b5362b87dd5f96b832d09d7ec9a71b1806429bca3b3843ab0a8397a9d6949de6005f5ed4868b4e5e973562404b4540b29f98c14ddfd0fe8069256de90db7eb3a55266a92c7456bcdc9a8329daae08c7aaece457b7c1538b5f39d3dd16ceb390e0635d3903aaf5ad630b9f905e72b8855701117f4a5993943f481b0a4baf956015630fabbfaf3779267e3f4f209fa32dced7a550ef3f3b49ff2a2ec0a0b0ebc3edf11ae58c37ac97c341512d061b4ce8b3243fe388dcb945a3ad553284e92f1f6032408265a6d8e057716bcf007f2ef4067c7233671ad3eceb022ba3929ec5745af0b5faf5bb1afdceaab8dc47be06ca944620bdd49be11e26e1163669d20179743b446973ead3609ad04495bbc14d7e14e50791b0eb2a1409dd92f1b3c1b3f2fd71d90bbd58d92e0cf28d9af696b8ebbca0dc641731ca32c68b24c20529aa7a8a1ef99d9d8edf1055fb1b07f9c4b4dc34ef2ef7ed52832e37f30f1517e9f601b44a6c61c1308cca0a8cfb676b0a15f5a0e75aac872bfc39103465bd06990989c6f85b1ff5b5722cc5487c51ad7253da5dfd5c548f9f463676e4ab2f586d848d4798bd9df673305a2b09ab22a12911a1c9f281110c50b5c59a8c9056bdbdc99a46fe1e96c2256078e60530bcd0f4c45dafef36e27631abacb869591cf8f1ae480f67b24e5a448fcf2515b16810a89cf3704eef3b036cf4c43e6aee62767e5ecfd834decb97cd0a06baa78bee8e0fcfc2578abe94581a09e939ad38e13e6912f33493c7feeffba417ceafbed7612b8aba272e3907d630dfdee256653244a472e54b3d196905830e287c66db8279fa1f43bc35fa0b8fe0902a8f52e0394d26091f93ff9e466294abe05a02e89bb95cd61f0f3f96208fddb78d7e42f2f419464167192331261d2074179c142a3ffd5af65309326e57bbdd3baf03b9f4f577d9c77436a169c433b13ba1ca69e98e19b2ce52003a0b387e209ee93066d0ec24995c9474c35dfa79bc1294ac8d8443a607f0b042e815633945fccdfa492921ab939eb9463bacf5468d7ee93476da05642dd1bc2ddd756bf09079b02785ba97dd0dd444090f9a664bb9dd2d30e617b07610e44073226485cf6c2cf5ca31e37ae47a24fe9c091d0a11b0c0793e9511905fd4581eed4072fb2de5220911ecb940b88b36d3cf6c8f5d10a0630d9047ad89a21c90bfb9381caf3eccd9287ee194bce63a29c0b80f882677c73bb7899decea6c9f2c49a258796cfd220e07e21cbeb789a3778152978d3349339637810f5a0eec4e42fe3a01d147081e370c0f50ffe2594d13ed8c354cbafaf88e87d8a906bcf229815bc72c1e7fcf116fe963bcf45d91aec8b6c988ec00e7c936ed9e8d8baa67a4b1d7404aac70934328db81779974604e25a1f6d7cf38a739dd3549af2939b4d2c32bb11b2f40a10d62071ffb882647321b63e273a72be84b853ae249e423ad4831488285ceecf8b400a7cfb5277967c540d56b891b32598d4331d21ee6f050e8c003e8b1aca9b3791dd36148621b02e82ef62e2f11db3fd7b1266c82fbc8636aee2f5ed3e4476c6f4ecabe4a600b83d57e6e1ab40440f098bfe0f1cfa8ad6ed053fd85e48695bf2d968c61bd83b69556cca72b6c7d654f3d982d567adea1aa7aca3b85686b1502e4bca415a61a91bb62f5e2335e65bdafa45904869fd18bd4dce128442d08d29723aadc966eb984be4944e73ac644be1df871bc76ce894a9e62cb8cf5b4fdf1921fa5ba085760f4607f050f4b7bdecc3c54a5c9b6b51748f5c1fb9848383d0005986c204587ff8f48dbe62413f6fd3d280e9ce38fececc39b4276451ff10fb7135d4b2a1e433f0e2acba2f870dfe1f8ea31da6bcb252621583b54dc7635291a2fb357098b0fb11fd8d34b57ca25310e1fcc06aa5a5f19b601ab15d7294584df53560b12fdb0d4f3f073f026b7a34447cf891f54142fa702bd1d7e1dea779467c05ea295c7dbf58c6ac89aaebe0bb133da3d09260247b62873add78d682c68a85118ce96904226578f7353ff8e76d937f7db79c9f2eba009e0f9d35f9ff1954861c10528273e0e76b14f091028a23395dcfcb957490c6cdc7c1748b0df017e2fb7b83d8bebf0081256f107b8b3f10f6204b3fcb676879f13b3e37e462b01404e66415aaa920b1a1bd931dee819652a6696c2543b531e157fd8b773321b4dab4ce6ac76f6f56f672d88b8fa45b55889ae07111b99e26ab7f0b7601d5083bbb613f6660ffd6c25627eb74d39647faf45eb89f9e762c357ac29dc7bd94da0339ff59633e630d6e0421fff8dd99cf56d7eb364bcf3878cdd4389c98f59095edf44100ee4b72ba924f1b7596f4b0ac270b18f7ea70b611997fb3556b3a8b089b935d9c655876edbd2a3c9a14fa0d6d6806f2a133ff7a7890b6a5096c87c92aaa1abd1225c0321d4ccb13879a9d7b44b81a060c99362aa8f560a6923cc6eaa2af74f0a838b3e03807c1f2affd29ebeb8d3243b3016855d96fd63c03a064badf8c42d407ffcfbbb554b9778969367008472b76d5688431f0a31787eb9dab7f09d25f8220d6ea69fb3f31438bf72842becbccbaab09f3407f10ca232f910d70f6d4c87670e511aa06eda33691908b803c672c15a45d45e4bf1c7c0697d2ccc16914fde1347f883afe3a736f31ed987629a267daa799786b961ecc8b5efe96ec5c3e0d72cbc626e508071f876229d2286fb733c1cea9fda3381d27e6174ca042c3ec6a039d6d45fc9db698d400206eb747563153d3f94ab9a484adf36a7f6aef4caacb030f2072bb18ac344915c42dce1e2cb676bef74a53fe276bc38a6b4c4e1f9f194a4a3cb4bc5f71b2a194202ee26bf98ebcfaaadd429468b2406a8b6e65744f261205058aa859f8b9d1cd32b79d20b0086fb3fe7dd22eab859235846e6b8e576a6ecce3e614f8454cd02a5ec501904e8523a951820bf2d899fceab846595746adf5c7a036284d17e717e4dbbac789f94812a573c2df10258fe6f659574e39491614bf9bafe08f5f00048705d1b6550a5fbe2018ca19295869ae70a4a900465efd0584658ba644746336fd1e9e385a79b9e6bbc21ce1d018b7572bc1e660b962e1f64615f94a5011b7276a0bb69bc6318509c694f7d65c3594a29c1fc627b7c73c4ad92b0d4a07a843a7002fea32f10a41933711786b0a489027edff6b8cc1d6b38e5ec86d135838742cee10dba321856a7b4afe6fe0e212e625b84cf8119a473187927227b68dc804cdca0fd6dbe848ddaed785d75f2678bddeeb3c2de2a96044e3bc0c1b2dd4237b97427eb2d7daed3fe8f6e405e22b08aad485c6b032db297aebc234be33653cd8d4a1cc0713719edc74d0adf331f092f13093b0e473f4385f1a7fb6af53f8e4ea312c33600311912a70bd8f507289cfec51f709e9b2d2f00cc523bc66cd2f2877c61540ae8d4f1827672e299a1c679e51d18f1865701b942b2721a013921f007f3ec3ea8de8b7d66df5b9636e340170123ee3823374d566c5b639abfc6435fcb253697450ec3af339a9d97185b076af9f9bb1f05eafcf7625194f1cb1f25001b41e6097b7a62dc44e4cbafc8cf0f0e47449d76a515c2afd9141f0610f16f406ccb3d56782e7dc699152564d8c2f3b0465ea499947d315e75d3279d316a0e3a83903659adf641285c0f97a584d6dc163cf4d3d0d5b65667f412af6eac9f994e5978f16f0dd432c7c2f137564c06aa5658190862ceee74e6399e451519ab38451df5f35234744d7a991f303fba97608ee806256294ff459d693501c9cf561cb9b6b31e589408cf23ed0974c0a7f4234ff0239073df3bd94fd53e0e21d06959f02cf690cae3947f3417a6bf35cfbf8687804635a9177bb691f2df9ecea81153c0747fc4f77c77d53640000cb2a64ddda9482240618265c5998bf6804932ded6f6962c35cd0d49971063dd4289e2a464e08b06259531a5b9faf60d76c2fad1f6eae7a4f9fe1cd433a110710f4d168283d5f2a5b231c1d546e17e73dd7b405a6b890ce26f1513323fc2bd9ba1000aaa4a4be7b6567d5ccb8fbeb2434c7b374032dcf632348b60b6cc22fc6002958a0cc23498fe6a5229468812bfaf342ff8a6c39e6095ca712bab1c376d802949ede8f649fedcd6ea7d142c8ad3893e523ea19b5eff73c20954b47fd01ab103da67a375b1040cb58a92bc860d93a97315fdb4f5ee19a20abdb3801e67109f01ae5c93e380c9a122df20307b63af32f2267ad9fa2e2edcaa8b19a54a53fd18184ee69573cdb90229d1a3af314198239d7f1d4e41f0460eac7682e8ab407b571b732820908a59ee816c5c3ad69104172d7095aa721344474b3cc84706526b9bbefd0fa384f1c2a5b6b0d05060f5e00b14e971131233159312aab0e1107cd5805de81a9c51368f51b0b2c70fc0e736979b53f25a7bb45a797c530b3cc8952a03e380080d0b78edd13827d40d569ee3177e57a687a9f4c1830c1dd7b4d49297ccfd207c8adeeff93ed154fa35e719afaf273d56d0bfdf4fcbb4b358f4035751b66d31cc433d76545f1e0606e38113b683c19c33919e8979b5b9727d6e0f966740b8a3dfee80b988b73e798b06fd31405a7a23f0dba034b834426cdc02374b602067d49739442a568a4b0bc6a5187ebb3560033cb90c525519575b97ca8123875c97b4230d86143385746184393154104825c3de7711fe9327e545a0949b250da3a85731404228d9d999f815eb3450aa4e6dd1610e378a7643b59aed07bca00cb4c1c6fd1b5e091ab63ef0b279258bad5e9e49e21432d0beb350bb76ca144a2d8eae0997a6c9de0a0cccf0bac75450e64564d91ecd65749aa5d9e653e0408f5095b0356c8703c7633f307a1c0e652cfc14f0194eeb63d904e56bf1e3aef0f2e2cce74e31dab9bdae2c9442d62a51a35b4d0f98c1b0b966f036d9473de7b4a042099abb246d12342f067c5a1493f645e89309ef3b64685eec382d25c3c9f651935f4ab75da4cd64132441a1299428be69481fbec86881410490cedffbdb26e0870cbaee52a5085242c79df5412faf618df0dd4b309fcbf0149c70d6deffb58fdc3b42d8dacb9ab2b4f4989aa1712bc6e0f2ace76643d0989a5ceadee8568660e861c74701390ede720d3a3f9f1028bb6cc009cf7ffcac52307dd1690c31ac73f86c0946a2833a6c635221107648fcee7e41ee6b23990ee0291766946784fff65d3ca10d760d8d2e4759a5dd9b126b4009987d0d0ca55d66fb69fd2a354db3fe5f7c48d6bf88f15e2a9d3eee2f7da92a1cc8206a7d8c56a29ecf34c274240242c5a23ad587d36cad7a3da862d2823f43174aeb06e43ad3cc244f56c44c156e83aeb9b0dd195430f8cb12754f17bf0e9c98b9557e915cc8448e58579372d20febf88a7fef7a2d724c49c86f4dd5af7c52352f8fbcc61a99a5b76336e45703991263b7f8ba4f78622a4fe87b7a9f49ecea879cab8db2a52caa04e02891e6019a03a09db36fddb97fd5d53026f469c3c796767f8d75cb06381977243b83f10a132e9afa21672fc521df3c83c247e21b367a5ed57dfd0f5f7f75f50b5ddf13852526dbcfb98355661630422dfc0810e0278194bf52cd1d7e723c4e4c9fd4f67e6b0f3647da160de73bcd72cb934ee26af89ec68f03db0420a4ddcca7f6a57937f2a8dd5d5ba8e077c68e9e07d512b77d0594a1699cd870fc7c4001340347a2dbff22ec96b376f55ea5558a55d56a97ff6b7a58312d09e68b06f72bbfead2907bf019d9bfa86c0d69cf279a2266c63eb939a96d3ba808575a3d6854e0c9831bd693e53e8c3d4fa4faa33aa3cf1df20a150adc02601d88622efbcc3dce553ff26cc2a0c2e814ccfc273dbc4ac61e72ac3ca3607664739032799f42f97f6dd6edf086405258f19e3f5a0f86df72f27c586c3a213daa9a5d5e12f7a3979e7745a77a04d0333e5e9d314989ddfeba08212838881de00136bce7b40bd2bcd9aec90ae7ded51c41e0723601a973f9e8a0e6c7dd83689015173b6f10f6ecddd88593b7ac0b9e8a4738a1664bb291b5235fd09658c15094be90b2af4f0e2659361959d4589f0c16265b9a967f938eb977f4bdce278351dc3ff70c47936b187784314915f0c5d140d82b9ac64d9127de45914d56f93656024e434e5299025cc4c22b964d31ac467affbb2890c9b37e513c136011b4d41d41afa8a8d67df2614d058eca15b43bc2a72b0501abcc3222d0a133444ee2d3a09f07e56d02d87f2a8af174ba4d7e0f0598d61b87d61a3985cfd2f82890e4a7eb7ef05eb25d51899db78aba3fb8e55b0a22b1a0f8cc1c5e35cc93555a8b1d5efd67418be6c21f4d99954e0abfcabb0a671e441ba7d4d34f50581d78f6edbdb992d04c32e1dab9209b60f13c007daef5de86899f866344dbf9e1a104a0b0f538b081e98db462ec2f74684f447705dc30d48f9d9f2864490e0b5bfb05c14db653fbb39946b008a65753459fa3f736f57faaa383511fd2abbaf42229780345bcb2efa088bb2ffcad6f9f14a6ea6671aca4040027c764854ea4fc200fb15132a21d0b0cb6ab4544faaaaee95c45e86756ba633f16c9d9d5a95a4c18db8d04bd9a526e314fd849a9cfad95cb2ba81bd5e34a0f149e642f3fd0198cea9ba8799c9a7cd7317d3f476120d07ace87aca0a71f947c54100228edc7a1e7541bc42e325b6bd5a5b8fceff76daa73ac120c8a58816833819d3ac33f37f36b3778e86f6ea497289758161ea4e7a1e937afaa12262690e9ca3f916c8b91eb0c281dedeb9d9e18daf502c01fb07b576ff36f81ffcb78f4ff712280281a054cff5f681713d5509aff94259e0c2896de983f24b99b75b9eb9fd62b8c78e6d1913c2d0f78ef9260c3804fc85540a55c23e34600b610061527357487b2b2ca627278b33fe693ec8d685786431042ea2afbc8e5b77d0b3ffe6729282ada3eb183c03a4c3fe1c16d34d894837c029b207cafb3118d13ecb33b566c3a9cb7df5d1a95da59c93f14e152b9d0a8c252ae418fc47664648be5fe40a2a9d71017ad3f85e6349a996bc035cb890d0b086a530001802a32f587516b4de2c78d0d04e1ada585d42ac157741dfff00aa422c8447f880b983949ff1c8d0547e79cdd01cd5bbc1437c23b16e5588ec398dd29b20c72c97194cc6c2dab19ffd4b5b9a7d01d1de4b36f200d95c837381abfe8c9f460f8aac581285cce60c20f693b702bdea7509ec92d267d51c3ed6d2be6feb6f1c150d935542eb481c6dd734c8fb436f9ac2ef8d4f17ff7e678d4c00c455eddabfbcc4e1c33eb280581eeceed3a4a99f53f83a7f06ec6310ee1b4144a40c35c15009c5611e0e81c020d1ea96525d28f60986aa3ca39de95aee9679ce3570787d884d3ce792d89c67b03ebe7c8e466a2dd0fbd929299d99be58c852bb6fb91f85536306a2a5a189e1d686d34bdb13472724a19c9889b60e8320db40baf0173aac75a5ff257dd8b5d02c867352f47e67f06a458cbdd90c629342d5ee58defcdce63443379e52bbcc5c2c5074a3397b09a53fb436610c8d4ca3291936916959dec87b6ab544e0cf19a3a36e6836af938590bb30cdd840ddfde6851292a7ccc8b8906316d65510c10932457ed5dc99ff0bc1e45727a26d54fbe5e40d83d3870281d03978e109dc009eef3603e7c302075c685a7fee0c704d77a06f33634dcfd9158205ec2c2ec1cf9b3f0e397f28491b3fefa45189b334d0d20b94350d0d7c723f40e68b74851d07c6d6b30841fb3b021878ba93c5b8e46626d9fd23e833ab2e43e24f57e340c34991fc75fd752095b2472e174abea2914cded21b3390db06a38d0ad2541bc21eff93bfacf98bde4f5f80a005cf51798441449996b087c14c00c079fd89fde88d7361094a11548aed3b3dbc7160cb99b7e5b5f475e031dda60bba75011475ff7bd3595f84bafa0ea314e6dcf92a493679682e3ded185067a49c18935e3c675a7fea79d85cdb134350165a4f3af0be5ed21553e2bfa3f00baf7c1a9a7a0ee2ae3ae84e375034a242408d72969d47981f3c3f0365f133fdabf85aa064b9e91076a46e5a27ae16508cbe7fba98a089febfb2d399818d626d5ce42aa20a4c19f7d673cc80d2dedbf62bd16de5e36f1ec766eb1d9cbbc5a42093dbb765ea5b70b99d3be59f0d14e39cf2e5c5da87e44271d11df4b2dd9bb5bad70ef4ddd938edb4739430d74057dc73efd5d57510c85cbcad27d252b0a9351a28afc97cfa47beefaefadc4f2bad8cce3473d35b23b98f3a82349067807b9af58721ff9762d81670da38837e258ff261db5825e38da6cb5850ba79617a7f8e84af9d5080527496d7065364f51798a1dd300f8173106b1948bdb9f128722d91a87b64d2fdcacae6632e67d8a743d09b22c1f44a896b1d1bd174fb4a5ad22b6b816b27a53b07953a68dbf577b9365c90f0d65d007b24d0527bb597293cded27e3ac75e0ffa6b7957663fd66af819cd0ffda4539b77c939c22a32b192c06b0b1a77fe991ad4de8d54631a6fcde99b27d78eeabe920ef334821176b5dfa1dc1d0210c24a3295413ddba9e839dbab0b31c261450a4c8a5b43c0e245fe090c5dd28d6bda6160f3c800bf78c9400fef2a2b77f5e1fd908ab0accdce947976ca06d9c6f50dd193b78477d25a748e92c9fc057c35f98c0fa67eb539c629f1b9f1b24b51a8edbe7ec9abd36d099bf482b80ab54c1996ef97a914c1d167cb15a92de8f640dcb34fa17639c596bf62708a8559f98fb8d50b0e5025dfc089a948c74822d40a336d712e39d584ade12a59f0cd074ae235aa6fff21d44326ff494629b927dae285925b6980fb6e1a27e257b2a5fd10259bd4735729ecdd3f03c88cd540a6e8308bd6aa6839f232bc931663c48f1074c0d21ced96304e6ba684bcd54e37d225b38ec1d2200d0f340a527d929ce16dbfe35578a94f1aff74ce852600ec2d5dce4cb8ea70a293ccfa0cb184d0835406424ee7b60c8afe4c2eb4aad873afdfae6f0c3fe6da2f97b6ca750ff86e6a6c22768006a2a7c543394d2a5c4bd3468dd9af51ea8008c543367194f59120b55b4bf60c4e19b40ffc77bfba6f0da318e32784d2b9cb7965dfdd1aea0058c62c92f38b7172d2d29a06b1eee5eed98387425fefff3d0980ef68c0fa3f923ce8436f1d84ae5b61d19c9376051676a30c709432c907a83233faa0bfc942bca0feeb86c839bbc3eecb6091d1f01694ca189ad35c9b46337300d48d055c071171a8c9eb6bfb90ac1782606e1868d149f17499350e9d9aef2d3ab935da75ae1376504f7d25044cdadd24e7eebcb7beadb7082cfdd896f2a0bb8f381097cc1d226b2d14e48d6661112bede25eb3806a9a83a0fc88f890c7a9827aed410bf7c51a49055af68cf37115efd46215c63fa091b9a69fe5586a6bc69894cabbb54f5b9824d0355ea436fd296418be38e4acf6fb25a0e07d9c22beee19d7fd864670354b9def93165a9abbf3dca2cc4190164770ed056eb57df85e2f9ce534407222b4556f16e0d5ea9b8c3fa3e184d394a10e0bd8ee410a66cbb82a6b043adca698330ace84a0ac4b7d91d19c8c908653eaada3f284ea1a224084e2795bb70c8234bc739402942e5d03d2da9942b9052d427cdc3ed5cd7b91e042a6eeb2073cf4f1a84c5de5fda54fc42b3e94323850e7ec2853c5517c5d65226e948ac326effdd7f314373393a0c8a8e8c4be42e31cde29de811a19788b77cc7fefbf3f3aca8afcf9873ea337d65d536d4b2ea91c8f0c300f5986ad570deee62b4c578a898d648226137a10284c562e61e19b5622fd39abc33d9179e943871dc7cf0d657b2c98a3e26970727a95a384677e65ffd1a8703150ac37b08f387d9c0310bccf812f32d6ae448b0a93fa30b15cd45055ece796263b62b6ca4f92358f5972dd959c8b9d41bbe7a686e8d1ec9c895431d47e67d6a3c310e206ba81120c5873b4b2317f1ef6abb982160003a3374e91ca775f0179d24a22de82e4f00926bb4909504881f68adde2fc74cca861086fccfb0cda5213dd1dc7a295cdd8d319dbf3e26f619524defd86e1245229b406e2e2a8db61ac062725ede5dc0ea8552e05171f862c767483211bdbf6cb708dae6d4d01119ee1bad996dc0499c081c4fea476bf95652d2f474ac12d3d3e318e0c03db5f51bd0aaec153708b2195033e16bd8fa49643ac82c57a8f904b62577ca89e730c805fef56d20663f58a83b6ba4664c6f1871fd2ff14e176ae10271c84ab5a5e802ad890b4bff989fb940ff22ccf1bb59b9fc72eddffcfeaf756df486eaf47b8f8b65423d6f7ad6a7ad58f14f90fd58400e2741512da4f3351401668aa44ee9f9bdbf756ad1edd806c9f928d18d2bd37a1d205f985685d0e507ebf927d0da97f96ea45278fc3abbabea68aa760a946315c9af24627eafc4fe26148e613f1a7ed545d03a0988cdbf55fc515a207c2aea89de5bcfe20dfd16325d46285089f3004b07408897ed494b03a306d996ee558d36dd15a17c12a289cf09c910508d5175ec98cb2eabd59de0e400fb0c6c73be374c30ce2a8cae19337fd5a216f40f406b175d13de4b21de74daeb0b26ecca51a74efde858bdb952359fe14cfc10ac90f5d2cae6673cd8cfe0951c5c7b6d368c9e89659fdb6ee07330712bee08e43040dc3d3ff2865a13aad641deed930ef803d8381ca7f08075287522d752552637c524c1da44539a7b92c11337cd2c94d45be077237aac3bd40dafe46bdba101896b8c0e2a409a21a28b166157580dd1fb8d98940ea4c03a31d24049d9d7b3f9015ada0ba96b1db556cae2ed410b666eee4a7bf926822609c04d9175bfaffba41fa47a4584b57f5d6fc9f31964e623644036f9d6692676beb99c7d48a80b5d49eb18e5e9d83fb5b8a8a510febb9aa1dfdfb374e24244063ac68654fe0aab7fb450a96d92340df81fe98b613e9678115241c2369eca823cdac4246e8e5c40980afbec3364c9cf577df94ee176cf487927e1e5a663ee087ea3a3143864116edd350fc685ebdd66390d02455ec75cee665e9f7843c54013ae8652c456d3deaf96b0b064c55a6273b46ad4aa2dd5368b033fa97a7ca99da43c874fe1d53b1b0010e73fa886a856624859cd0954a58031b215cd4ece110c6f535bab26cbfb2f01abb9c783b1fc93f5e0df7dbe88be425fb9603b94179aa9ba3840c43a9031bd30d5cc4b69efadacb83111fd54f4e03208794f6af04f055443641e40fc25c88180e0877e9ecdebbf6290d13cdd4ce83d87c02010477cae3336f9e533ede266e90f308bc1a077759f4b2d9872a65f6f29f7fce65487aa95e5538e17445760325ee4c0ae87e072fcb81453b9f0cc523460efb54d217376cedba1d5a638f72af373dbe3c263cfb69e21f2588ec5644b41a4f92c84b75f71b4a8af8a15d1d55a04f67de616601bdcf1087e8e7156362209d781a8a504ef58ee5e488fd7a1c7d6c31c85104b915d3ace68874770ea010ed78a759e644567652ccf146000830c34ba52d48d5a8a5a947c702df77fd5ccb25f087c34f2878c8361b6d88c6e9fdf44212e6099d398cdd502418760c464b448239e273efaba5cd861bc27aa25bd022f4a839ebfb557ef1e2112a999fd2e7ffdafd4c9f64f8e49b7bd9bbdeab205da7c5598c2f6193f886c1684115b9f05915fb21d1186d6228fb007ea73ed45976911fe4eecb1d2e12af139ce8bb7c612a9078402b0fc859c4033abf1d9a09a3b00a1abd69ebaec5b5d9ffb563390808654254ea8065857856cb37c04104be3cb73233ba30ede1f21a72834dd8047b0ff3112ae9869b02b45e5357b5f779802bd357699065e8669f30bf3aea10d99ab6b2344d259a1085acc02bed18d955143452bd70c749a800704884242e55177ba750b7482b88cdfc069163ded16aeb0592ac0f2cbb1809516c42bb7fd6391cdfcf127c6c1cc6158715b8328d8c7878f4d93eab333df1d25e01a00cac7b806ccd4092753eeeca09442abf2b23e39be0bd4d7c8c96a3f2eb03e4a8eb09767e9c2c9a8c13c61510fcb25448c4b2e4205cd3e6ed8cb86e7014784267e2689d91d6becf730a3fe37dbda35c7d65e1bdf243abe5334a409cd2d19c824a143b7a1af96e5e49a3405bd566970779a9d7e0c0001a5ebfbc7c34c62c75f56db48029f84cf5eca1476044586e383774607ae5e0765dfdd183651f90e077c240d31b59b85897236ca551df627738764d87c25e33e748d16d39e4332efa262693a49fd05cdfd68ddaa0361865e39afadc1709c0a417f0d00d7ad563c4888feb15de744af6463e10da7ebdff660c61af3c62d894cccb777a79bb9bd51b32843460818bc0443f48b24e122fb1a0506b080587870001fbc50bdf12fe0cf147f65846709d35d1f442fdf803c645487cbc6f116a8563b05dd5e0349e032d7bec0544f877d4ad464fe60ef441d822825cd38c3e113ded8005768f287c48766e510581d4a2880eb65752a4ccf8d560613c9ce79d3ff10f5f3481344011d60519652817c505d8518fa06c19246409a7ab32a7a405de1ce80fc5538b5c4dae0334ae6a85e34372f8cee0e536abdc3feb6349d4c4de8ae682423d3fc483e5894d6353f05ded500aa3a47e5a397fd548306cfe76249c87e647a824e003d870fa3aa9ac66a9752b1faa940a0f2b6c9e59bb67144f69e714017e22743545bb8613ec0296d65fe268aa2894c37b677836b2a75365854d5b174d2bff9f3708d3642b16f8910ac66d69d784387afbebc28361f265b66cb885c5e221d9a482906c69dab2ed96be2518e6510691796fe7665fca540be20ab37ada19b12fae618a3892683ab1af7b94e96afca3405e451175cdc737aaeabf5b964e7cbccd4a97b296c9e047546b53876701e591698d6eee02d2e1a7d1af57c9cbedc5f3dcceaf35c5bee5dea13f222f00b9ade9fd340a774bcefd7f11e6a284044f4e78d8f7609706bdfa7a4f635c5cd75fe3014e069cf829bd4bf1bf3c2f86285712f1f41e924dffcb65ebee6c3d8f202f302c37cd29fc3c55a886af60fbb542e89b072a44c2b3413cb140ace6fc0a47dead770d00a922aafca9519434e88c3386403a7bc3d355d186f359080ae8f64fa419ae11cc1065671eab856c7b8a8538698ddae25e603c940e2a0bc45c1e4ce510f2893a490892aa2159f549f51276c67d1b498d55560019056e3e94165dec66c2f7204e27676e0ee0dded12d5a4ac53b7825f4a108abf12d858293e4c7cd0514699bdafaf7eb8e3b3baf587b55e1169d5be2495180612d1a10cd6be0569489e5000c17081ab7e80e1013fa71f5272966da50e3651dd75929393de9a09eba17272d441e02140be80aac51442f5e5314d2e7d4a86becc95222f27fd81019d905b3b497d1c6ebca587633e92d41eeb6250d11ada0e16ac7ba5f77abb93f74e6167af8bf25591d546f861771bbac47c046430859ae89c8583e9434b3d0d20bd1fbcde34767cc5b05b9f351c302f5177e1abc9add75dfd7660a87ea0e97a03dbf511a3b20602a99ab9fbfd3adbf276f683a7e6136979c0b388c5ce5cb0c263689a9f7e18160990477dc7a8b4976438b4afd4f4165a9c395ebf8ab8a74c6d8f85b0b4e2bcd8e627f0d8469ff866bac5a09123349f87231a6b0020e7228d721e0d814acc4782dd0f5814968621d314060e3c526dd340e6c9f6826eeade1b829a9c4bff730b965273c8c63de5d6291220190630ff1e3e2982b55a5c8e80452a165ff24ef514a50ed2be07ec8f53d7ff5887c6ce2162c0cd61386ff7b9cee158e775737ae35b1c81d07fe7f5da95a1a7d9be0b9f971b80693de5dd6644282c3015782eda8a70bc9956776facac4f560f9c257f2eec0be1414b1db3f5a810749cadc7464b599940f775d97694cbc3e2e2ed1c2aa3d328e97cb17aec3947861b1fba635b8b5c612c8644932f62154ce9e126c0a8540fe3ce7f51fa4f2dd5e004a83e2f27d8320e6bb9e094807fc6b1cd95251cb9af9389d7374cab470d8e4bb85e06e8624fed641ef26508f53e6778b7e15a0804f7997cf912d7cc60bf54c2f78ad5e1f8b3b1dbe96b1e7c015054e60176ddfca3974f78dbc537db7c072fa9980458251e13a4a8d3c94fc52b0bad91d979fbb4e013de7bfea71903f8ea72a175bf68302a7fe1f52aaeed7012a8e0be00a32b5400e0277669c6111b02f59d139c7bae01fe21e6ea57ee6a206017dceb3af04387cabca64d1dde5ef2d0d4c7ef76066d0298d3b92445711ab4bf5f2df625b2c14f95be4e03acaddfe976c3709573357123f02a6a746122a8382f69f136e3c6c2d5b2e09f3ed162cd66d069421b37c16042dda0d8d46cdd901924655d86121439d0c5cbb60028ca2fe331cff57e60ba5c8b750346233ccc20269ea28ab93919f2c625cbfa31e72bf8655f83e272681b5bbcc5801d49afdbe84b1a065bdee0d4dc1a36b1ca137a710e91b7c78fc6fbc9c644ffdd40a5b6a5aeb14820f24372e1e255174a0d33d35269e1a570583130a86195c0e953e4f765c976e9419654cfb91e38692a77aeb6f785e1657d1b5c9367b5bcf316b508660c7d21a123f30fc93bc9e16c9ce96eaa36a564e4ae77a67c0559d3932ac6a1231e1723bb8e154c831b4471dd88a6d4218314d2525ffb45ae03be5eeb8ba16f1389540249d18cd0ecb9c4aa603ce73f2fc6023413d309242981ff1c4b51fa3f2d27a83b35cfbc1dc6a83c1c898b9901090a9ccea2a870af6107bf298a25cef97702309cb85c4b37348deb5379b896bdc17ea33ed4d0cd37c7b69a62608f89ca3974dff77e4bce5570e20b70e87ab0677fe1b89946bc1e1dff44502bb217b336a7ca41e0bdaa16d7b6d3ebde12c15a5e73864219a6d44b98cdc4f884875297bedfb0a03957a6a3639d781dd4cd503b1cee50d9cbe660820c7ce94a9fa22af9a30f299d293b33d34c5fc72511a00fc267b787545ae15f57161a762c302a7b5a160b585962be99347d2023a7fb4439641f3433827ad5efda2b5801eb412fcd338768147d6d4ca96b891d02a870b7a996d42d771edcab3122a30384336eab1be9d111604e82241732237b13f7e6f48719fe8685f3814509023fb2c0d5173d23a0a94c84415605b039fd77cbc83ddc75f673973cc6a30eeca48a654349a52e8ba65b8b84c5c41f760c325d1654caba80e849c3fc6c2a58087322be3c508d7c0c72e4296f18cef54e1656b98c1b2d6a4d30f0e26b9a07f2c440e71ab2c8de0e60781506cd95bbc6418c481678ba46c8c0cbfc9e523ef8e3053d93791f756e45cf9b348d6704e3ae606f3797d389d5a8ef038be7b812e5f516f42ab2935ab1973813725155924d7df8a3b2771b07aa55a025eaa14812e6ac2776b464a731e0b3c1ae227a1ac218b4c3b8b692c9529079c57df170666b3ec06e5b6a564818a1a0c6dcd7218d55dfb4de50928877eee2ef7ca8652e5f01a50a393d0d3750256bf0eebcc4cbfe1b2ef25ca110b1f06fad446f0800c9700765580afcdceceef4ec1d8003880d4c26ff40d11ca67ccebbf3dc25095714017bffb4de1c4140c118060954ab98331607ee6ca2a2b26706924b7fa5443396e75dd5808c3378cabcd1b98f20d4b374761a49ba13cc9098c37bc54c88a7b1de3d26eebd9864ef456bf62cf9f2ed9e2eb7c3faa8ce357882375c3efaaabb75056cc0016eb53bf1ee29afa3f7515434fba374570aa2b86f50b116681d20f725043d13d2f64105d0b53e77f7bfe838d8e52cc5a18e0d001fad08e04842899ebc612dadeb54aa9f1fd82ee219eeba40313ea1ae45c418bd55907c077b2650aa3054d6c3c56e60079fad88b3f861202ce1188893aebae72a1646c6ebc89453feb5cf107e20565dd488675997462ba734c97782fbece3deb6d5e25515e3e6304b18e3c333b173eb97c8c0e1cdcfae0e61b82d44c5372297565c1a5497e0cdb026b4190b0a428276f22a837ca2b60ca998066a393bcd34c36ccd506649aa6e395f32e402cde1eb789cbcb9a0094fe7ce57cb87b0b654c77311730983480e5d1e37b3ac65a6f3b658f9dc6fb2f38eda9c78baffa767820ddcc55dbd2506930310c6df78acd44afd003abec7f6ce625096750c9988a53628ed5d18aa2f09900a3f885166480b4bdbb6083bbd1d5705243d0500214bc10ed2555ca34f505c50df18f3fa98d5ed38d644661749f3dbdba12f2d4625a50a2f1ada95e382e2703bfac9fc2320abe8baf784fe6405592b424d37a4325ea32c6a17cbe2f3fa5c9c7ecd35228867dbce484376814c59d6bd31667b0b41e902c0b3c33858b2a8e76e7c8629af3e382e23ec3e3a56f8bfb9925686f237dacbc990f4654dcae64fe36aeac411d2c50dfcd43edb784007ccf1b9b28ac4af52d102cd82041248d5e77d70e178e71fb1be5064862aa8e338ac2c20cd9e81314a7f3809d098237351d00f85c9f059c390002c90382b30c9a94ae809f30b2f288fe4d4b2a07b9b5d15ea552c8b4b906856288f0aa77869e8f81b081ddb6fd1edb2811bbeafc76df3ee2e10a7ae2e10ad2c78df25722d58cbe2860a261cc065c828fa9382d725a833c32ea19c000ec0c70b0a6af03b74c245dca782718fc96ce4e2e65274679a34ad024c6cb75e2499001edebedcc9e8a6e5dfad3d698f803347736ad3c1a0bbfe349b568a3ef53f89a2da5bce1bf21b886f95103806412788b56b5a3474d35b16fcb96273c785b50606288737e5cce4fdbf2e6bbe598f597c5c4e7b25bd3992bfd0e92318a59ed8f08755fc374c11664ca9511d15f37831c22f9ebb5144ee5919ddc3581cc8fd0c1c32f362134988d54cd7bf6827fe9b55ea2a618dec80443ca4c4398bc97e0582a54f376e1fc4cb93dec4721de4d688c7aeb946319679cb91f9cffcafc5f82aae6bd55213cf3db949dacdaa2fcf9895683eafc6e8326000dba1019b6a325decf4baa2c56c20392fefc03f8ba18c0678320f16d7bf8f1f06d8ec3d69616dbda1552002c94fb55e32ea80df70fdcb6c864de449ccfc59660ce3d4407b2cc39ab404b33234f016d0558c8ec77b4854e6980b4f13e14d5d4cb8c425a9e906970c1765750c00b63e91200bd27999fc3562f4d566e89ae4b35688d29056a5c036063f0915368b3d155fe9850af68ebe20797285900ec439390d006ea498e61b0dc04a8964691a4074249c189cf9e4825fd9882957bea4aa2163d7bdecb57c35e0425241cdd5bed459c014eb03f8eb899c84073856bde77462764e842454c9e76bfa3bba6d2384829b4e29c2f7337ab6ac3f9fc4c17b1fdaec920f22156dee3ebff3c30e6a35ddc1e0da652d54852f237be9ea4e5858f7ab281445c5558d30021bfa531cd239e6172bc9180797c1669a0efd270827a3ce868fa4813f708b12f380cdc25f347fe91f5d20ffa7254a64eff62aabd6301c449d2d22edd48999bd0715bc82a1e857609c139638ae206340e737d87781e4fee54ff8106b6b0bdc0504ba8ee601641ae2401545a45a216f22510264e71795cb170b38c7398ef6d84d607764670f574734c9be2f4a8b6e201a747435b49ef925d5e1600dabc5efff6ff7b9f9497f62894b013f9b151e4b2acd3130c623547249236ac6cdf3e30cc37e9243e6ec823af9dcd331345c8fcdc35262e6c45bd3fe87f3ea3a5d6b94c0c3dae65254d910c4259c20d13ceca31c49ee52797146818875f3424dc755357d4e0f77ff2e967f2be2f89b4dbf738971515695d614181b3f1038b3f9c35767f7fa5e043b30722db23e1a25764be74bbfc5ee1b5ac0e549a7ec00f1583dac7c519e424b5b11a69a2ca9de4beb7739166cf848b8420dea07e64984cc932ee5792b0dc37165280b1604d9aeee6f71178f22c81c94bb28a3d35f691365b86c9a81aad2395e314c7cf0478164b7b1ef59cb048ef5dafc56ab1c8b9057c78e741cb06dd3243d62d6e088bb8677eef3f5332d6b708d4b0b9150f3e97c9a60ab05cc20d4a8b07281a38b2d1ebcf22a1387ab3c6edcc33816e8064cedbecf966b7dad3bdb30171990c1b54df20171e279c40e8270c7ea36f1ee1d9775d36f57f000f432d14e40c05cb4fede176762121bba37cad8b1da0da8f91e6cc80595ca438957765453e2fc00b80f1112b529f103f3a8500f0ba7b2671752ae1bf460676a1c51a78df76a1bd22cc3c0a8e9374e4cc9dd3120955dcab92d55dd6a77bb95c48f2ba58e87fb1e9d8fe3a058ebe14819c475a5c74d4588a9521a78ac481a0d2dd21b8988c41fc2055363ec3eb37ad25b5c26e30ec71b775046d9b76a06bfbbaaa8973e96c083c7fa2b02abd53ae507ef78428868c23e754e2c0eae498fb3950b8942e92b61fbcedca2d326c37d2705fe1389b8e7df73bd5e4935f554fab5b0dd126706a8b6d254a8584c594e8b98e5849f69f8cd935cf49de7d27e5e90887826b55c20211cf74f828ed9752d3542aaac5da34c26ebbea2992c57e7fd5b70b4e746fe21de95a0268ffda801c8f2e8363ca8c9d95ecd772bd25564f02b32a7766269b2c0b30c6057fc22ccc0d326b9b3f080cf8ba0ca9369391cb79bc68999754745fdbf98954149ad227e7fd93401accbfbaa13948f7685ebf505e95ada5c9be6825c8a74e2ff9ec82199a0b7d4c32f718602d91d79afcce13e225ae106575a2686509a7d36eac9ae361c824750bd55d5bc1862fd31a7b205a91f7ad0af2ad9b684e688b1969961f1a6d03a3860723e502efc23767e2656bf29b09369b6f294ed23a615cacccc02a8e743de9e1c9e1f3b157a131b84be08d62dbbfc6fc79d2803b853caacee3614da74fd7994d2a098af6ff25bec49ff1a926f5ff222fa2cdaed5a3a2d003d1df90dc4fc231aea961b8321a88bfde7cfbe48ec4cfcbeefd283a30ab08804c257abed9902d1ad0c232be94b25c89b91c46d67737cbbe922de09eadde2bf71f435a6008fd762b10e7763dca221ee0c07b74d928f175fdd15b5ac82173bba0075d5da0f37fd0b5ff91796785cd5c38293a4862fee21880791c5783d0abb1cf822265ad5d9f7a631705f58a157de4efa21cc00bea3d84112c040724b8a51d5365325e2e826c29bfd90abd824123e236543c4eaf404825fef3b839d99475d7f99f2ac1ea101fa7deb6e7be683c49f742ead4f1d41ba685daeb9bdea4a8acaab03af5238dc319bcd55d23557f658100ca1f772aa955788ab51a432121baff5d0177d05ec258100700d71c0a56fa41d0605cd1ebcabf3609d73f36157dc4f6613183dd6c35752dd3d378ede2e78c2fa57b91bb1373a1f54ce46b9ca62a108c0f1461e31c9dfc1b716aebdb0ea8da559226d38e3a63939c9b6e8d0583f358021168561a68947fd64281543b92f0191149e4ddc3ac6cebef39a744b61f1a7f80ec4c541e08d2c459f53597930e949926dd8e3b4bf5d763bf4e3848284a7344e080bb2b979e1d4c096503789321ad4c667e6d82c1068546ab9b0419392cd144dc02d462d07722a2af2e1a36e4352ea945e7b96849696b0e08bed90acdec0b5a58617119a3e1a64e5c88d202261a4a4727bbf6fb96c78ff7f5caeb417d00f837179c4d01b78f216d64a6da3a1e4e484ba73abf9a9534720eb97880abb72f1579dab047a66faf10941149e0b895a944e41549b8db33c41a4d97b277e78e316286d5a7be683ba2d1a2a96c6e868761c2da119b64046a2b4c296658ec77b12eeb34c830b7abe759e8ffc9c8297d77a9c15812caefd10a18d6a6ee2f422fe0235e7583d85d4675850b3bd48f1a6bbe679f2c43b61b4fd97809ac08601bed9839db21ff1e4bc1388ccb7d242563f1875ce00d084f6c1ce46d0578e70c920fc63596a91c7c140b4bf97cfc62787921f27205fe95109299c57705e37610e1201e87cc07e73f41d1f58f599cbc6595f19d7c939140e62771aaf07ddcbaa1ae77eaa17c61d12ea07820776f8d0310910ea9ec49ac5e2d78bb8f229370e4e071074408e0c31c360c6394aab7cc86dd72ddb8ca30badcf60bce9250c28d1b01e9d0dac5b5d95040381969c016bfcc7899b240cab2a79f2af08798b1c080a540a2e8898af75e6467f28b149320348812b5eea30c486c26fa52b31251cfbfbfd490aa68d51f7d832b78c29dcc4c808148f072bd4fd3d4c12240c697fd4fcbec761ce1634759d639d25a810b5fc485b4b8a731c66a238825bb3fe2c6c7a9cda9f85f7b7ac4932177b12be588d17cc95e8f93a940e4c848a003dedb2f6c6e91576a77400ee9c8646a0445f9b6ef111c330d13c54744e78d22d41d23c6bbaade840483fa6b07845893226a6081ef446f337816b3474b853807cd76e62ab8fd6d606edf89705a73180da9c7dceaaf18d78b7016262cc8ff53bd58b210919e9eecef046110780dec989ef2b69747d5af4b7988cd11d25d12533f27e74c70ced9462d36e60512908f8d9ec5318f7edfd90cc35aa88a9e1e1510aac87e606d3e6ac2a3484a91fa972896e3b43d7ade90ccab169176c4029541be9de47a9cfa0439880790cfe68f5fdc9f1143511ef52cf68936f27719a0601cd9438b0b1a7adb4b9ad5dee528ec70ff163f849faa9284a458f1394901aa3d4c27e4f038bfa9e6560588b83deffebcb9e79d622043f3965fdbb7622ab7044a5afe0d7a9146e74757ebf6041cd0e1d006ff0848b379a5d0b7543272e3df4cb2120806aa802d126b9690db4bfb5f59417278362fdce729bfcb9a61edfc4f2c6deddedb48bd91be889ec43281c7a2c32073fb9b9bec004d7dada3ac89b885b10b1004ab2c62bc2c0b49aefd0b5371cba01b22e0d4d76af9bde5d10719ecf81c5f76c8e87b5a91ddc16f9efa37237378243a2bd84eebc066d954b4f3cb6c00b2613dd2ba7fdc000fb0e41bde259de02209f8a6e24087ddec60e465647269d9275c1046f9442a0c6270d5c4746d2e58a57adb3c6111de07cf0bcb380e627faaccce213115536e25c9183fe63028a1c429fc2a9833021decf1e5ac5e477b8c0ba2b33b171495a9b405de22227e7953bad66b07c7545cd267b4a7d6d031d21703ec6b152dde2a46e8a934f254e210b1c45699129320e3c051b812ebcd905c10f0b55440c8cdf451579ef299525f724d8a32ee9ebe10bff5b63f2329bfb987adf108cfd2598093b02bb7f479e95176856c7fc99eb9231e36142d976196397f5601a7511842601eabb038c62b166adbbe39f016ccecf199dd73456ddd6b4ab217bca24b82865f95f115562b08b6a30e89662d6a382c3fa930a0837c50b0e6359dbe0b907e2faa519d43f1ea4e7a06c95208a6b7e779cf2d9b12fd9222d75002cf281f822fab32afa272090cd7b24cea5e5e65c67bd42bb17c451ffa195a02615ea75388d46141f0eeac792b4e449498cce5c61dc4354bb585c9192ed4604e7b903c418608248574a1840d7b157e3a889e7be5dac5680d2060f905928829ab7bba7a26f2f826b5a8adb439db9568b7c4359375470c72cc856b3f3456b0848b17187956cb3319092510cd871e4b5d44935fe08b7bcdad8cc5caa43c712d505258c798acd501e622c4a94391ec81f989cea6fdaa30eb2d08f1f80919193db080c0005fbf5969b37d9c9b416a70798ddc01e1a10044fe19aaf07eaec68d43eea329c8c045ed5f2d1ae131f645f3f6ee28db8f2ed8b82ec2123604b417f8dbc0ffa0c05eb7e154031d1d1b6f9ca69c813f26be0f527574a2b731e2fec7a367761eaa7c59b1b59fc91ef84812f7c154867ef913c61d5ab435ae23456dbf72098b9222272a21ad89c97609cbf4e50b415b374f0eb647584a8865d8167bf711e064248b2da12be6b7837e06c25ecdfb603254a2e49347557016bcd29a0393f0771d71434f05728dcbd6dac8bc2811b4408080b3e2165ce85a4c37ec83bbe7</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>school</tag>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>è®ºå¯¹æ‹åœ¨OIä¸­çš„å¦™ç”¨</title>
    <url>/2022/03/03/matcher/</url>
    <content><![CDATA[<h1 id="è®ºå¯¹æ‹åœ¨OIä¸­çš„å¦™ç”¨"><a href="#è®ºå¯¹æ‹åœ¨OIä¸­çš„å¦™ç”¨" class="headerlink" title="è®ºå¯¹æ‹åœ¨OIä¸­çš„å¦™ç”¨"></a>è®ºå¯¹æ‹åœ¨OIä¸­çš„å¦™ç”¨</h1><span id="more"></span>
<hr>
<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå›½å†…çš„OIæ¯”èµ›ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯ä»¥é€‰æ‰‹çš„æœ€åä¸€æ¬¡æäº¤å¾—åˆ†ä¸ºå‡†ï¼Œä¸”é€‰æ‰‹æ— æ³•åœ¨æ¯”èµ›å½“ä¸­å®æ—¶æŸ¥çœ‹å¾—åˆ†ã€‚è¿™å°±å¯¼è‡´äº†å¾ˆå¤šæ—¶å€™é€‰æ‰‹çš„æœ€ç»ˆå¾—åˆ†ä¸æœŸæœ›å¾—åˆ†ä¸ç¬¦çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œæŒ‚åˆ†â€ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œé€‰æ‰‹ä¸€èˆ¬ä¼šåœ¨æ¯”èµ›ä¸­è‡ªå·±é€ æ•°æ®ï¼Œåˆ†åˆ«è®©æš´åŠ›ç¨‹åºå’Œå¾…æ£€éªŒçš„ç¨‹åºè®¡ç®—ï¼Œæ£€éªŒè¾“å‡ºæ˜¯å¦ç›¸åŒï¼Œè¿™å°±æ˜¯æ‰€è°“â€œå¯¹æ‹â€ã€‚</p>
<blockquote>
<p>å¯¹æ‹æ˜¯ä¸€ç§è¿›è¡Œæ£€éªŒæˆ–è°ƒè¯•çš„æ–¹æ³•ï¼Œé€šè¿‡å¯¹æ¯”ä¸¤ä¸ªç¨‹åºçš„è¾“å‡ºæ¥æ£€éªŒç¨‹åºçš„æ­£ç¡®æ€§ã€‚å¯ä»¥å°†è‡ªå·±ç¨‹åºçš„è¾“å‡ºä¸å…¶ä»–ç¨‹åºçš„è¾“å‡ºè¿›è¡Œå¯¹æ¯”ï¼Œä»è€Œåˆ¤æ–­è‡ªå·±çš„ç¨‹åºæ˜¯å¦æ­£ç¡®ã€‚ </p>
<p> â€”â€” OI Wiki</p>
</blockquote>
<p>å¯¹æ‹è¿‡ç¨‹éœ€è¦å¤šæ¬¡è¿›è¡Œï¼Œå› æ­¤éœ€è¦é€‰æ‰‹å®ç°è‡ªåŠ¨åŒ–å¯¹æ‹ã€‚</p>
<p>æœ€åŸºç¡€çš„å¯¹æ‹ç¨‹åºæ¡†æ¶å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> cas = <span class="number">1000</span>; <span class="comment">// å¯¹æ‹æ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">        <span class="comment">// åœ¨ Linux / macOS ä¸‹è¿è¡Œå½“å‰ç›®å½•ä¸‹æ–‡ä»¶æ—¶éœ€è¦åŠ  `./` å‰ç¼€ï¼ŒWindows å¯ä»¥ä¸åŠ </span></span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./_generator.exe &gt; task.in&quot;</span>);         <span class="comment">// é€ æ•°æ®</span></span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./_brute.exe &lt; task.in &gt; task.ans&quot;</span>);  <span class="comment">// è·å¾—æš´åŠ›ç¨‹åºçš„è¾“å‡º</span></span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./task.exe &lt; task.in &gt; task.out&quot;</span>);    <span class="comment">// è·å¾—å¾…æ£€éªŒç¨‹åºçš„è¾“å‡º</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">system</span>(<span class="string">&quot;fc.exe task.out task.ans&quot;</span>)) &#123;</span><br><span class="line">            <span class="comment">// Windows ä¸‹ä½¿ç”¨ `fc` å‘½ä»¤æ¯”è¾ƒæ–‡ä»¶æ˜¯å¦ç›¸åŒ</span></span><br><span class="line">            <span class="comment">// å¦‚æœç›¸åŒï¼Œ`system` è°ƒç”¨ä¼šè¿”å› 0ï¼Œå¦åˆ™è¿”å› 1 è¡¨ç¤ºä¸åŒ</span></span><br><span class="line">            <span class="comment">// Linux / macOS ä¸‹æ²¡æœ‰ `fc` å‘½ä»¤ï¼Œç”¨ `diff` æ›¿ä»£å¦‚ä¸‹ï¼š</span></span><br><span class="line">            <span class="comment">// system(&quot;diff task.out task.ans&quot;);</span></span><br><span class="line">            std::cerr &lt;&lt; <span class="string">&quot;Wrong Answer&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cerr &lt;&lt; <span class="string">&quot;Accepted&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„ <code>_generator.exe</code> æ˜¯æ•°æ®ç”Ÿæˆå™¨çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œ<code>_brute.exe</code> ä¸ºæš´åŠ›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œ<code>task.exe</code> ä¸ºå¾…æ£€éªŒç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™ä¸‰ä¸ªæ–‡ä»¶éœ€è¦ä¸å¯¹æ‹ç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆæˆ‘ä¸€èˆ¬ç§°ä½œ <code>matcher.exe</code>ï¼‰æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ã€‚</p>
<p>è¿™ç§å¯¹æ‹è™½ç„¶ç®€å•ï¼Œä½†æœ‰æ—¶åœ¨æ¯”èµ›ä¸­ä¸èƒ½è·å¾—å¾ˆå¥½çš„æ•ˆæœï¼Œæ¯”å¦‚åªèƒ½å°†å¾…æ£€éªŒç¨‹åºä¸æš´åŠ›è¿›è¡Œå¯¹æ‹ï¼Œæ— æ³•æ£€æµ‹æ•°ç»„è¶Šç•Œç­‰ã€‚</p>
<p>æœ¬æ–‡å°±æ¥è®²è®²â€œå¯¹æ‹åœ¨OIä¸­çš„å¦™ç”¨â€ï¼Œå³<strong>é«˜é˜¶çš„å¯¹æ‹æŠ€å·§</strong>ã€‚</p>
<hr>
<h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h2 id="æ•°æ®ç”Ÿæˆå™¨çš„å†™æ³•"><a href="#æ•°æ®ç”Ÿæˆå™¨çš„å†™æ³•" class="headerlink" title="æ•°æ®ç”Ÿæˆå™¨çš„å†™æ³•"></a>æ•°æ®ç”Ÿæˆå™¨çš„å†™æ³•</h2><p>åœ¨è€ƒåœºä¸Šï¼Œæˆ‘ä»¬ä¸ä¼šå»å†™é‚£ç§éå¸¸æ ‡å‡†çš„ <code>generator</code>ï¼ˆæ¯•ç«Ÿè€ƒåœºä¸Šä¹Ÿä¸ä¼šç»™ä½ æä¾› <code>testlib.h</code>ï¼‰ã€‚ä¸ºäº†ä¾¿äºç”Ÿæˆä¸åŒå­ä»»åŠ¡å¯¹åº”çš„æ•°æ®èŒƒå›´ï¼Œæˆ‘ä¸€èˆ¬ä¼šä½¿ç”¨ä¸€ä¸‹æ¡†æ¶ç¼–å†™ç”Ÿæˆå™¨ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¤´æ–‡ä»¶çœç•¥</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// éšæœºæ•°éƒ¨åˆ†ï¼Œä¿è¯æ•°æ®çš„éšæœºæ€§</span></span><br><span class="line">random_device rd;</span><br><span class="line"><span class="function">mt19937 <span class="title">rng</span><span class="params">(rd())</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//// ç”Ÿæˆéšæœºæ•´æ•°ï¼ŒèŒƒå›´ [l, r]</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rand_int</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="function">uniform_int_distribution&lt;<span class="type">int</span>&gt; <span class="title">qwq</span><span class="params">(l, r)</span></span>;    <span class="comment">// C++11 è‡ªå¸¦çš„å‡åŒ€åˆ†å¸ƒ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">qwq</span>(rng);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//// ç”Ÿæˆéšæœºæµ®ç‚¹æ•°ï¼ŒèŒƒå›´ [l, r)</span></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">rand_double</span><span class="params">(<span class="type">double</span> l, <span class="type">double</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="function">uniform_real_distribution&lt;<span class="type">double</span>&gt; <span class="title">qwq</span><span class="params">(l, r)</span></span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">qwq</span>(rng);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹åº”å­ä»»åŠ¡çš„æ•°æ®èŒƒå›´</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ namespace è¾ƒä¸ºä¼˜é›…</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//// å¯¹åº”çš„ç¬¬ä¸€ä¸ª subtask</span></span><br><span class="line"><span class="keyword">namespace</span> subtask1 &#123;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N_MIN = <span class="number">100</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N_MAX = <span class="number">200</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> A_MAX = <span class="number">1e5</span>;</span><br><span class="line">&#125;;  <span class="comment">// namespace subtask1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//// å¯¹åº”çš„ç¬¬äºŒä¸ª subtask</span></span><br><span class="line"><span class="keyword">namespace</span> subtask2 &#123;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N_MIN = <span class="number">1e3</span>;</span><br><span class="line"><span class="comment">//// ......</span></span><br><span class="line">&#125;;  <span class="comment">// namespace subtask2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//// éœ€è¦ä¿®æ”¹æ•°æ®èŒƒå›´æ—¶ï¼Œåªéœ€è¦ä¿®æ”¹ä¸‹é¢è¿™ä¸€å¥å°±è¡Œ</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> subtask1;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¨å±€å˜é‡å‚¨å­˜</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»å‡½æ•°éƒ¨åˆ†</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//// é€ æ•°æ®</span></span><br><span class="line">    n = <span class="built_in">rand_int</span>(N_MIN, N_MAX);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        a[i] = <span class="built_in">rand_int</span>(<span class="number">1</span>, A_MAX);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//// è¾“å‡ºæ•°æ®</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, a[i], <span class="string">&quot; \n&quot;</span>[i == n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è‡ªå·±ç ”ç©¶å‡ºæ¥çš„ <code>generator</code> ä¸å¾—ä¸è¯´çœŸçš„æŒºä¼˜é›…ï½</p>
<h3 id="æ•°æ®çš„éšæœºæ€§"><a href="#æ•°æ®çš„éšæœºæ€§" class="headerlink" title="æ•°æ®çš„éšæœºæ€§"></a>æ•°æ®çš„éšæœºæ€§</h3><p>è¿™ä»½ç”Ÿæˆå™¨åœ¨ Linux / macOS ä¸‹å®Œç¾è¿è¡Œå¹¶ä¸”å¯ä»¥ç”Ÿæˆå®Œå…¨éšæœºçš„æ•°æ®ã€‚ä½†æ˜¯å¦‚æœä½ åœ¨ Windows ä¸‹ä½¿ç”¨ MinGW ç¼–è¯‘ï¼Œå°±ä¼šå‘ç°æ¯æ¬¡è¾“å‡ºçš„æ•°æ® !å®Œ!å…¨!ç›¸!åŒ! </p>
<p>è¿™æ˜¯ç”±äº MinGW çš„ <code>random_device</code> å®ç°ä¸å¥½ï¼Œæ²¡æœ‰è°ƒç”¨ç³»ç»Ÿç†µï¼Œä»è€Œä¸èƒ½åšåˆ°çœŸéšæœºã€‚è‡³äºåœ¨ MinGW ä¸‹çš„çœŸéšæœºï¼Œç¬”è€…ä¹Ÿæ²¡æœ‰æ‰¾åˆ°è¾ƒå¥½çš„æ–¹æ³•ã€‚é‰´äºå¤§éƒ¨åˆ† NOI ç³»åˆ—æ¯”èµ›ä¸­éƒ½ä¼šæä¾› NOI Linux <del>ï¼ˆé™¤äº† JSOI è¿™ç§æ¯’ç˜¤ï¼‰</del>ï¼Œè¿˜æ˜¯å»ºè®®å¤§å®¶åœ¨ Linux ä¸‹å¯¹æ‹å§ï¼</p>
<h2 id="å„ç§é”™è¯¯çš„å¤„ç†"><a href="#å„ç§é”™è¯¯çš„å¤„ç†" class="headerlink" title="å„ç§é”™è¯¯çš„å¤„ç†"></a>å„ç§é”™è¯¯çš„å¤„ç†</h2><h3 id="Wrong-Answer-çš„å¤„ç†"><a href="#Wrong-Answer-çš„å¤„ç†" class="headerlink" title="Wrong Answer çš„å¤„ç†"></a>Wrong Answer çš„å¤„ç†</h3><p>å¯¹äºå¸¸è§„æƒ…å†µï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ä¸Šæ–‡æåˆ°çš„ <code>fc</code> æˆ– <code>diff</code> å‘½ä»¤å³å¯æ£€éªŒä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ç›¸åŒã€‚</p>
<h4 id="å¿½ç•¥ç©ºç™½ç¬¦"><a href="#å¿½ç•¥ç©ºç™½ç¬¦" class="headerlink" title="å¿½ç•¥ç©ºç™½ç¬¦"></a>å¿½ç•¥ç©ºç™½ç¬¦</h4><p>ç„¶è€Œæœ‰æ—¶ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µ:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ diff 1.out 1.ans</span><br><span class="line">2d1</span><br><span class="line">&lt;</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€æ–‡ä»¶ä¸€çœ‹ï¼Œ<code>1.out</code> å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">114514 1919810</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>1.ans</code> å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">114514 1919810</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·çš„è¾“å‡ºè®©ä½ æ„Ÿåˆ°å¥‡æ€ªï¼šæ˜æ˜ä¸¤ä¸ªè¾“å‡ºçš„æ•°å­—éƒ½ä¸€æ ·ï¼Œä¸ºä»€ä¹ˆ <code>diff</code> å‡ºæ¥ä¼šæŠ¥é”™å‘¢ï¼Ÿä»”ç»†çœ‹äº†ä¸€ä¼šå„¿å‘ç° <code>1.out</code> å¤šäº†ä¸€ä¸ªè¡Œæœ«å›è½¦ã€‚è¿™æ˜¯æ¯”è¾ƒå¥½çš„æƒ…å†µï¼Œä¸‡ä¸€ <code>.ans</code> æ–‡ä»¶æ˜¯åœ¨ Windows ä¸‹åˆ¶é€ çš„ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šä½¿å¾— <code>.ans</code> æ–‡ä»¶çš„å›è½¦ç¬¦å…¨éƒ½å˜æˆäº† <code>CRLF</code> è€Œéåœ¨ç±» Unix æ“ä½œç³»ç»Ÿä¸‹çš„ <code>LF</code>ï¼Œæ­¤æ—¶è‚‰çœ¼çœ‹ä¸å‡ºä¸¤ä¸ªæ–‡ä»¶çš„å·®åˆ«ï¼Œ<code>diff</code> å´ä¼šæŠ¥é”™ã€‚</p>
<p>å¦‚ä½•é¿å…è¿™ç§æƒ…å†µå‘¢ï¼Ÿ<code>diff</code> æœ‰ä¸€ä¸ªå¿½ç•¥ç©ºç™½ç¬¦çš„é€‰é¡¹ <code>diff -w</code>ï¼Œæˆ–è€…åœ¨ Windows ä¸‹ä½¿ç”¨ <code>fc.exe /w</code> å¯ä»¥å¿½ç•¥ç©ºç™½ç¬¦ã€‚</p>
<p>åªéœ€è¦åœ¨ä¸Šæ–‡çš„å¯¹æ‹ç¨‹åºä¸­ç¨ä½œä¿®æ”¹å³å¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">system</span>(<span class="string">&quot;fc.exe /w task.out task.ans&quot;</span>)) <span class="comment">// æˆ–è€… system(&quot;diff -w task.out task.ans&quot;)</span></span><br></pre></td></tr></table></figure>
<h4 id="Special-Judge"><a href="#Special-Judge" class="headerlink" title="Special Judge"></a>Special Judge</h4><p><a href="https://oi-wiki.org/tools/special-judge/">spjçš„å†™æ³•</a>è¿™é‡Œä¸å†èµ˜è¿°ã€‚</p>
<p>å¯¹æ‹æ—¶ä¹Ÿåªéœ€è¦ä¿®æ”¹ä¸€ç‚¹ç‚¹ï¼Œå°†åŸæœ¬è°ƒç”¨ <code>fc</code> æˆ– <code>diff</code> æ”¹ä¸ºè°ƒç”¨ <code>_spj.exe</code> å³å¯:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">system</span>(<span class="string">&quot;./_spj.exe task.in task.out task.ans&quot;</span>)) <span class="comment">// éœ€è¦ä¿è¯ `_spj.exe` ä¸å¯¹æ‹ç¨‹åºå¤„äºåŒä¸€ç›®å½•ä¸‹</span></span><br></pre></td></tr></table></figure>
<p><strong>å–„æ„çš„æé†’ï¼š</strong> ä¸€å®šè¦å¤šé€ ä¸€äº›æç«¯æ•°æ®ï¼ï¼ï¼</p>
<h3 id="Runtime-Error-çš„å¤„ç†"><a href="#Runtime-Error-çš„å¤„ç†" class="headerlink" title="Runtime Error çš„å¤„ç†"></a>Runtime Error çš„å¤„ç†</h3><p>ç¨‹åºå‡ºç° Runtime Error æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªé $0$ çš„è¿”å›å€¼ã€‚ç”±æ­¤æˆ‘ä»¬å¯ä»¥æ ¹æ®ç¨‹åºçš„è¿”å›å€¼æ¥åˆ¤æ–­æ˜¯å¦å‡ºç°è¿è¡Œé”™è¯¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸‰ä¸ª system æ”¹æˆè¿™æ ·</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">system</span>(<span class="string">&quot;./task.exe &lt; task.in &gt; task.out&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœè¿è¡Œåˆ°è¿™é‡Œï¼Œè¯´æ˜è¿”å›å€¼é 0ï¼Œå°±æ˜¯è¿è¡Œé”™è¯¯äº†ã€‚</span></span><br><span class="line">    std::cerr &lt;&lt; <span class="string">&quot;Runtime Error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Howeverï¼Œæœ‰æ—¶æ•°ç»„è¶Šç•Œäº†ï¼Œå¯ç¨‹åºå´æ­£å¸¸è¿è¡Œè·‘è¿‡å»äº†ï¼Œæ²¡æœ‰å‡ºç° RE çš„æƒ…å†µï¼ˆè¿™æ˜¯æ¯”è¾ƒç„å­¦çš„ï¼‰ï¼Œä¸Šé¢çš„ç¨‹åºä¹Ÿæ— æ³•åˆ¤æ–­ã€‚</p>
<p>è¿™æ—¶å°±è¦è¯·å‡º C++ çš„å¤§æ€å™¨ <strong>Address Sanitizer</strong> äº†ã€‚ï¼ˆå…¶å®æˆ‘ç¬¬ä¸€æ¬¡å¬è¯´è¿˜æ˜¯ä»å¤§æ¯’ç˜¤ JSOI çš„åœ¨çº¿ç³»ç»Ÿé‡Œï¼‰</p>
<p>è¿™ä¸ªä¸œè¥¿æˆ‘ä¹Ÿä¸å¤šä»‹ç»äº†ï¼Œæ€»ä¹‹å°±æ˜¯èƒ½å¤Ÿæœ‰æ•ˆåœ°åˆ¤æ–­æ•°ç»„è¶Šç•Œæˆ–è€…å†…å­˜è®¿é—®è¶Šç•Œé—®é¢˜ã€‚</p>
<p>è‡³äºå¦‚ä½•å¼€å¯ï¼Œå°±è¦æ‰‹åŠ¨ä¿®æ”¹ç¼–è¯‘å‘½ä»¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">g++ -O2 -std=c++14 -fsanitize=address -o task.exe task.cpp <span class="comment"># åªæ˜¯ä¸¾ä¸ªä¾‹å­</span></span><br></pre></td></tr></table></figure>
<p>Dev-Cpp å¦‚ä½•ä¿®æ”¹ç¼–è¯‘å‘½ä»¤è¯·è‡ªè¡Œç™¾åº¦ã€‚</p>
<p>é¡ºå˜´æä¸€å¥ï¼Œ<strong>æ£€æŸ¥REçš„æ—¶å€™ä¸€å®šè¦ç”¨å¤§æ•°æ®æ¥æµ‹ï¼ï¼ï¼</strong></p>
<h3 id="Time-Limit-Exceeded-çš„å¤„ç†"><a href="#Time-Limit-Exceeded-çš„å¤„ç†" class="headerlink" title="Time Limit Exceeded çš„å¤„ç†"></a>Time Limit Exceeded çš„å¤„ç†</h3><p>è¿™å°±æ¶‰åŠåˆ° C++ çš„è®¡æ—¶æ¨¡å—äº†ã€‚ç”±äºæˆ‘ä»¬åªæ˜¯å†™ä¸ªå¯¹æ‹ï¼Œæ²¡å¿…è¦åˆ°æ—¶é—´å°±æŠŠç¨‹åºææ‰ï¼Œåªæ˜¯è®¡ç®—ä¸‹ç¨‹åºè¿è¡Œçš„æ—¶é—´å³å¯ã€‚</p>
<p>å»ºè®®ä½¿ç”¨ C++11 è‡ªå¸¦çš„ <code>std::chrono::steady_clock</code>ï¼Œéœ€è¦æ·»åŠ å¤´æ–‡ä»¶ <code>chrono.h</code>ï¼ˆå·²åŒ…å«åœ¨ä¸‡èƒ½å¤´ä¸­ï¼‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std::chrono;</span><br><span class="line"><span class="keyword">auto</span> t1 = steady_clock::<span class="built_in">now</span>();</span><br><span class="line"><span class="comment">// do something like `system(&quot;...&quot;)`</span></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;something&quot;</span>);</span><br><span class="line"><span class="keyword">auto</span> t2 = steady_clock::<span class="built_in">now</span>();</span><br><span class="line"><span class="type">double</span> dif = duration_cast&lt;duration&lt;<span class="type">double</span>&gt;&gt;(t2 - t1).<span class="built_in">count</span>();</span><br><span class="line"><span class="comment">// dif å°±æ˜¯è¿è¡Œçš„æ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œè¾ƒä¸ºç²¾ç¡®</span></span><br><span class="line"><span class="keyword">if</span> (dif &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    std::cerr &lt;&lt; <span class="string">&quot;Time Limit Exceeded&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ£€æŸ¥TLEçš„æ—¶å€™ä¹Ÿä¸€å®šè¦ç”¨å¤§æ•°æ®æ¥æµ‹ï¼ï¼ï¼</strong></p>
<h3 id="Memory-Limit-Exceeded-çš„å¤„ç†"><a href="#Memory-Limit-Exceeded-çš„å¤„ç†" class="headerlink" title="Memory Limit Exceeded çš„å¤„ç†"></a>Memory Limit Exceeded çš„å¤„ç†</h3><h4 id="é™æ€å†…å­˜ç©ºé—´"><a href="#é™æ€å†…å­˜ç©ºé—´" class="headerlink" title="é™æ€å†…å­˜ç©ºé—´"></a>é™æ€å†…å­˜ç©ºé—´</h4><p>åœ¨ä½ çš„ç¨‹åºä»£ç ä¸­ï¼Œæœ€å¼€å¤´å®šä¹‰ä¸€ä¸ª <code>bool</code> å˜é‡ <code>m_be</code>ï¼Œä¸»å‡½æ•°å‰å®šä¹‰ <code>m_ed</code>ï¼Œå°†ä¸¤è€…åœ°å€åšå·®ï¼Œå°±å¾—åˆ°äº†åŒºé—´å†…å®šä¹‰çš„é™æ€å˜é‡æ€»å¤§å°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="type">int</span> arr[MAXN], brr[MAXN]; <span class="comment">// ...</span></span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cerr &lt;&lt; <span class="built_in">fabs</span>(&amp;m_ed - &amp;m_be) / <span class="number">1024</span> / <span class="number">1024</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="comment">// something else</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºçš„æ˜¯ä»¥MBä¸ºå•ä½çš„é™æ€ç©ºé—´å¤§å°ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ <code>fabs</code> å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºåœ¨ä¸åŒç¼–è¯‘å™¨çš„ä¸åŒå®ç°ä¸­ï¼Œæœ‰å¯èƒ½ä¼šæœ‰ä¸åŒçš„æ•ˆæœã€‚åœ¨æˆ‘çš„ macOS ä¸Šï¼Œä½¿ç”¨ clang ç¼–è¯‘çš„å°±æ˜¯ <code>&amp;m_be &lt; &amp;m_ed</code>ï¼Œg++ åˆ™æ˜¯ <code>&amp;m_ed &lt; &amp;m_be</code>ï¼Œä½†æ˜¯ç»å¯¹å€¼ç›¸åŒã€‚</p>
<p>è‡³äºåŠ¨æ€ç©ºé—´å¤§å°ï¼Œæˆ‘æƒ³åº”è¯¥æ²¡æœ‰äººä¼šæ— èŠåˆ°åœ¨OIä¸­å¼€ä¸€å¤§å † <code>vector</code> ä¹‹ç±»çš„ä¸œè¥¿å§ã€‚ã€‚ã€‚å¥½åƒæš‚æ—¶ä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆæ¯”è¾ƒå¥½çš„æ–¹æ³•æµ‹åŠ¨æ€å†…å­˜ï¼Œå°±è·³è¿‡äº†ã€‚</p>
<hr>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è´´ä¸€ä¸‹æœ€ç»ˆçš„å¯¹æ‹ç¨‹åºä»£ç å§ï¼ˆLinux / macOSç‰ˆï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std::chrono;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1000</span>;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;g++ -std=c++14 -O2 -o _generator.exe _generator.cpp&quot;</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;g++ -std=c++14 -O2 -o _brute_.exe _brute_.cpp&quot;</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;g++ -std=c++14 -O2 -fsanitize=address -o task.exe task.cpp&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= tot; ++cas) &#123;</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./_generator.exe &gt; task.in&quot;</span>);</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;./_brute.exe &lt; task.in &gt; task.ans&quot;</span>);</span><br><span class="line">        <span class="keyword">auto</span> t1 = steady_clock::<span class="built_in">now</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">system</span>(<span class="string">&quot;./task.exe &lt; task.in &gt; task.out&quot;</span>)) &#123;</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;Runtime Error&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> t2 = steady_clock::<span class="built_in">now</span>();</span><br><span class="line">        <span class="type">double</span> dif = duration_cast&lt;duration&lt;<span class="type">double</span>&gt;&gt;(t2 - t1).<span class="built_in">count</span>();</span><br><span class="line">        <span class="keyword">if</span> (dif &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;Time Limit Exceeded&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">system</span>(<span class="string">&quot;diff -w task.out task.ans&quot;</span>)) &#123;</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;Wrong Answer&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cerr &lt;&lt; <span class="string">&quot;Test &quot;</span> &lt;&lt; cas &lt;&lt; <span class="string">&quot; Passed&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    cerr &lt;&lt; <span class="string">&quot;Accepted&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>P4719 ã€æ¨¡ç‰ˆã€‘åŠ¨æ€DP&amp;åŠ¨æ€æ ‘åˆ†æ²»</title>
    <url>/2022/02/08/sol-p4719/</url>
    <content><![CDATA[<h2 id="P4719-ã€æ¨¡ç‰ˆã€‘åŠ¨æ€DP-amp-åŠ¨æ€æ ‘åˆ†æ²»"><a href="#P4719-ã€æ¨¡ç‰ˆã€‘åŠ¨æ€DP-amp-åŠ¨æ€æ ‘åˆ†æ²»" class="headerlink" title="P4719 ã€æ¨¡ç‰ˆã€‘åŠ¨æ€DP&amp;åŠ¨æ€æ ‘åˆ†æ²»"></a>P4719 ã€æ¨¡ç‰ˆã€‘åŠ¨æ€DP&amp;åŠ¨æ€æ ‘åˆ†æ²»</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4719">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ­¤å¤„è®°å½•ä¸€ä¸‹æ ‘å‰–çš„å†™æ³•ã€‚</p>
<p>é¦–å…ˆæœ‰ç®€å•çš„$dp$æ–¹ç¨‹å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\begin{cases}
dp_{u,0}=\sum \max(dp_{v,0},dp_{v,1}) \\
dp_{u,1}=a_u + \sum dp_{v,0}
\end{cases}</script><p>è€ƒè™‘è¿ç”¨æ ‘å‰–ï¼Œæ¯æ¬¡å°†è½»å„¿å­çš„ç­”æ¡ˆæš´åŠ›è´¡çŒ®åˆ°çˆ¶äº²ä¸Šé¢ï¼Œçˆ¶äº²èŠ‚ç‚¹åªéœ€è¦åŠ ä¸Šé‡å„¿å­çš„è´¡çŒ®ã€‚</p>
<p>è€ƒè™‘ä½¿ç”¨çŸ©é˜µï¼Œæœ‰è¿™æ ·çš„è½¬ç§»çŸ©é˜µï¼š</p>
<script type="math/tex; mode=display">
\begin{pmatrix}
dp_{v,0} & dp_{v,1}
\end{pmatrix}
\times
\begin{pmatrix}
g_{u,0} & g_{u,1} \\
g_{u,0} & -\infty
\end{pmatrix}
=
\begin{pmatrix}
dp_{u,0} & dp_{u,1}
\end{pmatrix}</script><p>å…¶ä¸­$v$æ˜¯$u$çš„é‡å„¿å­ï¼Œ$g<em>{u,0}$è¡¨ç¤ºè½»å„¿å­ä¸­ä¸å–$u$å¯ä»¥å¾—åˆ°çš„æœ€å¤§è´¡çŒ®ï¼Œ$g</em>{u,1}$è¡¨ç¤ºè½»å„¿å­ä¸­å–$u$å¯ä»¥å¾—åˆ°çš„æœ€å¤§è´¡çŒ®ï¼ˆåŒ…æ‹¬$a_u$ï¼‰ã€‚çº¿æ®µæ ‘ç»´æŠ¤çŸ©é˜µï¼Œä¿®æ”¹æ—¶æš´åŠ›è·³è½»é“¾å¹¶ä¿®æ”¹è½»é“¾çš„çˆ¶äº²ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n\log^2 n)$ï¼Œçœ‹ä¸‹ä»£ç è‡ªå·±æ•²ä¸€ä¸‹å°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚</p>
<p>å¬è¯´æ‹¿LCTå†™å¯ä»¥åšåˆ°$O(n\log n)$è€Œä¸”è·‘çš„é£å¿«ï¼Ÿæ”¹å¤©æœ‰ç©ºè¯•è¯•ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4719.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4719</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span> &#123;</span><br><span class="line">    <span class="type">int</span> a[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">Matrix</span>() &#123; <span class="built_in">memset</span>(a, <span class="number">-0x3f</span>, <span class="built_in">sizeof</span>(a)); &#125;</span><br><span class="line">    Matrix <span class="keyword">operator</span>*(<span class="type">const</span> Matrix&amp; o) <span class="type">const</span> &#123;</span><br><span class="line">        Matrix ret;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; ++j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span>; ++k)</span><br><span class="line">                    ret.a[i][j] = <span class="built_in">max</span>(ret.a[i][j], a[i][k] + o.a[k][j]);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; mat[MAXN];</span><br><span class="line"><span class="type">int</span> n, q, a[MAXN];</span><br><span class="line"><span class="type">int</span> f[MAXN][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> fa[MAXN], siz[MAXN], wson[MAXN];</span><br><span class="line"><span class="type">int</span> dfn[MAXN], sfa[MAXN], dwn[MAXN], id[MAXN], dfc;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> li (i &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ri (i &lt;&lt; 1 | 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lson li, l, mid</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rson ri, mid + 1, r</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span> &#123;</span><br><span class="line">    Matrix nd[MAXN * <span class="number">4</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">void</span>(nd[i] = mat[id[l]]);</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">build</span>(lson), <span class="built_in">build</span>(rson);</span><br><span class="line">        nd[i] = nd[ri] * nd[li];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">void</span>(nd[i] = mat[id[l]]);</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (q &lt;= mid)</span><br><span class="line">            <span class="built_in">update</span>(lson, q);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">update</span>(rson, q);</span><br><span class="line">        nd[i] = nd[ri] * nd[li];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Matrix <span class="title">query</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">            <span class="keyword">return</span> nd[i];</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (qr &lt;= mid)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">query</span>(lson, ql, qr);</span><br><span class="line">        <span class="keyword">if</span> (ql &gt; mid)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">query</span>(rson, ql, qr);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(rson, ql, qr) * <span class="built_in">query</span>(lson, ql, qr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sgt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    fa[u] = f, siz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">        siz[u] += siz[v];</span><br><span class="line">        <span class="keyword">if</span> (siz[wson[u]] &lt; siz[v])</span><br><span class="line">            wson[u] = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> sf)</span> </span>&#123;</span><br><span class="line">    dfn[u] = ++dfc, id[dfc] = u;</span><br><span class="line">    sfa[u] = sf, dwn[u] = u;</span><br><span class="line">    f[u][<span class="number">0</span>] = <span class="number">0</span>, f[u][<span class="number">1</span>] = a[u];</span><br><span class="line">    mat[u].a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    mat[u].a[<span class="number">0</span>][<span class="number">1</span>] = a[u];</span><br><span class="line">    mat[u].a[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (wson[u]) &#123;</span><br><span class="line">        <span class="built_in">dfs2</span>(wson[u], sf);</span><br><span class="line">        dwn[u] = dwn[wson[u]];</span><br><span class="line">        f[u][<span class="number">0</span>] += <span class="built_in">max</span>(f[wson[u]][<span class="number">0</span>], f[wson[u]][<span class="number">1</span>]);</span><br><span class="line">        f[u][<span class="number">1</span>] += f[wson[u]][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == fa[u] || v == wson[u])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">        f[u][<span class="number">0</span>] += <span class="built_in">max</span>(f[v][<span class="number">0</span>], f[v][<span class="number">1</span>]);</span><br><span class="line">        f[u][<span class="number">1</span>] += f[v][<span class="number">0</span>];</span><br><span class="line">        mat[u].a[<span class="number">0</span>][<span class="number">0</span>] += <span class="built_in">max</span>(f[v][<span class="number">0</span>], f[v][<span class="number">1</span>]);</span><br><span class="line">        mat[u].a[<span class="number">1</span>][<span class="number">0</span>] += <span class="built_in">max</span>(f[v][<span class="number">0</span>], f[v][<span class="number">1</span>]);</span><br><span class="line">        mat[u].a[<span class="number">0</span>][<span class="number">1</span>] += f[v][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">    mat[u].a[<span class="number">0</span>][<span class="number">1</span>] += k - a[u], a[u] = k;</span><br><span class="line">    <span class="keyword">while</span> (u) &#123;</span><br><span class="line">        Matrix t1 = sgt.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, dfn[sfa[u]], dfn[dwn[u]]);</span><br><span class="line">        sgt.<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, dfn[u]);</span><br><span class="line">        Matrix t2 = sgt.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, dfn[sfa[u]], dfn[dwn[u]]);</span><br><span class="line">        u = fa[sfa[u]];</span><br><span class="line">        mat[u].a[<span class="number">0</span>][<span class="number">0</span>] += <span class="built_in">max</span>(t2.a[<span class="number">0</span>][<span class="number">0</span>], t2.a[<span class="number">0</span>][<span class="number">1</span>]) - <span class="built_in">max</span>(t1.a[<span class="number">0</span>][<span class="number">0</span>], t1.a[<span class="number">0</span>][<span class="number">1</span>]);</span><br><span class="line">        mat[u].a[<span class="number">1</span>][<span class="number">0</span>] += <span class="built_in">max</span>(t2.a[<span class="number">0</span>][<span class="number">0</span>], t2.a[<span class="number">0</span>][<span class="number">1</span>]) - <span class="built_in">max</span>(t1.a[<span class="number">0</span>][<span class="number">0</span>], t1.a[<span class="number">0</span>][<span class="number">1</span>]);</span><br><span class="line">        mat[u].a[<span class="number">0</span>][<span class="number">1</span>] += t2.a[<span class="number">0</span>][<span class="number">0</span>] - t1.a[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    Matrix t = sgt.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, dfn[sfa[u]], dfn[dwn[u]]);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(t.a[<span class="number">0</span>][<span class="number">0</span>], t.a[<span class="number">0</span>][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>), <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    sgt.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> u, k;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(k);</span><br><span class="line">        <span class="built_in">update</span>(u, k);</span><br><span class="line">        <span class="built_in">write</span>(<span class="built_in">query</span>(<span class="number">1</span>)), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3203 [HNOI2010] å¼¹é£ç»µç¾Š</title>
    <url>/2022/02/07/sol-p3203/</url>
    <content><![CDATA[<h2 id="P3203-HNOI2010-å¼¹é£ç»µç¾Š"><a href="#P3203-HNOI2010-å¼¹é£ç»µç¾Š" class="headerlink" title="P3203 [HNOI2010] å¼¹é£ç»µç¾Š"></a>P3203 [HNOI2010] å¼¹é£ç»µç¾Š</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3203">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å¥½å®¶ä¼™ï¼Œå…¨éƒ½å¾€åå¼¹ä¸å°±å½¢æˆäº†ä¸€æ£µæ ‘çš„ç»“æ„ï¼Œç„¶åè¦æ±‚åŠ¨æ€ç»´æŠ¤ï¼Œé‚£å°±LCTå‘—ï¼Œç„¶åç»´æŠ¤åŠ¨æ€$dep$æ•°ç»„å°±å¯ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3203.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3203</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LCT</span> &#123;</span><br><span class="line">    <span class="type">int</span> fa[MAXN], ch[MAXN][<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> val[MAXN], siz[MAXN], tag[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; siz[x] = siz[ch[x][<span class="number">0</span>]] + siz[ch[x][<span class="number">1</span>]] + <span class="number">1</span>; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">connect</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> f, <span class="type">int</span> w)</span> </span>&#123; fa[x] = f, (~w) &amp;&amp; (ch[f][w] = x); &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ch[fa[x]][<span class="number">0</span>] == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ch[fa[x]][<span class="number">1</span>] == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (tag[x]) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">                tag[ch[x][<span class="number">0</span>]] ^= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (ch[x][<span class="number">1</span>])</span><br><span class="line">                tag[ch[x][<span class="number">1</span>]] ^= <span class="number">1</span>;</span><br><span class="line">            tag[x] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushall</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (~<span class="built_in">get</span>(x))</span><br><span class="line">            <span class="built_in">pushall</span>(fa[x]);</span><br><span class="line">        <span class="built_in">pushdown</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> y = fa[x], z = fa[y], w = <span class="built_in">get</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (~w)</span><br><span class="line">            <span class="built_in">connect</span>(ch[x][w ^ <span class="number">1</span>], y, w);</span><br><span class="line">        <span class="built_in">connect</span>(x, z, <span class="built_in">get</span>(y));</span><br><span class="line">        <span class="built_in">connect</span>(y, x, w ^ <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">pushup</span>(y);</span><br><span class="line">        <span class="built_in">pushup</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">pushall</span>(x);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> f = fa[x]; f = fa[x], ~<span class="built_in">get</span>(x); <span class="built_in">rotate</span>(x))</span><br><span class="line">            <span class="keyword">if</span> (~<span class="built_in">get</span>(f))</span><br><span class="line">                <span class="built_in">rotate</span>(<span class="built_in">get</span>(f) == <span class="built_in">get</span>(x) ? f : x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> pre = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x) &#123;</span><br><span class="line">            <span class="built_in">splay</span>(x);</span><br><span class="line">            ch[x][<span class="number">1</span>] = pre;</span><br><span class="line">            <span class="built_in">pushup</span>(x);</span><br><span class="line">            pre = x;</span><br><span class="line">            x = fa[x];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">makeroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">access</span>(x);</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        tag[x] ^= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">makeroot</span>(x);</span><br><span class="line">        <span class="built_in">access</span>(y);</span><br><span class="line">        <span class="built_in">splay</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">access</span>(x);</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        <span class="keyword">while</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">            <span class="built_in">pushdown</span>(x), x = ch[x][<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">makeroot</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">findroot</span>(y) == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        fa[x] = y;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">findroot</span>(x) != <span class="built_in">findroot</span>(y))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">split</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span> (fa[x] != y || ch[x][<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        fa[x] = ch[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; lct;</span><br><span class="line"><span class="type">int</span> n, q, a[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]), lct.siz[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        lct.<span class="built_in">link</span>(i, <span class="built_in">min</span>(n + <span class="number">1</span>, i + a[i]));</span><br><span class="line">    <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> op, x, y;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(x)++;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            lct.<span class="built_in">split</span>(x, n + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">write</span>(lct.siz[n + <span class="number">1</span>] - <span class="number">1</span>), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">read</span>(y);</span><br><span class="line">            lct.<span class="built_in">cut</span>(x, <span class="built_in">min</span>(n + <span class="number">1</span>, x + a[x]));</span><br><span class="line">            a[x] = y;</span><br><span class="line">            lct.<span class="built_in">link</span>(x, <span class="built_in">min</span>(n + <span class="number">1</span>, x + a[x]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>nndç°åœ¨æ•°ç»„è¶Šç•Œå…¨éƒ¨éƒ½å«WAäº†æ˜¯å§ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>NFLSOJ-423B</title>
    <url>/2022/02/06/sol-nflsoj423b/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">
  <script id="hbeData" type="hbeData" data-hmacdigest="930e3b53c868cf6b09be156623ee4c983e18a66529bc92af680a4975a9803b8f">67362a200d4bb0b1cd1ef5f7bb774ffb58a2089a15905f15111606287b2ae8c189eee0c4b7d84ffa1a7174e1da26f1c69ee2d77100c9b604410f259e929e87ba0bff4c648a3a51ce82ea3ba9db0274edf488f9bf9e10a561189142f5ea3834a1b0e32055be167d532b7f6ebdddcbbcb598571144e5ad880b6057d6f61a004e6d8941c3b86c8e97d00b268abdca89045106ec317993a8326f6f526d6874f89d8a949e7d681e3fa7b81dce9bbba8e0a3493b1d820879c7630760b4e47af0e880ec1679f1e037ecd6417a932d966bb2765995d0ba8210ada88eaea4b8b67e1f8541b24cf02f28779896df245d662809b73c9097a78cc2ebbb9a927e8e1f61b7780c3a004897be561728861c60bf49adc8ffe4921d37c768a46f2c5e8315052954581644e51d309a3e6113d234ce105ee98d14c548e361e4abfc35152b55c70d2763f1426e29aad82356c43b20f9b63fcf7082757b529da0515652f8da658d566c81d466a6c6a4d6713d97e0b6110cd61c45ddadea29ede7b9dc1fe084970531471c38a609a2a96c34e71524eb1bb25680aa86f0ad80934034a53c2b69039a0257417df7b0a4716339cbabf88977875d18e50d5b583645b558def5c51f6307fe47c982fa713b353c6e88a5b0fbbe0ecdac38aeaf5de5ac1f58b379effc65d4be6904422b67b9653734e71893759067cf744f86e19f073e778a7703f9375ca97b9c384370e33ee05361e1b01c031e026671ba129b57e447f32f3d9f7de8654183ed300ddb5c013e689b56bdbfb66320709880b9cddb6e68f849d4b9de9b85e906676ad0551e545cfff4b18685ad9ac02c74cf5099251b86a7d6377b3b9a7fb4756890ab7869e5d6ad6bb9b122bce52a3ea2d1a50985ed1170a327ac35528955488429e05d96622ad2aeea53f4dd69404229c6b8b571936f9ef38d40a35f5151e024610c0617212d4a682dcf5c64e8f6fc222aea74902712eac852a9728141818defe6425335e180c0d60ec884a271aacdc7d9b7a6a69dbe5f35f064024a05883a37f39a999a09ca5036c603b35e334cf7370761d615d2afe1203e3744975ea222e174eda402c17346d58eab95fb4efdfea24316c962963b19fe24c02d4adb83cd2a4d66cadf3809ee101d44e328f22bcca4f1f8d31b0d278bb34ee91299bfa180733510154eabfec2ee1d7d0d9ba777781de0d15af25e2a99be417cba209ca0cc349ef50f9f44631792c60bd45bb8aa007c2999008117f4dcd59452accd57f440bdc1155b8d35b08ab45d5ddb19f4f462d6075940f103db437d3cf74890cda31a6fa79a27dfa8db6e7d20ead0436264d5d5fe088e4c89ce736d045b66b4394bf7736d418a4fa08bd540fdb33066c0b79c0b11cfd678d6ee5251bfafac4f971e6e423261a92f8c611993b4d927b993713d43eb732975c248e1ede22fae123a6090c8e7c19887e0e8f39153b97e27ce0ae8d828c6523996fb6cd1254dd8e548926f9166b8ce42a4af7e34a8269df094ce2dc292f7e18e65fbb5a4d05af0a61027d3f2841e5e60264efe75f21a4c346ade00465f079fd74bd4c8b00feef2b89ff2af807b14bedbbaeae7c2083d4d2eee07282d5f44c3b7ac99f5f9ac3fc8fab84f7fad30e01a8c362dc8927dd310f5131de0e0038201fd700a57e69289047c8203c51c668ca21bfa41493b00b1dac42169a83fd6c777bc8a92146ab45e3700be80cb0117d05d8f29567a299199951ee407ade61a7d422633405057b1c98768cbea271fd9c70249bf636117e61f387652caa1883258532ee8658e5b85624ab4be3e8447de1e84711faa3a013a8d05003e86545bfedddf142bba93b551f3eb5ee93631c5048d41c6a96198ce0e18026251f5c28d9ea4da8e69c632d7ebc2f4ff61dda5d934caa070141b45c63f82f8869886f9852ea2b91d6bf63072c2e349de7fd52ea193c305d31096335033a16258a098ec4a21d75c9c00a89f967936aa1717eb821eca5a2511a862a9155c193e89d632c1d0afccea0914d12eca4b3ee8d88d5571dce9c13e8170289ccff0b04c1be4981938f3fd6ea85f8753055e76e0b8e4c87fae81c0aade1c3100f7a660ba3d3d91e99485d499c11853adf086b838597611818a6e7ddf42a400e29aa2df750018c7a1e00f0ce5703fa4669bd0ff89ffae406e3b1f2eb43b448501952a1ea06094a8c15700f1e6db0d977e93c7445801d2715846a3ec430d4f77822f87bf319ad970085376819ca261e21eb48ed55d07dd88ca1a56791ec123d5a5ffbf1a97001935ae86ce6c02b3e4cdfc84493db79c16880984cbe4a969ff80bdd7f5c60ca04c8b7b862d02fb0198db1b1a408b09f569f9076e74e6c07196eb992912d4a21bade008afbbd85fc2b385dddcb3cd0091ba9a91ee05c674b0e008253f74383b62bbe2096f84a8a0c4cc4eb2d777e98e9ec4ffaf3e83adfe4e26eca1124296d09ecc977c3c7d5a8d4b8917801de816843269866d5a980b758664e17c5570457159e1ff38494238625c569f6abc90f69d26554ad1698d07ab7243a747792f9656abd22865ad34546dedd24c7cb0d1e37759b4dd8a509f8cf1b049e56a4d91e7ace5d4c2079d9c8f733dbcaa51e542eb888b2de8fb447dac40e6f548fc4b1a2ce8da0bab95e99023fa543424ac0e1b677bc2f731c46f23c59896f11d52e0a1c847d772185822d9926a3cb4bbd846a188b30ba914e2160f2474bc3125f89fbf4a981f8afc9829744168de74a46a91d5a659302cedcc0524398624a6ad2414d2a77ab2ee22580ff9745447d717626837a1a2dbde063a3dc7b96feb5f66bd8214a1384c2230b1ba25368b9b11490583526bf8d33b249e8fb5821acea9c3d88a582a5a329d84bb7f163e4313561a91180c330c18f12493edaf5a5c42dd489ae7bb1696f13bd08c4c2c11ebd7c76217a6c197a529ee8981696a0d8ed787d93ff7e512a7ad82d377ba96f2281dd5ee4c118b68f0ef15967a97bc8fe5f3683cd3a39f521df08469dbb6a807e80750176d851dcde7ee45d9d945f07fce277672bd7d8aaf2e951d7bca087757d62bdfd34a3b5461947dd1b448f900d8200f5f462cc68238f2a11271f96d993d4d0e519cd9bfe63c81fce961afb1c0325f7bb9382efdf2b332a992dca2b1ae680e3b1e1a74ffb48bff74068c9d9094e486c3e62120ec617960ee0ab34e00e8381056c59b5de52f11afb18de758d0b519a1b74201d2f2140d332092f9f4fa49c0e12753dc88fe117207974f6461726a709eeadab72c77ace153715730abcee354cfc23d0c6f033c584dc5ad80f7ef68e8bf731b2032da345fa1f83fb6200d330de9144fcf4ecec61d6bb204183bd92a68b0addb712d9d4b57c6d81fe4054ad3202f3161f5123742616d34055661df8e6581a7aa6d533ca4f0cc20e086539b4224682593a7f26bcb81d5d8f6b916d8fbaad3392e739f97ba2d9a8d4fe9100584260d54d7c80b0c86bc374085406521a6f36d800867ddbb14e956a584c1cc7c08c90bd285078682045b1f27343763ef1112711ffd41203986cb6575e938452d3c4cf32aa8ca615719acc2c4468efe94666867a58b573c5464c47466b9d45f979bf05249e8ca538e2956b97e21bc59d39e507fc9c6449e4b4e2f3ae82e5207f1f1614251852856d9ed8069b8bf51402b64a2fd1d4b814788a675faa426e488ba0b1844b8c1e90f216e0268b7faebe69c34ce77f1bc917a0614940d0de5232dd2b0827c48d63fac4bbbb0f87a75a75a8eae000f6383f47c181e2bb45af92d225825cc0a3d837fae50352a5c1581621dd83009f8fb46b2316c2516119fafbc7a92cd944bcf879bb99fb8cd0278090a9d0486fac919c9f1983457a7c4d04d6b200140c9083dd287b9578a6d1963835c1bbc19ac96df93bb347d57e60f319e1d1e9dcb65977e4a2c49d122a936dd884f1e22987f28a30ec0baab7db0be83411b39590768b0b13c3b2a0fed5265a45c37b4bb8be813cd30bfa8a4d8d43ee554860b572083c9edd2144e19ed482e32390eb88848491a9f6e5fd8823436415b4d529a3ec72686d445d1d6d43a64ed17e1ff3c366fe50890d784e83ca013f4e1af76f23c97ebd09d5622bd6b6f5b8781582089996a2e306e6f936f9bab0fc261d0494b11bc9c86bcd71d8f0474a37a2a3683bf3557906c3750cc52a55bf7acbb380278482d093d48170928ea5de87ebca8c81450a4014e8fb56726781f87b5227958cc81b7925f96e61e8794b3317f3e8c22e125af6088f086e890f7ec2f543c41d29a937eaf9b6abe0fa1e74135711beca89aad544d9eb004dae5e04af49bd3252263fc1bf64833504abd0114e989cadd56f648b9dfdc5db1a11ada93d385938f85e9ceeb90b65c78d8b5c9e88fb211ebd56089d84c584ed3a4959eb305b76c81fb56e515cc1705fd642bf66ef4f65834ff3a401c0a76c26995e488a0ef563c2eedfb4d61deceae0613eb52b5c6527c0ef206ed813fd26a3fb0b7876d04c0eb6fcd8478b352a56eb7dda05ac2ba524e602f96c90c5a9216ec7ffb8e3d2b60285e1e1ee005aeb17bd2d3ff224c184d3eb527848ecdc1edb467d3899d61153185bd0b9fc6b13f8644f1ea1624632d4ad6b2078241a559b0d083b1ae3b794eafa581f9533cc68e7e7c73f4e8105e27df458b227008e8f63cfd8b2f686df0064425148d45a5bfd8f6a72d52726f274e9591403e0e04e3dd2e4443a9bad990298861833a5cf0ddccca6ebbc2cf24aa1ef37e6561e94d9fa814292bb84a81643528d57d581c4d0e113c38e586845c3e90cc7c001837f77e479d64f7b36c99f6a636f9999b37f0010e2dc5bf1d137b8a8aa2f037e87cbaae759421d95511f840ad7efbf9e46bc60364d45b699e860c684e97a82febfba2d34957ae77cd23ce34487712af715a9ce897d7718e6c3ccd6f65110097ed7266c639c2f4feaafe84259a15b6ae25ba786063d5597ba83796313ed6dc7c91422f7c5be310097f937a9727ead178cb41fec99abf4784dfb553eee88763aa6807691523e183a79be10a8d856e3ef9b25550c5e694f7bbbed6c441988b81d39786baeff8f3cbca4c5d2ccad90c6b3d04cc40ef6e81f37aea8934c4e69f71571e642d2990fefa214f4e7366ad6b247063ccd6ff4403146fb5bab99c3ee6f9c2c21733a491faf110d8038c300f3e8c31dc1fbaacb417245d916f5b041180e52bca9ce1090cd98edf1e7ef06e7b47cd34f5495b591da0734a48835b4857ad5d7df8b998753c3b5b6a92fedfb6e62096ac7c5967a0c28c7cf86fd5a5985bf0bac1e42d3f9d9a1591c2d5874a27dc8815819574309f53b5490bcc3ff068ac101a0361841f1769306ad83ca7514ece1b1f061e5925ca2b5beac59f53e26f16d14ce458980548655544a5e97435fb5ce6eb9324f4b2dc703d8f24390a95ec37b3c20393aa48abd52b39d0d13218d3cf0d71d3eeb51e74efab36a9f0981f88b98e6fc8786f12ceb4be262ad143fd2a3d8fce6fcda3091405aa20559dc677593c45ffc52d4756ccf49bcc30f40a0d6790533cb285d41dfa42d0057498cf97f41cc526c31ddfd787a75693900d87fcad834d67b4b74c399e2835e36c7824316e69116c1fec1583a997c23669730b13ced4b15e905879a37eb52a9b1799b0d2d34985e098bc678838ef67607f91dda34c7c883eede4bc2d8f6bde273e417d68d89474de651d41c1a735dfdfd3d54d1d3a769e8eda10adeaab0e455dd4ffe784fe31d7baf38f4980034dd370be86d7cde14b73a70a0079742c4538495293fad9ec99388f96f4cc3e44ba2d89c8c12fffa7ddcf0d7d3cc2fe8ee4d6e14e42d550fd666832bbd02c24df6fd9217d5eb3ae10da0328f0a1abc9b3be1b9bc019ab6555cafc02c6c903ed2c9c33f47882e43579b9af4802de1b40e131efcb6050bca22796812ec2ec1135744ab03c175d2ed01047956c548329e88a866d18f7080a8725d5fc341a45b3db43ae839e9b575b61c1d2538f0b1de5c65f5a69eb045e1f0562673ac0831226477459b2b9cb60c00c9ce2befcdd86be15eafb0ca485edadfb572c8e435cdb96031ba913ee90df2cdc0e9da2773704320d8a050d90276fa64838378b3d0f53120c12977037ee2a324a0332c101adb8b28c6b385025d60811a8d95d6dea97526541a5a8a2ce4ea5262f3e9d56ff7a7a47499c726e005bea85716a3468e98f89ac3bc4e90b71474f67eed523c028f5a388227c4e98fc74d9eac90f14f90914fc1a365e942924b490c7824bb1954406abadd308eb24b53e5969ada05aed50d4cfaf986aa23cd3ed5837cf1b9cfa4d9988cd25618b5ffe02625f29c5caead3c6d782872e539c02529691bd155516bddd13f67599d9073318eb4ab6986ff415b4be86d761f9cbce19e64178b9d8b22f49119c49030d9e544313336a9bb24e2bd9c2dabd5377cfcca276e542d3a577b27630a41532b11a419a0bd194f506945ef96e7ea7f89e183ea275fae597e495ea4fd441d913de481ff85b1537cbfaa999c29d6e13c52d7395166b56680010b76ef30a079e56001a8e32b0df2ff67a088b9367e730aa1fb9fad702969880f72d99e2237526b836ea10f3a655ad777305ea75c0e5c4d60ab886a2a31ead15d701a2f5a9018ea9018544d861b0ce13ae6ee500b235389d7220ecb456487622c3994cb4debc95eaa3fd68c56444b84826d04d40af45ac5a0e7d2d2f3f5a104356c9b848852cb9e7a39e8f3e3a7d141f44e9de650d435cd21a54a2bdf277d82a53348181c9f0d24e34e4a370e1c6660882c5a1cd760083a16d6113c67c134a648870b048bd3edfe71bfa9936b20c5c4bee42176086624c711ff88b9253882227f24ff5b0a9db0c4a636665796768126a2a88d0c1479538b8c4b34411594cd561f52db9f6b0aa3fa71442393612e06e0869d302f81820a5f656b1a196675085bbf9ae38116a383713c6b682dbe487b56346d9355c2c10a3341b4b5bd7ef840bad46e080c50d642dde8d810cb8247369bbd3f81ecdb7e8ba54664f8dad9650fa207c97659ceb85c9e544b804b272e9bb0fd59bb784da403104b3a51d953bcbce5ad28b7dd5cdca76e41c6376463468fa07b3b445f4140e1b76f58fe592f86ae907cff77f2fb5700a0c3c400a5b1e7f8d723b21115e88bcef44168c84a874329e565dc0778107d6d8290791dfb596e75e13edd6b90daa708357657077c8e65a5ee8fa49f11391962ffe3a9ea3b401db498fd3fe4f06d602544e22c49a13cc33ac7a139b2d2a4fe3d997d3a9624f801d9acc4d3721b4cd34b2261d5e8a81e6e1a98eb4fac6e557a34c5d50c5aa81398898c1a087d26a66510c153af3e3030786ea30b4375ac1cd133a3fd2831692b5f8b65e924a19d1d2a01662179fb9fb698e525613ab4490e42818fd7cf736d770e30f86e0c27939223ee6ac2ae1b8acd6ee02999beecc89e86d18c205b11266740a38a33e6668a83c73aab199a499e7be768d4f5ce2f6fedd52739c4d7aa2d786cb4d0a97a1d84798f8dfd7e7d371169fd2f033782488a1765e32ce2eaa58f2307a1dd674253a4b383a7fa4921ed618e9bd336e5e44d1b301ab78893c065233848d218c364fc1fa6cc3270a98305b9ed89087724a88f7f3256f0ed6e39c30e2fde60080d250e387a438e63bb607e6893c70685583864e28cfdfb4c25eb75f19cf1b6119238fbeb3c4a1aca157e0ddb62e2b741bbd49b4bac7bcc3a20c3cd7fd5439d7171586204065556af21b008c74406d7398cca01ef34f79abc0b1d4d76a08c7e6aae657c709d83b4015d3a9117d0835f8ae9b81d8bb86a7656ec1ace63e698ba8d8952c461a8aed90acfed534ff65e3cf6ee52580d03e83f007dc97ebd82bf413ca89a94f94cb9419469c169d2baf86fd42eea30377b42b7053d3f5e41e4b2330491b69635df145271302f6b41b7fe1c966683d2c8ddeb70474b71a47e98c36709b3c108cc280cbc67f9a360c5fcb8ee0601587dee54e4fa216b397694e3d09d1b44477d3714360de50fb421a97e7c251297a0b81f84a73bdf8e618380f6f773c8910eab6924101734050d0cfbedb15f769312e5a10cbfc2037be7bcc3d4bb181f0402846ba1dffa1ae479d9a5ae693b0b9f29c2a4a91645bdfc64748e54570cb83e45cd2eb613d3911e1c9b200740044ce808e654f7e773c1c8c52d5137c409bd4dd085b320f8ec74ae0bdc0e8f43d829c99d40ea1549db9a8640e8d8a1ced9297eb2c019034d525d8cd9c79464ad4959b898023ef97bc5eb4188dd7ab35f4729397263e09e3ac3df357b8beaf84b48ad8107887ad58f4dbfef258d8c4d78caa724940976cc80f5adb8897fe160e234aebd1f183077d7fefbce869fb1c28100c738ac8f8565069e82b37779cdb482c8cfeb9aae173b2291f2091f2114a2bdab9b1898074938589783c87a6121f454c7fd798658abe3960dcb72545ecd1434bb042135741c9e1cf220de572f05b269030bf5e9983a80ae11a410dc2e3231d3022def36db77a28c695242199a29240d947988fde0cd10a81182f22048fd3ca2d8f46f792f7f83a5f436ce4486559d88f5463a3c998282331e8a6aa27ab2061cf7aed4633f1e42b61e15c59ea1d5e1ca218f85a56ce1b46e4fbfc0fbe11ef6d0a3686a672f3df688d7996202991a46e6db857f43b279d016611c32cf71ea326f6bbd10f74df3edd6a343f1e2c33e60140d3b7339c7085b9d0cc7c2df33ddfe295f05b166158e3375bfcab8dba14b558a083d474a7718ddf8c22d36a4e7d4924d22d8d6d37ebdca57aa4494520f0cea5b171da0ab6789d6943fdc4c864fe7c57ac3266cc4bb295a6400f767712fca7f3ce45b1fc25a2dfd45f5ef3e4a7ec76b7dc40dafc65afde8eb1bcc145df5222acd6e052dfbdfa923b4319a0b263c4b074ae4ca0f9bce9d01d6b6bde115c98d4f0b70872c14ab32f17b2c3db866a94aebd10bcbb65dedd577d6b40064bd3d26d5c261b5ba6279a147c01af8682a542b73f72cbad6345838bfac07ff12859ac7f2a24e434086ee4f133f3707cb5ccdd8ca0eb17a06569e5fa4385a98f458c548b4499eef67656c545c6ea51b0572ed1723e7050b15da92d75dd28a361782a7119e87b2a42a9d24ab680b644a747c77799440ab5e07a566e86c242708f79d744921a93586509460cc7a49dc7932102a720dc2577a9fb31dcd5f5257c3d2abffaebd85bd972dea9af1a854bed3800ca4d28bb356a6579ef74d0cd0431f4338fc188d463685562b15e2d9391c210ecab0c1eb6c09cae1cdc6a167235507f8e92ed3fa2a0b4e192553b8e00a08f29eeec953f1b596ee8309242e13c11ddff7ee8f27a1c439bda8ee065502eb15d12848b741490717506472d22f4cfab752d5753b6fdf4a125aacdb6f47796231552f9933e04e61ee0a663d110f9262ff239d93eaf7e92a85041456fc58d6c7e51a92a77d531df01294c7c40a359d9a814b3996070d9fbf9b20ed660e68e261e3d7fa38c0a6baaf5be4f5c2bbabf716d0e3cc4a9a1105f483193b94de37d483f7b63f5638e9bc357c4cfb2682163d857e620ec99fe5d0c25c84f967882a3b5793a8905be45cbf229056bd1dd53a5df4bada46195aa9e86ded7f756545f50747fe75aa1bca28b6fb0159789640a30bd230f903b9325cd536db32a5bec910b24f6ea8ea00c9a3fe5318b2c304026aca40adbc4cf3bf4d044f99f1e39994d23d1fd1bcd265e412deb7d6ff42af3429250a126e9fd2a111f04ed36138fa5621d882e881990a5a8dc859172724c8276aa5b3798eec918a303866506561ee34df79d292772a55c67efeeca1bcd4211fe6349d85df6468128f23e362cf9d922bb2b8a1f75d8e3fc81b3318c802923a62ccb34c4f76ece1ee8278e51fb724d42900a5ff0a1c3ce4c04f070eaab2ac04399b42e52233da901b323cacf5238cfa861fc2b040fe2d83894519920ee8f9536e97e4ae855f156faec6d86dfb706b62a37ac30a57ad88bee4d8180665de8d879afc7f5f4860f25d845e475c6a703dec4ab64cd2ce6e874437693b26ad2503d10fa3ddc27da880d023bb50e22b4c86227d3f356bd99838976e5f4a582d8b69f48cd9903d9ed259cc1b7d2c628946a70ff7ca76aaab3b759bb8121ceb32cb4dfae05e0e6be902c715ac2eefcbd20c570d1dae7b28ceffa3ed748dd156e4ba9de15acba4c9ec6a6142a7ea9843c63cc9320f0d2d059d40f75b470365747713976131251871fa4757869e0566161533c6413167fb362656a79871068fbacd0d08feddb3cd6fb60995bac0edbce1e70ecb7a9633a9a997d88dfdbaecabeb2072a6454cbaab8d93a4b435b6c014e10554e71e9a1ebd968a43cb121024a94a60d35a3b7ce3e4ed346f1b9190a479b2f788cc9fffd65a9856e90def2b27725f90cb15051afbe7e0b8c5a608e1d49592f4d989271a6f2fa7a1a43d2cfeb4b6f1604f87347b576f20bd790ea5e4329c0f2d1a0dcc9e77382655b5c65ce0a7eb3c3a6ad95f4875c5af9a2ef8ef0070544bbf814351a26acd30f985ea56be343096b3e0df44583a9417c807ab85f0f7d675599b36235472ee5138d032b121535843e908fbe8146ad32358064db21cc320e63abfc9b7d09934ef0cedb7371f72f6a44c8f7aa77eddb789a6f25eabd37c42bfe26e95336fe81fdb467d5b0a0bbf60dcc826d5a3eaa72a995852e6b24b1b9752cd4e1bf8bf401ee934a486e64bb4a6ce0003042eadc8a00c5813a5be97f2d584e291fbcff9e5bfdfa2e12a5c3d02eefe6599af8c93d5cb0f798b63c58ed259df7bf6fde4d39467e7d373fd340cc3f1f3a5e39c0c53521f0d52986c0269252dfb3a25630c01e874430da8dc13b371a95999f8ac63c9baa1b295b27943698624dffc874461081c75159c1bc5dcea2124587b4ef8056f9d2bfd1c431bdbd3ccbb809c16e79f2b0e5f2a23b6390d1d9253dcc7804e5ca707aad1843d66e4c93adcd93c8a6565eb7cf747ec602ab89f79b3116d98569a2d87b926b7c89e95e3010c84036f4ffa3c2d36e8c2fed5efb75f7e22a27ae5ed481f7b9c69d5f08cdea293cd4a47bf1ae4ce0ffd0be88b288fc4fa8789ac0213877ecfabfc325cf6498d4e700682a4e5f7885abd8c333691047e130de6b0e195b1a0943e198feb4df7339cc0f38db50e62ff6aaf30ef09c688bb6ff0cebeb3517df6c8d88b0f92c57731d4b73045f108c2a1509b3145c22bf9b4a7a27680b2e06516915e55bde0111a5c28d58923341d4eb0be4d42e5351c3f9c59337ba51a1cfeab4594e25b1162e2d77e0a09c209d8492189080b5b035bc763a207c189972e9ef73e6a06542e4b966cad0c731996f120885a443745c9ff276521a06c6d6e52a20270975b2a4aa41462e0dcb87903cab154dfa8e1d267d7f572d438cb4644015c5d969fe913e0df4decb7e086ae154764f5357acd50c54953cb8ee3e3720d0f8e74b8e136261d9cb15abcfc7dde5db3f136d67a0e4a639db95a849fa1f0b9ef7873ed34f8a64d51793814b2247ad7d9991c4e979b8b19147b1517923f0a761cfea3aba6987530a599d595a0e5099a2584ada01adea90a5e7be59d38fffc9f54854c694fbd76d75ecae1a5404a40ce1315fef94f6653a52417e63b353e0dfa3d831fd5e66e5acd47178b0f853e318766065cad71db7778c28e1ae1d86f2d648a195b7ac1ac17b9344954d421477fa7357f117eb8b43021a8305f0800e3695a58860e76388e679f79fb8a8657feb87a56d5d3b5e0100a9d004e4af6a517ca28fff26ecc2227f38b56ca42eae1ce4ec9f6361c3668ae690414737aca8e65fb79c5a488598636b041500d6cc06d3812d69814c958c629ba64bff145b0b7cb29092e00399916207fd2892b76debfdef4f677b31afd7b5c01d5e93e75a6056168ae99a7e230d79c317f3ee65a5bcff7c351fbb3f39e4fac553d1b1df06da6824a88225c64bafc03ab76ce24117f0326a71292f63186b8dfd9cb2fd7fe612d3e160d17c32591711425ddd191adc242851b06b1384a1a83a94779827e7034ce63b170b2a55b2af720144c245dee034d1ef2942d7df5e8957a35256b135784cf9e3e75219920b5b2fe6bd6f782943a2c258229a94755c62694e734a60a73e2ce16d58c49e650550601253c78751455c262841894416ed98ab852f1350349b931bc5c94322f1cbcaf828230d2d5f20040728fbf9b84f01c1b2c2284f52fe66815a20965352b0718eb8b62b6802db992051935c5e5b04ddfcc1afa2dde5631ab0d09ec2f22383a64ba572985e88e34ff7a73136abbe53c2616ab1a9de4cf619d6ec1042be1d4c387fb3c5052d7c0117188bf7e3aa580fbdcfc6c4a4b7efccc4da54c6829f6dacf990226554edf34e3e5d94895e61d6980cbeb02e354a9babdbad41c555be0da60c061030c41f77c079ed84d10d622670bfc7c06c1c98150b14076d689f7a23ad15dec26e9d050d6703188b7432dec93843354c5ba6f5b13ddbd32193ecdb8816ba8fccc0d03d2e15b32b593787a973789c4310c946a06cd261b6ef98edf016b994cbe0bca3696d86f768069342933d6b8ae4bf92e487bafae467d3f5cc3d01c86cdddfbaf9aec87fb82ccb7dfdd6c46400bd9ebeddf6ee434f9b716b5cf4dfa68935a177f3671191aa073c533e80c2cce99678c0a20d9fa77aac0fe61caaee4179498b80a149a535463aeea092b248394a2288b930bc24f8cbb1c7de7be0dc84eba71ed63d0246845159f78d79df5ab21994a5e14ededd8033772a6e99028fe7c1c14cf9ae641745ea81c78b26f2eb351c27b0f1a3ffd67ac28b03531da23b5a37f384996d1c1aa8ae70fb26b02149ef2fc6829d1e52330f7c6b1ea499a58c04cfd57fd00bf8c75a03cc22e32c81489e44ff1a5f3f44828214acfb24e0cebfe7a578b738d0df975a710ab32f7cc41cf5c4d5187b446960044a4cd9c83d139862137dee6f47f341fcd7333e7cc279860c6e42470cff3127e7169290aff1543bf5c6347feef2ccc0848262fc124933cc6d77db2beb53824fcfd14967497ecdd32014c291720e28e8ddbc77bbc986491e5c80ee3c883f91d10d97b5e921ba2e0f9ec8a37d37aa58dc9a7503a5ae3532f3e0c795b9e9dbe99a362ac406d28cd908ee2a1da2b50c5f831fce4ebcd5f88657aa4ae39822e0ee3254fa5b013ca8c79d3c0a5af61ae8a08277eacb34875d1309c332b0cb0849fe8bac0d6a92625d71418f2c52e2a00ae3d847593198dd347465c41e6c5fbb3c44053cbb772afa7fd0a820f8822a80b81a5c0c6473537713cb223a67524036d70c469360f3f38192cdea5e7165762f7b72e3de5b84e3f8763fdd0031833806b58d9487972de84f55d26340347c2f302ef4053a988f0a25f7e33cc7488631f0792df9beebc8cdb30ec33339499408ebf643c0add0fc5c2f474d9bd50d0a192155400b84f4ca6cbd6f02a21e0c9a615a2e68f76d7b3c81bcc70c3126430bbd4d30dcecd18df93d42b74e7f90303be12dce2cb87252d3d9d1f49f9fd52da4ae5c52aa08f771c749ec792e2c941b0289e79700407ae04fa1065af220b3584096b230f6787c18d84acc0a6c4ade3338ee58416a4e7646e3d96389ab3b8d0457f534ed89a8d98542ba6d501c2e2a837501e72ebb5cc5c6f31f52282e226080991ecfa886cb9a243602ee293531e086b147b9d6b9bc9ae1e083a38b8c6a2daa1dbf9a6167d07d240f268aa7e99339f3f31a6a58cb9d1f0de008664125702783a94a7f90433394d763584de5d89401d5330c08385356bdbd58c5bc53f3efc92d45e95aecd2e777f3a808c4061bca06c9354abbbce60737439b18fa9557c6d8298b9c6e117fa0ad357055ecc57b384a88eeb00fc6db4fa3e38ea59cae15365333d5e9d9e284d8cf313ca6399c0cb2e179a1bbc669d9938ed4949c36a15690375c6177a8315b8df6136e78a1365e89f12dd34d0de6af779d6cca5dd99309448ca25546c25e9efbf93af7586a24aad152858d87c556bf9b2daeeb61918dfb9ae4f0a0879d71e09192e97a263cc44af70f13a5b6a44b597886e394f3b7cb7cba1505c50b65cd295fd94d23f8daaa66349cd66c1f2e6357b52c41ef18fd85a1e8aa26f29284b986efc9839818a53c20bf6ba58cce524551b157c06642076c064129ee0e80418b3e7e284748806535314517125c5c890ec608f6fb9602b9632e6b6f2defb13ea9b1be1bcb6abfbc3b3adbea3b8ca7c2b90340c973fef00119c747ff1308cdd16da2074da5899f14b8a72c55f9042ba7328d13e1419f080841ca3859031eb583d5b73f267011e21767cc66065497e82823e7459c67e100cd8310dde043f67fbf89f15d7af008eb30889c9f06605e3f1bc21c06697c68dd436455dfe649a7da1bac4fef76a78574e2597f8071dabc23bb78b82c3bd7140189d2794452e9750dc669e7c7829e2c6584653001a10691b2b4c1dd2acba71a441ff2f381d6486db9eff29b0eef9f347f925c7a93d33910654bea8e28748e4cb540840a39db1ce163b51b3613d33566e8b5705632ab459883d15151c192a230d44f398dc694a577df5c9adecc2d9450eaae601f78a62c01fc16a93817c82ee7c04a441678084c99489d337a55885fa577cb3ca09d7f5c81e7aa026adb75c661e1472f84c6769c08569563ce6eb3a0d5f434dbd1676f37616142e2a2ae512e369c8bc4c7923f80beb11b8e888348bcad26954ce442cfc7cbd11818ab6af34b14628be25fc7d6b4811bf096b61ab7434a7e6eeddbf44524e2b4a16c086c42707ebfc6945e22dfc5152bbf4430e5a513a0786e610fbeec618933a29b377b5dbebec2bba662a07424eff9f49be1fb4bd4a2c7f4ecfc43dc754c3b9fe2638c38bae8b8cf4caf524b39d902b777aa58c2ab7217f3f32f9b54112410154d7334497962231d44148914937f69e9eb55d9f40bda90c343091bb97b48c87c879a56f9fd71d17cb0cde11420c0844986d1f780b317a53c687af1b4d910db34636cb003938a92295517dbd3750fb68155ab29e3e4802e63767a40de4519d71ad6e8dd4351a30db052c0f318d4387a96b6191b3b0b43cfccae9ddc579efb0699e5c4c520cf07493878cd5fd9e3a77401240c124273166db70001e720caec2be5446e92bed27d39b2df790649ea5c974788f9b154cf4e5193ae2bbc1b88ae83f515b672b2e834d12e4b4067faec7799d4b8a9ccd2d8cb5b5b41a9a257d49339a676e6c3c542b5dc1a2bdb62b2fabe8df3e2ea0ac4863e78f3a14c4f5303b82837f05b4f7e70fefe595fb3307f64cdf1dcd81cb368fb2c020b10f8354f52e4abe4c8764d6e45f1e71ba88875bc177b1a3237a0f83f75ff7972b54eae030bdc07c394b96b0c50ec0c17e0f2d9e17be94808e23056ef2253220994376733315c400e9dff05a66cb1d3867c74a16ac4cc442bdfbd93234210ce3cc6d66397528b24d4f1697b8ee1ea21103ab1e22b756d296e9eb27e84cf817ccd322d6f28b24ed5fac8fbcee8fafa8504f8bde3e163a77fdcf7787ca1930447af8ffabdf3d8d061f5b000ed8e33316838a43351c69125a971672aafafc8fde111391bb7b8248bf068a07ffc64a2b22a5da1ba1584bd9e4ed198515fc60a054d46757d154cded479b0a73a82125cfed50c32ea01af7b757709be2223f25bbc2ae770ebb74228b3bcb18c2c6f67f96df895e53d0d3244743ad41fac2b0436f3a0c6511ac7d7b143acce48f09eb445d1b4957a34e173ac6c3759236b421265dde07576996ea90ae00dd71560a221283841b3f0a5881d6386cbbca4ce92604375fdaa22c1aac26af0d39b6d3713085975ac67bc772f49196d45fd1e84e044c35fb076e5d759e48c6e75a2de7c2846c6e70495e3157e6fe13441ad8fe57773fb9ac487d7153a97fc186daf98438b5dea17e9e6320ec6303657ff8b5d63da4bd857866ba005b3da14be4e12761473f6034b77cc52f45eaa6b7727d9e288bdbae6a64e46027e6b97ab019ddac37eb50f885e572d4825edca4d2c67bda60c55b52e3ed5acee553e75b268d3a6c8daa51c56c930cdcae8e38e8cc2edc39114d6815e4a1c5fd6622c3e04505bb3372d2bc9c3a9cb0613153eff04624b7650c236d91908598c0b209000ffbfe2a6838ec8d19abf9f38af412eaeb12789538257e288af1eda107736ab7f3bd04518565149dd9cb93778e7ce4d9a1984dba3695bc1859cd580ec01417acb7ee415d00fa65238357cfb3e4a38b9940a20bfab9df9cf9f69a918d88eedd9c4c225483d889cfda4134762d4bd806a0764c8db4687fbafa513192eb63ca9fa6c40b677b033f6542af055f13e6842257f83bde14cb946e1ca7bf4440f0e02671469ab91c5fafca7d66d1153fad242d7b8739559911267bcde2de849329eab55b7595f1bd3f5ccbb98770d596c3d6a617e25e657439aa5874358a2105040c2c0629c12f860307c1b5f968d9171f2bbeb4b5836883307769d9d0842f09d8b84f008f6dcff1daa3f97ac0e5f016cb4182d47a8b9ff2a9e19479c56b3dfc323439422d6701151a79f27421b3d388501a9b7db927844fa68e4c1b6fb8ff1d52e5bbc434b47a8822e3a51c5ccd991b967b657793291d845293e113124dcf3dfbf4aacbd9624f4c756e77ac5d087f937f37584260689a53ad317a24bd8c26833dac2997432be8702834a13f97d07634edd76ff01846dc3737c1912299980e4485e793f7fd4ac57f2b51842879c24e0ca7e606e04978927fa44e057af5b4ece9efff394b92c6fefa21b18ec3d79ff2da97de99b91cd03b053b13e80f33e1f64ba962e30c94a0629923ffed18495e88099b51788b7f5f3708bf26df89354c8e8b3390a550ff959299dcfb6b368a8dc4b1f2215f9c83b5f24cc38e549985e8a8c2eeee9f949d3902e2a317aeefb243441e12b68335cab538ca16693ebcdbc28c7050034213bcbb8c1ddea2154e37e36ecad797c6f5ea9c87052175060fc11211ef61651f69ac752402f060e3c72de5b4e18853c8ed895c3ff9e33bd3bf5b288f49adbf2f839776181e034cadc8121068c7a6059aebdd78eaaf0c64333323da5b3abca99598e1281786cdd9fb73121d2880c107934db2e3a25e83341c0a7c3d08fca37f9b2cf72e02aaff68e4fedb422db192e2ed955041265dfd25d648d0d8d578d53e8a7844e5aacb288cc8f1ddd3fa9c9f5048f5aefc156feb04c83a3c5b485fbe107fe765f3bcc92b2d9cc4376dbed0981da50ceefdefa1fa9248587822c73cea7793a142d73d5c63556f51f5e39967dbc16260411ec6d895f2f9ad86726c749e53059ead176d3e35d2d84538ea064b8195c7083bf41605d8c14e999d4463fecfef8b9522a82556c95e094b7fdb7c42a1ad98760f26c75dfd3a7b941a4042d1eb3331ffcdea7f86da0359e17ec1708fbb90bf58481186569e60a6fbda5f25493eb0aa75c4a980985edcaa78b4f05d6f16ae6ebf54b427dc49e695b1315f71eb2bc049c258e785067f07714aadd3c59392672f3166451947f670182d2bfa9fcefb65b9b8d13bb3476d7318e9b3e076dcdb8608c4d8e132b1e27e2c5cc1d7a059146ebd95e4373dc72de8152888f512679b8335e0baf45ffd7851fb5c06995abbd3d5d46002856c538e00a3c36db666c558ced834d9eee630e76ac6c2e8474a2bdbbb97b17ae36fc45b36824588910ed9646001116fd083834852719c35f8e9a9166404236741febab7c7554bbd8bfa6b19742c7f1d64f5da22699b030e6bfbf1735dc3fbfcf959523ebc6964ec0b06ae25d584e12020ce23449c79e50f9c7daa9ee96725423af4435065724c04fcdcad59ffd021481724cd0e319dbe42fec73bccc739ff814f193bef39f2573d064de2fa3017d497231a11733611a92f0815f915a2a172ba0e79f667c2ed103248656aa8e48a6c5e896239e41436f12f819631eee0c591255a4d3c132b57bb68f3c88a32262b20613688e3e8595d8faf07bb4da9bfa4bd94d64edc1e4ab4870d19c33484b290670a32cbb2a91dcf2a905d11e3d069c563d52ec5778d2851a77d927628024769a9deb6b199a293ae0865507804a1d731b7f30bc9015003da988a013dcc858f7df3ce7889df6e144d5faa071eb848cfdaf4384680eb6560f14610df8512a89831101bca2373177837f0f3d9f1f1567e122561d01b32883abb9e21af4130c3070999d59e4e5ab67a0dd9a9969886e1facb5d49da1886f4410f7c68ed8424636f8f139790d628459a15e3ec30cd88a57959388e567ffa95ee879e1591892de7bdc367531c344dada8e06f028bedbb14d11d8beaee33b5d1df8cc0ccaab7562850b782279e346196f971da340a9a90ceff69dc8419ca484395aa9d8cc84451deed3ff24213a847da3b7b62282eaccf20a8c33abb159bde52710666cbdddc058336464ad815a78c1a4be38342d33a6c1c4068131d8a68a1b6376e6cc3fe4ad9aae60b4dbd5d2801629035e8cdc52c6339889252c3bd485d453a23ba45a0bb82b9dbd71fc6cd35068c699fe9934426914b250568198c67ee98b2ca80684d19cad9f22001fd7e9e41270f8061deaf78dbc9ee8c24386b5e63c52424fee4a7f3907c20ab49d40d994c5c204552435e2e641f04b759465e30740ac7c27783ad66d3cc5b45b429c95a258fa74a0e72e4e98cbf0bd259e09bae88e4459db4d315ddbd9c00ade20864b816c488886280eb29a94e64cb8a0e1691183002fe626a64c4d414f17b6d4f469737c3d59e4bd6f1f3f7ff81963c41ed03b4ea9f5d965436003f794a17e02a902a91d37cb41efab38a9c7e555fb96cc7b9285184e638d0d1189dbc850732b5adcccf6ecfdfd07552e96fbfa7d2a3ef21ce20c82cda341466420fbfa0649f9d75b157e20ca88e7a39ba6f7bbfbcd5d47aa3ffbb7ce95b0256fba87e17def6e1df21a1dcd480098a721cac6321b37423c036ba3decd3beada37b185098e97166ac7058e35dcc41ed338ae8b404e16b805b36a1b8916c0c5cfd544774edca698d48da6c942f8b5e207be9ab9819bcc24443f7e1f4bf6034e5481936dac4f416fbc64baccd8983d5d7f2cd5d82c1c18a5df9600ebaa7b7bea2723b3119a875c7865b5ea58f7ac8e3fc9c1ff76f265b5c238832de9ad1581608dc62cd39f774768e0bc725727e278dcf65339e9e543d5055406852ce3c39615ae2018e8a8b07e7875f9fb826316dbd9d98e2cd2ebe3806bfc74e0adff275deb7fd2cb3f9ded4e24eff4a16531fc72a6beb2cd6f3293c34ea6332544ca1ad0a08962cc15a0dd1e73f3e671f45e7a608be67c510aa91486a03d63526c542a06d92c1aeddd394d5bb3a654608da3c99e6eafec05102aa1ffbeca287653c4c018837b995c3945a8acb6c6d41ac8d1bfd59cd51b488786db70d09420b98acbf3974d65a0cb8b2a0f5509e3846175f6b655200749020b450b2e861a69009b6a5deb5c7e1a8c976b0204e4c566dce57db0393cc161c583b2d6a58401b0a9832ad87e1d33ee8af317a90098fdc87f952a46300ebe190bbdcc23e1281fdb6f4ef4310626961cea9c352cacb0c6b448ad60250a8ce345908a665be6ecd8cba1a4d04f0a39b757812205a2efa75674d490db7fd6686f36997a0be03776cf706f809fd8dd83fee73a6eda67ce7105172be4321dd71a3aaba242c57d273a86961567b0a2d30f469ffcebf751d3b6c9384221284410a3e62f0ffdc9b7e2e645e1968a959763dd97a462eec0e4a8a73f1534b3061f3151557d45a7f32aaacf71b554c09454df18474002d37abbd8d196150e6d39e4970669f3ee3e73ed88a8059fe93654f838423e0e81c15dd2477ebad9f8f8dd6ba82738ce6e9e09627d79fec27710a35e1bf4faab1f4e29dde2600ed916a75b2231601f072c9e1eafd18f63197aaa03c4e9393138a05cbd4a83893360e375985dd0a73354e8190bcb2888622e5af84017f0ce51dad30b3f2a8c4af3cc730bda9b611aa20579c85d9a6888eefcdcda57999dcc4c23a67b9c076b478566492e846cad9baa7665c963e0af468c1e99f391f2a59aabe047e7fb079b5b82d19a2146af93d7eeac332cbacbf06370ab9731ebc50ededd484f43feddd56d9fdcbc3db74af0c1f99be60a152211f304db5f36fb6862b9790923bf0e4f579729a3882cfa38a7378a5f8d2c1dcf77c304336700b642554053ad99fec4571949798e189151627f0a2bb6c447bc3606e490e1da0022cdd93f66a251e2f9306e12fa1c81ed03ffe9e44fd9298c05a90afa375186f4bbc8221c91d0ef82a013d5cc7f83a3c5cb65591fef242688d852e83e0855bccae88fa3f98eb1c95bea892c180ea6f0cd1375f691043a10b1166ecde7259849a5ad01363985903663d815c435a2a6f71c9ee24061cbb9336fd3e31c5d17233edd3cd77b943c38d5436c6f8a68e2d95176dc9d0215074ab2b0b16277c5ae78d3142814b3f463cb8a67e41327d3649aab114a4e48bc6079ad692be5eaa2af5eda9e93bf8eb28a44ebb7b625151654b885ad44f21f019c36fe7be035901083559d2f43aa8c95d53b2def4d227f1c61079b9a17c9f3e96f9429e79b97b1f4a8e2967c79b5b62d6ccd8218839ba8a37312853bf53caeb9bb87560bc7732a69538a9055c35de36572dfc48b2135b0da0689912b16cc74037f42cf8a23df3b667c442c1c161905f0efcc024fe57a353da36650af56175fe147b66dcfdcde46cac2ca75c78eaf5223b502547802a17b8de300345a132d2546c3b80b88cc4560fdb2eefb0b21894b454c863dd94672f2838e3cd59c6b6290d9158900c4930c99a81cf9c466d7219d9aa2aeb3ab7418168db20dbda1a57f55862d4d77fd4e604ba7e74e1552f23145f39138bb2e6ff0f047bb755fdcb07a48c81db245071c8cf24ca6eaf5f84d6c0e2757f2d7ff2e765fa03ffac37763b6621efa18429f06a26e14fa1cd8263a087d289f346436fd676a79cf899ee2d87377dd3c256ae3b1c053dc216af59e7727f1326e96e04a06e0d2d621369a10b4c1a9f3a2e74dde178d75d4aefbc022aac52fad49ace893433c67dbe6053a4c175f76692b1647b7aeafc01e72bddabfaa497d4b6dddcfd043cd50e4cdba9815d95e379bc12cfe105387b48c8766855d0d81b73df49b3b0574976c34553fd5ecad7e426a63bba49f5f2221944796e1f41b6982701a95e71b2d126e5f573fff5d268c3e246095cf2928f8f8b79ba898e44e8340c1f8bfc05daccce96d3908a1b92e23d59d11c5ff5807edfcfe25249ef93d0592c2498cc6f8e8075feaabd8b6b78ebcb6315b74021506c2040d666af9efd799d554ad304d84769daebcd1566eed6eee714684cce5e3f1888efbd1b706b2955d5070bb3ad9a6bac0802347093b6e4ada9d3f8b0a4b9431ce8ec18aa160db498408e1642aa5e9644c94d490e51b90dbecd72d9fa4d609cef2def1b186200cbe8368a283183c3e8b53f7f171b88f025a00c384d1c0bcf0bdbfe5823f899e012875ec4a93c7ed09029c5dd08072bec58c52de880e7bd5a53e9abf78057b6138869bf79030a5ac180443391b755e7e571b2599b8668bf0a394ab35862c141a890f006b154b1e3718971344c58559eeb0cef32a722e25b7c99ef082c1b481d924a4cd023c99cb2f002860c6e3aff04344916e2d6fd9a4a55e0229a072f6a4f8b308bfe76cac21bc87aa7720e45db40e8d01fe59de8669b23bfccd21a50fa4eb2a322fd980a5b0460063747a48e5742914a6c8d5d16c1892b4bc2de6e985c49dcb7188bfe8637469c5bae49c76d7c4966cffc92ceeb055b63120f240c948b84763542c6412777ffa6f9732e1b7d520cf522b60e63eb29671af0b16bbac210b27dfd6b1956292dcbf3cc92f4b36f8b47d94d3d503ecdecd35995c5d17bbddef108894805ce1c375f464df52da532bee1b330dde8203980b41797ba98b1ffeb769edeac3d442be4a210fef797ce4eb0081602af0bdb041b5114f3024c307314b23b74b9855295bbde3ac6993a8310d4c9746231ecea5829c34c5deb6b90c24f3cbfcdec3c8edcf5fca4541509bfdc536e648403f10607908c54c8603368b2b04eff44675560d4d00c3340ecf2322738deb8f161e5ca142324e30f117186d2a857f5ef4b799cafa16234cd9f8b00927d2e46021f6cf1852a12a7826b3203a4384537bcc5643b612af0fddc7bd3827a3c10c53ed5e5dea3671d95e708a5796ea668a7840eeaa958209ee6c686b6b8b43dc5d8bcd904575543396b51541fd7b30e9b935f29c4fb551ee5e62a507c0269c159496ae2402b11959243d63d5ee45e719e97fc2f54d1b36eecc4e6c10c5f5ecbf9476e4488366ff1485ad936725c927b0a249ab0817bf85dd44d80a141280b27d44a3c916a68e7bbff0a0629d82bcf4bbd8e4528de419927822a126bacdcc56f521cacf06a3d4c2af38e257e3b46d82622edbd758ed29e473a65853919f06d090cc08361b256094846212332cd6580ff982b999b8fe88a904f50063d6f4d9f055f1054cc3281d6ef45c88999d15d1f8435792c495166784a2673fb29c6e63fcb07fba24ed0d48b8ef7acd0f00715c2cb8c69fdb6066ae3f22906b44dcaedb9ad9ae26d57f0e53121c86cd9d8e5d00d8d3a32468c31fb799ebeb9b227909ceb68879963928859e2447ba5015f9a9de98a212878610c722e7eff4c8bb03f73cfd5ae14c999f20c0425df3f24d2ac4e9044ff1aca477e49d21f62cb44b15417548f1904657415cb9911f329731955de819e0c0ebabf08fd05a95853f7cd29986d29d2b6c80bd81751750e265dc90f131258d2048c5c425cab1f002581417c01f7690fe7f64c0035f9be5b5d96ca886ed1b5bda755d9350eba89a0356d40a14ca1ed8227a0cc33cb87fdf9e9bcd0fb676098c01b4e1ebb2a9feed7e21281240bfa5fb4a32f283ac2f840903b61c29f919443251faca14d7942762aead8ff160da3e6b9fd336d23e8f9f57e2ca19e104a892742fa7e0d96bfad1e3b220872085fe4301fdf7efc8136d8842c38c414d5a8a8c836a66cc9c363029093b3af4b5e83941eb1e6714562d69c53204488c3d8da161a60dede4d75074386bcb81186cfdabfb2848f8b3b22a2b0072ac4e8ff8014dea1b175d6bc713ea5543036479601db80a1e035cf0922c93f811516a09be296c30928d08f1af1aeaa651625bdd66868c9389cb7ebc9d748dd91aba36e172c2f8914012b91102add0fa11c3b71dbfaef5b8923a13412d55377db31c1f1505b471a7699d2c80d7c3e4e7c6aa000c0cec5f35c426330f094f78efb5064a5083e7c4ebe728accc6f28956d200f1188549fd135748b8c6cb6be937421632ef553c662a7d23026d74bd65c3dd44439c46968dc638fa7015d39fd7aeabc2b0eada1e4535ea04f2abcffd1037b1246d86a2af114a1856b24e5f8d09978f5e1d4e998558286cef85e877b0593512e3248919313234f2410e700d6fddf9b3e3df3e848fdc7fc0158c3a4575e6ec424093a44e03a61d24920a4319a0896db8f79d06d737cd69a54d191aa6ea8e0fa46138ed29675f96823b95c4f65b98b8fe267764e0067c8868dcb8b2725b4740626e21c91f7982064498c0667d8bf27a9efb7b4fb2c3ca14a76bb777d7bdb06167f973fccbf95aad94fa7993afe9496bd473388a17acb2d936dbb9a3cbe94072f5050703c57b44cf28f4b2f1dcdd60a31cfe7fd9e0980b6511d64f8af6da78a199127a2275da8db0e34a3bdcc2fbee900bdc5bd7110192b1c098b4c4401650757fc844562ee890cf2bba1ebd34dedc8c5fd04cd1be1409d6ccf83b03e64ff9880f01ee7bf0339eed01961d64494e87ca872185482cd35823853d083fcda1b921c5e92319a76ed826921ce7ae92316282a29cf50e00458c6f552df5c44878420f1e4e462b5970624fdb38fa87ba51dde4e616bed84ab2ac8b94b4e07222d398720a6f2cf627f05402aca32bf7fdfda046f6762015bdaf7570727a1dbdc945ca846edd38f49402a2ce9bcbea2a09ba3025cc468a3fde20860a6dd35c52421f1cff59d61b8fbe89f7529545725e0c5cfaf884e81d9e6ea83f11ecabc5dd1aecb3be4e769bb9a98bef2c355763e2e959ada6070646875f2db5e36fd4af1d81d6ff4ce7bf86134df7a05ca7d43f2770fcadd719882f1221438685c35869aefcaef45d992556a9894ead3484fbf9014aa676e0569009bcc9daeb0ea43e6adf414c2930c998fc91b19a0208bdd7ef43012bbedb1bc1247050c0c2e35263d71ffd61b2aba3f7a6e6745e745514829fa51251c8411cfef297d1bbb531ee5aac0faba5af6b9692a03cf1fb5f770eda8f65913eaa7e3d6fb5a8e75f374483b66b7c423afaa0d35d944330b7870c6f0ae14487584a155817232595188992ecb4460cfc3832b29bbc312037f929a7bd628ce5ae03a4f31e791d3695785e23302849151d9408140e178d0c1a1cb2eb569096fc5d3f5d3a4073c28bff6e0a82cd021b2e7771b6aca214ff31184547464e55c903123165c91337e1bff1051dc338b0cf3316a0d8e84255272537c16a2c9dd1a0fcbb68b8c6ae740d0ba572e7871994808162fef22c28a9c591cb72426b994fae159c41278c96b0ade3f1f556ffce6377d4fdbee256b9a366e95cd093c391c50a9692b229268fb531e72b7a1b0bdd592a7cb580e7e8aa776ef7ca36956f0f529e92ef876fc2f48bc76be3532050a37aeeed55a1a41ee2adeb8072db1bb01d79c28738919244f46e3db17b7618909cde22996c7a3416d0da5cd3dd5699d4e315d3396ce454a02b734719922982cf798657e5ec9bc0e5e63bc907a071cbdf73d59434e508961ead4b8437b3ce8c313600448c08f0ee87ef7cb95da7df5adbded6be2420154d774f03643dcf7e89331632fe4a3a54d7ef2f0d49f3a6645bcf9f0e1deb4fd63e6cf238954e18e45f8176151f98c62add808623972eef5633ffd43a2cc83004ecb9516fe285451d670ba919b987747acd4d3bb6b13287b1e88e8c26a659e8b9b95794715202dd9c06b921818b00083c87efb5a4c63d73228fe4426ee5570393df3664334c3f6c784c2a12ae6e0ebbdb77d63d9a671907b0c4dfdb2adcea088b194c86e181a55f092976b9306567e807e4a24b3f190696dc6e25a618a3986db1f289d87bdb803ee45cc4117d95f24f683a46842470ff19f2ce16782e835d633e3bd86dcca04c8a5539e032d3740c747b82098f876c49314bc4da6f0c2da5db5295436e47c5919dfe1f1e2cc5428d678888aadf50b8ffc470da46b55a7bea31ee0ad3a7eb73f1dca4d6fee581576eb3ecc99e53d4c81c59c51a39322ef18d9c09887a56d1764c54f8d29a71ee201adf26a28bb3508df5b2957c029b44c72dc1a1b6b45107f8d759fe48ae78957e03bf34abf6034dd29a8da45374ae1babadefdbc6fdf94b78e4de1392859e5ce5118350a364b9155643693f5f88bcad7b5a18129909b2231571c1f4638c8d4a16f288119b63494670ab9cac4aefacb632c8092cc792d24af650535c31a81b323c8ef78b24108f00cdd941bf5772a31517747031e5a3e3e6f4e0075dad7edb2fe70ca2ed32521ed749fb6277fc6b41b703c301e23de43585ab4ea4f1b484e9181717d98b7187addecaab304ea7d5ef8046eb0d7c7b84acb29df17a83a6067b189415b4a5401d2b5e6c64261ee721fee238776eab21ca2386d10a23dc35a267f7c6bf61ae9e16946c76d5c4ae7790ba90435d20396fcd723182f1e032cec9d8ec1b693fafdcc2c2f74a50abe49cb880191dd510736395682cc6b36ccf813bfc188e8a0e02aed66b742d655facb60024898328a153b573394326c5ac8cfc1abe116f724d9426708e09a70b6dc718401463d883b4e5fc37bfb39746867df9f818ae4cdb18a532852fb014f691c46f29692199563dfe47149191ff4a2fd4f2ffb12438254c86ca1392ff2f75afdf5d35cfe9261c12657a4020ef702316dda2ca6b1a8c076fcd9ee52f761074700347b4db93b230481e46f1e73903953e54d314428fcdb743264aebe3d3179b0285de2c14fab9123600c0584f6244be6740e9dc942d988baa09331d5188bfb4d6836a64dedd5f9f0927660ff8521993c35e963323b797510f3cc6286cd38f5ed6e48b7def2d66582054dece47a8d627d1edf8b53da06415ebf562df14d8cbdcb18d75693f310331d59c9b020a8e1bfba6b6f4b12477ac10ded6272511250f8381728162c37b7c79215cb60e591fc836e14a3f8e02df2f224a6e7c00f909dcedfc3159a00994623dbbf7f1589ba3885b2fa531efe651e1b55e3c8d13290a1a17b301885f6bfc998c0a63155fa9acfeb1a75c86a71089ed81114aa21086b54af6b0161842355d4a8e19989c6e1c303db64e613b1d3bb2642dfd3db979c5b2cebd876c33a2dff45cdaa2cad42ad3ceffb0905f27c96e9409f60ddd82fd6c2ffe8595ce6e1c67fe413073e0f8260fb38a955420e9751b9d4f83017f32dc85bba0f76e077c3eb4ae9ddcb68caa31aca50842c4a17e0fcc88280d4becca43d4f8961cf78d98a633ab8316a17abf438e356e0ad744c546e054a04d6649b041f5ee081143e0655789aa2e05abe9abe4a2ec32ede966a7d62ff6704c46d13242d0b0b1dacffcb5b91e3d0e3965921b36d9c526aa7455e88d517c1a6febbc3e7d92c22e53364a9cc8dbf21108ab2ecb6a5ab0e501d542f0d9f1c523ea89722749fb5fac275acefc9dd73289471f2d67e2951a918b4c4e0568b0321f53724890eba83dfa7672b4be1bb989d24ad1321815273717ecedd2079297386afd692f92654f404b94baaeafd361b4f1b18ba018fb73f95a25c8948d74d8e42a3be09ae6972f4afa526d6a6893a234115444ea5c34346bd3109ddd83e81398eaad55f383d0222a7e28f4fe7c44b07cd0e7f75c8863c0fc63512d777b5e05c7f54da04708dea6ef08ed99fb5f5dd283fe8eed557f463cd8074dc609f82c9fc2188b6c580b81352f713f3569b19df0661813a69e50f16958f4a727220b8015ce5fc1d1dc3efee1a760ce98f8ebee5f54efb3d539db87dee4822c205586502e33058daab6d4de56a7de262e5368e774ae8d02a2c8a2895e301c6ad6e1dc66274232e4a361531df3a0c07cc8c14c43f97ca8def5512e165fa4cbeddff31deafb780f7528c5bd5cabbbd755291f62ac9a6a97a432e7665b178e79f39798a6bee2266fd80699a0fc5300b880158b619bf9ece0ac6be33c8f702609befd943cee718648442192691481b27fce7375eeb3bb8b24a2b03ff7066ad8ec00cdc4ed5f8e29eb6d69afb170b3cba7a66fd57e1847baa362f8e6c84e4d7559e3f92a4edcd1d090fac8b3e19df51f6692a62b6ef10b2b809af32ae65167be1dbdbdd5c3a85fb9c333cccfa6a1b4d9828262d5ffc5d691434232615e3f0370faec67940b258abce1ea7fdcd44bba734d768ec1eb7812ca97ff8ea2fee33b57c7af5f789ed4c5b2b9589c7036d32783565c2fe30c8fa7b095a21fbbd1d0173f613c77e4868289c01cad17dea273bd33b8f53df2e1c53fef55b841f8c3517d0c2f0dc0217fd2aca812adea797e4b44c5d0bc05206105090176d285db1162aac75a2b79e423778602809711ca747f55c12306c668c424b81c01fce4575e8317c9e267756bb5864be34fb29b7966704fc53321a0cbe2e465f1774d15f3496f86f3b52f9c80ba1ca5cc342779905a90e5ac5fb180fc5c26276e5066dcd441d8af5c82634d16835bf91011c7f535a789160229e40a3b7ce716ee413b045620d9387f5dfceb55ad523c7c45817cc4c5fdfc381e548bc4f0f493960b8fcc692e907bb7571cea4fb95dd7582cff5a12a01a3afbb582c481d2a86221cbd516604a69d093e05e6b6e4a7483698de44cd5d433d7611a987d88d7037c6cec03036bc60cf29a48df5e4cc20b94e414f1e4cbf72bddba13f293bbc738f25ed48c370901a5e9d8c766ad5af5d472325b20bd31d92170d79501b71d7a414171797bd0743fa33627e75337554b67bfe4a7391e42026c7ab286b108d030c2d22474e892057f5d7c120e6e2a4d2939a97fbc258750fbcfe8e6eb1645633f8be882175148307b9cc0f7ec52296dc080cb5266ae448eaa767cee417d2affa1e85cb15cbf8f08e2133958d7523692ed98af13151f56a27c692160f553a131cb41c4efa2db7cc0f4f388ee794c87b3622ac2256f814d4fdd1d28733c44752829df6b4ca0c7a54258f82f266847ae1ca96c0eb845ea611529541788985f4ff584de3733af7b6f15bfdb90b1cbd8f6bafe345f8b0b6f00bb6b4fec96ff41e8f4e71333341c30c2d45aff89c91337b75face23ac86b6025af9b30b68e31a793c2f3269b0ed66d96e9aedb42a7e1aca12f725c138d04906b55d52a7305bd74664781a4b1ded761d0460251b5c783ec1ac93d1951b448a7db6a315641d2152528b5238495b2afcf6b8af90dac42db916cfea35665149fb7975d89aafa1218cc556e261ca8ed1eb2cb54b4055671a34607baa7059d500f11007c6f498727a8af8e0f08b005538a9d775d47654d9c52c9c453ecef2c8f059e70cbe4a00139e0e47e6e784c9c510f68aa0455eb51c064f9f1368351b24bc1365fc5edbaf9e0c585e8f6463f53610136c338e9e4ac617ca00272545a9fc2aee94189ba2a1ed728bdd718bab1d2b08fd85bc8ac17a4d140a699eeb103e1064779077c8c4eff487ada33df3a0355c7be8d1ec2377c9c0c0e30f52086145a4a0157a1462baa73e59d9bf37591a240dbd53e9d403fdfe0fe27b46506726a30bf8f72e0de7b2136859e162dfd4e4fbe69f3db6b0c962f0a959752f61298500bea22c81107ff0bd549f16d2e6f94634b9b25867d0e0718c7a29bcd8f3f577f6de0a580e616636acab034485648283d53f10c6e2b7052b3e83dd21cc174ed8db9d439453d597145d1f70841444e30c8fd48ce7034302832857c4898bfd5645a972a755b66c59d43c9f92d30ef881b82064a1bddb0a5c0385e64d5cddcde2fd8c4f6c1b4369a0600ca785913a27e6a50d4e9796c92add86049423a356309f7e27546ed97c1c8c62ce66ce3032f677e327185be61b545173cb5f15d88158f37eb4eaacc944694eb4fd54789dc0462050099760b1990c851475e581a1d69dfa035b7bbb8ed1e872693314c8fb3d01a3c3bfcd9ed71f230d7de6793561a8d22edfa2149d173f6d0467cdc70735191ccb0a7b643785dc985d5483d08eb7798cf6c339aa89fbe80cc3e4b724ad2ebedf16f1c6c483bd013432414d0a218eb6f52818fbf71289a7edf8c23f0a8ca87cb8915a368c4b72f056f986888a8242ce838976611fff81c8488a9994cac229e3345b898777a79e1a7203c84e0833fefe97f3ea0d7acb59ab02eead15a877528976fe0c5b5f7a8d97ea1de8bde51b5dd47359b821c528a48c39c06a529f1bb43e0b2f526c6c8d4b32a3e3e4b29705712a8f6ff1d3fca0f6fcbbe066db66bd112d404a07c92385b8644a1a321e8a8b860354b8ab5c167b5e698a8412c713df52118953b5f71ed2177f5c9459926ee9ad29ccbc0d229652ccbf26fd85b24a40cb9cb89bfa0e855ec8e16d93081a1f71118e74c95ea17b34ae26ffa4e3b5d4211f7876b94731f25d9b3936ef675e0ab7d93c4c1de8e436f50f7c94840a1d499132fb761f1df4b3c28b7cd992f89a289eebbee909c884cba5725aa798133eed4d1884dab1e4eaa24ea4603300c5224d84cd4c569b4923d5e25d520de27e3588d56fab5c3e63a2ea9c9e228a7b5f9b8bea4f241e246ec0fd79123b3b156088dc4c432f6fa923f858e034b09e3c3e257f74ea33face0e8d58a70731f3a489128cd0e8efc0792e5a36b280bda10c43e3b7be2c2dae70dcb93c4b7e65adf2bb7d66f40d729c35e10ff94f54fa78a5dbbe398f2e24b0b03df2e015d68e09c4488ab8e41fdbd648df01498bebed5a878390f8d852f450d5026cbabca8878e0ff141fead3a1e3e5b1f4a2e9b8dbe6a9ce888e02235aaf3a101958b865a86ac5239cb247051b9a9666f812c34c76d63182990d0dd34d70bde8cf8ab1f93ee39a36b581f98dc6205db88e787ccbc4403ee6bae01e4ea6d8944b3e08fe107a5749c3f52ab785a831d1f02174476aea7cf076c0f03a122fa6a9e56a899fad7bfc3f47743b54999576187f041bd621284c38f566f016d811e66010d541e0cbd27f0474d1f521f410c18284f5931ce221b22059bfc1f929417b618e5f17ab1ed06bf2377ff6af125eebe346b4792e783fe0289bc253d894ea8d22209a21ba62a19c933b4b47e416a6e54d18055e9babc5bafa1d6e1598e26aafdc8474fb29669f05de4d2be4dda2d50287662c5b4bc44d2a4869c99f25848a0399975c6d63630ff091730966abe3351189d093440e01c9b8f675705770e0168367c8e8eace1a7c068502abca1e5644d39a474fd79ef5f7c0d0dc0bdf0e96e6e9d4863ee4aa86261b3a4ecd197814b3b339540843d970da076b81a97e6a4ad7da4d0729d956b13c1267472bc3e5fa81e2fe7534f93947cfd0646da8378d5f35e053b1835e2332d2a86aed6b9443c5b907e894629c2c700f0967e812657a934203bf48a9f086bae39f059c63e1b27d6b939f5e2680bce5c493a5f65300095ee7f05f4eff12c6da1905b723f6a0f8b97eccb2c095fda974a507d99f2360fb0af12af5bb4ece3921ec3d5a2eadc5ad58c1b85040c3e07f9130e9ffb452a26fb3538609d822f02be73a55a1825f8461df14f620a0694de3a0dd2ba75f216c4b993f8bcda4240db41686206462f1a6c6acd435a408b1fa4e9322d76156b13ffeca95d55310fb10846a7c59b2ef0d26a35c1a0e047677cfac432f730723db7747c63f98c45ae92408aa973272c20246f959987772e77f2f7b0ccb45f2cf2a3c32f055139d4fd247b0c636c478759402d8a0ef477adce5e99b278ddc4905eb0fcd2a03d33d02e85837f0c06aa14814a77317f8a0792f6a6f86291d6978dab029ed2e232320f0ee719108f0d4e09656f7489f40492128d683d0febc0f25a6d02965900482c5152a4256dd2d0c6ecb07a4b4ffc4c8c26e5ec32db92e91f0d062e7723d48f090e9004f83282a8cc93ab1b75a9da981dbaaf90017469f557af6203417c2209635c2c661db79550959ba07bac306d17a5518b5f04287e848f98a86806a81311287a8ff9ea1f0c1a366d5f0a568c3cfbdecd6a88a753af19ea5f1c2b8835b142cab1c5d65871c658611b5d0ce3d8513e8f8e59f45f59c6af0454b1a820784eacd9286a61d0fc806ef4989cf476cb2ab8f5165ac91bff378ca6de0e03c480bf3958f19617ef764f55b03a0a8e7bfad611259c73e861ac36649f163edc3a0661d00540a8091efe2851ffd301d3782d74795ca746b33b41a799e8a5b0572d60b74e8e519bdeb4bfef3b40a8365151ee68084f7d5097ee9df752913fd87f72278553f6f95812a840ed1ae4ecbe34604a092b4188b928a7e51eb549f24184115f971198e8286644a2745b5479dc1aee3ee1f3aa24a5a7934fe28242fe947485b563fd13e8288c4c89b42153f106bd978697537d81e9350343ba77440bcf8d557a281cff88e606721078a8dc3186799c42c41baae809e3622f78031839eae69a86dcb12539ceffc1707825d842cb40cbf0bb7838db63745d535f58e97a799319ff2bf67ab96ad84771a8ea90b20df89905116c67819d008c48c8ee83d7e22062bf6810b2d1c720e475c0e9a18aafc666ed52153edff2979b52086bd63d213f8baa8145cc66abd2d0a25936232d261b5d13a6b50b4e4055dd0138220eac508052bb23524693ea824bc93537a9e91639998a0abc7b1c66e55243e66078f49c2548b804fd40f4ae46af6d572a5bff48afe160ef14822f69c9e273d62c301e0bcd84b2d9317606188441a6b46f2b8ef3a11750a30eb5953aadc9c59b87ad275fa63af674f5811bb6839f1a3be0a9b008448db693d2f36f3866256d6bee05ec92219bb9240220cd670e9a58c5eafccb6a11adc9db889edd8cd5d1851c7febe782b8e777b40d193d0ad4583d2f3a10868b195a07a9d80a2c4945231ea5ef3e38483613f661ed54c6b0da532e0a7076a79644a948af70393ec1f412bfcbeee47cebdcd07b510b5d9f5dff6020c37e6c57261e391bdae583a9e0f6de8d32c7d0fc709b6af7f97887b0c4cd10747a10956f20cf72cc8cc9be6281a26f64135bb94da34f655f3c83b7c1b09ede14edaac8e4440d4a0341ef49346f2c4977c0e12d182c04d63acbabec3fdbd0d7ad15d4d543871a913b774d8a736e791aa9460a97a4a0063b2c14d818ade7da780347d537cd764bcf0edec287ba09b74c6b73529e2d441345ab6c49c305c01ca1b4051c53c8030a3566d3ead83df8ade651eb4586de91b2c0b152e6b19952be0de1678e33ca6a8678ceb40f38ad0e062583b3ac747ad26de1ba4e498c06e36bf6291f77ae166323f5da012ce14bf4748d495b0a65ae2aa1a65d478aaf0c45f8e25e64b50388af1d299eab48b8385bfd7166203a47017ca613b2d944ac66fc2604cb31998f8ab759460c7a5e8e7c6c83366add11de8ccdea05eed303bd891fe1bf0f6212e346557d97f7f5bcae137936f13b3ccafbf9fabe4e9558af71010fd614391e0e79fe339100259d3a8df785d4b0a471e62d8cb3aea3415f7b2a13b61a89f108a7bf7e1fc4068ea63697932c3fa9fee2169c637672c5f1b490ae77d3667d8500f46a442372970fb70c1ba2ed4cac6326935f4d8062c1bc0a2a6ac089b33252fc9ca596f800f7899e2b1ec63a309673c884f894cfb2ad179aeb22af2a1a29225bb06673476dfe1fa9fbb789c6425937b3cd12e29ebc1a02dc96ebfbfbe5bdc9746eb060d5d64cbfe23749c7907849c94662522e4167ddae788ca88d41167a3887c43615de76d23ecad5c0b54c0f2623a5f8fe762d97e107774dd49f3c1465698c9f2464e2e061e27fb2746897bdc3fea91d5c15b6fee753fe7e6a85c1378bd42e33ded4f889be385efe5a3f10c028a458c6afaceed15b62689ca670d9d080ed8eda7c5262554256fb4ea5770b9124774f58ff07f1e6bb1dff0f53bccfc093611b982b859dae21a98ca03b8fd265c5b21d406638c1702a5325226e43c692441be3e793d373d56f472e2a9b8fd3e740eb6045accdbec16ece218fe7785fce7128dd707a74fda0bfdd3834c1a724eb52f8b9632d114b3bbdc90c7ba0900e53ccfa8103f82e272bf9edcb328b8a1382d72a04be810f08f4e46ca9cf0e4799610c411db4c142258b1a15da9fbbe1f772054552af505ec00150ec0ab9e3257f16ffe5f4eb16940531dc115964a3ac1d69a16f731ce20a4c60f9646fe1b818ed7a4b2bf536f074b363c6dd681dd5651397afbd293398f29d21797019c192ecc1b7425a32d6ef581d948ea1239dbbd7882d971a879274781a19fcd561ea3eeb064141b41041b4a332eb00be61c80523c5ddb69b53d773d666411e9f1b14435f21ff0aefb06855d9a3eadf87fee4e7e3c050d722452e6b14b24adfef925ac55ba97fd95f41631806f850e108266d619d9b60c3a5fd7318ab76611fd83ae79282d93e863bb741e9455a548de128c043577f1c510791ff363c96ac261defedcb833c0fc55c3e1451be32f0b03ab5154f4d166f839e7d643a40939bd296931be8b18ad266e1435099ec1d23f09b6ddd2f92ee962480125cbd0cacc04dd4188b1d5f8b73a0e990d5a8cc7b46941530d89f33dd86a2b42b8c1fe3cdc467618001080c826b3337fe9bed834e714f74c9082b6c095bceab32a10889f5793eabbbb277c115974707e19c228db59524c4b02360f7a99685bdee6caf2837f80becd3f16821da6048338e702d6afd0732be92434cdf303252811fa17019daa52cb79001a6600278cea5af9cf826ec4beeb4c98b213cbd7880a9c889c176b0f1de1d170f3b098f4d005ac6d8eeab157f4ce97501b462d8cdfd38da0c7c262aa4d68ddf755f681164840993172568138274004a499007fe02b0d95d1c7b1bb40a73d1817ce2bf58cd4f0faaeb3e437ad980b9af1b59a4ffc5c3210042c2d480ebedfbd1506ea216dcd96cfaf405d0e9bdcc2ad02e839f550feaa105e10c9c9cb5a9454b57543fd23044acd67e9d14ab70cc54b8164e0013937d1ee417c675d73b835cf1f42ed9abfda601aef3a23c67b4fd0988dfd4e3dc7dc4ad2579c31a0f1ffc455f5b346b667647167dd85e9a8bf34af1e2290b7b5656458647a1</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>school</tag>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF986E Prince&#39;s Problem</title>
    <url>/2022/02/06/sol-cf986e/</url>
    <content><![CDATA[<h2 id="CF986E-Princeâ€™s-Problem"><a href="#CF986E-Princeâ€™s-Problem" class="headerlink" title="CF986E Princeâ€™s Problem"></a>CF986E Princeâ€™s Problem</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF986E">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æˆ‘ä¸ºä½•ç«Ÿç¬¬ä¸€æ—¶é—´æƒ³åˆ°æ ‘å‰–ï¼Ÿ</p>
<p>æ•°æ®ç»“æ„é¢˜åšå¤šäº†å±äºæ˜¯ã€‚å…¶å®æ ¹æœ¬æ²¡æœ‰ä¿®æ”¹æ“ä½œè¦ä¸ªPçš„æ ‘å‰–ï¼Œæ ‘ä¸Šå·®åˆ†ä¸å°±è¡Œäº†ã€‚å¥—è·¯åœ°å°†$(x,y)$æ‹†åˆ†æˆ$\frac{ans(x)\times ans(y)}{ans(lca(x,y))\times ans(fa[lca(x,y)])}$ï¼Œç„¶åå‘ç°å¯ä»¥ç¦»çº¿ä¸‹æ¥ä¸€è¾¹$dfs$ä¸€è¾¹æã€‚</p>
<p>å…·ä½“åœ°ï¼Œç”±äº$10^7$ä»¥å†…çš„è´¨æ•°åªæœ‰ä¸åˆ°$7\times 10^5$ä¸ªï¼Œæ‰€ä»¥åœ¨$dfs$æ—¶è®°å½•æ•°ç»„$num[p][k]$è¡¨ç¤ºæ ¹åˆ°å½“å‰èŠ‚ç‚¹$u$çš„è·¯å¾„ä¸ŠåŒ…å«è´¨å› å­$p$çš„æ¬¡æ•°ä¸º$k$çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚ç„¶åå¤„ç†è¯¢é—®ï¼Œæ˜¾ç„¶å¯ä»¥åšåˆ°åœ¨$O(n\log^2n+\omega)$çš„æ—¶é—´å¤æ‚åº¦å†…å®Œæˆã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF986E.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF986E</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXP = <span class="number">7e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXL = <span class="number">1e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">17</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGL = <span class="number">24</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="type">int</span> n, q, cnt, a[MAXN], ans[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % p)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x % p;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getinv</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">qpow</span>(x, p - <span class="number">2</span>, p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> cntp, pri[MAXP], fac[MAXL];</span><br><span class="line">bitset&lt;MAXL&gt; mark;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getprime</span><span class="params">(<span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">    mark = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= mx; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mark[i])</span><br><span class="line">            pri[++cntp] = i, fac[i] = cntp;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cntp; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i * pri[j] &gt; mx)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            mark[i * pri[j]] = <span class="literal">true</span>;</span><br><span class="line">            fac[i * pri[j]] = j;</span><br><span class="line">            <span class="keyword">if</span> (i % pri[j] == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; <span class="built_in">getfactors</span>(<span class="type">int</span> x) &#123;</span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; result;</span><br><span class="line">    <span class="keyword">while</span> (x &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> p = fac[x], c = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x % pri[p] == <span class="number">0</span>)</span><br><span class="line">            x /= pri[p], ++c;</span><br><span class="line">        result.<span class="built_in">push_back</span>(&#123;p, c&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dfc, dfn[MAXN], dep[MAXN], fa[MAXN][LOGN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    dfn[u] = ++dfc;</span><br><span class="line">    fa[u][<span class="number">0</span>] = f, dep[u] = dep[f] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; LOGN; ++i)</span><br><span class="line">        fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">build</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v])</span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">    <span class="type">int</span> t = dep[u] - dep[v];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((t &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            u = fa[u][i];</span><br><span class="line">    <span class="keyword">if</span> (u == v)</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> (fa[u][i] != fa[v][i])</span><br><span class="line">            u = fa[u][i], v = fa[v][i];</span><br><span class="line">    <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Query</span> &#123;</span><br><span class="line">    <span class="type">int</span> x, w, i, k;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Query&amp; o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dfn[x] &lt; dfn[o.x];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; query[MAXN * <span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> num[MAXP][LOGL];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span>&amp; cur)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> t : <span class="built_in">getfactors</span>(a[u]))</span><br><span class="line">        ++num[t.first][t.second];</span><br><span class="line">    <span class="keyword">while</span> (cur &lt;= cnt &amp;&amp; dfn[query[cur].x] &lt; dfn[u])</span><br><span class="line">        ++cur;</span><br><span class="line">    <span class="keyword">while</span> (cur &lt;= cnt &amp;&amp; query[cur].x == u) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> t : <span class="built_in">getfactors</span>(query[cur].w)) &#123;</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; t.second; ++i)</span><br><span class="line">                sum += num[t.first][i] * i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = t.second; i &lt; LOGL; ++i)</span><br><span class="line">                sum += num[t.first][i] * t.second;</span><br><span class="line">            <span class="keyword">if</span> (query[cur].k == <span class="number">1</span>)</span><br><span class="line">                (ans[query[cur].i] *= <span class="built_in">qpow</span>(pri[t.first], sum)) %= MOD;</span><br><span class="line">            <span class="keyword">if</span> (query[cur].k == <span class="number">-1</span>)</span><br><span class="line">                (ans[query[cur].i] *= <span class="built_in">getinv</span>(<span class="built_in">qpow</span>(pri[t.first], sum))) %= MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        ++cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == fa[u][<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(v, cur);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> t : <span class="built_in">getfactors</span>(a[u]))</span><br><span class="line">        --num[t.first][t.second];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">debug</span>(<span class="string">&quot;Memory used: %.5lfMB.&quot;</span>, (&amp;m_ed - &amp;m_be) / <span class="number">1024.0</span> / <span class="number">1024.0</span>);</span><br><span class="line">    <span class="built_in">getprime</span>(<span class="number">1e7</span>);</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> x, y, w;</span><br><span class="line">        <span class="built_in">read</span>(x), <span class="built_in">read</span>(y), <span class="built_in">read</span>(w);</span><br><span class="line">        <span class="type">int</span> p = <span class="built_in">lca</span>(x, y);</span><br><span class="line">        query[++cnt] = &#123;x, w, i, <span class="number">1</span>&#125;;</span><br><span class="line">        query[++cnt] = &#123;y, w, i, <span class="number">1</span>&#125;;</span><br><span class="line">        query[++cnt] = &#123;p, w, i, <span class="number">-1</span>&#125;;</span><br><span class="line">        query[++cnt] = &#123;fa[p][<span class="number">0</span>], w, i, <span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(query + <span class="number">1</span>, query + cnt + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">fill</span>(ans + <span class="number">1</span>, ans + q + <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, *<span class="keyword">new</span> <span class="built_in">int</span>(<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans[i]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P6095 [JSOI2015] ä¸²åˆ†å‰²</title>
    <url>/2022/02/05/sol-p6095/</url>
    <content><![CDATA[<h2 id="P6095-JSOI2015-ä¸²åˆ†å‰²"><a href="#P6095-JSOI2015-ä¸²åˆ†å‰²" class="headerlink" title="P6095 [JSOI2015] ä¸²åˆ†å‰²"></a>P6095 [JSOI2015] ä¸²åˆ†å‰²</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P6095">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ˜¾ç„¶åˆ†å‰²çš„ä¸²é•¿åº¦ä¸æ˜¯$\lceil \frac{n}{k} \rceil$å°±æ˜¯$\lfloor \frac{n}{k} \rfloor$ã€‚</p>
<p>ä¸å¦¨å…ˆç ´ç¯ä¸ºé“¾ï¼Œå»ºç«‹åç¼€æ•°ç»„å¹¶äºŒåˆ†æœ€å¤§å€¼åç¼€çš„æ’å$mx$ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½å°†$n$ä¸ªæ•°åˆ’åˆ†æˆ$k$æ®µä½¿å¾—æ¯æ®µéƒ½$\le mx$ã€‚</p>
<p>é¦–å…ˆæšä¸¾èµ·å§‹ä½ç½®ï¼Œè®¾$len=\lceil \frac{n}{k} \rceil$ï¼Œåˆ™ä¸€å…±æœ€å¤šæœ‰$len$ä¸ªèµ·å§‹ä½ç½®ï¼Œç„¶åæ¯æ¬¡è´ªå¿ƒåœ°åˆ’åˆ†ï¼Œå‡è®¾å½“å‰ä»$cur$ä½ç½®å¼€å§‹åˆ’åˆ†ï¼Œå¦‚æœ$s[curâ€¦cur+len-1]\le mx$åˆ™åˆ’åˆ†$len$ä¸ªï¼Œå¦åˆ™åˆ’åˆ†$len-1$ä¸ªã€‚é‡å¤$k$æ¬¡çœ‹åˆ’åˆ†çš„æ€»é•¿åº¦æ˜¯å¦$\ge n$ã€‚åˆ¤æ–­çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(len \times \frac{n}{len})=O(n)$ã€‚</p>
<p>æ€è€ƒè¿™ç§è´ªå¿ƒçš„æ­£ç¡®æ€§ã€‚å¦‚æœå‰ä¸€æ¬¡åˆ’åˆ†$len$ä¸ªï¼Œåä¸€æ¬¡ç”±äº$\gt mx$å¯¼è‡´åªåˆ’åˆ†äº†$len-1$ä¸ªï¼Œæ€»å…±å°±åˆ’åˆ†äº†$2\times len-1$ä¸ªï¼Œå®¹æ˜“å‘ç°è¿™æ ·å’Œå…ˆåˆ’åˆ†$len-1$ä¸ªå†åˆ’åˆ†$len$ä¸ªæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æ­£ç¡®æ€§æ˜¾ç„¶ã€‚æ•…æ­¤é—®é¢˜èƒ½å¤Ÿåœ¨$O(n\log n)$çš„æ—¶é—´å¤æ‚åº¦å†…è§£å†³ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P6095.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P6095</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">6e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">19</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], he[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            he[rk[i]] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa;</span><br><span class="line"><span class="type">int</span> n, k, ln;</span><br><span class="line"><span class="type">int</span> lg2[MAXN], st[MAXN][LOGN];</span><br><span class="line"><span class="type">char</span> str[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getlcp</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; r)</span><br><span class="line">        <span class="built_in">swap</span>(l, r);</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="type">int</span> k = lg2[r - l];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(st[l + <span class="number">1</span>][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">comp_lesseq</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> lcp = <span class="built_in">getlcp</span>(x, y);</span><br><span class="line">    <span class="keyword">if</span> (lcp &gt;= len)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> str[sa.sa[x] + lcp] &lt;= str[sa.sa[y] + lcp];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> st = <span class="number">1</span>; st &lt;= ln; ++st) &#123;</span><br><span class="line">        <span class="type">int</span> cur = st;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">comp_lesseq</span>(sa.rk[cur], mx, ln))</span><br><span class="line">                cur += ln;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                cur += ln - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cur &gt;= st + n)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">copy</span>(str + <span class="number">1</span>, str + n + <span class="number">1</span>, str + n + <span class="number">1</span>);</span><br><span class="line">    sa.<span class="built_in">init</span>(n + n, str);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n + n; ++i)</span><br><span class="line">        lg2[i] = (i &amp; (i - <span class="number">1</span>)) ? lg2[i - <span class="number">1</span>] : lg2[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n + n; ++i)</span><br><span class="line">        st[i][<span class="number">0</span>] = sa.he[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; LOGN; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n + n; ++i)</span><br><span class="line">            st[i][j] = <span class="built_in">min</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">    ln = (n - <span class="number">1</span>) / k + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">1</span>, r = n + n, ans = r;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(mid))</span><br><span class="line">            r = mid - <span class="number">1</span>, ans = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ln; ++i)</span><br><span class="line">        <span class="built_in">putchar</span>(str[sa.sa[ans] + i]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4770 [NOI2018] ä½ çš„åå­—</title>
    <url>/2022/02/05/sol-p4770/</url>
    <content><![CDATA[<h2 id="P4770-NOI2018-ä½ çš„åå­—"><a href="#P4770-NOI2018-ä½ çš„åå­—" class="headerlink" title="P4770 [NOI2018] ä½ çš„åå­—"></a>P4770 [NOI2018] ä½ çš„åå­—</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4770">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å®¹æ˜“æƒ³åˆ°ç¦»çº¿åç”¨åç¼€æ•°ç»„è§£å†³ã€‚<del>ï¼ˆå’±å°±æ˜¯è¯´èƒ½ç”¨SAçš„å°±ä¸ç”¨SAMï¼‰</del></p>
<p>ä¹‹åå¯¹äºæ¯ä¸ªè¯¢é—®ä¸²ï¼Œæšä¸¾å…¶æ¯ä¸ªåç¼€$i$ï¼Œæ³¨æ„åˆ°å¯ä»¥äºŒåˆ†ä¸€ä¸ªæœ€å¤§çš„å‡ºç°è¿‡çš„å­ä¸²$lcp$é•¿åº¦$len$ï¼Œåœ¨SAä¸ŠäºŒåˆ†å‡ºå·¦å³ç«¯ç‚¹ï¼Œç„¶ååœ¨ä¸»å¸­æ ‘ä¸Šåˆ¤æ–­åŒºé—´$[l,r-len+1]$ä¸­æ˜¯å¦å­˜åœ¨$lcp\ge len$çš„æ•°å°±å¥½ã€‚è¿™æ ·æ—¶é—´å¤æ‚åº¦æ˜¯$O(n\log^2n)$çš„ã€‚ä½†æ˜¯$10^6$çš„æ•°æ®è‚¯å®šä¸èƒ½é€šè¿‡ã€‚</p>
<p>é‚£ä¹ˆï¼Œæ—¢ç„¶æ˜¯äºŒåˆ†+ä¸»å¸­æ ‘ï¼Œèƒ½å¦åœ¨ä¸»å¸­æ ‘ä¸ŠäºŒåˆ†å‘¢ï¼Ÿäº‹å®ä¸Šæ˜¯å¯ä»¥çš„ã€‚æ‰€ä»¥å¤æ‚åº¦ç¬é—´é™ä¸‹ä¸€ä¸ª$\log n$ï¼ŒåŒæ—¶å†™èµ·æ¥æ›´åŠ éº»çƒ¦äº†ã€‚ç„¶è€Œè¿™ç§æ–¹æ³•è¿‡äºå¤æ‚äº†ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰å®Œå…¨çœ‹æ‡‚ã€‚æœ‰æ²¡æœ‰æ›´åŠ é€šä¿—æ˜“æ‡‚çš„å•$\log$å†™æ³•å‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯æœ‰çš„ã€‚æŒ‰é¡ºåºæšä¸¾æ¯ä¸ªåç¼€ã€‚å¦‚æœ$i$ä½ç½®çš„é•¿åº¦ä¸º$len$ï¼Œé‚£ä¹ˆ$i+1$ä½ç½®çš„é•¿åº¦æœ€å°ä¸º$len-1$ï¼ŒåŸç†å’Œåç¼€$height$æ•°ç»„ç›¸åŒã€‚è¿™æ ·æš´åŠ›è‹¥å¹²æ¬¡$+1$å¹¶ç”¨ä¸»å¸­æ ‘åˆ¤æ–­ï¼Œä¸€æ³¢åŠ¿èƒ½åˆ†æä¸‹æ¥å°±æ˜¯$O(n\log n)$çš„ã€‚å°½ç®¡å¦‚æ­¤ä½†å¸¸æ•°å·¨å¤§ï¼Œæ‰€ä»¥èƒ½çœ‹æ‡‚ä¸»å¸­æ ‘äºŒåˆ†çš„å°±å°½é‡å†™ä¸»å¸­æ ‘äºŒåˆ†å§ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4770.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4770</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">21</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], he[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            he[rk[i]] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="type">int</span> sum, ls, rs;</span><br><span class="line">    &#125; nd[MAXN * <span class="number">25</span>];</span><br><span class="line">    <span class="type">int</span> tot, rt[MAXN];</span><br><span class="line">    <span class="type">int</span> &amp;<span class="keyword">operator</span>[](<span class="type">int</span> i) &#123; <span class="keyword">return</span> rt[i]; &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123; <span class="keyword">return</span> nd[++tot] = nd[i], tot; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> &amp;i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> q, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        i = <span class="built_in">newnode</span>(i);</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">void</span>(nd[i].sum += v);</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (q &lt;= mid)</span><br><span class="line">            <span class="built_in">update</span>(nd[i].ls, l, mid, q, v);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">update</span>(nd[i].rs, mid + <span class="number">1</span>, r, q, v);</span><br><span class="line">        nd[i].sum = nd[nd[i].ls].sum + nd[nd[i].rs].sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">            <span class="keyword">return</span> nd[v].sum - nd[u].sum;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            ret += <span class="built_in">query</span>(nd[u].ls, nd[v].ls, l, mid, ql, qr);</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            ret += <span class="built_in">query</span>(nd[u].rs, nd[v].rs, mid + <span class="number">1</span>, r, ql, qr);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sgt;</span><br><span class="line"><span class="type">int</span> n, m, q;</span><br><span class="line"><span class="type">int</span> typ[MAXN], pre[MAXN], nxt[MAXN], lst[MAXN];</span><br><span class="line"><span class="type">int</span> lg2[MAXN], st[MAXN][LOGN];</span><br><span class="line"><span class="type">int</span> ps[MAXN], ln[MAXN], ls[MAXN], rs[MAXN];</span><br><span class="line"><span class="type">char</span> s[MAXN], buf[MAXN], str[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getlcp</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="type">int</span> k = lg2[r - l];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(st[l + <span class="number">1</span>][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> lt, <span class="type">int</span> rt, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l, r, cl, cr;</span><br><span class="line">    l = <span class="number">1</span>, r = p, cl = p;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">getlcp</span>(mid, p) &gt;= len)</span><br><span class="line">            r = mid - <span class="number">1</span>, cl = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    l = p, r = m;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">getlcp</span>(p, mid) &gt;= len)</span><br><span class="line">            l = mid + <span class="number">1</span>, cr = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sgt.<span class="built_in">query</span>(sgt[lt - <span class="number">1</span>], sgt[rt - len + <span class="number">1</span>], <span class="number">1</span>, m, cl, cr) &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">read</span>(q);</span><br><span class="line">    m = n + <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">copy</span>(s + <span class="number">1</span>, s + n + <span class="number">1</span>, str + <span class="number">1</span>);</span><br><span class="line">    str[n + <span class="number">1</span>] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        <span class="built_in">read</span>(ls[i]), <span class="built_in">read</span>(rs[i]);</span><br><span class="line">        ln[i] = <span class="built_in">strlen</span>(buf);</span><br><span class="line">        <span class="built_in">copy</span>(buf, buf + ln[i], str + m);</span><br><span class="line">        str[m + ln[i]] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">        <span class="built_in">fill</span>(typ + m, typ + m + ln[i], i);</span><br><span class="line">        ps[i] = m, m += ln[i] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sa.<span class="built_in">init</span>(m, str);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        sgt.<span class="built_in">update</span>(sgt[i] = sgt[i - <span class="number">1</span>], <span class="number">1</span>, m, sa.rk[i], <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= m; ++i)</span><br><span class="line">        lg2[i] = lg2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        st[i][<span class="number">0</span>] = sa.he[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; LOGN; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= m; ++i)</span><br><span class="line">            st[i][j] = <span class="built_in">min</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        pre[i] = lst[typ[sa.sa[i]]];</span><br><span class="line">        nxt[lst[typ[sa.sa[i]]]] = i;</span><br><span class="line">        lst[typ[sa.sa[i]]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> tt = <span class="number">1</span>; tt &lt;= q; ++tt) &#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= ln[tt]; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> len = <span class="built_in">min</span>(rs[tt] - ls[tt] + <span class="number">1</span>, ps[tt] + ln[tt] - i);</span><br><span class="line">            <span class="type">int</span> p = sa.rk[i + ps[tt] - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (k &lt; len &amp;&amp; <span class="built_in">check</span>(p, ls[tt], rs[tt], k + <span class="number">1</span>))</span><br><span class="line">                k++;</span><br><span class="line">            ans += ln[tt] - i + <span class="number">1</span> - <span class="built_in">max</span>(k, <span class="built_in">getlcp</span>(pre[p], p));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3900 [æ¹–å—é›†è®­] å›¾æ£®</title>
    <url>/2022/02/05/sol-p3900/</url>
    <content><![CDATA[<h2 id="P3900-æ¹–å—é›†è®­-å›¾æ£®"><a href="#P3900-æ¹–å—é›†è®­-å›¾æ£®" class="headerlink" title="P3900 [æ¹–å—é›†è®­] å›¾æ£®"></a>P3900 [æ¹–å—é›†è®­] å›¾æ£®</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3900">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä»£ç æå…¶æ¶å¿ƒï¼Œæ‰€ä»¥ç®€å•å†™ä¸‹æ€è·¯ã€‚</p>
<p>åŸºæœ¬æ€è·¯æ˜¯$dp$å’Œå»ºå›¾ã€‚é¦–å…ˆå°†æ‰€æœ‰ä¸²æ­£å‘å’Œåå‘ä¸²èµ·æ¥ï¼Œè¿™æ ·$dp[i]$å°±è¡¨ç¤ºå½“å‰å›æ–‡ä¸²çš„å…¶ä¸­ä¸€è¾¹æ‹“å±•åˆ°äº†ç«¯ç‚¹ï¼Œå¦ä¸€è¾¹æ‹“å±•åˆ°$i$çš„ä½ç½®ã€‚å¾€åè½¬ç§»åªè¦æšä¸¾åœ¨å…¶ä¸­ä¸€è¾¹åŠ ä¸Šå“ªä¸ªå°ä¸²ï¼Œç”¨åç¼€æ•°ç»„$O(1)$æ‰¾åˆ°èƒ½æ‹“å±•å‡ ä½ã€‚å°†è¿™ä¸ª$dp$çš„è½¬ç§»å»ºå›¾ï¼Œå¦‚æœä¸æ˜¯DAGåˆ™æ˜¾ç„¶æœ‰æ— é™é•¿åº¦ï¼Œè¾“å‡º<code>Infinity</code>ã€‚å¦åˆ™åœ¨ä¸Šé¢åšDAGæœ€é•¿è·¯å³å¯ã€‚æ—¶é—´å¤æ‚åº¦$O(n^2L)$ã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯ç‰¹æ®Šå¤„ç†ã€‚é¦–å…ˆæ˜¯åˆå§‹çŠ¶æ€ï¼Œéœ€è¦æ‰¾å‡ºæ¯ä¸ªå°ä¸²çš„å‰ç¼€å›æ–‡ä¸²å’Œåç¼€å›æ–‡ä¸²ã€‚è¿™ä¸ªç”¨SAä¼¼ä¹å¯ä»¥æš´åŠ›åšã€‚å…¶æ¬¡æ˜¯å›¾çš„è¾¹é›†$E$çš„å¤§å°ï¼Œåº”å½“äºæ—¶é—´å¤æ‚åº¦åŒé˜¶ï¼Œæ˜¾ç„¶ä¸å¯èƒ½å­˜ä¸‹æ¥ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ¯æ¬¡åšDAGæ—¶æ±‚ä¸€è¾¹è¾¹é›†ï¼Œè¿™æ ·å°±ä¿è¯ç©ºé—´å¤æ‚åº¦ä¸ä¼šå¤ªé«˜ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œä½ è¿˜éœ€è¦è®¡ç®—æ¯ä¸ªå°ä¸²ä¸­åŒ…å«çš„æœ€é•¿å›æ–‡ä¸²ã€‚ã€‚ã€‚ä¸ç„¶åªæœ‰$90pts$ï¼ˆåˆ«é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„ï¼‰ã€‚æ‰€ä»¥å†å†™ä¸ªmanacherå§ã€‚</p>
<p>ä¸‹é¢æ”¾å‡ºæˆ‘<del>shitä¸€æ ·</del>çš„ä»£ç </p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3900.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3900</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">120</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGM = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXM], rk[MAXM], tp[MAXM], he[MAXM];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXM];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            he[rk[i]] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa;</span><br><span class="line"><span class="type">int</span> n, m, tot, cnt, ans;</span><br><span class="line"><span class="type">int</span> fr[MAXN], bk[MAXN], ln[MAXN];</span><br><span class="line"><span class="type">int</span> lg2[MAXM], st[MAXM][LOGM];</span><br><span class="line"><span class="type">int</span> id[MAXM], dis[MAXM], deg[MAXM];</span><br><span class="line"><span class="type">char</span> buf[MAXM], str[MAXM];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; palfr[MAXN], palbk[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getlcp</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = sa.rk[x], r = sa.rk[y];</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">        <span class="built_in">swap</span>(l, r);</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="type">int</span> k = lg2[r - l];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(st[l + <span class="number">1</span>][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">findedges</span><span class="params">(<span class="type">int</span> i, function&lt;<span class="type">void</span>(<span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>)&gt; addedge)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> l : palfr[j])</span><br><span class="line">                <span class="built_in">addedge</span>(i, fr[j] + l, l);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> l : palbk[j])</span><br><span class="line">                <span class="built_in">addedge</span>(i, bk[j] + l, l);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i &gt; m || str[i] == <span class="string">&#x27;$&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">upper_bound</span>(fr + <span class="number">1</span>, fr + n + <span class="number">1</span>, i) - fr - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; bk[t]) &#123;</span><br><span class="line">        <span class="type">int</span> len = ln[t] - (i - fr[t]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="type">int</span> lcp = <span class="built_in">min</span>(&#123;len, ln[j], <span class="built_in">getlcp</span>(i, bk[j])&#125;);</span><br><span class="line">            <span class="keyword">if</span> (lcp == len &amp;&amp; lcp == ln[j]) &#123;</span><br><span class="line">                <span class="built_in">addedge</span>(i, <span class="number">0</span>, lcp * <span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (lcp == len) &#123;</span><br><span class="line">                <span class="built_in">addedge</span>(i, bk[j] + lcp, lcp * <span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (lcp == ln[j]) &#123;</span><br><span class="line">                <span class="built_in">addedge</span>(i, i + lcp, lcp * <span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">addedge</span>(i, m + <span class="number">1</span>, lcp * <span class="number">2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">int</span> len = ln[t] - (i - bk[t]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="type">int</span> lcp = <span class="built_in">min</span>(&#123;len, ln[j], <span class="built_in">getlcp</span>(i, fr[j])&#125;);</span><br><span class="line">            <span class="keyword">if</span> (lcp == len &amp;&amp; lcp == ln[j]) &#123;</span><br><span class="line">                <span class="built_in">addedge</span>(i, <span class="number">0</span>, lcp * <span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (lcp == len) &#123;</span><br><span class="line">                <span class="built_in">addedge</span>(i, fr[j] + lcp, lcp * <span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (lcp == ln[j]) &#123;</span><br><span class="line">                <span class="built_in">addedge</span>(i, i + lcp, lcp * <span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">addedge</span>(i, m + <span class="number">1</span>, lcp * <span class="number">2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">manacher</span><span class="params">(<span class="type">char</span>* s, <span class="type">int</span> tlen)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> d[MAXM];</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> t[MAXM];</span><br><span class="line">    <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tlen; ++i)</span><br><span class="line">        t[++len] = <span class="string">&#x27;#&#x27;</span>, t[++len] = s[i];</span><br><span class="line">    t[++len] = <span class="string">&#x27;#&#x27;</span>, t[++len] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">    <span class="type">int</span> mx = <span class="number">0</span>, id = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i) &#123;</span><br><span class="line">        d[i] = mx &gt; i ? <span class="built_in">min</span>(d[id * <span class="number">2</span> - i], mx - i) : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (t[i + d[i]] == t[i - d[i]])</span><br><span class="line">            ++d[i];</span><br><span class="line">        <span class="keyword">if</span> (i + d[i] &gt; mx)</span><br><span class="line">            mx = i + d[i], id = i;</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, d[i] - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), m = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        <span class="type">int</span> t = ln[i] = <span class="built_in">strlen</span>(buf);</span><br><span class="line">        <span class="built_in">copy</span>(buf, buf + t, str + m);</span><br><span class="line">        fr[i] = m, str[m + t] = <span class="string">&#x27;$&#x27;</span>, m += t + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">reverse</span>(buf, buf + t);</span><br><span class="line">        <span class="built_in">copy</span>(buf, buf + t, str + m);</span><br><span class="line">        bk[i] = m, str[m + t] = <span class="string">&#x27;$&#x27;</span>, m += t + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    str[m] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">    sa.<span class="built_in">init</span>(m, str);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= m; ++i)</span><br><span class="line">        lg2[i] = (i &amp; (i - <span class="number">1</span>)) ? lg2[i - <span class="number">1</span>] : lg2[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        st[i][<span class="number">0</span>] = sa.he[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; LOGM; ++j) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= m; ++i) &#123;</span><br><span class="line">            st[i][j] = <span class="built_in">min</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        palfr[i].<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        palfr[i].<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j + j &lt;= ln[i]; ++j) &#123;</span><br><span class="line">            <span class="type">int</span> p1 = fr[i] + j, p2 = bk[i] + (ln[i] - j);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">getlcp</span>(p1, p2) &gt;= j)</span><br><span class="line">                palfr[i].<span class="built_in">push_back</span>(j + j);</span><br><span class="line">            <span class="keyword">if</span> (j + j &lt; ln[i]) &#123;</span><br><span class="line">                p1 = fr[i] + j + <span class="number">1</span>, p2 = bk[i] + (ln[i] - j);</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">getlcp</span>(p1, p2) &gt;= j)</span><br><span class="line">                    palfr[i].<span class="built_in">push_back</span>(j + j + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        palbk[i].<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        palbk[i].<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j + j &lt;= ln[i]; ++j) &#123;</span><br><span class="line">            <span class="type">int</span> p1 = bk[i] + j, p2 = fr[i] + (ln[i] - j);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">getlcp</span>(p1, p2) &gt;= j)</span><br><span class="line">                palbk[i].<span class="built_in">push_back</span>(j + j);</span><br><span class="line">            <span class="keyword">if</span> (j + j &lt; ln[i]) &#123;</span><br><span class="line">                p1 = bk[i] + j + <span class="number">1</span>, p2 = fr[i] + (ln[i] - j);</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">getlcp</span>(p1, p2) &gt;= j)</span><br><span class="line">                    palbk[i].<span class="built_in">push_back</span>(j + j + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="built_in">findedges</span>(i, [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            ++deg[v];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m + <span class="number">1</span>; ++i)</span><br><span class="line">        <span class="keyword">if</span> (!deg[i])</span><br><span class="line">            que.<span class="built_in">push</span>(i);</span><br><span class="line">    <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> i = que.<span class="built_in">front</span>();</span><br><span class="line">        id[++cnt] = i, que.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">findedges</span>(i, [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (--deg[v] == <span class="number">0</span>)</span><br><span class="line">                que.<span class="built_in">push</span>(v);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m + <span class="number">1</span>; ++i)</span><br><span class="line">        <span class="keyword">if</span> (deg[i])</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Infinity&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">-0x3f</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    dis[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> x = id[i];</span><br><span class="line">        <span class="built_in">findedges</span>(x, [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            dis[v] = <span class="built_in">max</span>(dis[v], dis[u] + w);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    ans = dis[m + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, <span class="built_in">manacher</span>(str + fr[i] - <span class="number">1</span>, ln[i]));</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P1117 [NOI2016] ä¼˜ç§€çš„æ‹†åˆ†</title>
    <url>/2022/02/04/sol-p1117/</url>
    <content><![CDATA[<h2 id="P1117-NOI2016-ä¼˜ç§€çš„æ‹†åˆ†"><a href="#P1117-NOI2016-ä¼˜ç§€çš„æ‹†åˆ†" class="headerlink" title="P1117 [NOI2016] ä¼˜ç§€çš„æ‹†åˆ†"></a>P1117 [NOI2016] ä¼˜ç§€çš„æ‹†åˆ†</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P1117">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>$O(n^2)$æš´åŠ›+$hash$èƒ½æ‹¿$95pts$ã€‚</p>
<p>ä½†æ˜¾ç„¶æˆ‘ä»¬ä¸æ»¡è¶³äºè¿™$95pts$ï¼Œè€ƒè™‘å¦‚ä½•ä¼˜åŒ–è¿™ä¸ª$O(n^2)$ï¼Œå³æ›´å¿«åœ°æ±‚å‡ºæ¯ä¸ªä½ç½®å¯¹åº”çš„<code>AA</code>ä¸²æ•°é‡ã€‚</p>
<p>è€ƒè™‘æšä¸¾<code>A</code>ä¸²çš„é•¿åº¦$len$ï¼Œå¹¶ä¸”æ¯éš”$len$ä¸ªå­—ç¬¦åˆ†å‰²ä¸€æ¬¡ï¼Œè¿™æ ·æ¯ä¸€æ¡é•¿åº¦ä¸º$len\times 2$çš„<code>AA</code>ä¸²éƒ½ç»è¿‡äº†è‡³å°‘$2$ä¸ªåˆ†éš”ç¬¦ï¼Œäºæ˜¯è€ƒè™‘ä»åˆ†éš”ç¬¦å‘ä¸¤è¾¹æ‹“å±•å³å¯ï¼Œç”¨åç¼€æ•°ç»„è®¡ç®—ã€‚æ—¶é—´å¤æ‚åº¦$O(n\log n)$ã€‚</p>
<p>é¬¼çŸ¥é“æˆ‘è°ƒäº†å¤šä¹…ï¼ˆå…·ä½“çœ‹ä»£ç å§ï¼‰ã€‚<strong>SAå¤šæ¬¡ä½¿ç”¨ä¸€å®šè¦æ¸…ç©ºï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚</strong></p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P1117.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P1117</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">3e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">16</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], he[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(sa, sa + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(rk, rk + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(tp, tp + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(he, he + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        n = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            he[rk[i]] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa, pa;</span><br><span class="line"><span class="type">int</span> n, a[MAXN], b[MAXN], lg2[MAXN];</span><br><span class="line"><span class="type">int</span> smn[MAXN][LOGN], pmn[MAXN][LOGN];</span><br><span class="line"><span class="type">char</span> s[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getlcs</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">        <span class="built_in">swap</span>(l, r);</span><br><span class="line">    <span class="type">int</span> k = lg2[r - l];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(smn[l + <span class="number">1</span>][k], smn[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getlcp</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">        <span class="built_in">swap</span>(l, r);</span><br><span class="line">    <span class="type">int</span> k = lg2[r - l];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(pmn[l + <span class="number">1</span>][k], pmn[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> tt;</span><br><span class="line">    <span class="built_in">read</span>(tt);</span><br><span class="line">    <span class="keyword">while</span> (tt--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">        n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        sa.<span class="built_in">init</span>(n, s);</span><br><span class="line">        <span class="built_in">reverse</span>(s + <span class="number">1</span>, s + n + <span class="number">1</span>);</span><br><span class="line">        pa.<span class="built_in">init</span>(n, s);</span><br><span class="line">        <span class="built_in">reverse</span>(s + <span class="number">1</span>, s + n + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(a, a + n + <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(b, b + n + <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">            lg2[i] = (i &amp; (i - <span class="number">1</span>)) ? lg2[i - <span class="number">1</span>] : lg2[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            smn[i][<span class="number">0</span>] = sa.he[i];</span><br><span class="line">            pmn[i][<span class="number">0</span>] = pa.he[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; LOGN; ++j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; ++i) &#123;</span><br><span class="line">                smn[i][j] = <span class="built_in">min</span>(smn[i][j - <span class="number">1</span>], smn[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">                pmn[i][j] = <span class="built_in">min</span>(pmn[i][j - <span class="number">1</span>], pmn[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x + x &lt;= n; ++x) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> sr = x + <span class="number">1</span>; sr &lt;= n; sr += x) &#123;</span><br><span class="line">                <span class="type">int</span> sl = sr - x;</span><br><span class="line">                <span class="type">int</span> pl = n - sr + <span class="number">1</span>, pr = n - sl + <span class="number">1</span>;</span><br><span class="line">                <span class="type">int</span> pre = <span class="built_in">getlcp</span>(pa.rk[pl], pa.rk[pr]);</span><br><span class="line">                <span class="type">int</span> nxt = <span class="built_in">getlcs</span>(sa.rk[sl], sa.rk[sr]);</span><br><span class="line">                pre = <span class="built_in">min</span>(pre, x), nxt = <span class="built_in">min</span>(nxt, x);</span><br><span class="line">                <span class="keyword">if</span> (pre + nxt &gt; x) &#123;</span><br><span class="line">                    a[sr - pre + x]++, a[sr + nxt]--;</span><br><span class="line">                    b[sl - pre]--, b[sl + nxt - x]++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            a[i] += a[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            b[i] += b[i + <span class="number">1</span>];</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">            ans += a[i] * b[i + <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        sa.<span class="built_in">clear</span>(), pa.<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4094 [HEOI2016/TJOI2016] å­—ç¬¦ä¸²</title>
    <url>/2022/02/04/sol-p4094/</url>
    <content><![CDATA[<h2 id="P4094-HEOI2016-TJOI2016-å­—ç¬¦ä¸²"><a href="#P4094-HEOI2016-TJOI2016-å­—ç¬¦ä¸²" class="headerlink" title="P4094 [HEOI2016/TJOI2016] å­—ç¬¦ä¸²"></a>P4094 [HEOI2016/TJOI2016] å­—ç¬¦ä¸²</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4094">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ç­”æ¡ˆå…·æœ‰äºŒåˆ†æ€§ï¼Œè€ƒè™‘å…ˆäºŒåˆ†ç­”æ¡ˆ$len$å¹¶åˆ¤æ–­ã€‚</p>
<p>åˆ¤æ–­æ—¶åœ¨$height$æ•°ç»„ä¸ŠäºŒåˆ†å‡º$cl \le rk[c] \le cr$ä¸¤ä¸ªç«¯ç‚¹ï¼Œä½¿å¾—$lcp(cl, cr) \ge len$ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦æœ‰$i$ä½¿å¾—$i \in [a, b - len + 1]$ä¸”$rk[i] \in [cl, cr]$ï¼Œæ˜¾ç„¶å¯ä»¥ç”¨ä¸»å¸­æ ‘ç»´æŠ¤æŸ¥è¯¢ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \log^2 n)$ï¼Œå¸¸æ•°å¹¶ä¸å°ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4094.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4094</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">19</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN], he[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = he[rk[i]] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="type">int</span> sum, ls, rs;</span><br><span class="line">    &#125; nd[MAXN * <span class="number">25</span>];</span><br><span class="line">    <span class="type">int</span> tot, rt[MAXN];</span><br><span class="line">    <span class="type">int</span>&amp; <span class="keyword">operator</span>[](<span class="type">int</span> i) &#123; <span class="keyword">return</span> rt[i]; &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123; <span class="keyword">return</span> nd[++tot] = nd[i], tot; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span>&amp; i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> q, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        i = <span class="built_in">newnode</span>(i);</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">void</span>(nd[i].sum += v);</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (q &lt;= mid)</span><br><span class="line">            <span class="built_in">update</span>(nd[i].ls, l, mid, q, v);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">update</span>(nd[i].rs, mid + <span class="number">1</span>, r, q, v);</span><br><span class="line">        nd[i].sum = nd[nd[i].ls].sum + nd[nd[i].rs].sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">            <span class="keyword">return</span> nd[v].sum - nd[u].sum;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            ret += <span class="built_in">query</span>(nd[u].ls, nd[v].ls, l, mid, ql, qr);</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            ret += <span class="built_in">query</span>(nd[u].rs, nd[v].rs, mid + <span class="number">1</span>, r, ql, qr);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sgt;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> lg2[MAXN], st[MAXN][LOGN];</span><br><span class="line"><span class="type">char</span> str[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lcp</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="type">int</span> k = lg2[r - l];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(st[l + <span class="number">1</span>][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> d, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l, r, cl, cr;</span><br><span class="line">    l = <span class="number">1</span>, r = sa.rk[c], cl = r;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">lcp</span>(mid, sa.rk[c]) &gt;= len)</span><br><span class="line">            r = mid - <span class="number">1</span>, cl = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    l = sa.rk[c], r = n, cr = l;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">lcp</span>(sa.rk[c], mid) &gt;= len)</span><br><span class="line">            l = mid + <span class="number">1</span>, cr = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sgt.<span class="built_in">query</span>(sgt[a - <span class="number">1</span>], sgt[b - len + <span class="number">1</span>], <span class="number">1</span>, n, cl, cr);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str + <span class="number">1</span>);</span><br><span class="line">    sa.<span class="built_in">init</span>(n, str);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">        lg2[i] = (i &amp; (i - <span class="number">1</span>)) ? lg2[i - <span class="number">1</span>] : lg2[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        st[i][<span class="number">0</span>] = sa.he[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; LOGN; ++j) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; ++i) &#123;</span><br><span class="line">            st[i][j] = <span class="built_in">min</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        sgt.<span class="built_in">update</span>(sgt[i] = sgt[i - <span class="number">1</span>], <span class="number">1</span>, n, sa.rk[i], <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="type">int</span> a, b, c, d;</span><br><span class="line">        <span class="built_in">read</span>(a), <span class="built_in">read</span>(b), <span class="built_in">read</span>(c), <span class="built_in">read</span>(d);</span><br><span class="line">        <span class="type">int</span> l = <span class="number">1</span>, r = <span class="built_in">min</span>(b - a + <span class="number">1</span>, d - c + <span class="number">1</span>), ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">            <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">check</span>(a, b, c, d, mid))</span><br><span class="line">                l = mid + <span class="number">1</span>, ans = mid;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                r = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4081 [USACO17DEC] Standing Out from the Herd P</title>
    <url>/2022/02/03/sol-p4081/</url>
    <content><![CDATA[<h2 id="P4081-USACO17DEC-Standing-Out-from-the-Herd-P"><a href="#P4081-USACO17DEC-Standing-Out-from-the-Herd-P" class="headerlink" title="P4081 [USACO17DEC] Standing Out from the Herd P"></a>P4081 [USACO17DEC] Standing Out from the Herd P</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4081">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¦–å…ˆæ„å»ºåç¼€æ•°ç»„ã€‚ä»ç„¶å¥—è·¯åœ°æšä¸¾å¤§ä¸²çš„ä½ç½®$sa[i]$ã€‚é¦–å…ˆè€ƒè™‘çš„æ˜¯ä¸èƒ½åœ¨åˆ«çš„å°ä¸²ä¸­å‡ºç°ï¼Œè®°å½•å…¶å‰åç¬¬ä¸€ä¸ªåœ¨ä¸åŒä¸²ä¸­å‡ºç°çš„åç¼€ä½ç½®ï¼Œåˆ†åˆ«ä¸º$pre_i$å’Œ$nxt_i$ï¼Œåˆ™ä»¥$sa[i]$å¼€å¤´çš„åç¼€å¯¹ç­”æ¡ˆè´¡çŒ®çš„æœ€å°é•¿åº¦ä¸º$\max(lcs(pre_i, i), lcs(i, nxt_i))$ï¼›æ¥ä¸‹æ¥è€ƒè™‘åªåœ¨å½“å‰å°ä¸²ä¸­å‡ºç°ä¸€æ¬¡æ˜¯ï¼Œåˆ™å¯¹ç­”æ¡ˆè´¡çŒ®çš„æœ€å°é•¿åº¦ä¸º$\max(lcs(i,i+1))$ã€‚ä¸¤è€…å–$\max$å³å¯ã€‚æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n \log n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4081.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4081</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN], he[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            he[i] = ht[sa[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa;</span><br><span class="line"><span class="type">int</span> n, m, id[MAXN], ed[MAXN], len[MAXN], ans[MAXN];</span><br><span class="line"><span class="type">char</span> buf[MAXN], str[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), m = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        len[i] = <span class="built_in">strlen</span>(buf);</span><br><span class="line">        <span class="built_in">copy</span>(buf, buf + len[i], str + m);</span><br><span class="line">        str[m + len[i]] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">        <span class="built_in">fill</span>(id + m, id + m + len[i], i);</span><br><span class="line">        ed[i] = m + len[i];</span><br><span class="line">        m += len[i] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sa.<span class="built_in">init</span>(m, str);</span><br><span class="line">    <span class="type">int</span> pre = <span class="number">0</span>, mn = INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (id[sa.sa[i]] != id[sa.sa[i - <span class="number">1</span>]]) &#123;</span><br><span class="line">            <span class="type">int</span> p = id[sa.sa[i - <span class="number">1</span>]];</span><br><span class="line">            pre = i - <span class="number">1</span>, mn = ed[p] - sa.sa[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        mn = <span class="built_in">min</span>(mn, sa.he[i]);</span><br><span class="line">        <span class="type">int</span> p = id[sa.sa[i]];</span><br><span class="line">        <span class="type">int</span> cur = <span class="built_in">max</span>(<span class="number">0ll</span>, ed[p] - sa.sa[i] - <span class="built_in">max</span>(mn, sa.he[i + <span class="number">1</span>]));</span><br><span class="line">        ans[p] += cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans[i]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P5028 Annihilate</title>
    <url>/2022/02/03/sol-p5028/</url>
    <content><![CDATA[<h2 id="P5028-Annihilate"><a href="#P5028-Annihilate" class="headerlink" title="P5028 Annihilate"></a>P5028 Annihilate</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P5028">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¢˜æ„å¾ˆ<del>ç®€æ´</del>ï¼Œè®©æ±‚$n$ä¸ªä¸²ä¸¤ä¸¤ä¹‹é—´çš„LCSã€‚</p>
<p>æ—¢ç„¶ä¸èƒ½$O(len^2)$çš„$dp$ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨åç¼€æ•°ç»„å§ã€‚</p>
<p>æ³¨æ„åˆ°å¯ä»¥å¥—è·¯åœ°å°†ä¸²æ‹¼æ¥ï¼Œç›´æ¥æšä¸¾å¤§ä¸²ä½ç½®$i$ï¼Œè®°å½•ä¸‹æ¯ä¸ªå°ä¸²çš„æœ€è¿‘çš„ä¸Šä¸€ä¸ªå­—ç¬¦ä½ç½®$pre_j$ï¼Œç”¨LCSæ›´æ–°ç­”æ¡ˆï¼Œ$O(n\times len)$ã€‚</p>
<p>æ³¨æ„åˆ°å†…å­˜é™åˆ¶ä¸º$64M$ï¼Œæ— æ³•ä½¿ç”¨STè¡¨ï¼Œäºæ˜¯åœ¨æ›´æ–°$pre$æ•°ç»„æ—¶è®°å½•å¦ä¸€ä¸ª$mn$æ•°ç»„ä¿å­˜ä»$pre$åˆ°$i$çš„LCSï¼Œç©ºé—´å¤æ‚åº¦å˜æˆ$O(n^2 + len)$ï¼Œå¯ä»¥é€šè¿‡ã€‚</p>
<p>æ³¨æ„åˆ°æœ€åçš„$40pts$å…¶å®æœ‰è€ƒå¯Ÿé€‰æ‰‹çš„ç»†å¿ƒç¨‹åº¦ï¼ŒLCSä¸èƒ½å¤§äºä¸²çš„é•¿åº¦ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P5028.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P5028</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">55</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1.1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXM], rk[MAXM], tp[MAXM], ht[MAXM], he[MAXM];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXM];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            he[i] = ht[sa[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> mn[MAXN], ed[MAXN], len[MAXN], pre[MAXN];</span><br><span class="line"><span class="type">int</span> id[MAXM], ans[MAXN][MAXN];</span><br><span class="line"><span class="type">char</span> buf[MAXM], str[MAXM];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), m = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        len[i] = <span class="built_in">strlen</span>(buf);</span><br><span class="line">        <span class="built_in">copy</span>(buf, buf + len[i], str + m);</span><br><span class="line">        str[m + len[i]] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">        <span class="built_in">fill</span>(id + m, id + m + len[i], i);</span><br><span class="line">        ed[i] = m + len[i];</span><br><span class="line">        m += len[i] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sa.<span class="built_in">init</span>(m, str);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            mn[j] = <span class="built_in">min</span>(mn[j], sa.he[i]);</span><br><span class="line">        <span class="type">int</span> p = id[sa.sa[i]];</span><br><span class="line">        <span class="type">int</span> clen = ed[p] - sa.sa[i];</span><br><span class="line">        pre[p] = i, mn[p] = clen;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pre[j]) &#123;</span><br><span class="line">                ans[j][p] = <span class="built_in">max</span>(ans[j][p], <span class="built_in">min</span>(mn[j], clen));</span><br><span class="line">                ans[p][j] = <span class="built_in">max</span>(ans[p][j], <span class="built_in">min</span>(mn[j], clen));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == j)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">write</span>(ans[i][j]), <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4070 [SDOI2016] ç”Ÿæˆé­”å’’</title>
    <url>/2022/02/03/sol-p4070/</url>
    <content><![CDATA[<h2 id="P4070-SDOI2016-ç”Ÿæˆé­”å’’"><a href="#P4070-SDOI2016-ç”Ÿæˆé­”å’’" class="headerlink" title="P4070 [SDOI2016] ç”Ÿæˆé­”å’’"></a>P4070 [SDOI2016] ç”Ÿæˆé­”å’’</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4070">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ³¨æ„åˆ°æ¯æ¬¡åŠ å…¥ä¸€ä¸ªå­—ç¬¦$s[i]$åï¼Œå¢åŠ çš„ä¸åŒå­ä¸²æ•°é‡å°±æ˜¯$i-lcs$ï¼Œå…¶ä¸­$lcs$æ˜¯å­ä¸²$s[1\cdots i]$å’ŒåŠ å…¥å‰$s$ä¸­ä»»æ„å­ä¸²æœ€é•¿çš„æœ€é•¿å…¬å…±åç¼€é•¿åº¦ã€‚</p>
<p>è¦æ±‚å‡ºæ¯ä¸ªå‰ç¼€å’Œå…¶ä»–å­ä¸²çš„lcsï¼Œå®¹æ˜“æƒ³åˆ°å°†ä¸²åè½¬åä½¿ç”¨åç¼€æ•°ç»„ã€‚ç°åœ¨é—®é¢˜è½¬åŒ–ä¸ºå¯¹æ¯ä¸ª$i$æ±‚å‡ºå¯¹åº”çš„$p \lt i$ä½¿å¾—$\min\limits_{k\in(rk[p],rk[i]]\bigcup(rk[i],rk[p]]}{height[k]}$æœ€å¤§ï¼Œæ˜¾ç„¶è¿™ä¸ª$rk[p]$æ˜¯$rk[i]$çš„å‰é©±æˆ–è€…åç»§ã€‚</p>
<p>æŒ‰é¡ºåºæšä¸¾$i$ï¼Œç”¨<del>å¹³è¡¡æ ‘</del>ä¸¤æ£µçº¿æ®µæ ‘ç»´æŠ¤å‰é©±åç»§ï¼Œæ±‚å‡ºlcså–maxï¼Œå¾—åˆ°æ¯æ¬¡å¢åŠ çš„ä¸åŒå­ä¸²æ•°é‡ï¼Œå¾—åˆ°æœ€ç»ˆç­”æ¡ˆã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \log n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4070.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4070</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">19</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN], he[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">1e5</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i], tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            he[i] = ht[sa[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> li (i &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ri (i &lt;&lt; 1) | 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lson li, l, mid</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rson ri, mid + 1, r</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Update</span>&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegmentTree</span> &#123;</span><br><span class="line">    _Update upd;</span><br><span class="line">    <span class="type">int</span> nd[MAXN * <span class="number">4</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        nd[i] = x;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">build</span>(lson, x), <span class="built_in">build</span>(rson, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> q, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">void</span>(nd[i] = <span class="built_in">upd</span>(nd[i], v));</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (q &lt;= mid)</span><br><span class="line">            <span class="built_in">update</span>(lson, q, v);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">update</span>(rson, q, v);</span><br><span class="line">        nd[i] = <span class="built_in">upd</span>(nd[li], nd[ri]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr, <span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &gt; qr)</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">            <span class="keyword">return</span> nd[i];</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = x;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            ret = <span class="built_in">upd</span>(ret, <span class="built_in">query</span>(lson, ql, qr, x));</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            ret = <span class="built_in">upd</span>(ret, <span class="built_in">query</span>(rson, ql, qr, x));</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MaxUpdate</span> &#123; <span class="function"><span class="type">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">max</span>(x, y); &#125; &#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MinUpdate</span> &#123; <span class="function"><span class="type">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">min</span>(x, y); &#125; &#125;;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> a[MAXN], b[MAXN], rev[MAXN], lg2[MAXN], st[MAXN][LOGN];</span><br><span class="line">SegmentTree&lt;MaxUpdate&gt; sgtpre;</span><br><span class="line">SegmentTree&lt;MinUpdate&gt; sgtnxt;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lcs</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="type">int</span> k = lg2[r - l];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(st[l + <span class="number">1</span>][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), m = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]), b[i] = a[i];</span><br><span class="line">    <span class="built_in">sort</span>(b + <span class="number">1</span>, b + m + <span class="number">1</span>);</span><br><span class="line">    m = <span class="built_in">unique</span>(b + <span class="number">1</span>, b + m + <span class="number">1</span>) - b - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        a[i] = <span class="built_in">lower_bound</span>(b + <span class="number">1</span>, b + m + <span class="number">1</span>, a[i]) - b;</span><br><span class="line">    <span class="built_in">copy</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>, rev + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">reverse</span>(rev + <span class="number">1</span>, rev + n + <span class="number">1</span>);</span><br><span class="line">    sa.<span class="built_in">init</span>(n, rev);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">        lg2[i] = (i &amp; (i - <span class="number">1</span>)) ? lg2[i - <span class="number">1</span>] : lg2[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        st[i][<span class="number">0</span>] = sa.he[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; LOGN; ++j) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; ++i) &#123;</span><br><span class="line">            st[i][j] = <span class="built_in">min</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sgtpre.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">0</span>);</span><br><span class="line">    sgtnxt.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n, n + <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> t = sa.rk[n - i + <span class="number">1</span>];</span><br><span class="line">        <span class="type">int</span> p1 = sgtpre.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, t, <span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> p2 = sgtnxt.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, t, n, n + <span class="number">1</span>);</span><br><span class="line">        cur += i - <span class="built_in">max</span>(<span class="built_in">lcs</span>(p1, t), <span class="built_in">lcs</span>(t, p2));</span><br><span class="line">        sgtpre.<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, t, t);</span><br><span class="line">        sgtnxt.<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, t, t);</span><br><span class="line">        <span class="built_in">write</span>(cur), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4341 [BJWC2010] å¤–æ˜Ÿè”ç»œ</title>
    <url>/2022/02/03/sol-p4341/</url>
    <content><![CDATA[<h2 id="P4341-BJWC2010-å¤–æ˜Ÿè”ç»œ"><a href="#P4341-BJWC2010-å¤–æ˜Ÿè”ç»œ" class="headerlink" title="P4341 [BJWC2010] å¤–æ˜Ÿè”ç»œ"></a>P4341 [BJWC2010] å¤–æ˜Ÿè”ç»œ</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4341">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ²¡åˆå§‹åŒ–$log_2$æ•°ç»„ï¼Œä½†è¿‡äº†æ ·ä¾‹ã€‚</p>
<p>æ³¨æ„åˆ°ä½¿ç”¨åç¼€æ•°ç»„æ’åºåï¼Œå¯ä»¥æ¯”è¾ƒæ–¹ä¾¿åœ°æŒ‰ç…§å­—å…¸åºæšä¸¾å­ä¸²ã€‚å…·ä½“åœ°ï¼Œå¯¹äºåç¼€$s[sa[i]â€¦n]$ï¼ŒæŒ‰ç…§é¡ºåºæšä¸¾å­ä¸²$s[sa[i]+he[i]â€¦n]$å³å¯ã€‚</p>
<p>æ³¨æ„åˆ°å¯ä»¥STè¡¨ç»´æŠ¤LCSï¼Œå¹¶äºŒåˆ†å‡ºæ¯ä¸ªå­ä¸²çš„å‡ºç°æ¬¡æ•°ã€‚äºæ˜¯è¿™é¢˜å˜æˆäº†SAæ¨¡ç‰ˆé¢˜ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4341.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4341</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">3e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">15</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN], he[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            he[i] = ht[sa[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa;</span><br><span class="line"><span class="type">int</span> n, lg2[MAXN], st[MAXN][LOGN];</span><br><span class="line"><span class="type">char</span> str[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lcs</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="type">int</span> k = lg2[r - l];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(st[l + <span class="number">1</span>][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str + <span class="number">1</span>);</span><br><span class="line">    sa.<span class="built_in">init</span>(n, str);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">        lg2[i] = (i &amp; (i - <span class="number">1</span>)) ? lg2[i - <span class="number">1</span>] : lg2[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        st[i][<span class="number">0</span>] = sa.he[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; LOGN; ++j) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; ++i) &#123;</span><br><span class="line">            st[i][j] = <span class="built_in">min</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> mn = sa.he[i] + <span class="number">1</span>, mx = n - sa.sa[i] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = mn; j &lt;= mx; ++j) &#123;</span><br><span class="line">            <span class="type">int</span> l = i, r = n, x = i;</span><br><span class="line">            <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">lcs</span>(i, mid) &gt;= j)</span><br><span class="line">                    l = mid + <span class="number">1</span>, x = mid;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (x != i)</span><br><span class="line">                <span class="built_in">write</span>(x - i + <span class="number">1</span>), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3649 [APIO2014] å›æ–‡ä¸²</title>
    <url>/2022/02/02/sol-p3649/</url>
    <content><![CDATA[<h2 id="P3649-APIO2014-å›æ–‡ä¸²"><a href="#P3649-APIO2014-å›æ–‡ä¸²" class="headerlink" title="P3649 [APIO2014] å›æ–‡ä¸²"></a>P3649 [APIO2014] å›æ–‡ä¸²</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3649">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ‰€ä»¥è¯´APIO2014è€ƒäº†é“æ¨¡ç‰ˆé¢˜ï¼Ÿ</p>
<p>è¿™æ˜¾ç„¶å°±æ˜¯PAMæ¨¡ç‰ˆï¼Œä½†æ—¢ç„¶ç¢°åˆ°äº†å°±è¿˜æ˜¯å†™ä¸€ä¸‹ï¼ˆåæ­£æˆ‘ä¹Ÿå¿˜äº†ï¼‰ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3649.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3649</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PAM</span> &#123;</span><br><span class="line">    <span class="type">int</span> siz, tot, last;</span><br><span class="line">    <span class="type">int</span> cnt[MAXN], len[MAXN], fail[MAXN], nxt[MAXN][<span class="number">26</span>];</span><br><span class="line">    <span class="type">char</span> str[MAXN];</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> l)</span> </span>&#123; <span class="keyword">return</span> len[++siz] = l, siz; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        siz = <span class="number">-1</span>, last = <span class="number">0</span>;</span><br><span class="line">        str[tot = <span class="number">0</span>] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">        <span class="built_in">newnode</span>(<span class="number">0</span>), <span class="built_in">newnode</span>(<span class="number">-1</span>);</span><br><span class="line">        fail[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getfail</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (str[tot - len[x] - <span class="number">1</span>] != str[tot])</span><br><span class="line">            x = fail[x];</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">char</span> c)</span> </span>&#123;</span><br><span class="line">        str[++tot] = c;</span><br><span class="line">        <span class="type">int</span> now = <span class="built_in">getfail</span>(last);</span><br><span class="line">        <span class="keyword">if</span> (!nxt[now][c - <span class="string">&#x27;a&#x27;</span>]) &#123;</span><br><span class="line">            <span class="type">int</span> x = <span class="built_in">newnode</span>(len[now] + <span class="number">2</span>);</span><br><span class="line">            fail[x] = nxt[<span class="built_in">getfail</span>(fail[now])][c - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            nxt[now][c - <span class="string">&#x27;a&#x27;</span>] = x;</span><br><span class="line">        &#125;</span><br><span class="line">        last = nxt[now][c - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        ++cnt[last];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; pam;</span><br><span class="line"><span class="type">char</span> s[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    pam.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; s[i]; ++i)</span><br><span class="line">        pam.<span class="built_in">insert</span>(s[i]);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = pam.siz; ~i; --i)</span><br><span class="line">        pam.cnt[pam.fail[i]] += pam.cnt[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= pam.siz; ++i)</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, pam.cnt[i] * pam.len[i]);</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2336 [SCOI2012] å–µæ˜Ÿçƒä¸Šçš„ç‚¹å</title>
    <url>/2022/02/02/sol-p2336/</url>
    <content><![CDATA[<h2 id="P2336-SCOI2012-å–µæ˜Ÿçƒä¸Šçš„ç‚¹å"><a href="#P2336-SCOI2012-å–µæ˜Ÿçƒä¸Šçš„ç‚¹å" class="headerlink" title="P2336 [SCOI2012] å–µæ˜Ÿçƒä¸Šçš„ç‚¹å"></a>P2336 [SCOI2012] å–µæ˜Ÿçƒä¸Šçš„ç‚¹å</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2336">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æœ¬ä»¥ä¸ºè‡ªå·±çš„$O(n\log n)$å‡åšæ³•èƒ½ddé¢˜è§£ï¼Œæ²¡æƒ³åˆ°è¿˜æ˜¯è¦ç”¨è«é˜Ÿâ€¦â€¦</p>
<p>æ—¢ç„¶èƒ½ç”¨åç¼€æ•°ç»„è§£å†³çš„é¢˜ï¼Œå°±ä¸€å®šä¸è¦å»å†™è‡ªåŠ¨æœºå•Šï½</p>
<p>å…ˆå¥—è·¯åœ°å°†ä¸²ä¹‹é—´ç”¨åˆ†éš”ç¬¦è¿æ¥ï¼Œä¸ºäº†ä¿è¯åç¼€æ’åºåçš„é¡ºåºæ˜¯ç›¸åŒåç¼€æ—¶å§“ååœ¨å‰ç‚¹ååœ¨åï¼Œåˆ™å°†å§“åä¹‹é—´çš„åˆ†éš”ç¬¦ASCIIç $\lt$ç‚¹åä¹‹é—´çš„åˆ†éš”ç¬¦ASCIIç ã€‚</p>
<p>åœ¨åç¼€æ•°ç»„ä¸Šæ‰«æå¹¶ç»´æŠ¤å•è°ƒæ ˆï¼Œå½“æ‰«æåˆ°ç‚¹åä¸²çš„å¼€å¤´æ—¶ï¼Œåœ¨å•è°ƒæ ˆä¸ŠäºŒåˆ†å¾—åˆ°ç¬¬ä¸€ä¸ªå¯ä»¥ä½¿å¾—åç¼€$sa[t\cdots i]$çš„å‰$len$ä¸ªæ•°å­—ç›¸åŒçš„$t$ï¼ˆå…¶ä¸­$len$æ˜¯è¯¥ç‚¹åä¸²çš„é•¿åº¦ï¼‰ï¼Œå½¢å¼åŒ–åœ°ï¼ŒäºŒåˆ†å‡ºæœ€å°çš„$t$ä½¿å¾—$\forall j \in (t,i] \quad height[j] \le len$ã€‚æ³¨æ„åˆ°$t$åˆ°$i$ä¹‹é—´çš„ä¸åŒå§“åä¸²æ•°é‡å°±æ˜¯ç­”æ¡ˆã€‚</p>
<p>æ‰€ä»¥å¯ä»¥ç¦»çº¿ä¸‹æ¥ï¼Œç”¨è«é˜Ÿæ±‚åŒºé—´ä¸åŒæ•°çš„ä¸ªæ•°ã€‚</p>
<p>æ€è€ƒå¦‚ä½•æ±‚å‡ºç¬¬äºŒä¸ªç­”æ¡ˆã€‚è¿ç”¨è«é˜Ÿçš„å°æŠ€å·§æˆ‘ä»¬çŸ¥é“å¯ä»¥åœ¨ç§»åŠ¨æŒ‡é’ˆæ—¶å·®åˆ†ç®—å‡ºæ¯æ¬¡åŠ å…¥æ–°çš„å§“åä¸²åˆ°ä¸‹ä¸€æ¬¡åˆ é™¤è¯¥å§“åä¸²ä¹‹é—´çš„æ­¥æ•°çš„æ€»å’Œï¼ŒåŠ èµ·æ¥å°±æ˜¯ç¬¬äºŒä¸ªç­”æ¡ˆã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \sqrt n)$ï¼Œè¢«è‡ªåŠ¨æœºåŠæ‰“<del>ä½†èƒ½è¿‡</del>ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2336.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2336</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN], he[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXN] = &#123;&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">5e5</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            he[i] = ht[sa[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sa;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Query</span> &#123;</span><br><span class="line">    <span class="type">int</span> l, r, i;</span><br><span class="line">&#125; query[MAXN];</span><br><span class="line"><span class="type">int</span> n, m, l, len, top, block;</span><br><span class="line"><span class="type">int</span> lb[MAXN], ta[MAXN], tb[MAXN], buf[MAXN], str[MAXN];</span><br><span class="line"><span class="type">int</span> sta[MAXN], hta[MAXN], typ[MAXN], cnt[MAXN];</span><br><span class="line"><span class="type">int</span> ans1[MAXN], ans2[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    ta[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> l1, l2;</span><br><span class="line">        <span class="built_in">read</span>(l1);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= l1; ++j)</span><br><span class="line">            <span class="built_in">read</span>(buf[j]);</span><br><span class="line">        buf[l1 + <span class="number">1</span>] = <span class="number">1e5</span>;</span><br><span class="line">        <span class="built_in">read</span>(l2);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= l2; ++j)</span><br><span class="line">            <span class="built_in">read</span>(buf[j + l1 + <span class="number">1</span>]);</span><br><span class="line">        l = l1 + l2 + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">copy</span>(buf + <span class="number">1</span>, buf + l + <span class="number">1</span>, str + ta[i]);</span><br><span class="line">        str[ta[i] + l] = <span class="number">1e5</span>;</span><br><span class="line">        ta[i + <span class="number">1</span>] = ta[i] + l + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    tb[<span class="number">1</span>] = ta[n + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(l), lb[i] = l;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= l; ++j)</span><br><span class="line">            <span class="built_in">read</span>(buf[j]);</span><br><span class="line">        <span class="built_in">copy</span>(buf + <span class="number">1</span>, buf + l + <span class="number">1</span>, str + tb[i]);</span><br><span class="line">        str[tb[i] + l] = <span class="number">2e5</span>;</span><br><span class="line">        tb[i + <span class="number">1</span>] = tb[i] + l + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    len = tb[m + <span class="number">1</span>] - <span class="number">1</span>;</span><br><span class="line">    sa.<span class="built_in">init</span>(len, str);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = ta[i]; j &lt; ta[i + <span class="number">1</span>]; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (str[j] &lt; <span class="number">1e5</span>)</span><br><span class="line">                typ[sa.rk[j]] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i) &#123;</span><br><span class="line">        <span class="keyword">while</span> (top &amp;&amp; hta[top] &gt; sa.he[i])</span><br><span class="line">            --top;</span><br><span class="line">        ++top, sta[top] = i, hta[top] = sa.he[i];</span><br><span class="line">        <span class="keyword">if</span> (sa.sa[i] &gt;= tb[<span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="type">int</span> p = sa.sa[i];</span><br><span class="line">            <span class="type">int</span> x = <span class="built_in">lower_bound</span>(tb + <span class="number">1</span>, tb + m + <span class="number">1</span>, p) - tb;</span><br><span class="line">            <span class="keyword">if</span> (tb[x] != p)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> t = <span class="built_in">lower_bound</span>(hta + <span class="number">1</span>, hta + top + <span class="number">1</span>, lb[x]) - hta - <span class="number">1</span>;</span><br><span class="line">            query[x] = &#123;t &lt;= top ? sta[t] : i + <span class="number">1</span>, i, x&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    block = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(len + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">auto</span> comp_query = [=](<span class="type">const</span> Query&amp; lhs, <span class="type">const</span> Query&amp; rhs) &#123;</span><br><span class="line">        <span class="type">int</span> bl = lhs.l / block, br = rhs.l / block;</span><br><span class="line">        <span class="keyword">return</span> bl == br ? ((bl &amp; <span class="number">1</span>) ? lhs.r &lt; rhs.r : lhs.r &gt; rhs.r)</span><br><span class="line">                        : bl &lt; br;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">sort</span>(query + <span class="number">1</span>, query + m + <span class="number">1</span>, comp_query);</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">0</span>, cl = <span class="number">0</span>, cr = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="keyword">while</span> (cl &lt; query[i].l) &#123;</span><br><span class="line">            <span class="keyword">if</span> (typ[cl] &amp;&amp; --cnt[typ[cl]] == <span class="number">0</span>)</span><br><span class="line">                --cur, ans2[typ[cl]] -= m - i + <span class="number">1</span>;</span><br><span class="line">            ++cl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (cl &gt; query[i].l) &#123;</span><br><span class="line">            --cl;</span><br><span class="line">            <span class="keyword">if</span> (typ[cl] &amp;&amp; cnt[typ[cl]]++ == <span class="number">0</span>)</span><br><span class="line">                ++cur, ans2[typ[cl]] += m - i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (cr &lt; query[i].r) &#123;</span><br><span class="line">            ++cr;</span><br><span class="line">            <span class="keyword">if</span> (typ[cr] &amp;&amp; cnt[typ[cr]]++ == <span class="number">0</span>)</span><br><span class="line">                ++cur, ans2[typ[cr]] += m - i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (cr &gt; query[i].r) &#123;</span><br><span class="line">            <span class="keyword">if</span> (typ[cr] &amp;&amp; --cnt[typ[cr]] == <span class="number">0</span>)</span><br><span class="line">                --cur, ans2[typ[cr]] -= m - i + <span class="number">1</span>;</span><br><span class="line">            --cr;</span><br><span class="line">        &#125;</span><br><span class="line">        ans1[query[i].i] = cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans1[i]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans2[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>WC2022æ¸¸å¯„</title>
    <url>/2022/01/27/trip-wc2022/</url>
    <content><![CDATA[<h2 id="WC2022æ¸¸å¯„"><a href="#WC2022æ¸¸å¯„" class="headerlink" title="WC2022æ¸¸å¯„"></a>WC2022æ¸¸å¯„</h2><p><del>å†»é›¶</del>å†¬çœ è¥å‡ æ—¥æ¸¸ï¼Œ<del>å­¦ä¹ äº†LCTç­‰ç®—æ³•</del></p>
<span id="more"></span>
<p>$8:15$ å·¦å³æŠŠæœºæˆ¿ç”µè„‘æ‰“å¼€äº†ï¼ˆå±…ç„¶è¦å…ˆæŒ‰<code>esc</code>ç„¶åç”¨é¼ æ ‡ç‚¹å¼€ç³»ç»Ÿï¼‰ï¼Œçœ‹åˆ°æ¡Œé¢ä¸Šæœ‰vscodeï¼Œæ²¡æ‰¾åˆ°NOI-Linuxï¼ˆJSä¼ ç»Ÿï¼Œäº‹å®è¯æ˜åªæ˜¯æˆ‘æ²¡çœ‹åˆ°ï¼‰ï¼Œå°±<del>è¶ç€è¿˜æ²¡æ–­ç½‘</del>å¿«é€Ÿä¸‹äº†ä¸‹æ’ä»¶ï¼Œé…ç½®äº†ä¸‹C++ï¼Œæ•²äº†ä¸‹æ¿å­ï¼Œè¿è¡Œçš„æ—¶å€™exeè¢«è«åå…¶å¦™å¡åˆ°åå°äº†ï¼ˆï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œä»»åŠ¡ç®¡ç†å™¨è¿˜æ²¡æœ‰æƒé™è°ƒå‡ºæ¥ï¼ˆç¦»å¤§è°±ï¼‰ï¼Œæ‰€ä»¥åªå¥½æŠŠ<code>template.cpp</code>æ”¹æˆ<code>template2.cpp</code>ã€‚ï¼ˆç„¶åè€ƒè¯•è‡³å§‹è‡³ç»ˆæ²¡æ‰“å¼€vscä¸€ç›´ç”¨çš„devï¼‰</p>
<p>$8:30$ æ‹¿åˆ°é¢˜ç›®çœ‹äº†çœ¼ï¼Œä¸€æ„é€ ä¸€ä¼ ç»Ÿä¸€äº¤äº’çœ‹çš„äººå¤´æ™•ï¼ˆçœŸå°±å’Œpyè€å¸ˆè¯´çš„é‚£æ ·è®²çš„å’Œè€ƒçš„æ²¡æœ‰ä»»ä½•å…³ç³»ï¼‰ã€‚</p>
<p>å…ˆçœ‹çœ‹T1ï¼Œæ˜¯ä¸ªæ„é€ +æ‹¬å·åºåˆ—ï¼Œæ“ä½œ$1$~$4$éƒ½æ˜¯å°†ä¸åŒçš„åºåˆ—æ”¹ä¸ºåŒæ ·çš„åºåˆ—ï¼Œæƒ³ç€ä¼¼ä¹å¯ä»¥å€’è¿‡æ¥åšæ¯”è¾ƒæ–¹ä¾¿ã€‚ç„¶åå¼€å§‹çæƒ³ï¼Œæ„Ÿè§‰å…ˆåœ¨åºåˆ—æœ«å°¾åŠ ä¸Šä¸€ä¸ª<code>()</code>ç„¶åå°±æ¯”è¾ƒå®¹æ˜“æ»¡è¶³$1$~$4$æ“ä½œçš„æ ¼å¼ï¼Œæœ€åå†æŠŠæœ«å°¾<code>()</code>åˆ æ‰ï¼Œæ€»ä¹‹æƒ³åˆ°çš„éƒ½æ˜¯ä¹±æã€‚æ­¤æ—¶å·²ç»è¿‡å»$1h$ï¼Œä¸€åˆ†æ²¡æœ‰ä¸¢æ‰T1å»çœ‹T2.</p>
<p>çœ‹ä¸€çœ¼T2å‘ç°æˆ‘ä¼šè«é˜Ÿï¼Œäºæ˜¯$O(n \sqrt{n \log n})$çš„åšæ³•ç›´æ¥æ˜¾ç„¶ã€‚ä½†æ˜¯ä¸€çœ‹æ•°æ®$5\times 10^5$ä¼¼ä¹å¹¶ä¸æƒ³æ”¾è«é˜Ÿè¿‡å»ã€‚ç»§ç»­æ€è€ƒå‘ç°åˆ é™¤å…ƒç´ ä¼¼ä¹å¯ä»¥$O(1)$æå®šï¼Œçœ‹åˆ°æ—¶é™$5s$ï¼Œå°±å¼€å¿ƒåœ°å†™èµ·äº†å›æ»šè«é˜Ÿï¼ˆæ­¤æ—¶æˆ‘è¿˜æ²¡æœ‰æ„è¯†åˆ°å›æ»šè«é˜Ÿçš„å·¨å¤§å¸¸æ•°ï¼‰ã€‚å¤§æ¦‚$30min$å†™å®Œè°ƒå®Œå°æ ·ä¾‹ï¼Œæ„Ÿè§‰å¤ªæ°´äº†å°±è¿…é€Ÿå†™äº†ä¸ªå¯¹æ‹ï¼ˆå¬è¯´åæ¥å‘äº†å¤§æ ·ä¾‹ï¼Œä¸è¿‡æˆ‘ä¹Ÿæ²¡çœ‹è§ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯è¿™é¢˜ï¼‰ï¼Œä¸€çœ‹$n=1000$å¥½åƒæ²¡å•¥é—®é¢˜ï¼Œé€ äº†ä¸ª<code>5e5</code>çš„æ•°æ®è·‘äº†$15s$ï¼Œç«‹é©¬æ„Ÿè§‰å±ï¼Œæƒ³åŠæ³•å¼€å§‹å¡å¸¸æ•°ï¼Œç»“æœå‘ç°å†™çš„å¥½åƒæŒºä¼˜é›…çš„ï¼Œåªå¥½ç»™å„ä¸ªå‡½æ•°åŠ äº†ä¸‹<code>inline</code>å°±ä¸¢æ‰å¼€æ‘†ï½</p>
<p>T3æ˜¾ç„¶ä¸å¯åšï¼Œæˆ‘èŠ±äº†å¤§é‡æ—¶é—´åœ¨è¿™é¢˜è€Œä¸æ˜¯æƒ³åŠæ³•ä¼˜åŒ–T2åº”è¯¥è¯´æ˜¯è¿™åœºæ¯”èµ›æœ€å¤§çš„å¤±è¯¯ã€‚è¿™é¢˜å‡ºçš„å°±å¾ˆç„å­¦ï¼Œç„¶åPDFé¢˜é¢ä¸­æ²¡å¼€<code>c++14</code>ä¸”äº¤äº’åº“ç”¨äº†<code>srand(0)</code>æå¾—æˆ‘æ—¢ä¸æ•¢ç”¨<code>rand</code>åˆä¸æ•¢ç”¨<code>mt19937</code>ï¼Œç¦»è°±å°±ç¦»è°±åœ¨é¢˜ç›®è¯´æ˜¯æœ‰$5$æ¬¡guessçš„æœºä¼šä½†æ˜¯æŒ‰ç…§è¿™ä¸ªäº¤äº’åº“çš„å†™æ³•ç›¸å½“äºæ˜¯ä½ é—®$4$æ¬¡è¿”å›$5$æ¬¡è€Œä¸æ˜¯è®©ä½ é—®$5$æ¬¡ï¼Œäºæ˜¯æˆ‘éå¸¸sbåœ°æƒ³åˆ°ç”¨$5$æ¬¡é—®å‡º$25$ä¸ªå­—æ¯æ˜¯å¦å‡ºç°ç„¶åæ ¹æ®å·²æœ‰ä¿¡æ¯åŸºæœ¬é”å®šç›®æ ‡ä¸²éšæœºé€‰å–çš„åšæ³•ï¼Œæµªè´¹äº†å¤§é‡æ—¶é—´åœ¨å†™meet in the middleï¼ˆä¼¼ä¹æ—¶é™$60$ç§’çš„è¯$2^{26}\times 26$çdpéƒ½èƒ½é¢„å¤„ç†å‡ºæ¥ï¼Ÿä¸æ€•æœ‰äººå¡è¯„æµ‹æœºå—ï¼Ÿï¼‰å†™å®Œå‘ç°ç™½å¹²äº†ï¼Œæœ€åäº¤äº†ä¸ªéšæœºç¨‹åºä¸Šå»ï¼ŒæœŸæœ›å¾—åˆ†$0$ã€‚ï¼ˆé¡ºä¾¿è¯´å¥å…¶å®æˆ‘è›®å–œæ¬¢Cé£æ ¼çš„stringçš„ï¼Œä¸çŸ¥é“ç®—ä¸ç®—é‚ªæ•™ï¼‰</p>
<p>æœ€åå¤§æ¦‚åŠä¸ªå¤šå°æ—¶å¼€å§‹å†™T1çš„æš´åŠ›ã€‚æš´åŠ›å¥½çƒ¦ï¼Œåˆè¦çŠ¶å‹åˆè¦åˆ¤æ–­æ‹¬å·åºåˆ—ï¼Œè€Œä¸”åªèƒ½æ‹¿$15$åˆ†ï¼Œæ„Ÿè§‰ä¸€ç‚¹ä¹Ÿä¸å€¼ã€‚çªç„¶å‘ç°ä¸é™åˆ¶$5$å’Œ$6$æ“ä½œçš„$25$åˆ†ä¼¼ä¹ç™½ç»™å°±è¿…é€Ÿå†™å®Œäº¤ä¸Šå»ã€‚è¿™æ—¶å€™é«˜ä¸‰å­¦é•¿å·²ç»åˆ°æœºæˆ¿é‡Œå‡†å¤‡ç»™æˆ‘ä»¬è®²è¯¾äº†ï¼Œå‘¨å›´ä¹±å“„å“„çš„ï¼Œä¹Ÿæ²¡å¿ƒæ€å†å†™äº†ï¼Œå°±$3min$æ¢$25pts$æ„Ÿè§‰<del>è¿˜æŒºå€¼</del>ã€‚</p>
<p>äºæ˜¯æœŸæœ›å¾—åˆ†åªæœ‰$25+60/100+0=85/125$ï¼Œå¿«ä¹æ‰“é“ï½</p>
<p>ç²—æ¥äº¤æµä¸‹å‘ç°jcyå’Œjthçš„T2éƒ½æ˜¯æ™®é€šè«é˜Ÿå†™çš„ï¼Œjcyæ‹¿åˆ°äº†T1çš„æš´åŠ›$50$åˆ†ï¼Œjthä¼¼ä¹æ²¡æ‹¿åˆ°T1çš„ç™½ç»™åˆ†ä½†æ˜¯T3éª—äº†$22$åˆ†ï¼ˆæˆ‘è¿™æ‰å‘ç°è‡ªå·±æ ¹æœ¬æ²¡æœ‰ç”¨<code>grader.cpp</code>ä¼°åˆ†ï¼‰ã€‚è€ƒå®Œzcæ¥é—®æœ‰æ²¡æœ‰äºº$160$ä»¥ä¸Šä¼¼ä¹æ²¡æœ‰äººä¸¾æ‰‹ã€‚</p>
<p>å¬jcyè¯´T1ä¼¼ä¹æ˜¯æŠŠæ‹¬å·è½¬æˆæ ‘ä¸Šé—®é¢˜ï¼ˆæˆ‘å±…ç„¶è¿æ ‘éƒ½æ²¡æœ‰æƒ³åˆ°ï¼Œä¸è¿‡ä¼°è®¡æƒ³åˆ°äº†ä¹Ÿä¸ä¼šåšï¼‰</p>
<p>ä¸‹åˆåœ¨å­¦æ ¡ç­¾äº†åœè¯¾ä¿è¯ä¹¦ï¼Œ$2:30$ä»¥åå»åƒäº†ä¸­<del>ä¸‹åˆ</del>é¥­ã€‚ä¸å¾—ä¸è¯´æ¤°æ ‘ç‰Œæ¤°æ±è¿˜è›®å¥½å–çš„ï¼ˆé€ƒ</p>
<p>æ™šä¸Šè®²é¢˜äº¤æµï¼Œå¤§å®¶çš„å›æ»šè«é˜Ÿéƒ½æ˜¯$9s$åªæœ‰æˆ‘å¤§å¸¸æ•°é€‰æ‰‹æ˜¯$15s$ã€‚</p>
<p>ç­‰æ˜å¤©å‡ºåˆ†å§ï¼ˆè¯´ä¸å®šT3è¿˜èƒ½éª—åˆ°ä¸ª$1pt$å‘¢ï¼‰</p>
<p>æœ€ç»ˆå¾—åˆ†åªæœ‰$90$ï¼Œæ»šCuäº†â€¦</p>
<p><img src="bee.png" alt="bee"></p>
]]></content>
      <categories>
        <category>æ¸¸è®°</category>
      </categories>
      <tags>
        <tag>trip</tag>
      </tags>
  </entry>
  <entry>
    <title>UVA11107 Life Forms</title>
    <url>/2022/01/26/sol-uva11107/</url>
    <content><![CDATA[<h2 id="UVA11107-Life-Forms"><a href="#UVA11107-Life-Forms" class="headerlink" title="UVA11107 Life Forms"></a>UVA11107 Life Forms</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/UVA11107">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ç›¸åŒå­ä¸²æƒ³åˆ°ç”¨åç¼€æ•°ç»„ã€‚</p>
<p>è€ƒè™‘å°†æ‰€æœ‰ä¸²ç”¨<code>$</code>è¿æ¥ã€‚è¿™æ ·åœ¨$height$æ•°ç»„ä¸Šç”¨STè¡¨ç»´æŠ¤åŒºé—´æœ€å°å€¼ï¼ˆå³åŒºé—´LCSï¼‰ï¼Œç¬¬ä¸€éæ‰«æç”¨åŒæŒ‡é’ˆå–$\left\lfloor\dfrac n 2\right\rfloor+1$ä¸ªä¸åŒä¸²ä¸­çš„æ•°å­—ï¼Œæ±‚å‡ºç­”æ¡ˆçš„é•¿åº¦ï¼Œç¬¬äºŒéæ‰«æå‡ºé•¿åº¦ä¸º$ans$çš„å­ä¸²ï¼Œç»è¿‡$hash$å»é‡åè¾“å‡ºå³å¯ã€‚æˆ‘çš„å†™æ³•éœ€è¦ç‰¹åˆ¤$n=1$ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(m \log m)$ï¼Œå…¶ä¸­$m=\sum |S|$ã€‚</p>
<p><del>ä»£ç å†™çš„æä¸‘æä¸ä¼˜é›…</del></p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           UVA11107.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/UVA11107</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">120</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">1e5</span> + <span class="number">150</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGK = <span class="number">19</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXK], rk[MAXK], tp[MAXK], ht[MAXK], he[MAXK];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXK];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">128</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i], tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">0</span>, w = <span class="number">1</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            he[i] = ht[sa[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, lg2[MAXK], mn[MAXK][LOGK];</span><br><span class="line"><span class="type">int</span> li[MAXN], ri[MAXN], id[MAXK], sz[MAXK], cnt[MAXN];</span><br><span class="line"><span class="type">char</span> s[MAXN][MAXM], str[MAXK];</span><br><span class="line"><span class="type">bool</span> vis[MAXN];</span><br><span class="line">unordered_map&lt;<span class="type">int</span>, <span class="type">bool</span>&gt; outed;</span><br><span class="line">SuffixArray sa;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> k = lg2[r - l];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(mn[l + <span class="number">1</span>][k], mn[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; MAXK; ++i)</span><br><span class="line">        lg2[i] = (i &amp; (i - <span class="number">1</span>)) ? lg2[i - <span class="number">1</span>] : lg2[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">read</span>(n) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (tot++)</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s[i]);</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, s[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> t = <span class="built_in">strlen</span>(s[i]);</span><br><span class="line">            li[i] = len;</span><br><span class="line">            ri[i] = len + t - <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">copy</span>(s[i], s[i] + t, str + len);</span><br><span class="line">            str[len + t] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">            len += t + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        str[--len] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        sa.<span class="built_in">init</span>(len, str);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> p = <span class="built_in">upper_bound</span>(li + <span class="number">1</span>, li + n + <span class="number">1</span>, sa.sa[i]) - li - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (li[p] &lt;= sa.sa[i] &amp;&amp; sa.sa[i] &lt;= ri[p])</span><br><span class="line">                id[i] = p, sz[i] = ri[p] - sa.sa[i] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                id[i] = <span class="number">0</span>, sz[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">            mn[i][<span class="number">0</span>] = <span class="built_in">min</span>(&#123;sa.he[i], sz[i - <span class="number">1</span>], sz[i]&#125;);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; LOGK; ++j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= len; ++i) &#123;</span><br><span class="line">                mn[i][j] = <span class="built_in">min</span>(mn[i][j - <span class="number">1</span>], mn[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fill</span>(cnt, cnt + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r = <span class="number">1</span>; r &lt;= len; ++r) &#123;</span><br><span class="line">            <span class="keyword">while</span> (id[l] == <span class="number">0</span>)</span><br><span class="line">                ++l;</span><br><span class="line">            <span class="keyword">while</span> (id[r] == <span class="number">0</span>)</span><br><span class="line">                ++r;</span><br><span class="line">            <span class="keyword">if</span> (cnt[id[r]]++ == <span class="number">0</span>)</span><br><span class="line">                ++cur;</span><br><span class="line">            <span class="keyword">while</span> (cur &gt; n / <span class="number">2</span> + <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (--cnt[id[l]] == <span class="number">0</span>)</span><br><span class="line">                    --cur;</span><br><span class="line">                ++l;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (l &lt; r &amp;&amp; cnt[id[l]] &gt; <span class="number">1</span>)</span><br><span class="line">                --cnt[id[l]], ++l;</span><br><span class="line">            <span class="keyword">if</span> (cur == n / <span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">                ans = <span class="built_in">max</span>(ans, <span class="built_in">query</span>(l, r));</span><br><span class="line">        &#125;</span><br><span class="line">        cur = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fill</span>(cnt, cnt + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (ans == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;?&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            outed.<span class="built_in">clear</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r = <span class="number">1</span>; r &lt;= len; ++r) &#123;</span><br><span class="line">                <span class="keyword">while</span> (id[l] == <span class="number">0</span>)</span><br><span class="line">                    ++l;</span><br><span class="line">                <span class="keyword">while</span> (id[r] == <span class="number">0</span>)</span><br><span class="line">                    ++r;</span><br><span class="line">                <span class="keyword">if</span> (cnt[id[r]]++ == <span class="number">0</span>)</span><br><span class="line">                    ++cur;</span><br><span class="line">                <span class="keyword">while</span> (cur &gt; n / <span class="number">2</span> + <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (--cnt[id[l]] == <span class="number">0</span>)</span><br><span class="line">                        --cur;</span><br><span class="line">                    ++l;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (l &lt; r &amp;&amp; cnt[id[l]] &gt; <span class="number">1</span>)</span><br><span class="line">                    --cnt[id[l]], ++l;</span><br><span class="line">                <span class="keyword">if</span> (cur == n / <span class="number">2</span> + <span class="number">1</span> &amp;&amp; <span class="built_in">query</span>(l, r) == ans) &#123;</span><br><span class="line">                    <span class="type">int</span> h = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ans; ++i)</span><br><span class="line">                        h = (h * <span class="number">12345</span> + str[sa.sa[r] + i]) % <span class="number">19260817</span>;</span><br><span class="line">                    <span class="keyword">if</span> (outed[h])</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    outed[h] = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ans; ++i)</span><br><span class="line">                        <span class="built_in">putchar</span>(str[sa.sa[r] + i]);</span><br><span class="line">                    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">debug</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4491 [HAOI] æŸ“è‰²</title>
    <url>/2022/01/25/sol-p4491/</url>
    <content><![CDATA[<h2 id="P4491-HAOI-æŸ“è‰²"><a href="#P4491-HAOI-æŸ“è‰²" class="headerlink" title="P4491 [HAOI] æŸ“è‰²"></a>P4491 [HAOI] æŸ“è‰²</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4491">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>è€ƒè™‘æœ´ç´ çš„åšæ³•ã€‚å®¹æ˜“æƒ³åˆ°é’¦å®š$k$ä¸ªé¢œè‰²å‡ºç°æ¬¡æ•°æ°å¥½ä¸º$S$ï¼Œå…¶ä»–é¢œè‰²éšä¾¿å¡«å¹¶å®¹æ–¥ã€‚æ±‚å‡º$k \in [0, \min(m,n/2)]$å³å¯ã€‚</p>
<script type="math/tex; mode=display">
F[k]=\binom{m}{k}\binom{n}{ks}\frac{(ks)!}{(s!)^k}(m-k)^{n-ks}</script><p>æ€è€ƒè¿™æ ·é‡å¤è®¡ç®—åˆ°çš„éƒ¨åˆ†ã€‚è®¾$G[i]$ä¸ºçœŸæ­£çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆæœ‰</p>
<script type="math/tex; mode=display">
F[k]=\sum_{i=k}^n\binom{i}{k}G[i]</script><p>ä½¿ç”¨äºŒé¡¹å¼åæ¼”ï¼Œå¾—åˆ°</p>
<script type="math/tex; mode=display">
G[k]=\sum_{i=k}^n(-1)^{i-k}\binom{i}{k}F[i]</script><p>å°†ç»„åˆæ•°å±•å¼€</p>
<script type="math/tex; mode=display">
G[k]=\sum_{i=k}^n(-1)^{i-k}\frac{i!}{k!(i-k)!}F[i]</script><p>å¯¹$1004535809$å–æ¨¡ï¼Œä½ æƒ³åˆ°äº†ä»€ä¹ˆï¼Ÿ</p>
<script type="math/tex; mode=display">
G[k]=\frac{1}{k!}\sum_{i=k}^ni!F[i]\times\frac{(-1)^{i-k}}{(i-k)!}</script><p>äºæ˜¯$O(n+m\log m)$ç®—å‡º$F[0\cdots m]$ï¼Œç„¶åNTTåšå·ç§¯å·®æ±‚å‡º$G[0\cdots m]$å³å¯ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4491.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4491</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1004535809</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x -= y;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % p)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x % p;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> rev[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span>* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">change</span>(f, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">            <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                f[k] = <span class="built_in">add</span>(u, t), f[k + h / <span class="number">2</span>] = <span class="built_in">sub</span>(u, t);</span><br><span class="line">                g = g * gn % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">        <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            f[i] = f[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace maths</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="type">int</span> n, m, s, w[MAXN];</span><br><span class="line"><span class="type">int</span> a[MAXN], b[MAXN], f[MAXN], g[MAXN];</span><br><span class="line"><span class="type">int</span> fac[MAXM], inv[MAXM];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">binom</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fac[x] * inv[y] % MOD * inv[x - y] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(s);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">read</span>(w[i]);</span><br><span class="line">    fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXM; ++i)</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">    inv[MAXM - <span class="number">1</span>] = <span class="built_in">qpow</span>(fac[MAXM - <span class="number">1</span>], MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXM - <span class="number">2</span>; ~i; --i)</span><br><span class="line">        inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">    <span class="type">int</span> mx = <span class="built_in">min</span>(m, n / s);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= mx; ++i) &#123;</span><br><span class="line">        f[i] = <span class="built_in">binom</span>(m, i) * <span class="built_in">binom</span>(n, i * s) % MOD * fac[i * s] % MOD</span><br><span class="line">             * <span class="built_in">qpow</span>(inv[s], i) % MOD * <span class="built_in">qpow</span>(m - i, n - i * s) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= mx; ++i) &#123;</span><br><span class="line">        a[i] = fac[i] * f[i] % MOD;</span><br><span class="line">        b[i] = (i &amp; <span class="number">1</span>) ? <span class="built_in">sub</span>(MOD, inv[i]) : inv[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">reverse</span>(a, a + mx + <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt;= mx + mx + <span class="number">1</span>)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, len, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(b, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        g[i] = a[i] * b[i] % MOD;</span><br><span class="line">    <span class="built_in">ntt</span>(g, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">reverse</span>(g, g + mx + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= mx; ++i)</span><br><span class="line">        g[i] = g[i] * inv[i] % MOD;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= mx; ++i)</span><br><span class="line">        ans = <span class="built_in">add</span>(ans, g[i] * w[i] % MOD);</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P1501 [å›½å®¶é›†è®­é˜Ÿ] Tree II</title>
    <url>/2022/01/23/sol-p1501/</url>
    <content><![CDATA[<h2 id="P1501-å›½å®¶é›†è®­é˜Ÿ-Tree-II"><a href="#P1501-å›½å®¶é›†è®­é˜Ÿ-Tree-II" class="headerlink" title="P1501 [å›½å®¶é›†è®­é˜Ÿ] Tree II"></a>P1501 [å›½å®¶é›†è®­é˜Ÿ] Tree II</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P1501">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä¸€é“LCTçš„æ¨¡ç‰ˆé¢˜ã€‚</p>
<p>ä½†æ˜¯æˆ‘ç«Ÿç„¶é”™äº†$2$æ¬¡ï¼ï¼ï¼</p>
<p>$4$ç§æ“ä½œå®¹æ˜“è¿›è¡Œä¸å¤šè¯´ï¼Œè€ƒè™‘ç»´æŠ¤<code>add</code>å’Œ<code>mul</code>æ“ä½œï¼Œéœ€è¦ç»´æŠ¤å­æ ‘$size$ï¼Œä¿®æ”¹çš„æ—¶å€™è¦è®°å¾—ä¿®æ”¹<code>val</code>è€Œä¸æ˜¯åªä¿®æ”¹<code>sum</code>ï¼Œå…¶ä»–å°±å’Œçº¿æ®µæ ‘æ²¡å•¥åŒºåˆ«äº†ã€‚</p>
<p>ç›¸æ¯”LCTçš„æ¨¡ç‰ˆï¼Œåªæ˜¯ä¿®æ”¹äº†<code>pushdown</code>å’Œ<code>getdown</code>ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P1501.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P1501</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">51061</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LCT</span> &#123;</span><br><span class="line">    <span class="type">int</span> fa[MAXN], ch[MAXN][<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> val[MAXN], sum[MAXN], siz[MAXN];</span><br><span class="line">    <span class="type">int</span> tag[MAXN], add[MAXN], mul[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">connect</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> f, <span class="type">int</span> w)</span> </span>&#123; fa[x] = f, (~w) &amp;&amp; (ch[f][w] = x); &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        val[x] = sum[x] = siz[x] = mul[x] = <span class="number">1</span>;</span><br><span class="line">        tag[x] = add[x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        siz[x] = siz[ch[x][<span class="number">0</span>]] + siz[ch[x][<span class="number">1</span>]] + <span class="number">1</span>;</span><br><span class="line">        sum[x] = (sum[ch[x][<span class="number">0</span>]] + sum[ch[x][<span class="number">1</span>]] + val[x]) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ch[fa[x]][<span class="number">0</span>] == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ch[fa[x]][<span class="number">1</span>] == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getdown</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> vm, <span class="type">int</span> va)</span> </span>&#123;</span><br><span class="line">        mul[x] = mul[x] * vm % MOD;</span><br><span class="line">        add[x] = (add[x] * vm + va) % MOD;</span><br><span class="line">        val[x] = (val[x] * vm + va) % MOD;</span><br><span class="line">        sum[x] = (sum[x] * vm + va * siz[x]) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mul[x] != <span class="number">1</span> || add[x] != <span class="number">0</span> || tag[x]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (tag[x])</span><br><span class="line">                <span class="built_in">swap</span>(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">                <span class="built_in">getdown</span>(ch[x][<span class="number">0</span>], mul[x], add[x]), tag[ch[x][<span class="number">0</span>]] ^= tag[x];</span><br><span class="line">            <span class="keyword">if</span> (ch[x][<span class="number">1</span>])</span><br><span class="line">                <span class="built_in">getdown</span>(ch[x][<span class="number">1</span>], mul[x], add[x]), tag[ch[x][<span class="number">1</span>]] ^= tag[x];</span><br><span class="line">            mul[x] = <span class="number">1</span>, add[x] = tag[x] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushall</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (~<span class="built_in">get</span>(x))</span><br><span class="line">            <span class="built_in">pushall</span>(fa[x]);</span><br><span class="line">        <span class="built_in">pushdown</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> y = fa[x], z = fa[y], w = <span class="built_in">get</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (~w)</span><br><span class="line">            <span class="built_in">connect</span>(ch[x][w ^ <span class="number">1</span>], y, w);</span><br><span class="line">        <span class="built_in">connect</span>(x, z, <span class="built_in">get</span>(y));</span><br><span class="line">        <span class="built_in">connect</span>(y, x, w ^ <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">pushup</span>(y);</span><br><span class="line">        <span class="built_in">pushup</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">pushall</span>(x);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> f = fa[x]; f = fa[x], ~<span class="built_in">get</span>(x); <span class="built_in">rotate</span>(x))</span><br><span class="line">            <span class="keyword">if</span> (~<span class="built_in">get</span>(f))</span><br><span class="line">                <span class="built_in">rotate</span>(<span class="built_in">get</span>(f) == <span class="built_in">get</span>(x) ? f : x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> pre = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x) &#123;</span><br><span class="line">            <span class="built_in">splay</span>(x);</span><br><span class="line">            ch[x][<span class="number">1</span>] = pre;</span><br><span class="line">            <span class="built_in">pushup</span>(x);</span><br><span class="line">            pre = x;</span><br><span class="line">            x = fa[x];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">makeroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">access</span>(x);</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        tag[x] ^= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">access</span>(x);</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        <span class="keyword">while</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">            <span class="built_in">pushdown</span>(x), x = ch[x][<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">makeroot</span>(x);</span><br><span class="line">        <span class="built_in">access</span>(y);</span><br><span class="line">        <span class="built_in">splay</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">makeroot</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">findroot</span>(y) == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        fa[x] = y;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">findroot</span>(x) != <span class="built_in">findroot</span>(y))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">split</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span> (fa[x] != y || ch[x][<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        fa[x] = ch[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, q;</span><br><span class="line">LCT lct;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        lct.<span class="built_in">clear</span>(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        lct.<span class="built_in">link</span>(u, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">char</span> op = <span class="built_in">getchar</span>();</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="string">&#x27;+&#x27;</span>) &#123;</span><br><span class="line">            <span class="type">int</span> u, v, c;</span><br><span class="line">            <span class="built_in">read</span>(u), <span class="built_in">read</span>(v), <span class="built_in">read</span>(c);</span><br><span class="line">            lct.<span class="built_in">split</span>(u, v);</span><br><span class="line">            lct.<span class="built_in">getdown</span>(v, <span class="number">1</span>, c);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="string">&#x27;-&#x27;</span>) &#123;</span><br><span class="line">            <span class="type">int</span> u1, v1, u2, v2;</span><br><span class="line">            <span class="built_in">read</span>(u1), <span class="built_in">read</span>(v1), <span class="built_in">read</span>(u2), <span class="built_in">read</span>(v2);</span><br><span class="line">            lct.<span class="built_in">cut</span>(u1, v1);</span><br><span class="line">            lct.<span class="built_in">link</span>(u2, v2);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="string">&#x27;*&#x27;</span>) &#123;</span><br><span class="line">            <span class="type">int</span> u, v, c;</span><br><span class="line">            <span class="built_in">read</span>(u), <span class="built_in">read</span>(v), <span class="built_in">read</span>(c);</span><br><span class="line">            lct.<span class="built_in">split</span>(u, v);</span><br><span class="line">            lct.<span class="built_in">getdown</span>(v, c, <span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> u, v;</span><br><span class="line">            <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">            lct.<span class="built_in">split</span>(u, v);</span><br><span class="line">            <span class="built_in">write</span>(lct.sum[v]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3690 ã€æ¨¡ç‰ˆã€‘åŠ¨æ€æ ‘ï¼ˆLink Cut Treeï¼‰</title>
    <url>/2022/01/23/sol-p3690/</url>
    <content><![CDATA[<h2 id="P3690-ã€æ¨¡ç‰ˆã€‘åŠ¨æ€æ ‘ï¼ˆLink-Cut-Treeï¼‰"><a href="#P3690-ã€æ¨¡ç‰ˆã€‘åŠ¨æ€æ ‘ï¼ˆLink-Cut-Treeï¼‰" class="headerlink" title="P3690 ã€æ¨¡ç‰ˆã€‘åŠ¨æ€æ ‘ï¼ˆLink Cut Treeï¼‰"></a>P3690 ã€æ¨¡ç‰ˆã€‘åŠ¨æ€æ ‘ï¼ˆLink Cut Treeï¼‰</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3690">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p><del>WCå®åœ¨æ˜¯å¤ªæ— èŠå­</del></p>
<p>ä»Šå¤©æ˜¯å†¬ä»¤è¥çš„ç¬¬ä¸€å¤©ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹LCTå§ï¼ˆé›¾</p>
<h4 id="å¼•å…¥-amp-å®šä¹‰"><a href="#å¼•å…¥-amp-å®šä¹‰" class="headerlink" title="å¼•å…¥&amp;å®šä¹‰"></a>å¼•å…¥&amp;å®šä¹‰</h4><p>Link Cut Treeï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¯ä»¥åŠ¨æ€ç»´æŠ¤æ ‘ä¸Šè·¯å¾„æƒå€¼å’Œã€æ ‘ä¸Šè¿è¾¹ä¸æ–­è¾¹æ“ä½œçš„ä¸€ç§æ•°æ®ç»“æ„ã€‚</p>
<p>è¯´åˆ°ç»´æŠ¤æ ‘ä¸Šè·¯å¾„æƒå€¼å’Œï¼Œé¦–å…ˆæƒ³åˆ°çš„åº”è¯¥å°±æ˜¯æ ‘é“¾å‰–åˆ†äº†ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šé€‰æ‹©ç”¨$O(n \log n)$çš„é‡é“¾å‰–åˆ†ã€‚ä½†æ˜¯åœ¨åŠ¨æ€æ ‘ä¸Šï¼Œé‡é“¾éšæ—¶ä¼šæ”¹å˜ï¼Œä½¿ç”¨é‡é“¾å‰–åˆ†å°±ä¸è¡Œäº†ã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é‡‡ç”¨æ›´ä¸ºæš´åŠ›çš„å®é“¾å‰–åˆ†ã€‚ä¸è€ƒè™‘å„å„¿å­çš„å­æ ‘å¤§å°ï¼Œç›´æ¥éšä¾¿å–ä¸€ä¸ªå„¿å­ä¸çˆ¶äº²è¿æ¥æˆä¸€æ¡é“¾ã€‚äºæ˜¯æ ‘çš„å½¢æ€å˜åŒ–å°±ä¸ä¼šå½±å“å¤æ‚åº¦ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ ·çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n^2)$çš„ã€‚</p>
<p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆæ•°æ®ç»“æ„å¯ä»¥å¾ˆå¥½åœ°ç»´æŠ¤è¿™æ ·çš„å®é“¾å‘¢ï¼Ÿè€ƒè™‘åˆ°ä¸€æ¡é“¾ä¸Šçš„èŠ‚ç‚¹æ·±åº¦éƒ½æ˜¯é€’å¢çš„ï¼Œä¸å¦¨ç”¨Splayæ¥ç»´æŠ¤æ¯æ¡é“¾ï¼Œè€ŒSplayçš„ä¸­åºéå†å°±æ˜¯æ•´æ¡é“¾ä»å¤´åˆ°å°¾çš„éå†ã€‚</p>
<p>å¦‚æ­¤æˆ‘ä»¬å¯ä»¥å°†ä¸€æ£µæ ‘ï¼ˆæ£®æ—ï¼‰è½¬åŒ–ä¸ºè‹¥å¹²æ¡é“¾ï¼Œæ¯æ¡é“¾ç”¨Splayæ¥ç»´æŠ¤ï¼Œæˆ‘ä»¬ç§°è¿™æ ·å½¢æˆçš„æ ‘å«åšè¾…åŠ©æ ‘ï¼ˆæ£®æ—ï¼‰ã€‚å¦‚ä¸‹å›¾ä¸­çš„ä¾‹å­ï¼ˆåŸæ ‘ï¼‰ï¼š</p>
<p><img src="tree-origin.png" alt="åŸæ ‘"></p>
<p>å…¶ä¸­å®çº¿è¡¨ç¤ºçš„æ˜¯éšæœºåˆ†é…çš„å®è¾¹ã€‚</p>
<p>å®ƒçš„è¾…åŠ©æ ‘å½¢æ€å¦‚ä¸‹ï¼š</p>
<p><img src="tree-aux.png" alt="è¾…åŠ©æ ‘"></p>
<p>åŸæ ‘ä¸­çš„å®é“¾éƒ½åœ¨åŒä¸€æ£µSplayä¸­ï¼Œè€ŒåŸæ ‘ä¸­çš„è™šé“¾åªæœ‰å„¿å­æŒ‡å‘çˆ¶äº²ï¼Œæ²¡æœ‰çˆ¶äº²æŒ‡å‘å„¿å­ã€‚</p>
<p>æ³¨æ„ï¼šè¾…åŠ©æ ‘çš„æŒ‡å‘ä¸ç­‰äºåŸæ ‘ä¸­çš„æŒ‡å‘ï¼Œè¾…åŠ©æ ‘çš„æ ¹ä¹Ÿä¸ç­‰äºåŸæ ‘çš„æ ¹ï¼</p>
<h4 id="æ•°ç»„-amp-å‡½æ•°"><a href="#æ•°ç»„-amp-å‡½æ•°" class="headerlink" title="æ•°ç»„&amp;å‡½æ•°"></a>æ•°ç»„&amp;å‡½æ•°</h4><p>é¦–å…ˆå®šä¹‰è¦ç”¨çš„æ•°ç»„ï¼š</p>
<ul>
<li><code>fa[x]</code> $x$åœ¨<strong>è¾…åŠ©æ ‘</strong>ä¸Šçš„çˆ¶èŠ‚ç‚¹</li>
<li><code>ch[x][0/1]</code> $x$åœ¨<strong>Splay</strong>ä¸­çš„å·¦å³å„¿å­</li>
<li><code>val[x]</code> $x$çš„æƒå€¼</li>
<li><code>sum[x]</code> $x$æ‰€åœ¨<strong>Splay</strong>çš„å­æ ‘ä¸­çš„æƒå€¼å’Œ</li>
<li><code>tag[x]</code> $x$èŠ‚ç‚¹çš„ç¿»è½¬æ ‡è®°ï¼ˆåé¢ä¼šæåˆ°ï¼‰</li>
</ul>
<p>éœ€è¦çš„å‡½æ•°å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>pushup(x)</code> æ›´æ–°èŠ‚ç‚¹æƒå€¼ï¼Œä¸å¤šè¯´äº†</li>
<li><code>pushdown(x)</code> ä¸‹ä¼ ç¿»è½¬æ ‡è®°</li>
<li><code>pushall(x)</code> å°†$x$åœ¨Splayä¸­åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„å…¨éƒ¨ä¸‹ä¼ æ ‡è®°</li>
<li><code>connect(x, f, w)</code> Splayæ“ä½œï¼šè¿æ¥$x$ä¸º$f$çš„$w$å„¿å­ï¼ˆ$w=-1$è¡¨ç¤ºè™šè¾¹ä¸Šçš„å„¿å­ï¼‰</li>
<li><code>get(x)</code> è·å–$x$æ˜¯å“ªç§å„¿å­</li>
<li><code>rotate(x)</code> Splayæ“ä½œï¼šæ—‹è½¬</li>
<li><code>splay(x)</code> Splayæ“ä½œï¼šæ—‹è½¬åˆ°æ ¹</li>
<li><code>access(x)</code> LCTçš„æ ¸å¿ƒï¼šå°†$x$ä¸æ ¹æ”¾åˆ°åŒä¸€æ¡å®é“¾ä¸­</li>
<li><code>makeroot(x)</code> å°†$x$å˜æˆåŸæ ‘çš„æ ¹</li>
<li><code>split(x, y)</code> å°†$x$åˆ°$y$çš„è·¯å¾„æ”¾åˆ°åŒä¸€æ¡å®é“¾ä¸­</li>
<li><code>findroot(x)</code> æ‰¾åˆ°$x$æ‰€åœ¨å®é“¾çš„é“¾å¤´</li>
<li><code>link(x, y)</code> è¿æ¥$x$åˆ°$y$</li>
<li><code>cut(x, y)</code> æ–­å¼€$x$åˆ°$y$</li>
</ul>
<h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><h5 id="pushup-x"><a href="#pushup-x" class="headerlink" title="pushup(x)"></a>pushup(x)</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°sum</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è§†æƒ…å†µè€Œå®šï¼Œæœ¬é¢˜ä¸ºå¼‚æˆ–å’Œ</span></span><br><span class="line">    sum[x] = sum[ch[x][<span class="number">0</span>]] ^ sum[ch[x][<span class="number">1</span>]] ^ val[x];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="pushdown-x"><a href="#pushdown-x" class="headerlink" title="pushdown(x)"></a>pushdown(x)</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ ‡è®°ä¸‹ä¼ </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tag[x]) &#123;</span><br><span class="line">        <span class="built_in">swap</span>(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">            tag[ch[x][<span class="number">0</span>]] ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (ch[x][<span class="number">1</span>])</span><br><span class="line">            tag[ch[x][<span class="number">1</span>]] ^= <span class="number">1</span>;</span><br><span class="line">        tag[x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="pushall-x"><a href="#pushall-x" class="headerlink" title="pushall(x)"></a>pushall(x)</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€’å½’å®ç°å³å¯</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushall</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (~<span class="built_in">get</span>(x))</span><br><span class="line">        <span class="built_in">pushall</span>(fa[x]);</span><br><span class="line">    <span class="built_in">pushdown</span>(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="connect-x-f-w"><a href="#connect-x-f-w" class="headerlink" title="connect(x, f, w)"></a>connect(x, f, w)</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‹åˆ°ä¸€è¡Œ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">connect</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> f, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">    fa[x] = f, (~w) &amp;&amp; (ch[f][w] = x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="get-x"><a href="#get-x" class="headerlink" title="get(x)"></a>get(x)</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªå‹ä¸äº†</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ch[fa[x]][<span class="number">0</span>] == x)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (ch[fa[x]][<span class="number">1</span>] == x)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="rotate-x"><a href="#rotate-x" class="headerlink" title="rotate(x)"></a>rotate(x)</h5><p>å’Œæ™®é€šçš„splayä¸ä¸€æ ·äº†ï¼Œè¦åˆ¤æ–­è™šè¾¹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x], z = fa[y], w = <span class="built_in">get</span>(x);</span><br><span class="line">    <span class="keyword">if</span> (~w)</span><br><span class="line">        <span class="built_in">connect</span>(ch[x][w ^ <span class="number">1</span>], y, w);</span><br><span class="line">    <span class="built_in">connect</span>(x, z, <span class="built_in">get</span>(y));</span><br><span class="line">    <span class="built_in">connect</span>(y, x, w ^ <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">pushup</span>(y);</span><br><span class="line">    <span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="splay-x"><a href="#splay-x" class="headerlink" title="splay(x)"></a>splay(x)</h5><p>ç¬¬ä¸€è¡Œè¦å…ˆå°†ä¸Šæ–¹çš„æ ‡è®°éƒ½ä¸‹ä¼ </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">pushall</span>(x);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> f = fa[x]; f = fa[x], ~<span class="built_in">get</span>(x); <span class="built_in">rotate</span>(x))</span><br><span class="line">        <span class="keyword">if</span> (~<span class="built_in">get</span>(f))</span><br><span class="line">            <span class="built_in">rotate</span>(<span class="built_in">get</span>(f) == <span class="built_in">get</span>(x) ? f : x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="access-x"><a href="#access-x" class="headerlink" title="access(x)"></a>access(x)</h5><p><img src="tree-aux.png" alt="è¾…åŠ©æ ‘"></p>
<p>è€ƒè™‘å°†ä¸Šå›¾çš„èŠ‚ç‚¹$9$ä¸æ ¹èŠ‚ç‚¹$1$æ‰“é€šã€‚</p>
<p>å› æ­¤è¦å…ˆå°†$9$è½¬åˆ°å½“å‰splayçš„æ ¹ï¼ˆå¦‚å›¾ï¼‰ã€‚</p>
<p><img src="tree-splayed.png" alt="splayåçš„è¾…åŠ©æ ‘"></p>
<p>è€Œæ ¹æ®è¾…åŠ©æ ‘ä¸Šé“¾çš„æ€§è´¨ï¼Œ$9$ã€$13$å’Œ$10$ä¸åº”è¯¥åœ¨ä¸€æ¡é“¾ä¸Šï¼Œäºæ˜¯å°†$9$ä¸$13$æ–­å¼€æˆè™šé“¾ï¼ˆä»çˆ¶äº²ä¸­ç§»é™¤æŒ‡å‘å³å¯ï¼‰ï¼ŒåŒæ—¶å°†ä¸‹æ–¹ä¸$x$è¿æ¥çš„å¦ä¸€æ£µsplayè¿æ¥ï¼ˆ<code>ch[x][1]:=pre</code>ï¼‰ã€‚</p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œä¸€ç›´å¾€ä¸Šé‡å¤æ­¤æ“ä½œç›´åˆ°æ ¹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> pre = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (x) &#123;</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        ch[x][<span class="number">1</span>] = pre;</span><br><span class="line">        <span class="built_in">pushup</span>(x);</span><br><span class="line">        pre = x;</span><br><span class="line">        x = fa[x];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="makeroot-x"><a href="#makeroot-x" class="headerlink" title="makeroot(x)"></a>makeroot(x)</h5><p>è®©$x$æˆä¸ºæ–°çš„åŸæ ‘çš„æ ¹ã€‚å°†$x$è½¬åˆ°æ ¹èŠ‚ç‚¹çš„splayä¸­ï¼Œç„¶åè®©$x$æˆä¸ºæ ¹èŠ‚ç‚¹ã€‚</p>
<p>ä½†æ˜¯è¿™æ ·ä¸€æ¥ï¼Œ$x$æ‰€åœ¨çš„splayæ ‘å°±ä¹±æ‰äº†ï¼Œå› ä¸ºæ— æ³•å†ä¿è¯æ·±åº¦é€’å¢ã€‚åŒæ—¶å‘ç°ç”±äºåœ¨<code>access(x)</code>ä¹‹å$x$çš„å³å„¿å­è¢«æ¸…ç©ºäº†ï¼Œæ‰€ä»¥å°†è¯¥splayç¿»è½¬å°±å¾—åˆ°æ–°çš„æŒ‰æ·±åº¦é€’å¢çš„splayï¼ˆä»”ç»†æƒ³æƒ³æ˜¯ä¸æ˜¯ï¼‰ã€‚äºæ˜¯ä»£ç å°±å‡ºæ¥äº†ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">makeroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(x);</span><br><span class="line">    <span class="built_in">splay</span>(x);</span><br><span class="line">    tag[x] ^= <span class="number">1</span>; <span class="comment">// è¿™æ˜¯ç¿»è½¬çš„æ ‡è®°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="split-x-y"><a href="#split-x-y" class="headerlink" title="split(x, y)"></a>split(x, y)</h5><p>å°†$x$æˆä¸ºåŸæ ‘çš„æ ¹ï¼ˆåŒæ—¶æ˜¯è¯¥splayçš„æ·±åº¦æœ€å°èŠ‚ç‚¹ï¼‰ï¼Œå†å°†$y$ä¸$x$æ‰“é€šï¼Œæ—‹è½¬$y$åˆ°è¯¥splayçš„æ ¹ï¼Œæ˜¾ç„¶$y$çš„å½“å‰$sum$å€¼å°±æ˜¯$x$åˆ°$y$è·¯å¾„çš„$sum$ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">makeroot</span>(x);</span><br><span class="line">    <span class="built_in">access</span>(y);</span><br><span class="line">    <span class="built_in">splay</span>(y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="findroot-x"><a href="#findroot-x" class="headerlink" title="findroot(x)"></a>findroot(x)</h5><p>å°†$x$ä¸æ ¹æ‰“é€šï¼ˆ<code>access(x)</code>ï¼‰ï¼Œæ˜¾ç„¶splayæœ€å·¦è¾¹çš„èŠ‚ç‚¹å°±æ˜¯æ ¹äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(x);</span><br><span class="line">    <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="keyword">while</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">pushdown</span>(x), x = ch[x][<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="link-x-y"><a href="#link-x-y" class="headerlink" title="link(x, y)"></a>link(x, y)</h5><p>å…ˆåˆ¤æ–­$x$ä¸$y$æ˜¯å¦è”é€šï¼Œç±»ä¼¼å¹¶æŸ¥é›†çš„æ–¹æ³•ã€‚</p>
<p>ç„¶å$y$è½¬åˆ°æ ¹ï¼Œå°†$x$æŒ‡å‘$y$ï¼ˆæ³¨æ„ä¸è¦è®©çˆ¶äº²$y$æŒ‡å‘å„¿å­$x$ï¼‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">makeroot</span>(x);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">findroot</span>(y) == x)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    fa[x] = y;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="cut-x-y"><a href="#cut-x-y" class="headerlink" title="cut(x, y)"></a>cut(x, y)</h5><p>è¿˜æ˜¯å…ˆåˆ¤æ–­$x$ä¸$y$åœ¨åŒä¸€ä¸ªè”é€šå—ã€‚</p>
<p>å°†$x$åˆ°$y$çš„è·¯å¾„å–å‡ºï¼Œå¹¶åˆ¤æ–­$x$ä¸$y$æ˜¯å¦ç›´æ¥è¿æ¥ã€‚</p>
<p>å¦‚æœç›´æ¥è¿æ¥ï¼Œç›´æ¥æ–­å¼€å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">findroot</span>(x) != <span class="built_in">findroot</span>(y))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">split</span>(x, y);</span><br><span class="line">    <span class="keyword">if</span> (fa[x] != y || ch[x][<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    fa[x] = ch[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼ŒLCTçš„å„å‡½æ•°å®ç°å°±è®²å®Œäº†ï¼Œä¸‹é¢æ”¾å‡ºä¸€ä¸ªå°è£…å¥½çš„æ¨¡ç‰ˆï¼š</p>
<h4 id="æ¨¡ç‰ˆ"><a href="#æ¨¡ç‰ˆ" class="headerlink" title="æ¨¡ç‰ˆ"></a>æ¨¡ç‰ˆ</h4><p>ç†è®ºæ—¶é—´å¤æ‚åº¦æ˜¯$O(n \log n)$ï¼ˆæˆ‘ä¹Ÿä¸ä¼šè¯æ˜ï¼‰ï¼Œä½†æ˜¯<strong>å¸¸æ•°æå¤§</strong>ï¼ˆå¬è¯´èƒ½æœ‰$20$ï¼Ÿï¼‰ï¼Œæ…ç”¨ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LCT</span> &#123;</span><br><span class="line">    <span class="type">int</span> fa[MAXN], ch[MAXN][<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> val[MAXN], sum[MAXN], tag[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; sum[x] = sum[ch[x][<span class="number">0</span>]] ^ sum[ch[x][<span class="number">1</span>]] ^ val[x]; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">connect</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> f, <span class="type">int</span> w)</span> </span>&#123; fa[x] = f, (~w) &amp;&amp; (ch[f][w] = x); &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ch[fa[x]][<span class="number">0</span>] == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ch[fa[x]][<span class="number">1</span>] == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (tag[x]) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">                tag[ch[x][<span class="number">0</span>]] ^= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (ch[x][<span class="number">1</span>])</span><br><span class="line">                tag[ch[x][<span class="number">1</span>]] ^= <span class="number">1</span>;</span><br><span class="line">            tag[x] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushall</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (~<span class="built_in">get</span>(x))</span><br><span class="line">            <span class="built_in">pushall</span>(fa[x]);</span><br><span class="line">        <span class="built_in">pushdown</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> y = fa[x], z = fa[y], w = <span class="built_in">get</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (~w)</span><br><span class="line">            <span class="built_in">connect</span>(ch[x][w ^ <span class="number">1</span>], y, w);</span><br><span class="line">        <span class="built_in">connect</span>(x, z, <span class="built_in">get</span>(y));</span><br><span class="line">        <span class="built_in">connect</span>(y, x, w ^ <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">pushup</span>(y);</span><br><span class="line">        <span class="built_in">pushup</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">pushall</span>(x);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> f = fa[x]; f = fa[x], ~<span class="built_in">get</span>(x); <span class="built_in">rotate</span>(x))</span><br><span class="line">            <span class="keyword">if</span> (~<span class="built_in">get</span>(f))</span><br><span class="line">                <span class="built_in">rotate</span>(<span class="built_in">get</span>(f) == <span class="built_in">get</span>(x) ? f : x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> pre = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x) &#123;</span><br><span class="line">            <span class="built_in">splay</span>(x);</span><br><span class="line">            ch[x][<span class="number">1</span>] = pre;</span><br><span class="line">            <span class="built_in">pushup</span>(x);</span><br><span class="line">            pre = x;</span><br><span class="line">            x = fa[x];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">makeroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">access</span>(x);</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        tag[x] ^= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">makeroot</span>(x);</span><br><span class="line">        <span class="built_in">access</span>(y);</span><br><span class="line">        <span class="built_in">splay</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">access</span>(x);</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        <span class="keyword">while</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">            <span class="built_in">pushdown</span>(x), x = ch[x][<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">makeroot</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">findroot</span>(y) == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        fa[x] = y;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">findroot</span>(x) != <span class="built_in">findroot</span>(y))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">split</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span> (fa[x] != y || ch[x][<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        fa[x] = ch[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3690.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3690</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LCT</span> &#123;</span><br><span class="line">    <span class="type">int</span> fa[MAXN], ch[MAXN][<span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> val[MAXN], sum[MAXN], tag[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; sum[x] = sum[ch[x][<span class="number">0</span>]] ^ sum[ch[x][<span class="number">1</span>]] ^ val[x]; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">connect</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> f, <span class="type">int</span> w)</span> </span>&#123; fa[x] = f, (~w) &amp;&amp; (ch[f][w] = x); &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ch[fa[x]][<span class="number">0</span>] == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ch[fa[x]][<span class="number">1</span>] == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (tag[x]) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">                tag[ch[x][<span class="number">0</span>]] ^= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (ch[x][<span class="number">1</span>])</span><br><span class="line">                tag[ch[x][<span class="number">1</span>]] ^= <span class="number">1</span>;</span><br><span class="line">            tag[x] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushall</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (~<span class="built_in">get</span>(x))</span><br><span class="line">            <span class="built_in">pushall</span>(fa[x]);</span><br><span class="line">        <span class="built_in">pushdown</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> y = fa[x], z = fa[y], w = <span class="built_in">get</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (~w)</span><br><span class="line">            <span class="built_in">connect</span>(ch[x][w ^ <span class="number">1</span>], y, w);</span><br><span class="line">        <span class="built_in">connect</span>(x, z, <span class="built_in">get</span>(y));</span><br><span class="line">        <span class="built_in">connect</span>(y, x, w ^ <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">pushup</span>(y);</span><br><span class="line">        <span class="built_in">pushup</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">pushall</span>(x);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> f = fa[x]; f = fa[x], ~<span class="built_in">get</span>(x); <span class="built_in">rotate</span>(x))</span><br><span class="line">            <span class="keyword">if</span> (~<span class="built_in">get</span>(f))</span><br><span class="line">                <span class="built_in">rotate</span>(<span class="built_in">get</span>(f) == <span class="built_in">get</span>(x) ? f : x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> pre = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x) &#123;</span><br><span class="line">            <span class="built_in">splay</span>(x);</span><br><span class="line">            ch[x][<span class="number">1</span>] = pre;</span><br><span class="line">            <span class="built_in">pushup</span>(x);</span><br><span class="line">            pre = x;</span><br><span class="line">            x = fa[x];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">makeroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">access</span>(x);</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        tag[x] ^= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">makeroot</span>(x);</span><br><span class="line">        <span class="built_in">access</span>(y);</span><br><span class="line">        <span class="built_in">splay</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">access</span>(x);</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        <span class="keyword">while</span> (ch[x][<span class="number">0</span>])</span><br><span class="line">            <span class="built_in">pushdown</span>(x), x = ch[x][<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">splay</span>(x);</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">makeroot</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">findroot</span>(y) == x)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        fa[x] = y;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">findroot</span>(x) != <span class="built_in">findroot</span>(y))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">split</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span> (fa[x] != y || ch[x][<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        fa[x] = ch[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, q;</span><br><span class="line">LCT lct;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(lct.val[i]);</span><br><span class="line">        lct.sum[i] = lct.val[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> op, x, y;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(x), <span class="built_in">read</span>(y);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">0</span>) &#123;</span><br><span class="line">            lct.<span class="built_in">split</span>(x, y);</span><br><span class="line">            <span class="built_in">write</span>(lct.sum[y]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            lct.<span class="built_in">link</span>(x, y);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>) &#123;</span><br><span class="line">            lct.<span class="built_in">cut</span>(x, y);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            lct.val[x] = y;</span><br><span class="line">            lct.<span class="built_in">splay</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF297E Mystic Carvings</title>
    <url>/2022/01/21/sol-cf297e/</url>
    <content><![CDATA[<h2 id="CF297E-Mystic-Carvings"><a href="#CF297E-Mystic-Carvings" class="headerlink" title="CF297E Mystic Carvings"></a>CF297E Mystic Carvings</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF297E">é¢˜ç›®é“¾æ¥</a></p>
<p><del>å·æ¥hbçš„é¢˜ï¼ˆå¼ºçƒˆå®‰åˆ©codeforcesçš„friendsåŠŸèƒ½ï¼‰</del></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>åœ¨åœ†ä¸­è¿æ¥$3$æ¡ä¸åœ¨ç«¯ç‚¹å¤„ç›¸äº¤çš„å¼¦ï¼Œå…±æœ‰ä»¥ä¸‹$5$ç§æƒ…å†µï¼š</p>
<p><img src="add.png" alt="add"></p>
<p><img src="sub.png" alt="sub"></p>
<p>é‚£ä¹ˆç¬¬ä¸€è¡Œçš„$2$ç§æ˜¯åˆæ³•çš„ï¼Œç¬¬äºŒè¡Œçš„$3$ç§ä¸åˆæ³•ã€‚å‘ç°ç¬¬äºŒè¡Œçš„$3$ç§æ›´åŠ ä¾¿äºè®¡ç®—ï¼Œäºæ˜¯æƒ³åˆ°ç”¨æ€»æ•°$\binom{n}{3}$å‡å»ä¸åˆæ³•çš„ã€‚</p>
<p>ç¬¬äºŒè¡Œç¬¬ä¸€ç§æƒ…å†µï¼Œæšä¸¾ä¸­é—´çš„ä¸€æ¡å¼¦ï¼Œé¢„å¤„ç†å‡ºæ¯æ¡å¼¦çš„ä¸¤ä¾§ä¸ä¸å…¶ç›¸äº¤çš„å¼¦çš„æ•°é‡ï¼Œè®¡ä¸º$ls_i$å’Œ$rs_i$ï¼Œç¬¬ä¸€ç§æƒ…å†µçš„è´¡çŒ®ä¸º</p>
<script type="math/tex; mode=display">
\sum_{i=1}^n ls_i \times rs_i</script><p>ç¬¬äºŒç§å’Œç¬¬ä¸‰ç§æƒ…å†µå¯ä»¥ä¸€èµ·è€ƒè™‘ã€‚è¿˜æ˜¯å…ˆæšä¸¾ä¸€æ¡å¼¦ï¼Œä¹‹åè¿˜éœ€è¦ä¸€æ¡ä¸å…¶ç›¸äº¤çš„å’Œä¸€æ¡ä¸å…¶ä¸ç›¸äº¤çš„å°±å¯ä»¥æ„é€ å‡ºç¬¬äºŒç§æˆ–ç¬¬ä¸‰ç§æƒ…å†µã€‚åŒæ—¶æ¯ç§æƒ…å†µä¼šè¢«è®¡ç®—$2$æ¬¡ï¼Œæ‰€ä»¥ç¬¬äºŒã€ä¸‰ç§æƒ…å†µçš„è´¡çŒ®ä¸º</p>
<script type="math/tex; mode=display">
\sum_{i=1}^n \frac{1}{2}(n-ls_i-rs_i-1)(ls_i+rs_i)</script><p>è‡³äºå¦‚ä½•æ±‚å‡º$ls_i$å’Œ$rs_i$ï¼Œç”¨æ ‘çŠ¶æ•°ç»„å’ŒCDQåˆ†æ²»éƒ½å¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \log n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF297E.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF297E</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">line</span> &#123;</span><br><span class="line">    <span class="type">int</span> l, r, id;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> line&amp; o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id &lt; o.id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, ls[MAXN], rs[MAXN], cnt[MAXN];</span><br><span class="line">line ln[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve1</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">solve1</span>(l, mid);</span><br><span class="line">    <span class="built_in">solve1</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="type">int</span> pos = l;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = mid + <span class="number">1</span>; i &lt;= r; ++i) &#123;</span><br><span class="line">        <span class="keyword">while</span> (pos &lt;= mid &amp;&amp; ln[pos].r &lt; ln[i].r)</span><br><span class="line">            pos++;</span><br><span class="line">        ls[ln[i].id] += pos - l;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">inplace_merge</span>(ln + l, ln + mid + <span class="number">1</span>, ln + r + <span class="number">1</span>, [](<span class="type">const</span> line&amp; lhs, <span class="type">const</span> line&amp; rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> lhs.r &lt; rhs.r;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve2</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">solve2</span>(l, mid);</span><br><span class="line">    <span class="built_in">solve2</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="type">int</span> pos = l;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = mid + <span class="number">1</span>; i &lt;= r; ++i) &#123;</span><br><span class="line">        <span class="keyword">while</span> (pos &lt;= mid &amp;&amp; ln[pos].r &gt; ln[i].r)</span><br><span class="line">            pos++;</span><br><span class="line">        rs[ln[i].id] += pos - l;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">inplace_merge</span>(ln + l, ln + mid + <span class="number">1</span>, ln + r + <span class="number">1</span>, [](<span class="type">const</span> line&amp; lhs, <span class="type">const</span> line&amp; rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> lhs.r &gt; rhs.r;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(ln[i].l), <span class="built_in">read</span>(ln[i].r);</span><br><span class="line">        <span class="keyword">if</span> (ln[i].l &gt; ln[i].r)</span><br><span class="line">            <span class="built_in">swap</span>(ln[i].l, ln[i].r);</span><br><span class="line">        ln[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(ln + <span class="number">1</span>, ln + n + <span class="number">1</span>, [](<span class="type">const</span> line&amp; lhs, <span class="type">const</span> line&amp; rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> lhs.l &gt; rhs.l;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">solve1</span>(<span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">sort</span>(ln + <span class="number">1</span>, ln + n + <span class="number">1</span>, [](<span class="type">const</span> line&amp; lhs, <span class="type">const</span> line&amp; rhs) &#123;</span><br><span class="line">        <span class="keyword">return</span> lhs.l &lt; rhs.l;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">solve2</span>(<span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">fill</span>(cnt + <span class="number">1</span>, cnt + n + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ++cnt[ln[i].r];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n + n; ++i)</span><br><span class="line">        cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        rs[ln[i].id] += cnt[ln[i].l];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fill</span>(cnt + <span class="number">1</span>, cnt + n + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ++cnt[ln[i].l];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n + n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        cnt[i] += cnt[i + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        rs[ln[i].id] += cnt[ln[i].r];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(ln + <span class="number">1</span>, ln + n + <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        ans += ls[i] * rs[i] * <span class="number">2</span>;</span><br><span class="line">        ans += (n - ls[i] - rs[i] - <span class="number">1</span>) * (ls[i] + rs[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    ans = n * (n - <span class="number">1</span>) * (n - <span class="number">2</span>) / <span class="number">6</span> - ans / <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å¹´å¤´OJæ•°ç»„è¶Šç•Œéƒ½ä¸æŠ¥REæŠ¥WAçš„å—ï¼Ÿ</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4223 æœŸæœ›é€†åºå¯¹</title>
    <url>/2022/01/20/sol-p4223/</url>
    <content><![CDATA[<h2 id="P4223-æœŸæœ›é€†åºå¯¹"><a href="#P4223-æœŸæœ›é€†åºå¯¹" class="headerlink" title="P4223 æœŸæœ›é€†åºå¯¹"></a>P4223 æœŸæœ›é€†åºå¯¹</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4223">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æœŸæœ›ä¹˜ä¸Š$\binom{n}{2}^k$åï¼Œå°±å˜æˆäº†æ±‚æ‰€æœ‰æƒ…å†µçš„é€†åºå¯¹æ•°é‡çš„æ€»å’Œã€‚</p>
<p>è€ƒè™‘è®¡ç®—è´¡çŒ®ã€‚å‡è®¾æšä¸¾äº†ä¸¤ä¸ªä½ç½®$i$å’Œ$j$ï¼Œå…¶å˜æ¢å‰çš„åºåˆ—ä¸­å¯¹åº”çš„æ•°å­—ä¸º$x$å’Œ$y$ï¼Œé‚£ä¹ˆç»è¿‡$k$æ¬¡å˜æ¢ï¼Œåœ¨è¿™ä¸¤ä¸ªä½ç½®ä¸Šçš„æ•°å­—æœ‰$7$ä¸­å¯èƒ½çš„æƒ…å†µï¼š</p>
<script type="math/tex; mode=display">
\begin{matrix}
(x,y) & (y,x) & (x,t) & (y,t) & (t,x) & (t,y) & (t,t)
\end{matrix}</script><p>è€Œè¿™$7$ç§çŠ¶æ€ä¹‹é—´å¯ä»¥åœ¨$1$æ¬¡å˜æ¢ä¹‹ä¸­ç›¸äº’è½¬åŒ–ï¼Œæ‰€ä»¥è€ƒè™‘çŸ©é˜µå¿«é€Ÿå¹‚ã€‚</p>
<p>å…ˆåˆ—å‡ºè½¬ç§»çŸ©é˜µå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
f_i(x,y) & f_i(y,x) & f_i(x,t) & f_i(y,t) & f_i(t,x) & f_i(t,y) & f_i(t,t)
\end{bmatrix} \\
\times \\
\begin{bmatrix}
\binom{n-2}{2} & 1 & n-2 & 0 & 0 & n-2 & 0 \\
1 & \binom{n-2}{2} & 0 & n-2 & n-2 & 0 & 0 \\
1 & 0 & \binom{n-2}{2}+n-3 & 1 & 1 & 0 & n-3 \\
0 & 1 & 1 & \binom{n-2}{2}+n-3 & 0 & 1 & n-3 \\
0 & 1 & 1 & 0 & \binom{n-2}{2}+n-3 & 1 & n-3 \\
1 & 0 & 0 & 1 & 1 & \binom{n-2}{2}+n-3 & n-3 \\
0 & 0 & 1 & 1 & 1 & 1 & \binom{n}{2}-4 \\
\end{bmatrix} \\
= \\
\begin{bmatrix}
f_{i+1}(x,y) & f_{i+1}(y,x) & f_{i+1}(x,t) & f_{i+1}(y,t) & f_{i+1}(t,x) & f_{i+1}(t,y) & f_{i+1}(t,t)
\end{bmatrix} \\</script><p>ç®—å‡ºäº†æ¯ç§æƒ…å†µçš„æ•°é‡åï¼Œå¯ä»¥å¼€å§‹ç»Ÿè®¡ç­”æ¡ˆäº†ã€‚</p>
<p>è€ƒè™‘æšä¸¾å³ç«¯ç‚¹$a_j=y$ï¼Œé€šè¿‡æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡å‡º$i<j$ä¸­$a_i<a_j$çš„æ•°å­—ä¸ªæ•°ã€æ¯ä¸ª$i-1$çš„å’Œä»¥åŠæ¯ä¸ª$n-i-1$çš„å’Œï¼Œåˆ†åˆ«è®¡ä¸º$lt_0$ï¼Œ$lt_1$å’Œ$lt_2$ï¼Œ$i<j$ä¸­$a_i>a_j$çš„é€šè¿‡è®¡ç®—æ±‚å‡ºå¹¶è®¡ä¸º$gt_0$ï¼Œ$gt_1$å’Œ$gt_2$ã€‚</p>
<ul>
<li>$(x,y)$: $p_0 \times gt_0$</li>
<li>$(y,x)$: $p_1 \times lt_0$</li>
<li>$(x,t)$: $p_2 \times \frac{gt_2+lt_1}{n-2}$</li>
<li>$(y,t)$: $p_3 \times \frac{lt_0(i-2)+gt_0(n-i)}{n-2}$</li>
<li>$(t,x)$: $p_4 \times \frac{gt_1+lt_2}{n-2}$</li>
<li>$(t,y)$: $p_5 \times \frac{gt_0(i-2)+lt_0(n-i)}{n-2}$</li>
</ul>
<p>$(t,t)$è¿™ç§æƒ…å†µæ”¾åœ¨æœ€åä¸€èµ·è€ƒè™‘ï¼Œè´¡çŒ®ä¸º$p_6 \times \frac{1}{2}\binom{n}{2}$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4223.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4223</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">binom2</span><span class="params">(<span class="type">int</span> x)</span></span>;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">MatrixType</span> &#123;</span><br><span class="line">    XY, YX, XT, YT, TX, TY, TT</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span> &#123;</span><br><span class="line">    <span class="built_in">int</span> (*a)[<span class="number">7</span>];</span><br><span class="line">    <span class="built_in">Matrix</span>() &#123; a = <span class="keyword">new</span> <span class="type">int</span>[<span class="number">7</span>][<span class="number">7</span>] &#123;&#125;; &#125;</span><br><span class="line">    <span class="built_in">Matrix</span>(<span class="type">int</span> n) &#123;</span><br><span class="line">        a = <span class="keyword">new</span> <span class="type">int</span>[<span class="number">7</span>][<span class="number">7</span>] &#123;</span><br><span class="line">            &#123; <span class="built_in">binom2</span>(n - <span class="number">2</span>), <span class="number">1</span>, n - <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, n - <span class="number">2</span>, <span class="number">0</span> &#125;,</span><br><span class="line">            &#123; <span class="number">1</span>, <span class="built_in">binom2</span>(n - <span class="number">2</span>), <span class="number">0</span>, n - <span class="number">2</span>, n - <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span> &#125;,</span><br><span class="line">            &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="built_in">binom2</span>(n - <span class="number">2</span>) + n - <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, n - <span class="number">3</span> &#125;,</span><br><span class="line">            &#123; <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="built_in">binom2</span>(n - <span class="number">2</span>) + n - <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, n - <span class="number">3</span> &#125;,</span><br><span class="line">            &#123; <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="built_in">binom2</span>(n - <span class="number">2</span>) + n - <span class="number">3</span>, <span class="number">1</span>, n - <span class="number">3</span> &#125;,</span><br><span class="line">            &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="built_in">binom2</span>(n - <span class="number">2</span>) + n - <span class="number">3</span>, n - <span class="number">3</span> &#125;,</span><br><span class="line">            &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="built_in">binom2</span>(n) - <span class="number">4</span> &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">7</span>; ++j)</span><br><span class="line">                a[i][j] %= MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span>* <span class="keyword">operator</span>[](<span class="type">int</span> i) &#123; <span class="keyword">return</span> a[i]; &#125;</span><br><span class="line">    <span class="keyword">friend</span> Matrix <span class="keyword">operator</span>*(<span class="type">const</span> Matrix&amp; lhs, <span class="type">const</span> Matrix&amp; rhs) &#123;</span><br><span class="line">        Matrix ret;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">7</span>; ++j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">7</span>; ++k)</span><br><span class="line">                    ret.a[i][j] = <span class="built_in">add</span>(ret.a[i][j], lhs.a[i][k] * rhs.a[k][j] % MOD);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BinaryIndexTree</span> &#123;</span><br><span class="line">    <span class="type">int</span> c[MAXN], n;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123; n = m; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = x; i &lt;= n; i += (i &amp; -i))</span><br><span class="line">            c[i] = ::<span class="built_in">add</span>(c[i], v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = x; i; i -= (i &amp; -i))</span><br><span class="line">            ret = ::<span class="built_in">add</span>(ret, c[i]);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, k, a[MAXN], p[<span class="number">7</span>], lt[<span class="number">3</span>], gt[<span class="number">3</span>], sum[<span class="number">3</span>];</span><br><span class="line">BinaryIndexTree ltr[<span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * y % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">binom2</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * (x - <span class="number">1</span>) / <span class="number">2</span> % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % MOD)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x % MOD;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Matrix <span class="title">qpow</span><span class="params">(Matrix x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    Matrix ret;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; ++i)</span><br><span class="line">        ret.a[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="function">Matrix <span class="title">base</span><span class="params">(n)</span>, ret</span>;</span><br><span class="line">    ret[<span class="number">0</span>][XY] = <span class="number">1</span>;</span><br><span class="line">    ret = ret * <span class="built_in">qpow</span>(base, k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; ++i)</span><br><span class="line">        p[i] = ret[<span class="number">0</span>][i];</span><br><span class="line">    ltr[<span class="number">0</span>].<span class="built_in">init</span>(n);</span><br><span class="line">    ltr[<span class="number">1</span>].<span class="built_in">init</span>(n);</span><br><span class="line">    ltr[<span class="number">2</span>].<span class="built_in">init</span>(n);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, inv = <span class="built_in">qpow</span>(n - <span class="number">2</span>, MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j) &#123;</span><br><span class="line">            lt[j] = ltr[j].<span class="built_in">sum</span>(a[i]);</span><br><span class="line">            gt[j] = sum[j] - lt[j];</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="built_in">add</span>(ans, <span class="built_in">mul</span>(p[<span class="number">0</span>], gt[<span class="number">0</span>]));</span><br><span class="line">        ans = <span class="built_in">add</span>(ans, <span class="built_in">mul</span>(p[<span class="number">1</span>], lt[<span class="number">0</span>]));</span><br><span class="line">        ans = <span class="built_in">add</span>(ans, <span class="built_in">mul</span>(p[<span class="number">2</span>], <span class="built_in">add</span>(<span class="built_in">mul</span>(gt[<span class="number">2</span>], inv), <span class="built_in">mul</span>(lt[<span class="number">1</span>], inv))));</span><br><span class="line">        ans = <span class="built_in">add</span>(ans, <span class="built_in">mul</span>(p[<span class="number">3</span>], <span class="built_in">add</span>(<span class="built_in">mul</span>(lt[<span class="number">0</span>], <span class="built_in">mul</span>(i - <span class="number">2</span>, inv)), <span class="built_in">mul</span>(gt[<span class="number">0</span>], <span class="built_in">mul</span>(n - i, inv)))));</span><br><span class="line">        ans = <span class="built_in">add</span>(ans, <span class="built_in">mul</span>(p[<span class="number">4</span>], <span class="built_in">add</span>(<span class="built_in">mul</span>(gt[<span class="number">1</span>], inv), <span class="built_in">mul</span>(lt[<span class="number">2</span>], inv))));</span><br><span class="line">        ans = <span class="built_in">add</span>(ans, <span class="built_in">mul</span>(p[<span class="number">5</span>], <span class="built_in">add</span>(<span class="built_in">mul</span>(gt[<span class="number">0</span>], <span class="built_in">mul</span>(i - <span class="number">2</span>, inv)), <span class="built_in">mul</span>(lt[<span class="number">0</span>], <span class="built_in">mul</span>(n - i, inv)))));</span><br><span class="line">        ltr[<span class="number">0</span>].<span class="built_in">add</span>(a[i], <span class="number">1</span>);</span><br><span class="line">        ltr[<span class="number">1</span>].<span class="built_in">add</span>(a[i], i - <span class="number">1</span>);</span><br><span class="line">        ltr[<span class="number">2</span>].<span class="built_in">add</span>(a[i], n - i - <span class="number">1</span>);</span><br><span class="line">        sum[<span class="number">0</span>] = <span class="built_in">add</span>(sum[<span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">        sum[<span class="number">1</span>] = <span class="built_in">add</span>(sum[<span class="number">1</span>], i - <span class="number">1</span>);</span><br><span class="line">        sum[<span class="number">2</span>] = <span class="built_in">add</span>(sum[<span class="number">2</span>], n - i - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="built_in">add</span>(ans, <span class="built_in">mul</span>(p[<span class="number">6</span>], <span class="built_in">mul</span>(<span class="built_in">binom2</span>(n), <span class="built_in">qpow</span>(<span class="number">2</span>, MOD - <span class="number">2</span>))));</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P5850 calc</title>
    <url>/2022/01/20/sol-p5850/</url>
    <content><![CDATA[<h2 id="P5850-calc"><a href="#P5850-calc" class="headerlink" title="P5850 calc"></a>P5850 calc</h2><span id="more"></span>
<p><del>åˆ«åšP4463ï¼Œæ¥åšP5850ï¼Œå¯ä»¥å°‘å†™ä¸€ä¸ªMTT</del></p>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P5850">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¦–å…ˆæƒ³åˆ°èƒ½æ„é€ ç”Ÿæˆå‡½æ•°ã€‚</p>
<script type="math/tex; mode=display">
F(x) = \prod_{t=1}^k (1 + tx)</script><p>ç­”æ¡ˆå°±æ˜¯$n! [x^n]F(x)$ï¼Œæ­£ç¡®æ€§æ˜¾ç„¶ã€‚</p>
<p>$k$å·¨å¤§ï¼ˆ$10^9$çº§åˆ«ï¼‰ï¼Œå¥—è·¯åœ°å°†$\prod$åŒ–ä¸º$\sum$ï¼š</p>
<script type="math/tex; mode=display">
F(x) = \exp \sum_{t=1}^k \ln(1+tx)</script><p>ä½¿ç”¨éº¦å…‹åŠ³æ—çº§æ•°å°†$\ln$åŒ–ç®€ï¼š</p>
<script type="math/tex; mode=display">
F(x) = \exp \sum_{t=1}^k {\sum_{j=1}^{+\infty}(-1)^{j-1}\frac{t^jx^j}{j}} \\
\ln F(x) = \sum_{t=1}^k {\sum_{j=1}^{+\infty}(-1)^{j-1}\frac{t^jx^j}{j}} \\
[x^n] \ln F(x) = (-1)^{n-1} \frac{1}{n} \sum_{t=1}^k t^n</script><p>å°†$\ln F(x)$æ¯é¡¹ç³»æ•°æ±‚å‡ºå†è¿›è¡Œå¤šé¡¹å¼$\exp$å¾—åˆ°$F(x)$ã€‚$\sum$å·¦è¾¹çš„éƒ¨åˆ†å¯ä»¥$O(1)$æ±‚å‡ºï¼Œå³è¾¹æ˜¯ä¸ªè‡ªç„¶æ•°å¹‚å’Œçš„å½¢å¼ã€‚ä»¤è‡ªç„¶æ•°å¹‚å’Œçš„<strong>æŒ‡æ•°ç”Ÿæˆå‡½æ•°</strong>ä¸º$S(x)$ï¼Œåˆ™æœ‰</p>
<script type="math/tex; mode=display">
[x^n] \ln F(x) = (-1)^{n-1} \frac{n!}{n} S(n) = (-1)^{n-1} (n-1)! S(n)</script><script type="math/tex; mode=display">
S(x) = \sum_{j=0}^{+\infty} \frac{x^j}{j!} \sum_{i=1}^k i^j
= \sum_{i=1}^k \sum_{j=0}^{+\infty} \frac{i^jx^j}{j!}</script><p>å‘ç°å³è¾¹ä¸€å¤§ä¸²å…¶å®æ˜¯$e^{ix}$çš„æ³°å‹’å±•å¼€å¼ã€‚</p>
<script type="math/tex; mode=display">
S(x) = \sum_{i=1}^k e^{ix}</script><p>è€Œä¸”æ˜¯ä¸ªç­‰æ¯”æ•°åˆ—æ±‚å’Œã€‚</p>
<script type="math/tex; mode=display">
S(x) = \frac{e^{(k+1)x}-e^x}{e^x-1} = \frac{\exp ((k+1)x) - \exp x}{\exp x - 1}</script><p>ä¼šå‘ç°åˆ†å­å’Œåˆ†æ¯çš„å¸¸æ•°é¡¹éƒ½æ˜¯$0$ï¼Œè€Œå¸¸æ•°é¡¹ä¸º$0$çš„å¤šé¡¹å¼æ²¡æœ‰é€†ï¼Œæ‰€ä»¥åˆ†å­åˆ†æ¯åŒæ—¶ä¹˜ä¸Š$\frac{1}{x}$å³å¯ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P5850.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P5850</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">namespace</span> fastio &#123;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> BUFFSIZ = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="type">char</span> pbuf[BUFFSIZ], *pp = pbuf;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">flush</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">fwrite</span>(pbuf, <span class="number">1</span>, BUFFSIZ, stdout), pp = pbuf;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pc</span><span class="params">(<span class="type">char</span> ch)</span> </span>&#123;</span><br><span class="line">    (pp == pbuf + BUFFSIZ) ? <span class="built_in">flush</span>() : <span class="built_in">void</span>();</span><br><span class="line">    *pp++ = ch;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace fastio</span></span><br><span class="line"><span class="keyword">using</span> fastio::pc;</span><br><span class="line"><span class="keyword">using</span> fastio::flush;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">pc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">pc</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">namespace</span> polynomial &#123;</span><br><span class="line"><span class="type">int</span> inv[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x -= y;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = <span class="number">1ll</span> * x * x % p)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = <span class="number">1ll</span> * ret * x % p;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span>* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">change</span>(f, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">            <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                <span class="type">int</span> u = f[k], t = <span class="number">1ll</span> * g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                f[k] = <span class="built_in">add</span>(u, t), f[k + h / <span class="number">2</span>] = <span class="built_in">sub</span>(u, t);</span><br><span class="line">                g = <span class="number">1ll</span> * g * gn % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">        <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            f[i] = <span class="number">1ll</span> * f[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">polymul</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">const</span> <span class="type">int</span>* g, <span class="type">int</span> m, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN], tg[MAXN];</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n + m - <span class="number">1</span>)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">copy</span>(f, f + n, tf);</span><br><span class="line">    <span class="built_in">fill</span>(tf + n, tf + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">copy</span>(g, g + m, tg);</span><br><span class="line">    <span class="built_in">fill</span>(tg + m, tg + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(tf, len, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(tg, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        tf[i] = <span class="number">1ll</span> * tf[i] * tg[i] % MOD;</span><br><span class="line">    <span class="built_in">ntt</span>(tf, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">copy</span>(tf, tf + n + m - <span class="number">1</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> n + m - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">polyinv</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tmp[MAXN];</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fill</span>(ans, ans + len + len, <span class="number">0</span>);</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="built_in">qpow</span>(f[<span class="number">0</span>], MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">copy</span>(f, f + h, tmp);</span><br><span class="line">        <span class="built_in">fill</span>(tmp + h, tmp + h + h, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">ntt</span>(tmp, h + h, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">ntt</span>(ans, h + h, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h + h; ++i)</span><br><span class="line">            ans[i] = <span class="number">1ll</span> * ans[i] * (<span class="number">2</span> - <span class="number">1ll</span> * ans[i] * tmp[i] % MOD + MOD) % MOD;</span><br><span class="line">        <span class="built_in">ntt</span>(ans, h + h, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(ans + h, ans + h + h, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">derivation</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i)</span><br><span class="line">        ans[i] = <span class="number">1ll</span> * f[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">    <span class="keyword">return</span> ans[n - <span class="number">1</span>] = <span class="number">0</span>, n - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">integral</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        ans[i] = <span class="number">1ll</span> * f[i - <span class="number">1</span>] * inv[i] % MOD;</span><br><span class="line">    <span class="keyword">return</span> ans[<span class="number">0</span>] = <span class="number">0</span>, n + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ln</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN], tg[MAXN];</span><br><span class="line">    <span class="built_in">derivation</span>(f, n, tf);</span><br><span class="line">    <span class="built_in">polyinv</span>(f, n, tg);</span><br><span class="line">    <span class="built_in">polymul</span>(tf, n - <span class="number">1</span>, tg, n, ans);</span><br><span class="line">    <span class="built_in">integral</span>(ans, n - <span class="number">1</span>, ans);</span><br><span class="line">    <span class="built_in">fill</span>(ans + n, ans + n + n, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exp</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tmp[MAXN];</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">1</span>, ans[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= (n &lt;&lt; <span class="number">1</span>); h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">ln</span>(ans, h, tmp);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; ++i)</span><br><span class="line">            tmp[i] = <span class="built_in">add</span>(i == <span class="number">0</span>, <span class="built_in">sub</span>(f[i], tmp[i]));</span><br><span class="line">        <span class="built_in">polymul</span>(ans, h, tmp, h, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace polynomial</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> polynomial;</span><br><span class="line"><span class="type">int</span> k, m, ta[MAXN], tb[MAXN], tc[MAXN], ts[MAXN], fac[MAXN], ans[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(k), <span class="built_in">read</span>(m);</span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        fac[i] = <span class="number">1ll</span> * fac[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; MAXN; ++i)</span><br><span class="line">        inv[i] = <span class="number">1ll</span> * (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">    tc[<span class="number">1</span>] = (k + <span class="number">1</span>) % MOD;</span><br><span class="line">    <span class="built_in">exp</span>(tc, m + <span class="number">2</span>, ta);</span><br><span class="line">    tc[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">exp</span>(tc, m + <span class="number">2</span>, tb);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m + <span class="number">2</span>; ++i)</span><br><span class="line">        ta[i] = <span class="built_in">sub</span>(ta[i], tb[i]);</span><br><span class="line">    tb[<span class="number">0</span>] = <span class="built_in">sub</span>(tb[<span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">        ta[i] = ta[i + <span class="number">1</span>], tb[i] = tb[i + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">polyinv</span>(tb, m + <span class="number">1</span>, tc);</span><br><span class="line">    <span class="built_in">polymul</span>(ta, m + <span class="number">1</span>, tc, m + <span class="number">1</span>, ts);</span><br><span class="line">    ts[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            ts[i] = <span class="built_in">add</span>(<span class="number">0</span>, <span class="number">1ll</span> * fac[i - <span class="number">1</span>] * ts[i] % MOD);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ts[i] = <span class="built_in">sub</span>(<span class="number">0</span>, <span class="number">1ll</span> * fac[i - <span class="number">1</span>] * ts[i] % MOD);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exp</span>(ts, m + <span class="number">1</span>, ans);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">write</span>(<span class="number">1ll</span> * ans[i] * fac[i] % MOD), <span class="built_in">pc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="built_in">flush</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>subtask1è¿‡äº†ï¼Œsubtask2ä¸€ç›´å¡å¸¸ï¼Œå¥½åƒå¸¸æ•°å¡åˆ°ç°åœ¨çš„$\frac{1}{4}$å€ï¼Œæ‰€ä»¥ä¸å¡äº†ï¼Œä»£ç è´´å‡ºæ¥ä½œä¸ºå‚è€ƒã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4726 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼expï¼‰</title>
    <url>/2022/01/18/sol-p4726/</url>
    <content><![CDATA[<h2 id="P4726-ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼expï¼‰"><a href="#P4726-ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼expï¼‰" class="headerlink" title="P4726 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼expï¼‰"></a>P4726 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼expï¼‰</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4726">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å®šä¹‰ï¼šç»™å®šå¤šé¡¹å¼$A(x)$ï¼Œæ±‚$B(x)$ä½¿å¾—$B(x) \equiv e^{A(x)} \pmod{x^n}$ã€‚</p>
<p>æ ¹æ®é¢˜ç›®æœ‰$B(x) = e^{A(x)}$ï¼Œä¸¤è¾¹åŒæ—¶æ±‚å¯¼ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
B'(x) =& e^{A(x)} \times A'(x) \\
B'(x) =& B(x) \times A'(x) \\
B(x) =& \int B(x) \times A'(x)
\end{aligned}</script><p>ä½¿ç”¨åˆ†æ²»NTTæš´åŠ›æï¼Œ$O(n \log^2 n)$ï¼ˆä»£ç ä¸è´´äº†ï¼Œæ¯•ç«Ÿä¸æ˜¯æœ€ä¼˜ï¼‰ã€‚</p>
<h4 id="ç‰›é¡¿è¿­ä»£æ³•"><a href="#ç‰›é¡¿è¿­ä»£æ³•" class="headerlink" title="ç‰›é¡¿è¿­ä»£æ³•"></a>ç‰›é¡¿è¿­ä»£æ³•</h4><p>è®¾æƒ³æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªæ•°$a$ï¼Œè¦æ±‚$\sqrt{a}$ç²¾ç¡®åˆ°æ•´æ•°ã€‚</p>
<p>é¦–å…ˆèƒ½æƒ³åˆ°äºŒåˆ†ï¼Œä½†æ˜¯å½“$a$éå¸¸å¤§ï¼Œéœ€è¦äºŒåˆ†çš„æ¬¡æ•°å°±éœ€è¦$\log_2 n$æ¬¡ã€‚</p>
<p>äºæ˜¯ä½¿ç”¨ç‰›é¡¿è¿­ä»£æ³•æ±‚è§£ã€‚è®¾$f(x)=x^2-a$ï¼Œè¦æ±‚çš„å°±æ˜¯$f(x)$çš„é›¶ç‚¹ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æ±‚å‡ºäº†ä¸€ä¸ªè¿‘ä¼¼å€¼$x_0$ï¼Œå°±å¯ä»¥è¿‡$(x_0,f(x_0))$ä½œ$f(x)$çš„åˆ‡çº¿ï¼Œå–åˆ‡çº¿ä¸$x$è½´çš„äº¤ç‚¹ä½œä¸ºæ–°çš„$x_0$ã€‚è¿™æ ·éœ€è¦çš„æ¬¡æ•°æ˜¯è¿œå°äºç›´æ¥äºŒåˆ†çš„ã€‚</p>
<p>å…·ä½“åœ°ï¼Œå½“æˆ‘ä»¬æœ‰ä¸€ä¸ªè¿‘ä¼¼å€¼$x_0$ï¼Œå…¶å…³äº$f(x)$çš„åˆ‡çº¿æ–¹ç¨‹å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
y=f'(x_0)(x-x_0)+f(x_0)</script><p>æ±‚å‡ºåˆ‡çº¿ä¸$x$è½´çš„äº¤ç‚¹$x$ï¼š</p>
<script type="math/tex; mode=display">
x=x_0-\frac{f(x_0)}{f'(x_0)}</script><p>ä»¥ä¸Šæ˜¯äºŒç»´åæ ‡ç³»ä¸­çš„ç‰›é¡¿è¿­ä»£ï¼Œè€Œå¤šé¡¹å¼å¯ä»¥çœ‹æˆæ˜¯å¤šç»´åæ ‡ç³»ä¸­çš„ç‚¹ï¼Œæ€»ä¹‹ç‰›é¡¿è¿­ä»£ä»ç„¶ä½¿ç”¨ã€‚</p>
<p>æƒ³è¦æ±‚ä¸€ä¸ªå‡½æ•°$G(x)$ä½¿å¾—$F(G(x))\equiv 0$ã€‚</p>
<p>ä½¿ç”¨ä¸Šé¢çš„å¼å­ï¼Œæˆ‘ä»¬å‘¢æ¯æ¬¡ä»¤</p>
<script type="math/tex; mode=display">
G(x)=G_0(x)-\frac{F(G_0(x))}{F'(G_0(x))}</script><p>ç»è¿‡ä¸¥è°¨çš„è¯æ˜ï¼ˆæˆ‘ä¸ä¼šè¯ï¼‰ï¼Œæ¯æ¬¡è¿­ä»£å¯ä»¥ä½¿ç²¾åº¦ç¿»å€ï¼Œå³å½“$F(G_0(x))\equiv 0 \pmod{x^\frac{n}{2}}$ï¼Œè¿­ä»£å$F(G(x))\equiv 0 \pmod{x^n}$ã€‚</p>
<p>å¸¦åˆ°è¿™é“é¢˜ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆç”±</p>
<script type="math/tex; mode=display">
\begin{aligned}
B(x) \equiv e^{A(x)} &\pmod{x^n} \\
\ln B(x) \equiv A(x) &\pmod{x^n} \\
\ln B(x) - A(x) \equiv 0 &\pmod{x^n} \\
\end{aligned}</script><p>æˆ‘ä»¬è®©$F(G(x))=\ln G(x) - A(x) \equiv 0$å³å¯ã€‚</p>
<p>å°†$F(G(x))$æ±‚å¯¼ï¼Œå¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
F'(G(x)) = \frac{1}{G(x)}</script><p>å› ä¸ºå¯¹äºå‡½æ•°$F(G(x))$è€Œè¨€ï¼Œè‡ªå˜é‡æ˜¯$G(x)$è€Œä¸æ˜¯$x$ï¼Œå…¶ä¸­çš„$A(x)$ç›¸å½“äºæ˜¯å¸¸æ•°ï¼Œå› è€Œç›´æ¥è¢«å¿½ç•¥ã€‚</p>
<p>å°†å¯¼æ•°å¸¦è¿›ä¸Šå¼å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
G(x) =& G_0(x) - \frac{\ln G_0(x) - A(x)}{\frac{1}{G_0(x)}} \\
=& G_0(x)(1 + A(x) - \ln G_0(x))
\end{aligned}</script><p>é€’å½’è®¡ç®—ï¼Œè¾¹ç•Œæ¡ä»¶æ˜¯$[x^0]B(x)=1$ã€‚</p>
<p>æ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸º</p>
<script type="math/tex; mode=display">
T(n) = T(\frac{n}{2}) + O(n \log n) = O(n \log n)</script><h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4726.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4726</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">19</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x -= y;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % p)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x % p;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> rev[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span>* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">change</span>(f, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">            <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                f[k] = <span class="built_in">add</span>(u, t), f[k + h / <span class="number">2</span>] = <span class="built_in">sub</span>(u, t);</span><br><span class="line">                g = g * gn % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">        <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            f[i] = f[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_multiply</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">const</span> <span class="type">int</span>* g, <span class="type">int</span> m, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN] = &#123;&#125;, tg[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n + m - <span class="number">1</span>)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fill</span>(ans, ans + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">copy</span>(f, f + n, tf);</span><br><span class="line">    <span class="built_in">fill</span>(tf + n, tf + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">copy</span>(g, g + m, tg);</span><br><span class="line">    <span class="built_in">fill</span>(tg + m, tg + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(tf, len, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(tg, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        tf[i] = tf[i] * tg[i] % MOD;</span><br><span class="line">    <span class="built_in">ntt</span>(tf, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">copy</span>(tf, tf + n + m - <span class="number">1</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_inverse</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tmp[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fill</span>(ans, ans + len + len, <span class="number">0</span>);</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="built_in">qpow</span>(f[<span class="number">0</span>], MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">copy</span>(f, f + h, tmp);</span><br><span class="line">        <span class="built_in">fill</span>(tmp + h, tmp + h + h, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">ntt</span>(tmp, h + h, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">ntt</span>(ans, h + h, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h + h; ++i)</span><br><span class="line">            ans[i] = ans[i] * (<span class="number">2</span> - ans[i] * tmp[i] % MOD + MOD) % MOD;</span><br><span class="line">        <span class="built_in">ntt</span>(ans, h + h, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(ans + h, ans + h + h, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_derivation</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i)</span><br><span class="line">        ans[i] = f[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">    ans[n - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_integral</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        ans[i] = f[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_ln</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN] = &#123;&#125;, tg[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="built_in">poly_derivation</span>(f, n, tf);</span><br><span class="line">    <span class="built_in">poly_inverse</span>(f, n, tg);</span><br><span class="line">    <span class="built_in">poly_multiply</span>(tf, n - <span class="number">1</span>, tg, n, ans);</span><br><span class="line">    <span class="built_in">poly_integral</span>(ans, n - <span class="number">1</span>, ans);</span><br><span class="line">    <span class="built_in">fill</span>(ans + n, ans + n + n, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_exp</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN] = &#123;&#125;, tg[MAXN] = &#123;&#125;;</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">1</span>, ans[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= (n &lt;&lt; <span class="number">1</span>); h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">poly_ln</span>(ans, h, tf);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; ++i)</span><br><span class="line">            tf[i] = <span class="built_in">add</span>((i == <span class="number">0</span>), <span class="built_in">sub</span>(f[i], tf[i]));</span><br><span class="line">        <span class="built_in">copy</span>(ans, ans + h, tg);</span><br><span class="line">        <span class="built_in">poly_multiply</span>(tf, h, tg, h, ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace maths</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="type">int</span> n, a[MAXN], b[MAXN], c[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">poly_exp</span>(a, n, b);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">write</span>(b[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == n - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤åï¼Œæˆ‘å†³å®šä¸€æ”¹å°è£…å¤šé¡¹å¼çš„åä¹ æƒ¯ï¼Œè½¬è€Œä½¿ç”¨é¢å‘è¿‡ç¨‹çš„å‡½æ•°å¼ç¼–ç¨‹ï¼Œä»¥é˜²æ­¢å¤šé¡¹å¼ä¼ é€’æ—¶é¢å¤–çš„å†…å­˜å¼€é”€ã€‚</p>
<p>åŒæ—¶ï¼Œè¿‘ä¸€ä¸ªæœˆçš„å¤šé¡¹å¼å­¦ä¹ ï¼Œè®©æˆ‘æ·±åˆ»è®¤è¯†åˆ°è‡ªå·±æ•°å­¦çŸ¥è¯†çš„ä¸è¶³ã€‚å› æ­¤ï¼Œè¿™ä¸ªå¯’å‡éœ€è¦åšçš„äº‹ä¸è¨€è€Œå–»ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4725 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼lnï¼‰</title>
    <url>/2022/01/18/sol-p4725/</url>
    <content><![CDATA[<h2 id="P4725-ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼lnï¼‰"><a href="#P4725-ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼lnï¼‰" class="headerlink" title="P4725 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼lnï¼‰"></a>P4725 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼lnï¼‰</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4725">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å®šä¹‰ï¼šç»™å®šå¤šé¡¹å¼$A(x)$ï¼Œæ±‚å¤šé¡¹å¼$B(x) \equiv \ln(A(x)) \pmod{x^n}$ã€‚</p>
<p>æ ¹æ®é¢˜ç›®æœ‰$B(x) = \ln(A(x))$ï¼Œä¸¤è¾¹åŒæ—¶æ±‚å¯¼ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
B'(x) =& \ln'(A(x)) \times A'(x) \\
=& \frac{1}{A(x)} \times A'(x) \\
=& \frac{A'(x)}{A(x)}
\end{aligned}</script><p>äºæ˜¯å°†$A(x)$æ±‚å¯¼ï¼Œå†ä¹˜ä¸Š$A(x)$çš„é€†ï¼Œæœ€ååšç§¯åˆ†ï¼Œå°±å¾—åˆ°äº†$B(x)$ã€‚</p>
<p>æ±‚å¯¼å’Œç§¯åˆ†å¤æ‚åº¦ä¸º$O(n)$ï¼Œå¤šé¡¹å¼æ±‚é€†å’ŒNTTéƒ½æ˜¯$O(n \log n)$ï¼Œæ€»æ—¶é—´å¤æ‚åº¦$O(n \log n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4726.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4726</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">19</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x -= y;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % p)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x % p;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">inverse</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">qpow</span>(x, p - <span class="number">2</span>, p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> rev[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span>* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">change</span>(f, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">            <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                f[k] = <span class="built_in">add</span>(u, t), f[k + h / <span class="number">2</span>] = <span class="built_in">sub</span>(u, t);</span><br><span class="line">                g = g * gn % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">        <span class="type">int</span> inv = <span class="built_in">inverse</span>(len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            f[i] = f[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">polynomial</span> &#123;</span><br><span class="line">    <span class="type">int</span> a[MAXN], len;</span><br><span class="line">    <span class="built_in">polynomial</span>() &#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a)); &#125;</span><br><span class="line">    <span class="built_in">polynomial</span>(<span class="type">int</span> len) : <span class="built_in">len</span>(len) &#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a)); &#125;</span><br><span class="line">    <span class="type">int</span> <span class="keyword">operator</span>[](<span class="type">int</span> i) <span class="type">const</span> &#123; <span class="keyword">return</span> a[i]; &#125;</span><br><span class="line">    <span class="type">int</span>&amp; <span class="keyword">operator</span>[](<span class="type">int</span> i) &#123; <span class="keyword">return</span> a[i]; &#125;</span><br><span class="line">    polynomial <span class="keyword">operator</span>*(<span class="type">const</span> polynomial&amp; o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> f[MAXN], g[MAXN];</span><br><span class="line">        <span class="function">polynomial <span class="title">ret</span><span class="params">(len + o.len - <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="type">int</span> slen = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (slen &lt; ret.len)</span><br><span class="line">            slen &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">copy</span>(a, a + slen, f);</span><br><span class="line">        <span class="built_in">copy</span>(o.a, o.a + slen, g);</span><br><span class="line">        <span class="built_in">ntt</span>(f, slen, <span class="number">1</span>), <span class="built_in">ntt</span>(g, slen, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; slen; ++i)</span><br><span class="line">            f[i] = f[i] * g[i] % MOD;</span><br><span class="line">        <span class="built_in">ntt</span>(f, slen, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">copy</span>(f, f + slen, ret.a);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">polynomial <span class="title">inverse</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> tmp[MAXN] = &#123;&#125;;</span><br><span class="line">        <span class="type">int</span> slen = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (slen &lt; len)</span><br><span class="line">            slen &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="function">polynomial <span class="title">ret</span><span class="params">(slen)</span></span>;</span><br><span class="line">        ret[<span class="number">0</span>] = maths::<span class="built_in">inverse</span>(a[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= slen; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(a, a + h, tmp);</span><br><span class="line">            <span class="built_in">fill</span>(tmp + h, tmp + h + h, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">ntt</span>(tmp, h + h, <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">ntt</span>(ret.a, h + h, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h + h; ++i)</span><br><span class="line">                ret[i] = ret[i] * (<span class="number">2</span> - tmp[i] * ret[i] % MOD + MOD) % MOD;</span><br><span class="line">            <span class="built_in">ntt</span>(ret.a, h + h, <span class="number">-1</span>);</span><br><span class="line">            <span class="built_in">fill</span>(ret.a + h, ret.a + h + h, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">polynomial <span class="title">derivation</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="function">polynomial <span class="title">ret</span><span class="params">(len - <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; ++i)</span><br><span class="line">            ret[i] = a[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">polynomial <span class="title">integral</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="function">polynomial <span class="title">ret</span><span class="params">(len + <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">            ret[i] = a[i - <span class="number">1</span>] * maths::<span class="built_in">inverse</span>(i) % MOD;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">polynomial <span class="title">ln</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">derivation</span>() * <span class="built_in">inverse</span>()).<span class="built_in">integral</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;  <span class="comment">// namespace maths</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">polynomial a;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    a.len = n;</span><br><span class="line">    a = a.<span class="built_in">ln</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">write</span>(a[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == n - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4002 ç”Ÿæˆæ ‘è®¡æ•°</title>
    <url>/2022/01/17/sol-p4002/</url>
    <content><![CDATA[<h2 id="P4002-ç”Ÿæˆæ ‘è®¡æ•°"><a href="#P4002-ç”Ÿæˆæ ‘è®¡æ•°" class="headerlink" title="P4002 ç”Ÿæˆæ ‘è®¡æ•°"></a>P4002 ç”Ÿæˆæ ‘è®¡æ•°</h2><p><del>é»‘ï¼ŒçœŸ$^{\text{TM}}$çš„é»‘å•Šï¼ˆæŒ‡é¢˜ç›®çš„é¢œè‰²ï¼‰</del></p>
<span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4002">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="å‰ç½®çŸ¥è¯†ï¼šæ±‚æ•°åˆ—å¹‚å’Œ"><a href="#å‰ç½®çŸ¥è¯†ï¼šæ±‚æ•°åˆ—å¹‚å’Œ" class="headerlink" title="å‰ç½®çŸ¥è¯†ï¼šæ±‚æ•°åˆ—å¹‚å’Œ"></a>å‰ç½®çŸ¥è¯†ï¼šæ±‚æ•°åˆ—å¹‚å’Œ</h3><p>ç»™å®šåºåˆ—${a<em>n}$ï¼Œå¯¹äº$0\le t \le k$ï¼Œæ±‚$\sum\limits</em>{i=1}^n a_i^t$ã€‚</p>
<p>å…ˆå†™å‡ºå¹‚æ¬¡å’Œæ‰€æ±‚å€¼ä¹‹é—´çš„ç”Ÿæˆå‡½æ•°ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
F(x) =& \sum_{t=0}{\sum_{i=1}^{n}{a_i^t x^t}} \\
=& \sum_{i=1}^{n}{\frac{1}{1-a_ix}}
\end{aligned}</script><p>ä¸å¦¨è®¾$G(x)=\sum\limits_{i=1}^{n}(\lnâ€™(1-a_ix))$ï¼Œåˆ™æœ‰</p>
<script type="math/tex; mode=display">
\begin{aligned}
G(x) =& \sum_{i=1}^n(\ln'(1-a_ix)) \\
=& -\sum_{i=1}^n\frac{a_i}{1-a_ix}
\end{aligned}</script><p>äºæ˜¯æ±‚å‡º$G(x)$åå¯ä»¥å¾ˆå®¹æ˜“åœ°æ±‚å‡º$F(x)$ã€‚æ€è€ƒå¦‚ä½•æ±‚$G(x)$ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
G(x) =& \sum_{i=1}^n(\ln'(1-a_ix)) \\
=& \left(\sum_{i=1}^n\ln(1-a_ix)\right)' \\
=& \left(\ln(\prod_{i=1}^n(1-a_ix))\right)'
\end{aligned}</script><p>ä½¿ç”¨åˆ†æ²»FFTæ±‚å‡º$\prod\limits_{i=1}^n(1-a_ix)$ï¼Œå†$\ln$å’Œæ±‚å¯¼ï¼Œæ±‚å‡º$G(x)$å’Œ$F(x)$ï¼Œæ—¶é—´å¤æ‚åº¦$O(n \log^2 n)$ã€‚</p>
<h3 id="å¤šé¡¹å¼-ln-mid-exp"><a href="#å¤šé¡¹å¼-ln-mid-exp" class="headerlink" title="å¤šé¡¹å¼$\ln \mid \exp$"></a>å¤šé¡¹å¼$\ln \mid \exp$</h3><p>è§<a href="/2022/01/18/sol-p4725/" title="P4725 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼lnï¼‰">P4725 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼lnï¼‰</a>å’Œ<a href="/2022/01/18/sol-p4726/" title="P4726 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼expï¼‰">P4726 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼expï¼‰</a>ã€‚</p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¦–å…ˆï¼Œä½ éœ€è¦æƒ³åˆ°ä½¿ç”¨<a href="https://oi-wiki.org/graph/prufer/">pruferåºåˆ—</a>æ¥è¿›è¡Œæ ‘å½¢æ€çš„æšä¸¾å¹¶è®¡ç®—è´¡çŒ®ã€‚</p>
<p>æ ¹æ®pruferåºåˆ—çš„å®šä¹‰ï¼Œä¸€æ£µ$n$ä¸ªèŠ‚ç‚¹çš„æ ‘å…±æœ‰$n^{n-2}$ç§ä¸åŒçš„å½¢æ€ã€‚</p>
<p>æˆ‘ä»¬è®¡ç®—ç­”æ¡ˆæ—¶éœ€è¦çš„æ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„åº¦$deg_u$ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿è®¾$d_u=deg_u-1$ï¼Œ$d_u$çš„å®é™…æ„ä¹‰æ˜¯$u$åœ¨pruferåºåˆ—ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚</p>
<p>æ‰€ä»¥æšä¸¾$\sum d_i=n-2$ï¼Œç„¶åpruferåºåˆ—çš„$n-2$ä¸ªæ•°å­—æ’åˆ—å…±$(n-2)!$ç§æƒ…å†µã€‚äºæ˜¯ä¹</p>
<script type="math/tex; mode=display">
\begin{aligned}
ans =& \sum_T val(T) \\
=& \sum_T \left(\prod_{i=1}^ndeg_i^m\right) \left(\sum_{i=1}^ndeg_i^m\right) \\
=& \sum_{\sum d_i=n-2}(n-2)!\left(\prod_{i=1}^n(d_i+1)^m\right) \left(\sum_{i=1}^n(d_i+1)^m\right) \left(\prod_{i=1}^n\frac{a_i^{d_i+1}}{d_i!}\right) \\
=& (n-2)! \prod_{i=1}^na_i \sum_{\sum d_i=n-2} \left(\prod_{i=1}^n\frac{a_i^{d_i}}{d_i!}(d_i+1)^m\right) \left(\sum_{i=1}^n(d_i+1)^m\right)
\end{aligned}</script><p>å·¦è¾¹ä¸¤é¡¹å®šå€¼å…ˆä¸ç®¡ï¼Œå³è¾¹å‡ é¡¹å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\sum_{\sum d_i=n-2} \sum_{i=1}^{n}{\frac{a_i^{d_i}}{d_i!}(d_i+1)^{2m} \prod_{j \neq i}{\frac{a_j^{d_j}}{d_j!}(d_j+1)^m}}</script><p>æ„é€ ä¸¤ä¸ªå¤šé¡¹å¼$A(x)$å’Œ$B(x)$ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
A(x)=\sum_i\frac{(i+1)^{2m}x^i}{i!} \\
B(x)=\sum_i\frac{(i+1)^mx^i}{i!}
\end{aligned}</script><p>åˆ™æœ‰</p>
<script type="math/tex; mode=display">
\begin{aligned}
F(x) =& \sum_{i=1}^{n}{A(a_ix) \prod_{j\neq i}B(a_jx)} \\
=& \sum_{i=1}^{n}{\frac{A(a_ix)}{B(a_ix)} \prod_{j=1}^{n}B(a_jx)} \\
=& \sum_{i=1}^{n}{\frac{A(a_ix)}{B(a_ix)} \exp\left(\sum_{j=1}^{n}\ln(B(a_jx))\right)}
\end{aligned}</script><p>å½“æˆ‘ä»¬æ±‚å‡º$\frac{A(x)}{B(x)}$å’Œ$\ln(B(x))$ä»¥åï¼Œè¦æƒ³æ±‚å‡º$\sum\limits<em>i \frac{A(a_ix)}{B(a_ix)}$å’Œ$\sum\limits_i \ln(B(a_ix))$ï¼Œåˆ™éœ€è¦å°†æ¯é¡¹ç³»æ•°ä¹˜ä¸Š$\sum\limits</em>{i=1}^na_i^k$ï¼Œç”¨å‰ç½®çŸ¥è¯†ä¸­çš„æ–¹æ³•åˆ†æ²»è®¡ç®—ã€‚</p>
<p>æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n \log^2 n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4002.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4002</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">17</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x -= y;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % p)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x % p;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> rev[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span>* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">change</span>(f, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">            <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                f[k] = <span class="built_in">add</span>(u, t), f[k + h / <span class="number">2</span>] = <span class="built_in">sub</span>(u, t);</span><br><span class="line">                g = g * gn % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">        <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            f[i] = f[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_multiply</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">const</span> <span class="type">int</span>* g, <span class="type">int</span> m, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN] = &#123;&#125;, tg[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n + m - <span class="number">1</span>)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">copy</span>(f, f + n, tf);</span><br><span class="line">    <span class="built_in">fill</span>(tf + n, tf + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">copy</span>(g, g + m, tg);</span><br><span class="line">    <span class="built_in">fill</span>(tg + m, tg + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">fill</span>(ans, ans + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(tf, len, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(tg, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        tf[i] = tf[i] * tg[i] % MOD;</span><br><span class="line">    <span class="built_in">ntt</span>(tf, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">copy</span>(tf, tf + n + m - <span class="number">1</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_inverse</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tmp[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fill</span>(ans, ans + len + len, <span class="number">0</span>);</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="built_in">qpow</span>(f[<span class="number">0</span>], MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">copy</span>(f, f + h, tmp);</span><br><span class="line">        <span class="built_in">fill</span>(tmp + h, tmp + h + h, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">ntt</span>(tmp, h + h, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">ntt</span>(ans, h + h, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h + h; ++i)</span><br><span class="line">            ans[i] = ans[i] * (<span class="number">2</span> - ans[i] * tmp[i] % MOD + MOD) % MOD;</span><br><span class="line">        <span class="built_in">ntt</span>(ans, h + h, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(ans + h, ans + h + h, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_derivation</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i)</span><br><span class="line">        ans[i] = f[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">    ans[n - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_integral</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        ans[i] = f[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_ln</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN] = &#123;&#125;, tg[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="built_in">poly_derivation</span>(f, n, tf);</span><br><span class="line">    <span class="built_in">poly_inverse</span>(f, n, tg);</span><br><span class="line">    <span class="built_in">poly_multiply</span>(tf, n - <span class="number">1</span>, tg, n, ans);</span><br><span class="line">    <span class="built_in">poly_integral</span>(ans, n - <span class="number">1</span>, ans);</span><br><span class="line">    <span class="built_in">fill</span>(ans + n, ans + n + n, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">poly_exp</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN] = &#123;&#125;, tg[MAXN] = &#123;&#125;;</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">1</span>, ans[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= (n &lt;&lt; <span class="number">1</span>); h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">poly_ln</span>(ans, h, tf);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; ++i)</span><br><span class="line">            tf[i] = <span class="built_in">add</span>((i == <span class="number">0</span>), <span class="built_in">sub</span>(f[i], tf[i]));</span><br><span class="line">        <span class="built_in">copy</span>(ans, ans + h, tg);</span><br><span class="line">        <span class="built_in">poly_multiply</span>(tf, h, tg, h, ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace maths</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="type">int</span> n, m, a[MAXN], ta[MAXN], tb[MAXN], tc[MAXN], ts[MAXN];</span><br><span class="line"><span class="type">int</span> fac[MAXN], inv[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> cl, <span class="type">int</span> cr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l + <span class="number">1</span> == r) &#123;</span><br><span class="line">        ts[cl] = <span class="number">1</span>, ts[cl + <span class="number">1</span>] = <span class="built_in">sub</span>(<span class="number">0</span>, a[l]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, cmid = (cl + cr) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">solve</span>(l, mid, cl, cmid);</span><br><span class="line">    <span class="built_in">solve</span>(mid, r, cmid, cr);</span><br><span class="line">    <span class="built_in">poly_multiply</span>(ts + cl, cmid - cl, ts + cmid, cr - cmid, ts + cl);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">    inv[n] = <span class="built_in">qpow</span>(fac[n], MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt;= n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        ta[i] = <span class="built_in">qpow</span>(i + <span class="number">1</span>, m + m) * inv[i] % MOD;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        tb[i] = <span class="built_in">qpow</span>(i + <span class="number">1</span>, m) * inv[i] % MOD;</span><br><span class="line">    <span class="built_in">poly_inverse</span>(tb, len, tc);</span><br><span class="line">    <span class="built_in">poly_multiply</span>(ta, len, tc, len, ta);</span><br><span class="line">    <span class="built_in">poly_ln</span>(tb, len, tc);</span><br><span class="line">    <span class="built_in">copy</span>(tc, tc + len, tb);</span><br><span class="line">    <span class="built_in">solve</span>(<span class="number">0</span>, len, <span class="number">0</span>, len &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">poly_ln</span>(ts, len, ts);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ts[i] = <span class="built_in">sub</span>(<span class="number">0</span>, ts[i] * i % MOD);</span><br><span class="line">    ts[<span class="number">0</span>] = n;</span><br><span class="line">    <span class="built_in">fill</span>(ts + n, ts + len, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        ta[i] = ta[i] * ts[i] % MOD;</span><br><span class="line">        tb[i] = tb[i] * ts[i] % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">poly_exp</span>(tb, len, tc);</span><br><span class="line">    <span class="built_in">poly_multiply</span>(ta, len, tc, len, ta);</span><br><span class="line">    <span class="type">int</span> ans = fac[n - <span class="number">2</span>] * ta[n - <span class="number">2</span>] % MOD;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ans = ans * a[i] % MOD;</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>Live2D æ­å»º</title>
    <url>/2022/01/15/extra-blog-live2d/</url>
    <content><![CDATA[<h2 id="Live2D-æ­å»º"><a href="#Live2D-æ­å»º" class="headerlink" title="Live2D æ­å»º"></a>Live2D æ­å»º</h2><p>ä¸€æ—¥é—²æ¥æ— äº‹ï¼Œå¿½è§‰Live2Dã€‚ç½‘ä¸Šæ‰¾æ•™ç¨‹ï¼Œå´å«Œä¸å¤Ÿè¯¦ç»†ã€‚å¥ˆä½•ï¼Ÿå¥ˆä½•ï¼Ÿåªå¾—è‡ªå·±æ‘¸ç´¢ã€‚</p>
<span id="more"></span>
<p><del>å†™çš„ä»€ä¹ˆçƒ‚è¯—</del></p>
<hr>
<h3 id="åˆçº§"><a href="#åˆçº§" class="headerlink" title="åˆçº§"></a>åˆçº§</h3><h4 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h4><p>è¿™æ˜¯æœ€åŸºç¡€çš„Live2Dï¼Œå®Œæˆååªæœ‰ä¸€ä¸ªäººç‰©åœ¨ç½‘é¡µä¸Šï¼Œæ²¡æœ‰å¯¹è¯åŠŸèƒ½ã€‚</p>
<p>ä¸”<strong>åˆçº§ä¸ä¸­çº§ã€é«˜çº§ä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»</strong>ï¼Œå¦‚æœæƒ³è¦æ›´å¥½çš„æ•ˆæœï¼Œè¯·<strong>è·³è¿‡åˆçº§æ•™ç¨‹</strong>ã€‚</p>
<h4 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h4><p>å…ˆå®‰è£…<code>hexo-helper-live2d</code>æ’ä»¶ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-helper-live2d</span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆ°<a href="https://github.com/xiazeyu/live2d-widget-models">è¿™é‡Œ</a>æ‰¾ä¸€ä¸ªä½ å–œæ¬¢çš„Live2Dæ¨¡å‹è¿›è¡Œå®‰è£…ã€‚å¦‚é€‰æ‹©äº†<code>live2d-widget-model-wanko</code>ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install live2d-widget-model-wanko <span class="comment"># æ²¡æœ‰ --save</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆ°<strong>æ ¹ç›®å½•</strong>çš„<code>_config.yml</code>ä¸­æ·»åŠ é…ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Live2D</span></span><br><span class="line"><span class="comment">## https://github.com/EYHN/hexo-helper-live2d</span></span><br><span class="line"><span class="comment">## https://l2dwidget.js.org/docs/class/src/index.js~L2Dwidget.html#instance-method-init</span></span><br><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment">#enable: false</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span> <span class="comment"># é»˜è®¤</span></span><br><span class="line">  <span class="attr">pluginRootPath:</span> <span class="string">live2dw/</span> <span class="comment"># æ’ä»¶åœ¨ç«™ç‚¹ä¸Šçš„æ ¹ç›®å½•(ç›¸å¯¹è·¯å¾„)</span></span><br><span class="line">  <span class="attr">pluginJsPath:</span> <span class="string">lib/</span> <span class="comment"># è„šæœ¬æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span></span><br><span class="line">  <span class="attr">pluginModelPath:</span> <span class="string">assets/</span> <span class="comment"># æ¨¡å‹æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span></span><br><span class="line">  <span class="comment"># scriptFrom: jsdelivr # jsdelivr CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: unpkg # unpkg CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js # ä½ çš„è‡ªå®šä¹‰ url</span></span><br><span class="line">  <span class="attr">tagMode:</span> <span class="literal">false</span> <span class="comment"># æ ‡ç­¾æ¨¡å¼, æ˜¯å¦ä»…æ›¿æ¢ live2d tagæ ‡ç­¾è€Œéæ’å…¥åˆ°æ‰€æœ‰é¡µé¢ä¸­</span></span><br><span class="line">  <span class="attr">debug:</span> <span class="literal">false</span> <span class="comment"># è°ƒè¯•, æ˜¯å¦åœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—</span></span><br><span class="line">  <span class="string">model</span></span><br><span class="line">    <span class="attr">use:</span> <span class="string">live2d-widget-model-wanko</span> <span class="comment"># æ›¿æ¢æˆä½ çš„æ¨¡å‹å</span></span><br><span class="line">    <span class="comment"># use: live2d-widget-model-wanko # npm-module package name</span></span><br><span class="line">    <span class="comment"># use: wanko # åšå®¢æ ¹ç›®å½•/live2d_models/ ä¸‹çš„ç›®å½•å</span></span><br><span class="line">    <span class="comment"># use: ./wives/wanko # ç›¸å¯¹äºåšå®¢æ ¹ç›®å½•çš„è·¯å¾„</span></span><br><span class="line">    <span class="comment"># use: https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json # ä½ çš„è‡ªå®šä¹‰ url</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">right</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">145</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">315</span></span><br><span class="line">  <span class="attr">mobile:</span></span><br><span class="line">    <span class="attr">show:</span> <span class="literal">true</span> <span class="comment"># æ˜¯å¦åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šæ˜¾ç¤º</span></span><br><span class="line">    <span class="attr">scale:</span> <span class="number">0.5</span> <span class="comment"># ç§»åŠ¨è®¾å¤‡ä¸Šçš„ç¼©æ”¾       </span></span><br><span class="line">  <span class="attr">react:</span></span><br><span class="line">    <span class="attr">opacityDefault:</span> <span class="number">0.7</span></span><br><span class="line">    <span class="attr">opacityOnHover:</span> <span class="number">0.8</span></span><br></pre></td></tr></table></figure>
<p>è¿è¡Œ<code>hexo c &amp;&amp; hexo g &amp;&amp; hexo s</code>ï¼Œå°±å¯ä»¥åœ¨æœ¬åœ°çœ‹åˆ°Live2Dæ¨¡å‹äº†ã€‚</p>
<hr>
<h3 id="ä¸­çº§"><a href="#ä¸­çº§" class="headerlink" title="ä¸­çº§"></a>ä¸­çº§</h3><h4 id="è¯´æ˜-1"><a href="#è¯´æ˜-1" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h4><p>é˜…è¯»é«˜çº§æ•™ç¨‹ä¹‹å‰ï¼Œè¯·å…ˆé˜…è¯»ä¸­çº§æ•™ç¨‹ã€‚</p>
<h4 id="æ“ä½œ-1"><a href="#æ“ä½œ-1" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h4><p>å…ˆå…³é—­<code>hexo-helper-live2d</code>ï¼ˆå¦‚æœå·²ç»æŒ‰ç…§åˆçº§æ•™ç¨‹å¼€å¯è¿‡çš„è¯ï¼‰ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-helper-live2d</span><br><span class="line">npm uninstall live2d-widget-model-wanko <span class="comment"># æ›¿æ¢æˆä½ çš„æ¨¡å‹å</span></span><br></pre></td></tr></table></figure>
<p>å…‹éš†<a href="https://github.com/stevenjoezhang/live2d-widget">live2d-widget</a>åˆ°æœ¬åœ°<code>themes/next/live2d-widget</code>ï¼ˆæˆ‘è¿™é‡Œæ˜¯<code>next</code>ä¸»é¢˜ï¼‰ä¸­ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes/next</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/stevenjoezhang/live2d-widget.git</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹<code>next</code>ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼š</p>
<p>æ‰“å¼€<code>themes/next/layout/_layout.swig</code>ï¼Œåœ¨<code>&lt;footer&gt;</code>æ ‡ç­¾ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Live2D --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/live2d-widget/autoload.js&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¹¶åœ¨æ–‡ä»¶çš„<code>&lt;head&gt;</code>æ ‡ç­¾ä¸­æ·»åŠ </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åé‡æ–°ç”Ÿæˆå¹¶è¿è¡Œã€‚</p>
<hr>
<h3 id="é«˜çº§"><a href="#é«˜çº§" class="headerlink" title="é«˜çº§"></a>é«˜çº§</h3><h3 id="è¯´æ˜-2"><a href="#è¯´æ˜-2" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>ç›¸æ¯”ä¸­çº§ï¼Œå¢åŠ äº†æ¢è£…åŠŸèƒ½ã€‚</p>
<h3 id="æ“ä½œ-2"><a href="#æ“ä½œ-2" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h3><p><strong>å…ˆæŒ‰ç…§ä¸­çº§å®Œæˆæ“ä½œ</strong></p>
<p>æ‰“å¼€<code>themes/next/layout/_layout.swig</code>ï¼Œåœ¨<code>&lt;footer&gt;</code>æ ‡ç­¾ä¸­çš„<code>&lt;script src=&quot;/live2d-widget/autoload.js&gt;</code>ä¹‹å‰çš„éƒ¨åˆ†æ·»åŠ <code>jquery</code>å’Œ<code>jquery-ui</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/jquery-ui-dist@1.12.1/jquery-ui.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹<code>themes/next/live2d-widget/autoload.js</code>ï¼Œåˆ æ‰åŸæœ‰å†…å®¹æ›¿æ¢å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŠ è½½ CSS</span></span><br><span class="line">$(<span class="string">&quot;&lt;link&gt;&quot;</span>).<span class="title function_">attr</span>(&#123;<span class="attr">href</span>: <span class="string">&quot;/live2d-widget/waifu.css&quot;</span>, <span class="attr">rel</span>: <span class="string">&quot;stylesheet&quot;</span>, <span class="attr">type</span>: <span class="string">&quot;text/css&quot;</span>&#125;).<span class="title function_">appendTo</span>(<span class="string">&#x27;head&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ’å…¥ DIV</span></span><br><span class="line">$(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;div class=&quot;waifu&quot;&gt;&lt;div class=&quot;waifu-tips&quot;&gt;&lt;/div&gt;&lt;canvas id=&quot;live2d&quot; class=&quot;live2d&quot;&gt;&lt;/canvas&gt;&lt;div class=&quot;waifu-tool&quot;&gt;&lt;span class=&quot;fui-home&quot;&gt;&lt;/span&gt; &lt;span class=&quot;fui-chat&quot;&gt;&lt;/span&gt; &lt;span class=&quot;fui-eye&quot;&gt;&lt;/span&gt; &lt;span class=&quot;fui-user&quot;&gt;&lt;/span&gt; &lt;span class=&quot;fui-photo&quot;&gt;&lt;/span&gt; &lt;span class=&quot;fui-info-circle&quot;&gt;&lt;/span&gt; &lt;span class=&quot;fui-cross&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ è½½ JS</span></span><br><span class="line">$.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">	<span class="attr">url</span>: <span class="string">&#x27;/live2d-widget/waifu-tips.js&#x27;</span>,</span><br><span class="line">	<span class="attr">dataType</span>:<span class="string">&quot;script&quot;</span>,</span><br><span class="line">	<span class="attr">cache</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">async</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line">$.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">	<span class="attr">url</span>: <span class="string">&#x27;/live2d-widget/live2d.min.js&#x27;</span>,</span><br><span class="line">	<span class="attr">dataType</span>:<span class="string">&quot;script&quot;</span>,</span><br><span class="line">	<span class="attr">cache</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">async</span>: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–çœ‹æ¿å¨˜ï¼ŒåŠ è½½ waifu-tips.json</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* å¯ç›´æ¥ä¿®æ”¹éƒ¨åˆ†å‚æ•° */</span></span><br><span class="line">live2d_settings[<span class="string">&#x27;modelId&#x27;</span>] = <span class="number">1</span>;                  <span class="comment">// é»˜è®¤æ¨¡å‹ ID</span></span><br><span class="line">live2d_settings[<span class="string">&#x27;modelTexturesId&#x27;</span>] = <span class="number">88</span>;          <span class="comment">// é»˜è®¤æè´¨ ID</span></span><br><span class="line"><span class="comment">/* åœ¨ initModel å‰æ·»åŠ  */</span></span><br><span class="line"><span class="title function_">initModel</span>(<span class="string">&#x27;/live2d-widget/waifu-tips.json&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹<code>themes/next/live2d-widget/waifu-tips.js</code>ï¼Œåˆ æ‰åŸæœ‰å†…å®¹æ›¿æ¢å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">live2d_settings</span> = <span class="title class_">Array</span>(); <span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        ã__,.ãƒ˜ãƒ½.ã€€ã€€ã€€ã€€/ã€€,ãƒ¼ï½¤ ã€‰</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ã€€ï¼¼ &#x27;, !-â”€â€-iã€€/ã€€/Â´</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ ã€€ ï¼ï½€ï½°&#x27;ã€€ã€€ã€€ L/ï¼ï½€ãƒ½ï½¤            Live2D çœ‹æ¿å¨˜ å‚æ•°è®¾ç½®</span></span><br><span class="line"><span class="comment">        ã€€ã€€ ã€€ /ã€€ ï¼,ã€€ /|ã€€ ,ã€€ ,ã€€ã€€ã€€ &#x27;,          Version 1.4.2</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ï½² ã€€/ /-â€/ã€€ï½‰ã€€L_ ï¾Š ãƒ½!ã€€ i             Update 2018.11.12</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ ï¾š ï¾ 7ï½²ï½€ï¾„ã€€ ï¾š&#x27;ï½§-ï¾„ï½¤!ãƒ|ã€€ |  </span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ !,/7 &#x27;0&#x27;ã€€ã€€ Â´0iã‚½| ã€€ |ã€€ã€€ã€€</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ |.ä»&quot;ã€€ã€€_ã€€ã€€ ,,,, / |./ ã€€ |    ç½‘é¡µæ·»åŠ  Live2D çœ‹æ¿å¨˜</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ ï¾š&#x27;| iï¼.ï½¤,,__ã€€_,.ã‚¤ / ã€€.i ã€€|       https://yaoxi-std.github.io/2022/01/15/extra-blog-live2d/</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ã€€ ï¾š&#x27;| | / k_ï¼—_/ï¾š&#x27;ãƒ½,ã€€ï¾Š.ã€€|           </span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ã€€ã€€ | |/i ã€ˆ|/ã€€ iã€€,.ï¾ |ã€€iã€€|    Thanks</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ã€€ã€€.|/ /ã€€ï½‰ï¼š ã€€ ï¾!ã€€ã€€ï¼¼ã€€|          journey-ad / https://github.com/journey-ad/live2d_src</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ ã€€ ã€€ kãƒ½&gt;ï½¤ï¾Š ã€€ _,.ï¾ï½¤ ã€€ /ï½¤!            xiazeyu / https://github.com/xiazeyu/live2d-widget.js</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ã€€ã€€ !&#x27;ã€ˆ//ï½€ï¼´Â´&#x27;, ï¼¼ ï½€&#x27;7&#x27;ï½°r&#x27;         Live2d Cubism SDK WebGL 2.1 Projrct &amp; All model authors.</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ã€€ã€€ ï¾š&#x27;ãƒ½L__|___i,___,ãƒ³ï¾š|ãƒ           fghrsh / https://github.com/fghrsh/live2d_api</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ã€€ ã€€ã€€ã€€ï¾„-,/ã€€|___./</span></span><br><span class="line"><span class="comment">        ã€€ã€€ã€€ã€€ã€€ ã€€ã€€ã€€&#x27;ï½°&#x27;ã€€ã€€!_,.:*********************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åç«¯æ¥å£</span></span><br><span class="line">live2d_settings[<span class="string">&quot;modelAPI&quot;</span>] = <span class="string">&quot;//live2d.fghrsh.net/api/&quot;</span>; <span class="comment">// è‡ªå»º API ä¿®æ”¹è¿™é‡Œ</span></span><br><span class="line">live2d_settings[<span class="string">&quot;tipsMessage&quot;</span>] = <span class="string">&quot;waifu-tips.json&quot;</span>; <span class="comment">// åŒç›®å½•ä¸‹å¯çœç•¥è·¯å¾„</span></span><br><span class="line">live2d_settings[<span class="string">&quot;hitokotoAPI&quot;</span>] = <span class="string">&quot;hitokoto.cn&quot;</span>; <span class="comment">// ä¸€è¨€ APIï¼Œå¯é€‰ &#x27;lwl12.com&#x27;, &#x27;hitokoto.cn&#x27;, &#x27;jinrishici.com&#x27;(å¤è¯—è¯)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤æ¨¡å‹</span></span><br><span class="line">live2d_settings[<span class="string">&quot;modelId&quot;</span>] = <span class="number">1</span>; <span class="comment">// é»˜è®¤æ¨¡å‹ IDï¼Œå¯åœ¨ F12 æ§åˆ¶å°æ‰¾åˆ°</span></span><br><span class="line">live2d_settings[<span class="string">&quot;modelTexturesId&quot;</span>] = <span class="number">88</span>; <span class="comment">// é»˜è®¤æè´¨ IDï¼Œå¯åœ¨ F12 æ§åˆ¶å°æ‰¾åˆ°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å·¥å…·æ è®¾ç½®</span></span><br><span class="line">live2d_settings[<span class="string">&quot;showToolMenu&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤º å·¥å…·æ           ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;canCloseLive2d&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤º å…³é—­çœ‹æ¿å¨˜  æŒ‰é’®ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;canSwitchModel&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤º æ¨¡å‹åˆ‡æ¢    æŒ‰é’®ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;canSwitchTextures&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤º æè´¨åˆ‡æ¢    æŒ‰é’®ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;canSwitchHitokoto&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤º ä¸€è¨€åˆ‡æ¢    æŒ‰é’®ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;canTakeScreenshot&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤º çœ‹æ¿å¨˜æˆªå›¾  æŒ‰é’®ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;canTurnToHomePage&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤º è¿”å›é¦–é¡µ    æŒ‰é’®ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;canTurnToAboutPage&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤º è·³è½¬å…³äºé¡µ  æŒ‰é’®ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨¡å‹åˆ‡æ¢æ¨¡å¼</span></span><br><span class="line">live2d_settings[<span class="string">&quot;modelStorage&quot;</span>] = <span class="literal">true</span>; <span class="comment">// è®°å½• ID (åˆ·æ–°åæ¢å¤)ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;modelRandMode&quot;</span>] = <span class="string">&quot;switch&quot;</span>; <span class="comment">// æ¨¡å‹åˆ‡æ¢ï¼Œå¯é€‰ &#x27;rand&#x27;(éšæœº), &#x27;switch&#x27;(é¡ºåº)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;modelTexturesRandMode&quot;</span>] = <span class="string">&quot;rand&quot;</span>; <span class="comment">// æè´¨åˆ‡æ¢ï¼Œå¯é€‰ &#x27;rand&#x27;(éšæœº), &#x27;switch&#x27;(é¡ºåº)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æç¤ºæ¶ˆæ¯é€‰é¡¹</span></span><br><span class="line">live2d_settings[<span class="string">&quot;showHitokoto&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤ºä¸€è¨€</span></span><br><span class="line">live2d_settings[<span class="string">&quot;showF12Status&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤ºåŠ è½½çŠ¶æ€</span></span><br><span class="line">live2d_settings[<span class="string">&quot;showF12Message&quot;</span>] = <span class="literal">false</span>; <span class="comment">// æ˜¾ç¤ºçœ‹æ¿å¨˜æ¶ˆæ¯</span></span><br><span class="line">live2d_settings[<span class="string">&quot;showF12OpenMsg&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤ºæ§åˆ¶å°æ‰“å¼€æç¤º</span></span><br><span class="line">live2d_settings[<span class="string">&quot;showCopyMessage&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤º å¤åˆ¶å†…å®¹ æç¤º</span></span><br><span class="line">live2d_settings[<span class="string">&quot;showWelcomeMessage&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ˜¾ç¤ºè¿›å…¥é¢é¡µæ¬¢è¿è¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//çœ‹æ¿å¨˜æ ·å¼è®¾ç½®</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuSize&quot;</span>] = <span class="string">&quot;800x800&quot;</span>; <span class="comment">// çœ‹æ¿å¨˜å¤§å°ï¼Œä¾‹å¦‚ &#x27;280x250&#x27;, &#x27;600x535&#x27;</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuTipsSize&quot;</span>] = <span class="string">&quot;250x70&quot;</span>; <span class="comment">// æç¤ºæ¡†å¤§å°ï¼Œä¾‹å¦‚ &#x27;250x70&#x27;, &#x27;570x150&#x27;</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuFontSize&quot;</span>] = <span class="string">&quot;14px&quot;</span>; <span class="comment">// æç¤ºæ¡†å­—ä½“ï¼Œä¾‹å¦‚ &#x27;12px&#x27;, &#x27;30px&#x27;</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuToolFont&quot;</span>] = <span class="string">&quot;14px&quot;</span>; <span class="comment">// å·¥å…·æ å­—ä½“ï¼Œä¾‹å¦‚ &#x27;14px&#x27;, &#x27;36px&#x27;</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuToolLine&quot;</span>] = <span class="string">&quot;20px&quot;</span>; <span class="comment">// å·¥å…·æ è¡Œé«˜ï¼Œä¾‹å¦‚ &#x27;20px&#x27;, &#x27;36px&#x27;</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuToolTop&quot;</span>] = <span class="string">&quot;0px&quot;</span>; <span class="comment">// å·¥å…·æ é¡¶éƒ¨è¾¹è·ï¼Œä¾‹å¦‚ &#x27;0px&#x27;, &#x27;-60px&#x27;</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuMinWidth&quot;</span>] = <span class="string">&quot;768px&quot;</span>; <span class="comment">// é¢é¡µå°äº æŒ‡å®šå®½åº¦ éšè—çœ‹æ¿å¨˜ï¼Œä¾‹å¦‚ &#x27;disable&#x27;(ç¦ç”¨), &#x27;768px&#x27;</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuEdgeSide&quot;</span>] = <span class="string">&quot;left:0&quot;</span>; <span class="comment">// çœ‹æ¿å¨˜è´´è¾¹æ–¹å‘ï¼Œä¾‹å¦‚ &#x27;left:0&#x27;(é å·¦ 0px), &#x27;right:30&#x27;(é å³ 30px)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuDraggable&quot;</span>] = <span class="string">&quot;disable&quot;</span>; <span class="comment">// æ‹–æ‹½æ ·å¼ï¼Œä¾‹å¦‚ &#x27;disable&#x27;(ç¦ç”¨), &#x27;axis-x&#x27;(åªèƒ½æ°´å¹³æ‹–æ‹½), &#x27;unlimited&#x27;(è‡ªç”±æ‹–æ‹½)</span></span><br><span class="line">live2d_settings[<span class="string">&quot;waifuDraggableRevert&quot;</span>] = <span class="literal">true</span>; <span class="comment">// æ¾å¼€é¼ æ ‡è¿˜åŸæ‹–æ‹½ä½ç½®ï¼Œå¯é€‰ true(çœŸ), false(å‡)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¶ä»–æ‚é¡¹è®¾ç½®</span></span><br><span class="line">live2d_settings[<span class="string">&quot;l2dVersion&quot;</span>] = <span class="string">&quot;1.4.2&quot;</span>; <span class="comment">// å½“å‰ç‰ˆæœ¬</span></span><br><span class="line">live2d_settings[<span class="string">&quot;l2dVerDate&quot;</span>] = <span class="string">&quot;2018.11.12&quot;</span>; <span class="comment">// ç‰ˆæœ¬æ›´æ–°æ—¥æœŸ</span></span><br><span class="line">live2d_settings[<span class="string">&quot;homePageUrl&quot;</span>] = <span class="string">&quot;auto&quot;</span>; <span class="comment">// ä¸»é¡µåœ°å€ï¼Œå¯é€‰ &#x27;auto&#x27;(è‡ªåŠ¨), &#x27;&#123;URL ç½‘å€&#125;&#x27;</span></span><br><span class="line">live2d_settings[<span class="string">&quot;aboutPageUrl&quot;</span>] =</span><br><span class="line">    <span class="string">&quot;https://yaoxi-std.github.io/2022/01/15/extra-blog-live2d/&quot;</span>; <span class="comment">// å…³äºé¡µåœ°å€, &#x27;&#123;URL ç½‘å€&#125;&#x27;</span></span><br><span class="line">live2d_settings[<span class="string">&quot;screenshotCaptureName&quot;</span>] = <span class="string">&quot;live2d.png&quot;</span>; <span class="comment">// çœ‹æ¿å¨˜æˆªå›¾æ–‡ä»¶åï¼Œä¾‹å¦‚ &#x27;live2d.png&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/****************************************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">render</span> = <span class="keyword">function</span> (<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> tokenReg = <span class="regexp">/(\\)?\&#123;([^\&#123;\&#125;\\]+)(\\)?\&#125;/g</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">replace</span>(tokenReg, <span class="keyword">function</span> (<span class="params">word, slash1, token, slash2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (slash1 || slash2) &#123;</span><br><span class="line">            <span class="keyword">return</span> word.<span class="title function_">replace</span>(<span class="string">&quot;\\&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> variables = token.<span class="title function_">replace</span>(<span class="regexp">/\s/g</span>, <span class="string">&quot;&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> currentObject = context;</span><br><span class="line">        <span class="keyword">var</span> i, length, variable;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>, length = variables.<span class="property">length</span>; i &lt; length; ++i) &#123;</span><br><span class="line">            variable = variables[i];</span><br><span class="line">            currentObject = currentObject[variable];</span><br><span class="line">            <span class="keyword">if</span> (currentObject === <span class="literal">undefined</span> || currentObject === <span class="literal">null</span>) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> currentObject;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/x/</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(re);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">empty</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> obj == <span class="string">&quot;undefined&quot;</span> || obj == <span class="literal">null</span> || obj == <span class="string">&quot;&quot;</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getRandText</span>(<span class="params">text</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">isArray</span>(text)</span><br><span class="line">        ? text[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * text.<span class="property">length</span> + <span class="number">1</span>) - <span class="number">1</span>]</span><br><span class="line">        : text;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showMessage</span>(<span class="params">text, timeout, flag</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">        flag ||</span><br><span class="line">        sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;waifu-text&quot;</span>) === <span class="string">&quot;&quot;</span> ||</span><br><span class="line">        sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;waifu-text&quot;</span>) === <span class="literal">null</span></span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(text))</span><br><span class="line">            text = text[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * text.<span class="property">length</span> + <span class="number">1</span>) - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (live2d_settings.<span class="property">showF12Message</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[Message]&quot;</span>, text.<span class="title function_">replace</span>(<span class="regexp">/&lt;[^&lt;&gt;]+&gt;/g</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (flag) sessionStorage.<span class="title function_">setItem</span>(<span class="string">&quot;waifu-text&quot;</span>, text);</span><br><span class="line"></span><br><span class="line">        $(<span class="string">&quot;.waifu-tips&quot;</span>).<span class="title function_">stop</span>();</span><br><span class="line">        $(<span class="string">&quot;.waifu-tips&quot;</span>).<span class="title function_">html</span>(text).<span class="title function_">fadeTo</span>(<span class="number">200</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (timeout === <span class="literal">undefined</span>) timeout = <span class="number">5000</span>;</span><br><span class="line">        <span class="title function_">hideMessage</span>(timeout);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hideMessage</span>(<span class="params">timeout</span>) &#123;</span><br><span class="line">    $(<span class="string">&quot;.waifu-tips&quot;</span>).<span class="title function_">stop</span>().<span class="title function_">css</span>(<span class="string">&quot;opacity&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (timeout === <span class="literal">undefined</span>) timeout = <span class="number">5000</span>;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        sessionStorage.<span class="title function_">removeItem</span>(<span class="string">&quot;waifu-text&quot;</span>);</span><br><span class="line">    &#125;, timeout);</span><br><span class="line">    $(<span class="string">&quot;.waifu-tips&quot;</span>).<span class="title function_">delay</span>(timeout).<span class="title function_">fadeTo</span>(<span class="number">200</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initModel</span>(<span class="params">waifuPath, type</span>) &#123;</span><br><span class="line">    <span class="comment">/* console welcome message */</span></span><br><span class="line">    <span class="built_in">eval</span>(</span><br><span class="line">        (<span class="keyword">function</span> (<span class="params">p, a, c, k, e, r</span>) &#123;</span><br><span class="line">            e = <span class="keyword">function</span> (<span class="params">c</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> (</span><br><span class="line">                    (c &lt; a ? <span class="string">&quot;&quot;</span> : <span class="title function_">e</span>(<span class="built_in">parseInt</span>(c / a))) +</span><br><span class="line">                    ((c = c % a) &gt; <span class="number">35</span> ? <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(c + <span class="number">29</span>) : c.<span class="title function_">toString</span>(<span class="number">36</span>))</span><br><span class="line">                );</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.<span class="title function_">replace</span>(<span class="regexp">/^/</span>, <span class="title class_">String</span>)) &#123;</span><br><span class="line">                <span class="keyword">while</span> (c--) r[<span class="title function_">e</span>(c)] = k[c] || <span class="title function_">e</span>(c);</span><br><span class="line">                k = [</span><br><span class="line">                    <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> r[e];</span><br><span class="line">                    &#125;,</span><br><span class="line">                ];</span><br><span class="line">                e = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;\\w+&quot;</span>;</span><br><span class="line">                &#125;;</span><br><span class="line">                c = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (c--)</span><br><span class="line">                <span class="keyword">if</span> (k[c]) p = p.<span class="title function_">replace</span>(<span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&quot;\\b&quot;</span> + <span class="title function_">e</span>(c) + <span class="string">&quot;\\b&quot;</span>, <span class="string">&quot;g&quot;</span>), k[c]);</span><br><span class="line">            <span class="keyword">return</span> p;</span><br><span class="line">        &#125;)(</span><br><span class="line">            <span class="string">&quot;8.d(\&quot; \&quot;);8.d(\&quot;\\U,.\\y\\5.\\1\\1\\1\\1/\\1,\\u\\2 \\H\\n\\1\\1\\1\\1\\1\\b &#x27;, !-\\r\\j-i\\1/\\1/\\g\\n\\1\\1\\1 \\1 \\a\\4\\f&#x27;\\1\\1\\1 L/\\a\\4\\5\\2\\n\\1\\1 \\1 /\\1 \\a,\\1 /|\\1 ,\\1 ,\\1\\1\\1 &#x27;,\\n\\1\\1\\1\\q \\1/ /-\\j/\\1\\h\\E \\9 \\5!\\1 i\\n\\1\\1\\1 \\3 \\6 7\\q\\4\\c\\1 \\3&#x27;\\s-\\c\\2!\\t|\\1 |\\n\\1\\1\\1\\1 !,/7 &#x27;0&#x27;\\1\\1 \\X\\w| \\1 |\\1\\1\\1\\n\\1\\1\\1\\1 |.\\x\\\&quot;\\1\\l\\1\\1 ,,,, / |./ \\1 |\\n\\1\\1\\1\\1 \\3&#x27;| i\\z.\\2,,A\\l,.\\B / \\1.i \\1|\\n\\1\\1\\1\\1\\1 \\3&#x27;| | / C\\D/\\3&#x27;\\5,\\1\\9.\\1|\\n\\1\\1\\1\\1\\1\\1 | |/i \\m|/\\1 i\\1,.\\6 |\\F\\1|\\n\\1\\1\\1\\1\\1\\1.|/ /\\1\\h\\G \\1 \\6!\\1\\1\\b\\1|\\n\\1\\1\\1 \\1 \\1 k\\5&gt;\\2\\9 \\1 o,.\\6\\2 \\1 /\\2!\\n\\1\\1\\1\\1\\1\\1 !&#x27;\\m//\\4\\I\\g&#x27;, \\b \\4&#x27;7&#x27;\\J&#x27;\\n\\1\\1\\1\\1\\1\\1 \\3&#x27;\\K|M,p,\\O\\3|\\P\\n\\1\\1\\1\\1\\1 \\1\\1\\1\\c-,/\\1|p./\\n\\1\\1\\1\\1\\1 \\1\\1\\1&#x27;\\f&#x27;\\1\\1!o,.:\\Q \\R\\S\\T v\&quot;+e.V+\&quot; / W \&quot;+e.N);8.d(\&quot; \&quot;);&quot;</span>,</span><br><span class="line">            <span class="number">60</span>,</span><br><span class="line">            <span class="number">60</span>,</span><br><span class="line">            <span class="string">&quot;|u3000|uff64|uff9a|uff40|u30fd|uff8d||console|uff8a|uff0f|uff3c|uff84|log|live2d_settings|uff70|u00b4|uff49||u2010||u3000_|u3008||_|___|uff72|u2500|uff67|u30cf|u30fc||u30bd|u4ece|u30d8|uff1e|__|u30a4|k_|uff17_|u3000L_|u3000i|uff1a|u3009|uff34|uff70r|u30fdL__||___i|l2dVerDate|u30f3|u30ce|nLive2D|u770b|u677f|u5a18|u304f__|l2dVersion|FGHRSH|u00b40i&quot;</span>.<span class="title function_">split</span>(</span><br><span class="line">                <span class="string">&quot;|&quot;</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            &#123;&#125;</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ¤æ–­ JQuery */</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> $.ajax != <span class="string">&quot;function&quot;</span>)</span><br><span class="line">        <span class="keyword">typeof</span> jQuery.<span class="property">ajax</span> == <span class="string">&quot;function&quot;</span></span><br><span class="line">            ? (<span class="variable language_">window</span>.<span class="property">$</span> = jQuery)</span><br><span class="line">            : <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[Error] JQuery is not defined.&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åŠ è½½çœ‹æ¿å¨˜æ ·å¼ */</span></span><br><span class="line">    live2d_settings.<span class="property">waifuSize</span> = live2d_settings.<span class="property">waifuSize</span>.<span class="title function_">split</span>(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">    live2d_settings.<span class="property">waifuTipsSize</span> = live2d_settings.<span class="property">waifuTipsSize</span>.<span class="title function_">split</span>(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">    live2d_settings.<span class="property">waifuEdgeSide</span> = live2d_settings.<span class="property">waifuEdgeSide</span>.<span class="title function_">split</span>(<span class="string">&quot;:&quot;</span>);</span><br><span class="line"></span><br><span class="line">    $(<span class="string">&quot;#live2d&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;width&quot;</span>, live2d_settings.<span class="property">waifuSize</span>[<span class="number">0</span>]);</span><br><span class="line">    $(<span class="string">&quot;#live2d&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;height&quot;</span>, live2d_settings.<span class="property">waifuSize</span>[<span class="number">1</span>]);</span><br><span class="line">    $(<span class="string">&quot;.waifu-tips&quot;</span>).<span class="title function_">width</span>(live2d_settings.<span class="property">waifuTipsSize</span>[<span class="number">0</span>]);</span><br><span class="line">    $(<span class="string">&quot;.waifu-tips&quot;</span>).<span class="title function_">height</span>(live2d_settings.<span class="property">waifuTipsSize</span>[<span class="number">1</span>]);</span><br><span class="line">    $(<span class="string">&quot;.waifu-tips&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;top&quot;</span>, live2d_settings.<span class="property">waifuToolTop</span>);</span><br><span class="line">    $(<span class="string">&quot;.waifu-tips&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;font-size&quot;</span>, live2d_settings.<span class="property">waifuFontSize</span>);</span><br><span class="line">    $(<span class="string">&quot;.waifu-tool&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;font-size&quot;</span>, live2d_settings.<span class="property">waifuToolFont</span>);</span><br><span class="line">    $(<span class="string">&quot;.waifu-tool span&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;line-height&quot;</span>, live2d_settings.<span class="property">waifuToolLine</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (live2d_settings.<span class="property">waifuEdgeSide</span>[<span class="number">0</span>] == <span class="string">&quot;left&quot;</span>)</span><br><span class="line">        $(<span class="string">&quot;.waifu&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;left&quot;</span>, live2d_settings.<span class="property">waifuEdgeSide</span>[<span class="number">1</span>] + <span class="string">&quot;px&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (live2d_settings.<span class="property">waifuEdgeSide</span>[<span class="number">0</span>] == <span class="string">&quot;right&quot;</span>)</span><br><span class="line">        $(<span class="string">&quot;.waifu&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;right&quot;</span>, live2d_settings.<span class="property">waifuEdgeSide</span>[<span class="number">1</span>] + <span class="string">&quot;px&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">waifuResize</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        $(<span class="variable language_">window</span>).<span class="title function_">width</span>() &lt;= <span class="title class_">Number</span>(live2d_settings.<span class="property">waifuMinWidth</span>.<span class="title function_">replace</span>(<span class="string">&quot;px&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">            ? $(<span class="string">&quot;.waifu&quot;</span>).<span class="title function_">hide</span>()</span><br><span class="line">            : $(<span class="string">&quot;.waifu&quot;</span>).<span class="title function_">show</span>();</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">if</span> (live2d_settings.<span class="property">waifuMinWidth</span> != <span class="string">&quot;disable&quot;</span>) &#123;</span><br><span class="line">        <span class="title function_">waifuResize</span>();</span><br><span class="line">        $(<span class="variable language_">window</span>).<span class="title function_">resize</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">waifuResize</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (live2d_settings.<span class="property">waifuDraggable</span> == <span class="string">&quot;axis-x&quot;</span>)</span><br><span class="line">            $(<span class="string">&quot;.waifu&quot;</span>).<span class="title function_">draggable</span>(&#123;</span><br><span class="line">                <span class="attr">axis</span>: <span class="string">&quot;x&quot;</span>,</span><br><span class="line">                <span class="attr">revert</span>: live2d_settings.<span class="property">waifuDraggableRevert</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (live2d_settings.<span class="property">waifuDraggable</span> == <span class="string">&quot;unlimited&quot;</span>)</span><br><span class="line">            $(<span class="string">&quot;.waifu&quot;</span>).<span class="title function_">draggable</span>(&#123; <span class="attr">revert</span>: live2d_settings.<span class="property">waifuDraggableRevert</span> &#125;);</span><br><span class="line">        <span class="keyword">else</span> $(<span class="string">&quot;.waifu&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;transition&quot;</span>, <span class="string">&quot;all .3s ease-in-out&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[Error] JQuery UI is not defined.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    live2d_settings.<span class="property">homePageUrl</span> =</span><br><span class="line">        live2d_settings.<span class="property">homePageUrl</span> == <span class="string">&quot;auto&quot;</span></span><br><span class="line">            ? <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">protocol</span> + <span class="string">&quot;//&quot;</span> + <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">hostname</span> + (<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">port</span> ? <span class="string">&#x27;:&#x27;</span> + <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">port</span> : <span class="string">&#x27;&#x27;</span>) + <span class="string">&quot;/&quot;</span></span><br><span class="line">            : live2d_settings.<span class="property">homePageUrl</span>;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">protocol</span> == <span class="string">&quot;file:&quot;</span> &amp;&amp;</span><br><span class="line">        live2d_settings.<span class="property">modelAPI</span>.<span class="title function_">substr</span>(<span class="number">0</span>, <span class="number">2</span>) == <span class="string">&quot;//&quot;</span></span><br><span class="line">    )</span><br><span class="line">        live2d_settings.<span class="property">modelAPI</span> = <span class="string">&quot;http:&quot;</span> + live2d_settings.<span class="property">modelAPI</span>;</span><br><span class="line"></span><br><span class="line">    $(<span class="string">&quot;.waifu-tool .fui-home&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//window.location = &#x27;https://www.fghrsh.net/&#x27;;</span></span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">location</span> = live2d_settings.<span class="property">homePageUrl</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $(<span class="string">&quot;.waifu-tool .fui-info-circle&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//window.open(&#x27;https://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02&#x27;);</span></span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">open</span>(live2d_settings.<span class="property">aboutPageUrl</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> waifuPath == <span class="string">&quot;object&quot;</span>) <span class="title function_">loadTipsMessage</span>(waifuPath);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">            <span class="attr">cache</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">url</span>:</span><br><span class="line">                waifuPath == <span class="string">&quot;&quot;</span></span><br><span class="line">                    ? live2d_settings.<span class="property">tipsMessage</span></span><br><span class="line">                    : waifuPath.<span class="title function_">substr</span>(waifuPath.<span class="property">length</span> - <span class="number">15</span>) == <span class="string">&quot;waifu-tips.json&quot;</span></span><br><span class="line">                    ? waifuPath</span><br><span class="line">                    : waifuPath + <span class="string">&quot;waifu-tips.json&quot;</span>,</span><br><span class="line">            <span class="attr">dataType</span>: <span class="string">&quot;json&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">                <span class="title function_">loadTipsMessage</span>(result);</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!live2d_settings.<span class="property">showToolMenu</span>) $(<span class="string">&quot;.waifu-tool&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    <span class="keyword">if</span> (!live2d_settings.<span class="property">canCloseLive2d</span>) $(<span class="string">&quot;.waifu-tool .fui-cross&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    <span class="keyword">if</span> (!live2d_settings.<span class="property">canSwitchModel</span>) $(<span class="string">&quot;.waifu-tool .fui-eye&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    <span class="keyword">if</span> (!live2d_settings.<span class="property">canSwitchTextures</span>) $(<span class="string">&quot;.waifu-tool .fui-user&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    <span class="keyword">if</span> (!live2d_settings.<span class="property">canSwitchHitokoto</span>) $(<span class="string">&quot;.waifu-tool .fui-chat&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    <span class="keyword">if</span> (!live2d_settings.<span class="property">canTakeScreenshot</span>) $(<span class="string">&quot;.waifu-tool .fui-photo&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    <span class="keyword">if</span> (!live2d_settings.<span class="property">canTurnToHomePage</span>) $(<span class="string">&quot;.waifu-tool .fui-home&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    <span class="keyword">if</span> (!live2d_settings.<span class="property">canTurnToAboutPage</span>)</span><br><span class="line">        $(<span class="string">&quot;.waifu-tool .fui-info-circle&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (waifuPath === <span class="literal">undefined</span>) waifuPath = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> modelId = sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;modelId&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> modelTexturesId = sessionStorage.<span class="title function_">getItem</span>(<span class="string">&quot;modelTexturesId&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!live2d_settings.<span class="property">modelStorage</span> || modelId == <span class="literal">null</span>) &#123;</span><br><span class="line">        modelId = live2d_settings.<span class="property">modelId</span>;</span><br><span class="line">        modelTexturesId = live2d_settings.<span class="property">modelTexturesId</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">loadModel</span>(modelId, modelTexturesId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadModel</span>(<span class="params">modelId, modelTexturesId = <span class="number">0</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (live2d_settings.<span class="property">modelStorage</span>) &#123;</span><br><span class="line">        sessionStorage.<span class="title function_">setItem</span>(<span class="string">&quot;modelId&quot;</span>, modelId);</span><br><span class="line">        sessionStorage.<span class="title function_">setItem</span>(<span class="string">&quot;modelTexturesId&quot;</span>, modelTexturesId);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        live2d_settings[<span class="string">&quot;modelId&quot;</span>] = modelId;</span><br><span class="line">        live2d_settings[<span class="string">&quot;modelTexturesId&quot;</span>] = modelTexturesId;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">loadlive2d</span>(</span><br><span class="line">        <span class="string">&quot;live2d&quot;</span>,</span><br><span class="line">        live2d_settings.<span class="property">modelAPI</span> + <span class="string">&quot;get/?id=&quot;</span> + modelId + <span class="string">&quot;-&quot;</span> + modelTexturesId,</span><br><span class="line">        live2d_settings.<span class="property">showF12Status</span></span><br><span class="line">            ? <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">                    <span class="string">&quot;[Status]&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;live2d&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;æ¨¡å‹&quot;</span>,</span><br><span class="line">                    modelId + <span class="string">&quot;-&quot;</span> + modelTexturesId,</span><br><span class="line">                    <span class="string">&quot;åŠ è½½å®Œæˆ&quot;</span></span><br><span class="line">                )</span><br><span class="line">            : <span class="literal">null</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadTipsMessage</span>(<span class="params">result</span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">waifu_tips</span> = result;</span><br><span class="line"></span><br><span class="line">    $.<span class="title function_">each</span>(result.<span class="property">mouseover</span>, <span class="keyword">function</span> (<span class="params">index, tips</span>) &#123;</span><br><span class="line">        $(<span class="variable language_">document</span>).<span class="title function_">on</span>(<span class="string">&quot;mouseover&quot;</span>, tips.<span class="property">selector</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> text = <span class="title function_">getRandText</span>(tips.<span class="property">text</span>);</span><br><span class="line">            text = text.<span class="title function_">render</span>(&#123; <span class="attr">text</span>: $(<span class="variable language_">this</span>).<span class="title function_">text</span>() &#125;);</span><br><span class="line">            <span class="title function_">showMessage</span>(text, <span class="number">3000</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    $.<span class="title function_">each</span>(result.<span class="property">click</span>, <span class="keyword">function</span> (<span class="params">index, tips</span>) &#123;</span><br><span class="line">        $(<span class="variable language_">document</span>).<span class="title function_">on</span>(<span class="string">&quot;click&quot;</span>, tips.<span class="property">selector</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> text = <span class="title function_">getRandText</span>(tips.<span class="property">text</span>);</span><br><span class="line">            text = text.<span class="title function_">render</span>(&#123; <span class="attr">text</span>: $(<span class="variable language_">this</span>).<span class="title function_">text</span>() &#125;);</span><br><span class="line">            <span class="title function_">showMessage</span>(text, <span class="number">3000</span>, <span class="literal">true</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    $.<span class="title function_">each</span>(result.<span class="property">seasons</span>, <span class="keyword">function</span> (<span class="params">index, tips</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="keyword">var</span> after = tips.<span class="property">date</span>.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">var</span> before = tips.<span class="property">date</span>.<span class="title function_">split</span>(<span class="string">&quot;-&quot;</span>)[<span class="number">1</span>] || after;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            after.<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>)[<span class="number">0</span>] &lt;= now.<span class="title function_">getMonth</span>() + <span class="number">1</span> &amp;&amp;</span><br><span class="line">            now.<span class="title function_">getMonth</span>() + <span class="number">1</span> &lt;= before.<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>)[<span class="number">0</span>] &amp;&amp;</span><br><span class="line">            after.<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>)[<span class="number">1</span>] &lt;= now.<span class="title function_">getDate</span>() &amp;&amp;</span><br><span class="line">            now.<span class="title function_">getDate</span>() &lt;= before.<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>)[<span class="number">1</span>]</span><br><span class="line">        ) &#123;</span><br><span class="line">            <span class="keyword">var</span> text = <span class="title function_">getRandText</span>(tips.<span class="property">text</span>);</span><br><span class="line">            text = text.<span class="title function_">render</span>(&#123; <span class="attr">year</span>: now.<span class="title function_">getFullYear</span>() &#125;);</span><br><span class="line">            <span class="title function_">showMessage</span>(text, <span class="number">6000</span>, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (live2d_settings.<span class="property">showF12OpenMsg</span>) &#123;</span><br><span class="line">        re.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">showMessage</span>(<span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">console_open_msg</span>), <span class="number">5000</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (live2d_settings.<span class="property">showCopyMessage</span>) &#123;</span><br><span class="line">        $(<span class="variable language_">document</span>).<span class="title function_">on</span>(<span class="string">&quot;copy&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="title function_">showMessage</span>(<span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">copy_message</span>), <span class="number">5000</span>, <span class="literal">true</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $(<span class="string">&quot;.waifu-tool .fui-photo&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">showMessage</span>(<span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">screenshot_message</span>), <span class="number">5000</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">Live2D</span>.<span class="property">captureName</span> = live2d_settings.<span class="property">screenshotCaptureName</span>;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">Live2D</span>.<span class="property">captureFrame</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $(<span class="string">&quot;.waifu-tool .fui-cross&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        sessionStorage.<span class="title function_">setItem</span>(<span class="string">&quot;waifu-dsiplay&quot;</span>, <span class="string">&quot;none&quot;</span>);</span><br><span class="line">        <span class="title function_">showMessage</span>(<span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hidden_message</span>), <span class="number">1300</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            $(<span class="string">&quot;.waifu&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">        &#125;, <span class="number">1300</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">showWelcomeMessage</span> = <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> text;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> == live2d_settings.<span class="property">homePageUrl</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>();</span><br><span class="line">            <span class="keyword">if</span> (now &gt; <span class="number">23</span> || now &lt;= <span class="number">5</span>)</span><br><span class="line">                text = <span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hour_tips</span>.<span class="property">t23</span> - <span class="number">5</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (now &gt; <span class="number">5</span> &amp;&amp; now &lt;= <span class="number">7</span>)</span><br><span class="line">                text = <span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hour_tips</span>.<span class="property">t5</span> - <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (now &gt; <span class="number">7</span> &amp;&amp; now &lt;= <span class="number">11</span>)</span><br><span class="line">                text = <span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hour_tips</span>.<span class="property">t7</span> - <span class="number">11</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (now &gt; <span class="number">11</span> &amp;&amp; now &lt;= <span class="number">14</span>)</span><br><span class="line">                text = <span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hour_tips</span>.<span class="property">t11</span> - <span class="number">14</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (now &gt; <span class="number">14</span> &amp;&amp; now &lt;= <span class="number">17</span>)</span><br><span class="line">                text = <span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hour_tips</span>.<span class="property">t14</span> - <span class="number">17</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (now &gt; <span class="number">17</span> &amp;&amp; now &lt;= <span class="number">19</span>)</span><br><span class="line">                text = <span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hour_tips</span>.<span class="property">t17</span> - <span class="number">19</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (now &gt; <span class="number">19</span> &amp;&amp; now &lt;= <span class="number">21</span>)</span><br><span class="line">                text = <span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hour_tips</span>.<span class="property">t19</span> - <span class="number">21</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (now &gt; <span class="number">21</span> &amp;&amp; now &lt;= <span class="number">23</span>)</span><br><span class="line">                text = <span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hour_tips</span>.<span class="property">t21</span> - <span class="number">23</span>);</span><br><span class="line">            <span class="keyword">else</span> text = <span class="title function_">getRandText</span>(result.<span class="property">waifu</span>.<span class="property">hour_tips</span>.<span class="property">default</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> referrer_message = result.<span class="property">waifu</span>.<span class="property">referrer_message</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">referrer</span> !== <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> referrer = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">                referrer.<span class="property">href</span> = <span class="variable language_">document</span>.<span class="property">referrer</span>;</span><br><span class="line">                <span class="keyword">var</span> domain = referrer.<span class="property">hostname</span>.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">hostname</span> == referrer.<span class="property">hostname</span>)</span><br><span class="line">                    text =</span><br><span class="line">                        referrer_message.<span class="property">localhost</span>[<span class="number">0</span>] +</span><br><span class="line">                        <span class="variable language_">document</span>.<span class="property">title</span>.<span class="title function_">split</span>(referrer_message.<span class="property">localhost</span>[<span class="number">2</span>])[<span class="number">0</span>] +</span><br><span class="line">                        referrer_message.<span class="property">localhost</span>[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (domain == <span class="string">&quot;baidu&quot;</span>)</span><br><span class="line">                    text =</span><br><span class="line">                        referrer_message.<span class="property">baidu</span>[<span class="number">0</span>] +</span><br><span class="line">                        referrer.<span class="property">search</span>.<span class="title function_">split</span>(<span class="string">&quot;&amp;wd=&quot;</span>)[<span class="number">1</span>].<span class="title function_">split</span>(<span class="string">&quot;&amp;&quot;</span>)[<span class="number">0</span>] +</span><br><span class="line">                        referrer_message.<span class="property">baidu</span>[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (domain == <span class="string">&quot;so&quot;</span>)</span><br><span class="line">                    text =</span><br><span class="line">                        referrer_message.<span class="property">so</span>[<span class="number">0</span>] +</span><br><span class="line">                        referrer.<span class="property">search</span>.<span class="title function_">split</span>(<span class="string">&quot;&amp;q=&quot;</span>)[<span class="number">1</span>].<span class="title function_">split</span>(<span class="string">&quot;&amp;&quot;</span>)[<span class="number">0</span>] +</span><br><span class="line">                        referrer_message.<span class="property">so</span>[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (domain == <span class="string">&quot;google&quot;</span>)</span><br><span class="line">                    text =</span><br><span class="line">                        referrer_message.<span class="property">google</span>[<span class="number">0</span>] +</span><br><span class="line">                        <span class="variable language_">document</span>.<span class="property">title</span>.<span class="title function_">split</span>(referrer_message.<span class="property">google</span>[<span class="number">2</span>])[<span class="number">0</span>] +</span><br><span class="line">                        referrer_message.<span class="property">google</span>[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    $.<span class="title function_">each</span>(result.<span class="property">waifu</span>.<span class="property">referrer_hostname</span>, <span class="keyword">function</span> (<span class="params">i, val</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (i == referrer.<span class="property">hostname</span>) referrer.<span class="property">hostname</span> = <span class="title function_">getRandText</span>(val);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    text =</span><br><span class="line">                        referrer_message.<span class="property">default</span>[<span class="number">0</span>] +</span><br><span class="line">                        referrer.<span class="property">hostname</span> +</span><br><span class="line">                        referrer_message.<span class="property">default</span>[<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                text =</span><br><span class="line">                    referrer_message.<span class="property">none</span>[<span class="number">0</span>] +</span><br><span class="line">                    <span class="variable language_">document</span>.<span class="property">title</span>.<span class="title function_">split</span>(referrer_message.<span class="property">none</span>[<span class="number">2</span>])[<span class="number">0</span>] +</span><br><span class="line">                    referrer_message.<span class="property">none</span>[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">showMessage</span>(text, <span class="number">6000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">if</span> (live2d_settings.<span class="property">showWelcomeMessage</span>) <span class="title function_">showWelcomeMessage</span>(result);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> waifu_tips = result.<span class="property">waifu</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">loadOtherModel</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> modelId = <span class="title function_">modelStorageGetItem</span>(<span class="string">&quot;modelId&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> modelRandMode = live2d_settings.<span class="property">modelRandMode</span>;</span><br><span class="line"></span><br><span class="line">        $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">            <span class="attr">cache</span>: modelRandMode == <span class="string">&quot;switch&quot;</span> ? <span class="literal">true</span> : <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">url</span>: live2d_settings.<span class="property">modelAPI</span> + modelRandMode + <span class="string">&quot;/?id=&quot;</span> + modelId,</span><br><span class="line">            <span class="attr">dataType</span>: <span class="string">&quot;json&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">                <span class="title function_">loadModel</span>(result.<span class="property">model</span>[<span class="string">&quot;id&quot;</span>]);</span><br><span class="line">                <span class="keyword">var</span> message = result.<span class="property">model</span>[<span class="string">&quot;message&quot;</span>];</span><br><span class="line">                $.<span class="title function_">each</span>(waifu_tips.<span class="property">model_message</span>, <span class="keyword">function</span> (<span class="params">i, val</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (i == result.<span class="property">model</span>[<span class="string">&quot;id&quot;</span>]) message = <span class="title function_">getRandText</span>(val);</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="title function_">showMessage</span>(message, <span class="number">3000</span>, <span class="literal">true</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">loadRandTextures</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> modelId = <span class="title function_">modelStorageGetItem</span>(<span class="string">&quot;modelId&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> modelTexturesId = <span class="title function_">modelStorageGetItem</span>(<span class="string">&quot;modelTexturesId&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> modelTexturesRandMode = live2d_settings.<span class="property">modelTexturesRandMode</span>;</span><br><span class="line"></span><br><span class="line">        $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">            <span class="attr">cache</span>: modelTexturesRandMode == <span class="string">&quot;switch&quot;</span> ? <span class="literal">true</span> : <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">url</span>:</span><br><span class="line">                live2d_settings.<span class="property">modelAPI</span> +</span><br><span class="line">                modelTexturesRandMode +</span><br><span class="line">                <span class="string">&quot;_textures/?id=&quot;</span> +</span><br><span class="line">                modelId +</span><br><span class="line">                <span class="string">&quot;-&quot;</span> +</span><br><span class="line">                modelTexturesId,</span><br><span class="line">            <span class="attr">dataType</span>: <span class="string">&quot;json&quot;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (</span><br><span class="line">                    result.<span class="property">textures</span>[<span class="string">&quot;id&quot;</span>] == <span class="number">1</span> &amp;&amp;</span><br><span class="line">                    (modelTexturesId == <span class="number">1</span> || modelTexturesId == <span class="number">0</span>)</span><br><span class="line">                )</span><br><span class="line">                    <span class="title function_">showMessage</span>(waifu_tips.<span class="property">load_rand_textures</span>[<span class="number">0</span>], <span class="number">3000</span>, <span class="literal">true</span>);</span><br><span class="line">                <span class="keyword">else</span> <span class="title function_">showMessage</span>(waifu_tips.<span class="property">load_rand_textures</span>[<span class="number">1</span>], <span class="number">3000</span>, <span class="literal">true</span>);</span><br><span class="line">                <span class="title function_">loadModel</span>(modelId, result.<span class="property">textures</span>[<span class="string">&quot;id&quot;</span>]);</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">modelStorageGetItem</span>(<span class="params">key</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> live2d_settings.<span class="property">modelStorage</span></span><br><span class="line">            ? sessionStorage.<span class="title function_">getItem</span>(key)</span><br><span class="line">            : live2d_settings[key];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ£€æµ‹ç”¨æˆ·æ´»åŠ¨çŠ¶æ€ï¼Œå¹¶åœ¨ç©ºé—²æ—¶æ˜¾ç¤ºä¸€è¨€ */</span></span><br><span class="line">    <span class="keyword">if</span> (live2d_settings.<span class="property">showHitokoto</span>) &#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">getActed</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">hitokotoTimer</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">hitokotoInterval</span> = <span class="literal">false</span>;</span><br><span class="line">        $(<span class="variable language_">document</span>)</span><br><span class="line">            .<span class="title function_">mousemove</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                getActed = <span class="literal">true</span>;</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">keydown</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                getActed = <span class="literal">true</span>;</span><br><span class="line">            &#125;);</span><br><span class="line">        <span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!getActed) <span class="title function_">ifActed</span>();</span><br><span class="line">            <span class="keyword">else</span> <span class="title function_">elseActed</span>();</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">ifActed</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!hitokotoInterval) &#123;</span><br><span class="line">            hitokotoInterval = <span class="literal">true</span>;</span><br><span class="line">            hitokotoTimer = <span class="variable language_">window</span>.<span class="built_in">setInterval</span>(showHitokotoActed, <span class="number">30000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">elseActed</span>(<span class="params"></span>) &#123;</span><br><span class="line">        getActed = hitokotoInterval = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="built_in">clearInterval</span>(hitokotoTimer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">showHitokotoActed</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($(<span class="variable language_">document</span>)[<span class="number">0</span>].<span class="property">visibilityState</span> == <span class="string">&quot;visible&quot;</span>) <span class="title function_">showHitokoto</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">showHitokoto</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (live2d_settings.<span class="property">hitokotoAPI</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;lwl12.com&quot;</span>:</span><br><span class="line">                $.<span class="title function_">getJSON</span>(</span><br><span class="line">                    <span class="string">&quot;https://api.lwl12.com/hitokoto/v1?encode=realjson&quot;</span>,</span><br><span class="line">                    <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!<span class="title function_">empty</span>(result.<span class="property">source</span>)) &#123;</span><br><span class="line">                            <span class="keyword">var</span> text = waifu_tips.<span class="property">hitokoto_api_message</span>[<span class="string">&quot;lwl12.com&quot;</span>][<span class="number">0</span>];</span><br><span class="line">                            <span class="keyword">if</span> (!<span class="title function_">empty</span>(result.<span class="property">author</span>))</span><br><span class="line">                                text += waifu_tips.<span class="property">hitokoto_api_message</span>[<span class="string">&quot;lwl12.com&quot;</span>][<span class="number">1</span>];</span><br><span class="line">                            text = text.<span class="title function_">render</span>(&#123;</span><br><span class="line">                                <span class="attr">source</span>: result.<span class="property">source</span>,</span><br><span class="line">                                <span class="attr">creator</span>: result.<span class="property">author</span>,</span><br><span class="line">                            &#125;);</span><br><span class="line">                            <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                                <span class="title function_">showMessage</span>(</span><br><span class="line">                                    text + waifu_tips.<span class="property">hitokoto_api_message</span>[<span class="string">&quot;lwl12.com&quot;</span>][<span class="number">2</span>],</span><br><span class="line">                                    <span class="number">3000</span>,</span><br><span class="line">                                    <span class="literal">true</span></span><br><span class="line">                                );</span><br><span class="line">                            &#125;, <span class="number">5000</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="title function_">showMessage</span>(result.<span class="property">text</span>, <span class="number">5000</span>, <span class="literal">true</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;fghrsh.net&quot;</span>:</span><br><span class="line">                $.<span class="title function_">getJSON</span>(</span><br><span class="line">                    <span class="string">&quot;https://api.fghrsh.net/hitokoto/rand/?encode=jsc&amp;uid=3335&quot;</span>,</span><br><span class="line">                    <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!<span class="title function_">empty</span>(result.<span class="property">source</span>)) &#123;</span><br><span class="line">                            <span class="keyword">var</span> text = waifu_tips.<span class="property">hitokoto_api_message</span>[<span class="string">&quot;fghrsh.net&quot;</span>][<span class="number">0</span>];</span><br><span class="line">                            text = text.<span class="title function_">render</span>(&#123; <span class="attr">source</span>: result.<span class="property">source</span>, <span class="attr">date</span>: result.<span class="property">date</span> &#125;);</span><br><span class="line">                            <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                                <span class="title function_">showMessage</span>(text, <span class="number">3000</span>, <span class="literal">true</span>);</span><br><span class="line">                            &#125;, <span class="number">5000</span>);</span><br><span class="line">                            <span class="title function_">showMessage</span>(result.<span class="property">hitokoto</span>, <span class="number">5000</span>, <span class="literal">true</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;jinrishici.com&quot;</span>:</span><br><span class="line">                $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">                    <span class="attr">url</span>: <span class="string">&quot;https://v2.jinrishici.com/one.json&quot;</span>,</span><br><span class="line">                    <span class="attr">xhrFields</span>: &#123; <span class="attr">withCredentials</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">result, status</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!<span class="title function_">empty</span>(result.<span class="property">data</span>.<span class="property">origin</span>.<span class="property">title</span>)) &#123;</span><br><span class="line">                            <span class="keyword">var</span> text = waifu_tips.<span class="property">hitokoto_api_message</span>[<span class="string">&quot;jinrishici.com&quot;</span>][<span class="number">0</span>];</span><br><span class="line">                            text = text.<span class="title function_">render</span>(&#123;</span><br><span class="line">                                <span class="attr">title</span>: result.<span class="property">data</span>.<span class="property">origin</span>.<span class="property">title</span>,</span><br><span class="line">                                <span class="attr">dynasty</span>: result.<span class="property">data</span>.<span class="property">origin</span>.<span class="property">dynasty</span>,</span><br><span class="line">                                <span class="attr">author</span>: result.<span class="property">data</span>.<span class="property">origin</span>.<span class="property">author</span>,</span><br><span class="line">                            &#125;);</span><br><span class="line">                            <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                                <span class="title function_">showMessage</span>(text, <span class="number">3000</span>, <span class="literal">true</span>);</span><br><span class="line">                            &#125;, <span class="number">5000</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="title function_">showMessage</span>(result.<span class="property">data</span>.<span class="property">content</span>, <span class="number">5000</span>, <span class="literal">true</span>);</span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="attr">default</span>:</span><br><span class="line">                $.<span class="title function_">getJSON</span>(<span class="string">&quot;https://v1.hitokoto.cn&quot;</span>, <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!<span class="title function_">empty</span>(result.<span class="property">from</span>)) &#123;</span><br><span class="line">                        <span class="keyword">var</span> text = waifu_tips.<span class="property">hitokoto_api_message</span>[<span class="string">&quot;hitokoto.cn&quot;</span>][<span class="number">0</span>];</span><br><span class="line">                        text = text.<span class="title function_">render</span>(&#123;</span><br><span class="line">                            <span class="attr">source</span>: result.<span class="property">from</span>,</span><br><span class="line">                            <span class="attr">creator</span>: result.<span class="property">creator</span>,</span><br><span class="line">                        &#125;);</span><br><span class="line">                        <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                            <span class="title function_">showMessage</span>(text, <span class="number">3000</span>, <span class="literal">true</span>);</span><br><span class="line">                        &#125;, <span class="number">5000</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="title function_">showMessage</span>(result.<span class="property">hitokoto</span>, <span class="number">5000</span>, <span class="literal">true</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $(<span class="string">&quot;.waifu-tool .fui-eye&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">loadOtherModel</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;.waifu-tool .fui-user&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">loadRandTextures</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;.waifu-tool .fui-chat&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">showHitokoto</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹<code>themes/next/live2d-widget/waifu-tips.json</code>ï¼Œåˆ æ‰åŸæœ‰å†…å®¹æ›¿æ¢å¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;waifu&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;console_open_msg&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å“ˆå“ˆï¼Œä½ æ‰“å¼€äº†æ§åˆ¶å°ï¼Œæ˜¯æƒ³è¦çœ‹çœ‹æˆ‘çš„ç§˜å¯†å—ï¼Ÿ&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;copy_message&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä½ éƒ½å¤åˆ¶äº†äº›ä»€ä¹ˆå‘€ï¼Œè½¬è½½è¦è®°å¾—åŠ ä¸Šå‡ºå¤„å“¦&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;screenshot_message&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ç…§å¥½äº†å˜›ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¯çˆ±å‘¢ï¼Ÿ&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;hidden_message&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æˆ‘ä»¬è¿˜èƒ½å†è§é¢çš„å§â€¦&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;load_rand_textures&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æˆ‘è¿˜æ²¡æœ‰å…¶ä»–è¡£æœå‘¢&quot;</span><span class="punctuation">,</span> <span class="string">&quot;æˆ‘çš„æ–°è¡£æœå¥½çœ‹å˜›&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;hour_tips&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;t5-7&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ—©ä¸Šå¥½ï¼ä¸€æ—¥ä¹‹è®¡åœ¨äºæ™¨ï¼Œç¾å¥½çš„ä¸€å¤©å°±è¦å¼€å§‹äº†&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;t7-11&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä¸Šåˆå¥½ï¼å·¥ä½œé¡ºåˆ©å˜›ï¼Œä¸è¦ä¹…åï¼Œå¤šèµ·æ¥èµ°åŠ¨èµ°åŠ¨å“¦ï¼&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;t11-14&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä¸­åˆäº†ï¼Œå·¥ä½œäº†ä¸€ä¸ªä¸Šåˆï¼Œç°åœ¨æ˜¯åˆé¤æ—¶é—´ï¼&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;t14-17&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;åˆåå¾ˆå®¹æ˜“çŠ¯å›°å‘¢ï¼Œä»Šå¤©çš„è¿åŠ¨ç›®æ ‡å®Œæˆäº†å—ï¼Ÿ&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;t17-19&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å‚æ™šäº†ï¼çª—å¤–å¤•é˜³çš„æ™¯è‰²å¾ˆç¾ä¸½å‘¢ï¼Œæœ€ç¾ä¸è¿‡å¤•é˜³çº¢~&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;t19-21&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ™šä¸Šå¥½ï¼Œä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;t21-23&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å·²ç»è¿™ä¹ˆæ™šäº†å‘€ï¼Œæ—©ç‚¹ä¼‘æ¯å§ï¼Œæ™šå®‰~&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;t23-5&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä½ æ˜¯å¤œçŒ«å­å‘€ï¼Ÿè¿™ä¹ˆæ™šè¿˜ä¸ç¡è§‰ï¼Œæ˜å¤©èµ·çš„æ¥å˜›&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;default&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å—¨~ å¿«æ¥é€—æˆ‘ç©å§ï¼&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;referrer_message&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;localhost&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ¬¢è¿é˜…è¯»&lt;span style=\&quot;color:#0099cc;\&quot;&gt;ã€&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ã€&lt;/span&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot; - &quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;baidu&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;Hello! æ¥è‡ª ç™¾åº¦æœç´¢ çš„æœ‹å‹&lt;br&gt;ä½ æ˜¯æœç´¢ &lt;span style=\&quot;color:#0099cc;\&quot;&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;&lt;/span&gt; æ‰¾åˆ°çš„æˆ‘å—ï¼Ÿ&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;so&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;Hello! æ¥è‡ª 360æœç´¢ çš„æœ‹å‹&lt;br&gt;ä½ æ˜¯æœç´¢ &lt;span style=\&quot;color:#0099cc;\&quot;&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;&lt;/span&gt; æ‰¾åˆ°çš„æˆ‘å—ï¼Ÿ&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;google&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;Hello! æ¥è‡ª è°·æ­Œæœç´¢ çš„æœ‹å‹&lt;br&gt;æ¬¢è¿é˜…è¯»&lt;span style=\&quot;color:#0099cc;\&quot;&gt;ã€&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ã€&lt;/span&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot; - &quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;default&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;Hello! æ¥è‡ª &lt;span style=\&quot;color:#0099cc;\&quot;&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;&lt;/span&gt; çš„æœ‹å‹&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;none&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ¬¢è¿é˜…è¯»&lt;span style=\&quot;color:#0099cc;\&quot;&gt;ã€&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ã€&lt;/span&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot; - &quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;referrer_hostname&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;yaoxi-std.github.io&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;yaoxi-std&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;model_message&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;1&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ¥è‡ª Potion Maker çš„ Pio é…± ~&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;2&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ¥è‡ª Potion Maker çš„ Tia é…± ~&quot;</span><span class="punctuation">]</span>  </span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;hitokoto_api_message&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;lwl12.com&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¿™å¥ä¸€è¨€æ¥è‡ª &lt;span style=\&quot;color:#0099cc;\&quot;&gt;ã€&#123;source&#125;ã€&lt;/span&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ï¼Œæ˜¯ &lt;span style=\&quot;color:#0099cc;\&quot;&gt;&#123;creator&#125;&lt;/span&gt; æŠ•ç¨¿çš„&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ã€‚&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;fghrsh.net&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¿™å¥ä¸€è¨€å‡ºå¤„æ˜¯ &lt;span style=\&quot;color:#0099cc;\&quot;&gt;ã€&#123;source&#125;ã€&lt;/span&gt;ï¼Œæ˜¯ &lt;span style=\&quot;color:#0099cc;\&quot;&gt;FGHRSH&lt;/span&gt; åœ¨ &#123;date&#125; æ”¶è—çš„ï¼&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;jinrishici.com&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¿™å¥è¯—è¯å‡ºè‡ª &lt;span style=\&quot;color:#0099cc;\&quot;&gt;ã€Š&#123;title&#125;ã€‹&lt;/span&gt;ï¼Œæ˜¯ &#123;dynasty&#125;è¯—äºº &#123;author&#125; åˆ›ä½œçš„ï¼&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;hitokoto.cn&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¿™å¥ä¸€è¨€æ¥è‡ª &lt;span style=\&quot;color:#0099cc;\&quot;&gt;ã€&#123;source&#125;ã€&lt;/span&gt;ï¼Œæ˜¯ &lt;span style=\&quot;color:#0099cc;\&quot;&gt;&#123;creator&#125;&lt;/span&gt; åœ¨ hitokoto.cn æŠ•ç¨¿çš„ã€‚&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;mouseover&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.container a[href^=&#x27;http&#x27;]&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¦çœ‹çœ‹ &lt;span style=\&quot;color:#0099cc;\&quot;&gt;&#123;text&#125;&lt;/span&gt; ä¹ˆï¼Ÿ&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.fui-home&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ç‚¹å‡»å‰å¾€é¦–é¡µï¼Œæƒ³å›åˆ°ä¸Šä¸€é¡µå¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„åé€€åŠŸèƒ½å“¦&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.fui-chat&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä¸€è¨€ä¸€è¯­ï¼Œä¸€é¢¦ä¸€ç¬‘ã€‚ä¸€å­—ä¸€å¥ï¼Œä¸€é¢—èµ›è‰‡ã€‚&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.fui-eye&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å—¯Â·Â·Â· è¦åˆ‡æ¢ çœ‹æ¿å¨˜ å—ï¼Ÿ&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.fui-user&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å–œæ¬¢æ¢è£… Play å—ï¼Ÿ&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.fui-photo&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¦æ‹å¼ çºªå¿µç…§ç‰‡å—ï¼Ÿ&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.fui-info-circle&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¿™é‡Œæœ‰å…³äºæˆ‘çš„ä¿¡æ¯å‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.fui-cross&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä½ ä¸å–œæ¬¢æˆ‘äº†å—...&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#tor_show&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ç¿»é¡µæ¯”è¾ƒéº»çƒ¦å—ï¼Œç‚¹å‡»å¯ä»¥æ˜¾ç¤ºè¿™ç¯‡æ–‡ç« çš„ç›®å½•å‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#comment_go&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æƒ³è¦å»è¯„è®ºäº›ä»€ä¹ˆå—ï¼Ÿ&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#night_mode&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ·±å¤œæ—¶è¦çˆ±æŠ¤çœ¼ç›å‘€&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#qrcode&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ‰‹æœºæ‰«ä¸€ä¸‹å°±èƒ½ç»§ç»­çœ‹ï¼Œå¾ˆæ–¹ä¾¿å‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.comment_reply&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¦åæ§½äº›ä»€ä¹ˆå‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#back-to-top&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å›åˆ°å¼€å§‹çš„åœ°æ–¹å§&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#author&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¯¥æ€ä¹ˆç§°å‘¼ä½ å‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#mail&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ç•™ä¸‹ä½ çš„é‚®ç®±ï¼Œä¸ç„¶å°±æ˜¯æ— å¤´åƒäººå£«äº†&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#url&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä½ çš„å®¶åœ¨å“ªé‡Œå‘¢ï¼Œå¥½è®©æˆ‘å»å‚è§‚å‚è§‚&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#textarea&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è®¤çœŸå¡«å†™å“¦ï¼Œåƒåœ¾è¯„è®ºæ˜¯ç¦æ­¢äº‹é¡¹&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.OwO-logo&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¦æ’å…¥ä¸€ä¸ªè¡¨æƒ…å—&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#csubmit&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¦[æäº¤]^(Commit)äº†å—ï¼Œé¦–æ¬¡è¯„è®ºéœ€è¦å®¡æ ¸ï¼Œè¯·è€å¿ƒç­‰å¾…~&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.ImageBox&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ç‚¹å‡»å›¾ç‰‡å¯ä»¥æ”¾å¤§å‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;input[name=s]&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ‰¾ä¸åˆ°æƒ³çœ‹çš„å†…å®¹ï¼Ÿæœç´¢çœ‹çœ‹å§&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.previous&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å»ä¸Šä¸€é¡µçœ‹çœ‹å§&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.next&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å»ä¸‹ä¸€é¡µçœ‹çœ‹å§&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.dropdown-toggle&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¿™é‡Œæ˜¯èœå•&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c-player a.play-icon&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æƒ³è¦å¬ç‚¹éŸ³ä¹å—&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c-player div.time&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;åœ¨è¿™é‡Œå¯ä»¥è°ƒæ•´&lt;span style=\&quot;color:#0099cc;\&quot;&gt;æ’­æ”¾è¿›åº¦&lt;/span&gt;å‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c-player div.volume&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;åœ¨è¿™é‡Œå¯ä»¥è°ƒæ•´&lt;span style=\&quot;color:#0099cc;\&quot;&gt;éŸ³é‡&lt;/span&gt;å‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c-player div.list-button&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;span style=\&quot;color:#0099cc;\&quot;&gt;æ’­æ”¾åˆ—è¡¨&lt;/span&gt;é‡Œéƒ½æœ‰ä»€ä¹ˆå‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c-player div.lyric-button&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æœ‰&lt;span style=\&quot;color:#0099cc;\&quot;&gt;æ­Œè¯&lt;/span&gt;çš„è¯å°±èƒ½è·Ÿç€ä¸€èµ·å”±å‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.waifu #live2d&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;å¹²å˜›å‘¢ä½ ï¼Œå¿«æŠŠæ‰‹æ‹¿å¼€&quot;</span><span class="punctuation">,</span> <span class="string">&quot;é¼ â€¦é¼ æ ‡æ”¾é”™åœ°æ–¹äº†ï¼&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;click&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.waifu #live2d&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;æ˜¯â€¦æ˜¯ä¸å°å¿ƒç¢°åˆ°äº†å§&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;èè‰æ§æ˜¯ä»€ä¹ˆå‘€&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;ä½ çœ‹åˆ°æˆ‘çš„å°ç†Šäº†å—&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;å†æ‘¸çš„è¯æˆ‘å¯è¦æŠ¥è­¦äº†ï¼âŒ‡â—ï¹â—âŒ‡&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;110å—ï¼Œè¿™é‡Œæœ‰ä¸ªå˜æ€ä¸€ç›´åœ¨æ‘¸æˆ‘(Ã³ï¹Ã²ï½¡)&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;seasons&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;01/01&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;span style=\&quot;color:#0099cc;\&quot;&gt;å…ƒæ—¦&lt;/span&gt;äº†å‘¢ï¼Œæ–°çš„ä¸€å¹´åˆå¼€å§‹äº†ï¼Œä»Šå¹´æ˜¯&#123;year&#125;å¹´~&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;02/14&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;åˆæ˜¯ä¸€å¹´&lt;span style=\&quot;color:#0099cc;\&quot;&gt;æƒ…äººèŠ‚&lt;/span&gt;ï¼Œ&#123;year&#125;å¹´æ‰¾åˆ°å¯¹è±¡äº†å˜›~&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;03/08&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä»Šå¤©æ˜¯&lt;span style=\&quot;color:#0099cc;\&quot;&gt;å¦‡å¥³èŠ‚&lt;/span&gt;ï¼&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;03/12&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä»Šå¤©æ˜¯&lt;span style=\&quot;color:#0099cc;\&quot;&gt;æ¤æ ‘èŠ‚&lt;/span&gt;ï¼Œè¦ä¿æŠ¤ç¯å¢ƒå‘€&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;04/01&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;æ‚„æ‚„å‘Šè¯‰ä½ ä¸€ä¸ªç§˜å¯†~&lt;span style=\&quot;background-color:#34495e;\&quot;&gt;ä»Šå¤©æ˜¯æ„šäººèŠ‚ï¼Œä¸è¦è¢«éª—äº†å“¦~&lt;/span&gt;&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;05/01&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä»Šå¤©æ˜¯&lt;span style=\&quot;color:#0099cc;\&quot;&gt;äº”ä¸€åŠ³åŠ¨èŠ‚&lt;/span&gt;ï¼Œè®¡åˆ’å¥½å‡æœŸå»å“ªé‡Œäº†å—~&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;06/01&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;span style=\&quot;color:#0099cc;\&quot;&gt;å„¿ç«¥èŠ‚&lt;/span&gt;äº†å‘¢ï¼Œå¿«æ´»çš„æ—¶å…‰æ€»æ˜¯çŸ­æš‚ï¼Œè¦æ˜¯æ°¸è¿œé•¿ä¸å¤§è¯¥å¤šå¥½å•Šâ€¦&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;09/03&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;span style=\&quot;color:#0099cc;\&quot;&gt;ä¸­å›½äººæ°‘æŠ—æ—¥æˆ˜äº‰èƒœåˆ©çºªå¿µæ—¥&lt;/span&gt;ï¼Œé“­è®°å†å²ã€ç¼…æ€€å…ˆçƒˆã€ççˆ±å’Œå¹³ã€å¼€åˆ›æœªæ¥ã€‚&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;09/10&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;span style=\&quot;color:#0099cc;\&quot;&gt;æ•™å¸ˆèŠ‚&lt;/span&gt;ï¼Œåœ¨å­¦æ ¡è¦ç»™è€å¸ˆé—®å£°å¥½å‘€~&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;10/01&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;span style=\&quot;color:#0099cc;\&quot;&gt;å›½åº†èŠ‚&lt;/span&gt;ï¼Œæ–°ä¸­å›½å·²ç»æˆç«‹äº†å‘¢&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;11/05-11/12&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ä»Šå¹´çš„&lt;span style=\&quot;color:#0099cc;\&quot;&gt;åŒåä¸€&lt;/span&gt;æ˜¯å’Œè°ä¸€èµ·è¿‡çš„å‘¢~&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span> <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;12/20-12/31&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;è¿™å‡ å¤©æ˜¯&lt;span style=\&quot;color:#0099cc;\&quot;&gt;åœ£è¯èŠ‚&lt;/span&gt;ï¼Œä¸»äººè‚¯å®šåˆå»å‰æ‰‹ä¹°ä¹°ä¹°äº†~&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹<code>themes/next/live2d-widget/waifu-tips.css</code>ï¼Œ<strong>ä¸è¦åˆ æ‰</strong>åŸæœ‰å†…å®¹ï¼Œåœ¨æ–‡æ¡£æœ«å°¾æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.waifu</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0</span>;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">20px</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">20px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.waifu</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">15px</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">15px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.waifu-tips</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: -<span class="number">20px</span> <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">224</span>, <span class="number">186</span>, <span class="number">140</span>, <span class="number">0.62</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">236</span>, <span class="number">217</span>, <span class="number">188</span>, <span class="number">0.5</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">15px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">191</span>, <span class="number">158</span>, <span class="number">118</span>, <span class="number">0.2</span>);</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">animation-delay</span>: <span class="number">5s</span>;</span><br><span class="line">    <span class="attribute">animation-duration</span>: <span class="number">50s</span>;</span><br><span class="line">    <span class="attribute">animation-iteration-count</span>: infinite;</span><br><span class="line">    <span class="attribute">animation-name</span>: shake;</span><br><span class="line">    <span class="attribute">animation-timing-function</span>: ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.waifu-tool</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#aaa</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.waifu</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.waifu-tool</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.waifu-tool</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#5b6c7d</span>;</span><br><span class="line">    <span class="attribute">transition</span>: <span class="number">0.2s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.waifu-tool</span> <span class="selector-tag">span</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#34495e</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.waifu</span> <span class="selector-id">#live2d</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> shake &#123;</span><br><span class="line">    <span class="number">2%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, -<span class="number">1.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">4%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">6%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">1.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">8%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">10%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">12%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">1.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">14%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, <span class="number">0.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">16%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, -<span class="number">0.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">18%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, <span class="number">0.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">20%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">22%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, -<span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">24%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">26%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">1.5px</span>, <span class="number">0.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">28%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">0.5px</span>, -<span class="number">0.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">30%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">1.5px</span>, -<span class="number">0.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">32%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, -<span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">34%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">36%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, -<span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">38%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, -<span class="number">0.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">40%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">0.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">42%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">44%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">46%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">1.5px</span>, -<span class="number">0.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">48%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, -<span class="number">0.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">52%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">0.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">54%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">56%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">58%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">60%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, -<span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">62%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">0.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">64%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">66%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">68%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, -<span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">70%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">72%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">0.5px</span>, -<span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">74%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">76%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">78%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">2.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">80%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">0.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">82%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">0.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">84%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">0.5px</span>, <span class="number">0.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">86%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, <span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">88%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, <span class="number">0.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">90%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, -<span class="number">0.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">92%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, -<span class="number">1.5px</span>) <span class="built_in">rotate</span>(<span class="number">1.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">94%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0.5px</span>, <span class="number">0.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">96%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">2.5px</span>, -<span class="number">0.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">98%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">1.5px</span>, -<span class="number">1.5px</span>) <span class="built_in">rotate</span>(-<span class="number">0.5deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">0%</span>, <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0</span>, <span class="number">0</span>) <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@font-face</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&#x27;Flat-UI-Icons&#x27;</span>;</span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;flat-ui-icons-regular.eot&#x27;</span>);</span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;flat-ui-icons-regular.eot?#iefix&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;embedded-opentype&#x27;</span>), <span class="built_in">url</span>(<span class="string">&#x27;flat-ui-icons-regular.woff&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;woff&#x27;</span>), <span class="built_in">url</span>(<span class="string">&#x27;flat-ui-icons-regular.ttf&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;truetype&#x27;</span>), <span class="built_in">url</span>(<span class="string">&#x27;flat-ui-icons-regular.svg#flat-ui-icons-regular&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;svg&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[class^=<span class="string">&quot;fui-&quot;</span>]</span>,</span><br><span class="line"><span class="selector-attr">[class*=<span class="string">&quot;fui-&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&#x27;Flat-UI-Icons&#x27;</span>;</span><br><span class="line">  <span class="attribute">speak</span>: none;</span><br><span class="line">  <span class="attribute">font-style</span>: normal;</span><br><span class="line">  <span class="attribute">font-weight</span>: normal;</span><br><span class="line">  <span class="attribute">font-variant</span>: normal;</span><br><span class="line">  <span class="attribute">text-transform</span>: none;</span><br><span class="line">  -webkit-<span class="attribute">font-smoothing</span>: antialiased;</span><br><span class="line">  -moz-osx-<span class="attribute">font-smoothing</span>: grayscale;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fui-cross</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\e609&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fui-info-circle</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\e60f&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fui-photo</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\e62a&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fui-eye</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\e62c&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fui-chat</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\e62d&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fui-home</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\e62e&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fui-user</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;\e631&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ°<a href="https://github.com/fghrsh/live2d_demo">è¿™é‡Œ</a>ä¸‹è½½ä»¥<code>flat-ui-icons</code>å¼€å¤´çš„$4$ä¸ªå›¾æ ‡æ–‡ä»¶ï¼Œæ”¾åœ¨<code>themes/next/live2d-widget/</code>æ–‡ä»¶å¤¹ä¸­ã€‚</p>
<p>è‡³æ­¤å·¥ä½œå…¨éƒ¨å®Œæˆï¼Œæ¸…ç†ç›®å½•å¹¶é‡æ–°ç”Ÿæˆ<code>html</code>æ–‡ä»¶ï¼Œæ‰“å¼€<code>localhost</code>ï¼Œä½ ä¼šå‘ç°è§’è‰²å¯ä»¥æ­£å¸¸æ¢è£…äº†ã€‚</p>
<p>æˆ‘ä¸€ç›´å¼€ç€ä¸€è¨€ç›´åˆ°æŸå¤©è¹¦å‡ºäº†ä¸€å¥â€œè¿™ç“œå¤šå°‘é’±ä¸€æ–¤â€ï¼ˆï¼Ÿï¼Ÿï¼Ÿ</p>
]]></content>
      <tags>
        <tag>blog</tag>
      </tags>
  </entry>
  <entry>
    <title>CF553E Kyoya and Train</title>
    <url>/2022/01/09/sol-cf553e/</url>
    <content><![CDATA[<h2 id="CF553E-Kyoya-and-Train"><a href="#CF553E-Kyoya-and-Train" class="headerlink" title="CF553E Kyoya and Train"></a>CF553E Kyoya and Train</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF553E">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>è€ƒè™‘dpã€‚$dp_{u,i}$è¡¨ç¤ºç‚¹$u$å¤„å·²èŠ±è´¹æ—¶é—´$i$çš„æœ€å°ä»£ä»·ã€‚</p>
<script type="math/tex; mode=display">
dp_{u,i} = 
\begin{cases}
0 & (u = n, i \lt t) \\
x & (u = n, i \ge t) \\
\min\limits_{e:u \to v,w}{w+\sum\limits_{k=1}^{t}{p_{e,k} dp_{v,i+k}}} & (u \neq n, i \lt t) \\
dist(u, n) & (u \neq n, i \ge t) \\
\end{cases}</script><p>æš´åŠ›è§£dpï¼Œå¤æ‚åº¦$O(mt^2)$ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦çš„ç“¶é¢ˆåœ¨äºç¬¬ä¸‰è¡Œçš„æ±‚å’Œï¼Œè€ƒè™‘ä¼˜åŒ–å®ƒã€‚</p>
<p>è®¾$g<em>{e,i} = w_e + \sum\limits</em>{k=1}^{t}{p<em>{e,k} dp</em>{v<em>e,i+k}}$ï¼Œå†è®¾$f</em>{e,i+t} = g_{e,i}$ï¼Œå°±æœ‰äº†</p>
<script type="math/tex; mode=display">
f_{e,i+t} = w_e + \sum_{k=1}^{t}{p_{e,k} dp_{v_e,i+k}}</script><p>è®¾$pâ€™<em>k=p</em>{t-k}$ï¼ˆç¿»è½¬ï¼‰ï¼Œè¿™ä¸ªæ±‚å’Œå°±å˜æˆäº†å·ç§¯ï¼š</p>
<script type="math/tex; mode=display">
f_{e,i+t} = w_e + \sum_{k=1}^{t}{p'_{e,t-k} dp_{v_e,i+k}}</script><p>é€šè¿‡åˆ†æ²»FFTè½¬ç§»ï¼Œå¤æ‚åº¦é™åˆ°$O(mt \log^2 t)$ï¼Œå¯ä»¥æ¥å—ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF553E.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF553E</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">55</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">120</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">1</span> &lt;&lt; <span class="number">17</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> EPS = <span class="number">1e-6</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line"><span class="keyword">using</span> comp = complex&lt;<span class="type">double</span>&gt;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> rev[MAXK] = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fft</span><span class="params">(comp* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">change</span>(f, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="function">comp <span class="title">wn</span><span class="params">(cos(<span class="number">2</span> * PI / h), sin(<span class="number">2</span> * PI / h))</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">            <span class="function">comp <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                comp u = f[k], t = w * f[k + h / <span class="number">2</span>];</span><br><span class="line">                f[k] = u + t, f[k + h / <span class="number">2</span>] = u - t;</span><br><span class="line">                w *= wn;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            f[i] /= len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace maths</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">    <span class="type">double</span> p[MAXK];</span><br><span class="line">    <span class="built_in">Edge</span>() &#123;&#125;</span><br><span class="line">    <span class="built_in">Edge</span>(<span class="type">int</span> _u, <span class="type">int</span> _v, <span class="type">int</span> _w) : <span class="built_in">u</span>(_u), <span class="built_in">v</span>(_v), <span class="built_in">w</span>(_w) &#123;&#125;</span><br><span class="line">&#125; edge[MAXM];</span><br><span class="line"><span class="type">int</span> n, m, t, x;</span><br><span class="line"><span class="type">int</span> dis[MAXN][MAXN];</span><br><span class="line"><span class="type">double</span> f[MAXM][MAXK], dp[MAXN][MAXK];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> comp tf[MAXK], tg[MAXK];</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> lx = r - mid, rx = r - l, len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt;= lx + rx)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> e = <span class="number">1</span>; e &lt;= m; ++e) &#123;</span><br><span class="line">        Edge&amp; ed = edge[e];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            tf[i] = tg[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lx; ++i)</span><br><span class="line">            tf[i] = dp[ed.v][i + mid + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; rx; ++i)</span><br><span class="line">            tg[i] = ed.p[rx - i];</span><br><span class="line">        <span class="built_in">fft</span>(tf, len, <span class="number">1</span>), <span class="built_in">fft</span>(tg, len, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            tf[i] *= tg[i];</span><br><span class="line">        <span class="built_in">fft</span>(tf, len, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = l; i &lt;= mid; ++i)</span><br><span class="line">            f[e][i] += tf[i + rx - mid - <span class="number">1</span>].<span class="built_in">real</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> comp tf[MAXK], tg[MAXK];</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            dp[edge[i].u][l] = <span class="built_in">min</span>(dp[edge[i].u][l], f[i][l] + edge[i].w);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">solve</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">calc</span>(l, r);</span><br><span class="line">    <span class="built_in">solve</span>(l, mid);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(t), <span class="built_in">read</span>(x);</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        dis[i][i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        Edge&amp; ed = edge[i];</span><br><span class="line">        <span class="built_in">read</span>(ed.u), <span class="built_in">read</span>(ed.v), <span class="built_in">read</span>(ed.w);</span><br><span class="line">        dis[ed.u][ed.v] = <span class="built_in">min</span>(dis[ed.u][ed.v], ed.w);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= t; ++j)</span><br><span class="line">            <span class="built_in">read</span>(ed.p[j]) /= <span class="number">1e5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; ++k)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">                <span class="keyword">if</span> (dis[i][j] &gt; dis[i][k] + dis[k][j])</span><br><span class="line">                    dis[i][j] = dis[i][k] + dis[k][j];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= t; ++j)</span><br><span class="line">            dp[i][j] = INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = t + <span class="number">1</span>; j &lt;= t + t; ++j)</span><br><span class="line">            dp[i][j] = dis[i][n] + x;</span><br><span class="line">    <span class="built_in">calc</span>(<span class="number">0</span>, t + t);</span><br><span class="line">    <span class="built_in">solve</span>(<span class="number">0</span>, t);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.10lf\n&quot;</span>, dp[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF773F Test Data Generation</title>
    <url>/2022/01/07/sol-cf773f/</url>
    <content><![CDATA[<h2 id="CF773F-Test-Data-Generation"><a href="#CF773F-Test-Data-Generation" class="headerlink" title="CF773F Test Data Generation"></a>CF773F Test Data Generation</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF773F">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>update: å‘ç°<a href="https://www.luogu.com.cn/discuss/396583">FFTä¸åŒå†™æ³•ä¼šè¾“å‡ºä¸åŒçš„ç­”æ¡ˆ</a></p>
<p>ç¬¬ä¸€ç§è§£æ³•å‡ºé”™ï¼Œæ˜¾ç„¶$n$è¦æ˜¯å¥‡æ•°ã€‚</p>
<p>ç¬¬äºŒç§è§£æ³•å‡ºé”™ï¼Œåˆ™$a_n$å’Œ$\frac{a_n}{g}$å¥‡å¶æ€§ä¸åŒï¼Œåªæœ‰$a_n$ä¸ºå¶æ•°ï¼Œ$\frac{a_n}{g}$ä¸ºå¥‡æ•°ã€‚è¿™æ—¶$a_n$ä¸­å› æ•°$2$çš„ä¸ªæ•°ä¸$g$ä¸­çš„ç›¸åŒã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æšä¸¾$g$ä¸­å› æ•°$2$çš„ä¸ªæ•°$k$ï¼Œå°†åºåˆ—$a$çš„æ‰€æœ‰æ•°é™¤ä»¥$2^k$ï¼Œç­”æ¡ˆå°±æ˜¯$1 \le a_i \le \frac{max_a}{2^k}$ä¸”$a_n$ä¸ºå¥‡æ•°çš„ä¸ªæ•°ã€‚</p>
<p>ä»¤$f_{a,n}$è¡¨ç¤ºæ‰€æœ‰æ•°$\in [1,a]$ï¼Œé•¿åº¦ä¸º$n$ï¼Œæœ€åä¸€ä½ä¸ºå¥‡æ•°çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>ä»¤$g_{a,n}$è¡¨ç¤ºæ‰€æœ‰æ•°$\in [1,a]$ï¼Œé•¿åº¦ä¸º$n$ï¼Œæœ€åä¸€ä½ä¸ºå¶æ•°çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>ç­”æ¡ˆæ˜¯</p>
<script type="math/tex; mode=display">\sum\limits_{i \equiv 1 \pmod{2}} f_{\lfloor\frac{max_a}{2^k}\rfloor,i}</script><p>ç”±äºè¦è®¡ç®—æ¯ä¸ª$f<em>{\lfloor\frac{max_a}{2^k}\rfloor}$ï¼Œå¦‚æœå¯ä»¥ä»$f</em>{\lfloor\frac{max_a}{2^{k+1}}\rfloor}$è½¬ç§»å°±å¯ä»¥ä¸ç”¨æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—ã€‚</p>
<p>æ‰€ä»¥åˆ†ä¸º$f<em>{a} \to f</em>{2a}$å’Œ$f<em>{a-1} \to f</em>{a}$ä¸¤ç§æƒ…å†µè½¬ç§»ã€‚</p>
<p>ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œå½“$a$ä¸ºå¥‡æ•°æ—¶ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{2a,k} &= \sum_{i+j=k}{(f_{a,i}+g_{a,i})g_{a,j}}-g_{a,k}g_{a,0}[k \neq 0] \\
g_{2a,k} &= \sum_{i+j=k}{(f_{a,i}+g_{a,i})f_{a,j}}-f_{a,k}f_{a,0}[k \neq 0] \\
\end{aligned}</script><p>ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œå½“$a$ä¸ºå¶æ•°æ—¶ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{2a,k} &= \sum_{i+j=k}{(f_{a,i}+g_{a,i})f_{a,j}}-g_{a,k}f_{a,0}[k \neq 0] \\
g_{2a,k} &= \sum_{i+j=k}{(f_{a,i}+g_{a,i})g_{a,j}}-f_{a,k}g_{a,0}[k \neq 0] \\
\end{aligned}</script><p>ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“è½¬ç§»ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
f_{a,k} &= f_{a-1,k} + (f_{a-1,k-1} + g_{a-1,k-1})[a \equiv 1 \pmod{2}] \\
g_{a,k} &= g_{a-1,k} + (f_{a-1,k-1} + g_{a-1,k-1})[a \equiv 0 \pmod{2}] \\
\end{aligned}</script><p>æ—¶é—´å¤æ‚åº¦$O(max_n \log max_n \log max_a)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF773F.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF773F</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">16</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line"><span class="type">int</span> mod;</span><br><span class="line"><span class="keyword">using</span> comp = complex&lt;<span class="type">long</span> <span class="type">double</span>&gt;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= mod ? x - mod : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fft</span><span class="params">(comp* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">change</span>(f, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="function">comp <span class="title">wn</span><span class="params">(cos(<span class="number">2</span> * PI / h), sin(<span class="number">2</span> * PI / h))</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">            <span class="function">comp <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                comp u = f[k], t = w * f[k + h / <span class="number">2</span>];</span><br><span class="line">                f[k] = u + t, f[k + h / <span class="number">2</span>] = u - t;</span><br><span class="line">                w *= wn;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            f[i] /= len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">polymul</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>* lhs, <span class="type">int</span>* rhs, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> comp f1[MAXN], f2[MAXN];</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt;= n + n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        f1[i] = f2[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        f1[i] = lhs[i], f2[i] = rhs[i];</span><br><span class="line">    <span class="built_in">fft</span>(f1, len, <span class="number">1</span>), <span class="built_in">fft</span>(f2, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        f1[i] *= f2[i];</span><br><span class="line">    <span class="built_in">fft</span>(f1, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        ans[i] = (<span class="type">int</span>)(f1[i].<span class="built_in">real</span>() + <span class="number">0.5</span>) % mod;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace maths</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="type">int</span> n, m, ans;</span><br><span class="line"><span class="type">int</span> f[MAXN], g[MAXN], tf[MAXN], tg[MAXN], sum[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">void</span>(f[<span class="number">0</span>] = <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> y = x &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">solve</span>(y);</span><br><span class="line">    <span class="keyword">if</span> (y &amp; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">            sum[i] = <span class="built_in">add</span>(f[i], g[i]);</span><br><span class="line">        f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">polymul</span>(n, sum, f, tg);</span><br><span class="line">        <span class="built_in">polymul</span>(n, sum, g, tf);</span><br><span class="line">        f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            f[i] = <span class="built_in">add</span>(f[i], tf[i]);</span><br><span class="line">            g[i] = <span class="built_in">add</span>(g[i], tg[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">            sum[i] = <span class="built_in">add</span>(f[i], g[i]);</span><br><span class="line">        f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">polymul</span>(n, sum, f, tf);</span><br><span class="line">        <span class="built_in">polymul</span>(n, sum, g, tg);</span><br><span class="line">        f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            f[i] = <span class="built_in">add</span>(f[i], tf[i]);</span><br><span class="line">            g[i] = <span class="built_in">add</span>(g[i], tg[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &amp; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i; --i)</span><br><span class="line">            f[i] = <span class="built_in">add</span>(f[i], <span class="built_in">add</span>(f[i - <span class="number">1</span>], g[i - <span class="number">1</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">2</span>)</span><br><span class="line">        ans = <span class="built_in">add</span>(ans, f[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(mod);</span><br><span class="line">    <span class="built_in">solve</span>(m &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF623E Transforming Sequence</title>
    <url>/2022/01/05/sol-cf623e/</url>
    <content><![CDATA[<h2 id="CF623E-Transforming-Sequence"><a href="#CF623E-Transforming-Sequence" class="headerlink" title="CF623E Transforming Sequence"></a>CF623E Transforming Sequence</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF623E">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>åºåˆ—$a$çš„å‰ç¼€æˆ–ä¸¥æ ¼å•è°ƒé€’å¢ï¼Œè€ƒè™‘åˆ°$b<em>n$äºŒè¿›åˆ¶è¡¨ç¤ºä¸­åŒ…å«$k$ä¸ª$1$çš„æƒ…å†µæœ¬è´¨ç›¸åŒè€Œé¡ºåºä¸é‡è¦ï¼Œæ‰€ä»¥è®¾$dp</em>{n,k}$è¡¨ç¤ºé•¿åº¦ä¸º$n$çš„åºåˆ—$a$ä¸­ï¼Œ$b_n$äºŒè¿›åˆ¶è¡¨ç¤ºä¸­åŒ…å«$k$ä¸ª$1$ã€‚åˆ™æœ‰</p>
<script type="math/tex; mode=display">
\begin{aligned}
dp_{n+m,k} &= \sum_{i+j=k}{dp_{n,i} \times dp_{m,j} \times \binom{k}{i} \times 2^{m \times i}} \\
&= \sum_{i+j=k}{dp_{n,i} \times dp_{m,j} \times \frac{k!}{i!j!} \times 2^{m \times i}} \\
&= k! \times \sum_{i+j=k}{(dp_{n,i} \times \frac{1}{i!} \times 2^{m \times i}) \times (dp_{m,j} \times \frac{1}{j!})} \\
\end{aligned}</script><p>ä»¤$n=m$ï¼Œå€å¢NTTæ±‚è§£ã€‚</p>
<p>éœ€è¦æ³¨æ„ï¼Œé‡Œé¢çš„$(dp_{n,i} \times i!)$å’Œç±»ä¼¼çš„ä¸æ˜¯å·ç§¯è€Œæ˜¯æŒ‰ä½å°†ç³»æ•°ç›¸ä¹˜ï¼Œåªæœ‰$i$å’Œ$j$ä¸åŒæ—¶æ‰æ˜¯å·ç§¯è¿ç®—ã€‚äºæ˜¯é˜¶ä¹˜å’Œé€†å…ƒä¸éœ€è¦å‚ä¸å·ç§¯è¿ç®—çš„ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿ï¼Œä»£ç ä¸­çš„<code>operator*()</code>æ˜¯æŒ‰ä½ä¹˜ç³»æ•°ï¼Œ<code>operator^()</code>æ˜¯å·ç§¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(k \log n \log k)$ã€‚</p>
<p>æ³¨æ„æ¨¡æ•°æ˜¯$10^9+7$è¦ç”¨<a href="/2021/12/05/sol-p4245/" title="ä»»æ„æ¨¡æ•°NTT">ä»»æ„æ¨¡æ•°NTT</a>ã€‚</p>
<p>PS: MTTå¸¦ä¸ª$5$çš„å¸¸æ•°ï¼Œè¿™é‡Œ$\log_2n=60$ï¼Œ$k=3\times 10^4$ï¼ŒFFTé•¿åº¦å–$2^{16}$ï¼Œå¯¼è‡´ç†è®ºä¸Šçš„è¿ç®—æ¬¡æ•°å·²ç»å¡æ»¡äº†$10^9$ï¼Œæœ¬åœ°å°æ ·ä¾‹éƒ½è¦è·‘$7$ç§’ï¼Œä½†è°å«CFè¯„æµ‹æœºå¿«å‘¢ï½</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF623E.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF623E</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">16</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">60</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> BLOC = <span class="number">1</span> &lt;&lt; <span class="number">15</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line">    <span class="keyword">using</span> comp = complex&lt;<span class="type">long</span> <span class="type">double</span>&gt;;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x += y;</span><br><span class="line">        <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x -= y;</span><br><span class="line">        <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + MOD : x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % p)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = ret * x % p;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">fft</span><span class="params">(comp* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="function">comp <span class="title">wn</span><span class="params">(cos(<span class="number">2</span> * PI / h), sin(<span class="number">2</span> * PI / h))</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="function">comp <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    comp u = f[k], t = w * f[k + h / <span class="number">2</span>];</span><br><span class="line">                    f[k] = u + t, f[k + h / <span class="number">2</span>] = u - t;</span><br><span class="line">                    w *= wn;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] /= len;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">poly</span> &#123;</span><br><span class="line">        <span class="type">const</span> <span class="type">static</span> <span class="type">int</span> len = <span class="number">1</span> &lt;&lt; <span class="number">16</span>;</span><br><span class="line">        <span class="type">int</span> a[MAXN];</span><br><span class="line">        <span class="type">int</span> <span class="keyword">operator</span>[](<span class="type">int</span> i) <span class="type">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span>&amp; <span class="keyword">operator</span>[](<span class="type">int</span> i) &#123;</span><br><span class="line">            <span class="keyword">return</span> a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        poly <span class="keyword">operator</span>*(<span class="type">const</span> poly&amp; rhs) <span class="type">const</span> &#123;</span><br><span class="line">            poly ret;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                ret[i] = a[i] * rhs[i] % MOD;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        poly <span class="keyword">operator</span>^(<span class="type">const</span> poly&amp; rhs) <span class="type">const</span> &#123;</span><br><span class="line">            <span class="type">static</span> comp f1[MAXN], f2[MAXN], f3[MAXN];</span><br><span class="line">            poly ret;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">                f1[i] = <span class="built_in">comp</span>(a[i] / BLOC, a[i] % BLOC);</span><br><span class="line">                f2[i] = <span class="built_in">comp</span>(a[i] / BLOC, -a[i] % BLOC);</span><br><span class="line">                f3[i] = <span class="built_in">comp</span>(rhs[i] / BLOC, rhs[i] % BLOC);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">fft</span>(f1, len, <span class="number">1</span>), <span class="built_in">fft</span>(f2, len, <span class="number">1</span>), <span class="built_in">fft</span>(f3, len, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">                f1[i] *= f3[i];</span><br><span class="line">                f2[i] *= f3[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">fft</span>(f1, len, <span class="number">-1</span>), <span class="built_in">fft</span>(f2, len, <span class="number">-1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">                <span class="type">int</span> axay = (<span class="type">int</span>)<span class="built_in">round</span>((f1[i].<span class="built_in">real</span>() + f2[i].<span class="built_in">real</span>()) / <span class="number">2</span>) % MOD;</span><br><span class="line">                <span class="type">int</span> bxby = (<span class="type">int</span>)<span class="built_in">round</span>((f2[i].<span class="built_in">real</span>() - f1[i].<span class="built_in">real</span>()) / <span class="number">2</span>) % MOD;</span><br><span class="line">                <span class="type">int</span> axby = (<span class="type">int</span>)<span class="built_in">round</span>((f1[i].<span class="built_in">imag</span>() + f2[i].<span class="built_in">imag</span>()) / <span class="number">2</span>) % MOD;</span><br><span class="line">                <span class="type">int</span> aybx = (<span class="type">int</span>)<span class="built_in">round</span>((f1[i].<span class="built_in">imag</span>() - f2[i].<span class="built_in">imag</span>()) / <span class="number">2</span>) % MOD;</span><br><span class="line">                ret[i] = (axay * BLOC % MOD * BLOC + (axby + aybx) * BLOC % MOD + bxby) % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line">poly fac, inv, lhs, rhs, ans;</span><br><span class="line">poly pw2[LOGN], dp[LOGN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">binom</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fac[x] * inv[y] % MOD * inv[x - y] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = fac[<span class="number">0</span>] = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">    inv[k] = <span class="built_in">qpow</span>(fac[k], MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = k - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = pw2[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">        pw2[<span class="number">0</span>][i] = pw2[<span class="number">0</span>][i - <span class="number">1</span>] * <span class="number">2</span> % MOD;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">        dp[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; LOGN; ++i) &#123;</span><br><span class="line">        pw2[i] = pw2[i - <span class="number">1</span>] * pw2[i - <span class="number">1</span>];</span><br><span class="line">        lhs = dp[i - <span class="number">1</span>] * inv * pw2[i - <span class="number">1</span>];</span><br><span class="line">        rhs = dp[i - <span class="number">1</span>] * inv;</span><br><span class="line">        dp[i] = (lhs ^ rhs) * fac;</span><br><span class="line">    &#125;</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; LOGN; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!((n &gt;&gt; i) &amp; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        lhs = ans * inv * pw2[i];</span><br><span class="line">        rhs = dp[i] * inv;</span><br><span class="line">        ans = (lhs ^ rhs) * fac;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= k; ++i)</span><br><span class="line">        tot = <span class="built_in">add</span>(tot, ans[i] * <span class="built_in">binom</span>(k, i) % MOD);</span><br><span class="line">    <span class="built_in">write</span>(tot), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF755G PolandBall and Many Other Balls</title>
    <url>/2022/01/03/sol-cf755g/</url>
    <content><![CDATA[<h2 id="CF755G-PolandBall-and-Many-Other-Balls"><a href="#CF755G-PolandBall-and-Many-Other-Balls" class="headerlink" title="CF755G PolandBall and Many Other Balls"></a>CF755G PolandBall and Many Other Balls</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF755G">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¦–å…ˆæƒ³åˆ°æœ´ç´ çš„dpã€‚ä»¤$dp_{n,k}$è¡¨ç¤º$n$ä¸ªæ•°å–$k$ä¸ªï¼Œåˆ™</p>
<script type="math/tex; mode=display">dp_{x+y,k} = \sum_{i+j=k}{dp_{x,i} \times dp_{y,j}} + \sum_{i+j=k-1}{dp_{x-1,i} \times dp_{y-1,j}}</script><p>å‘ç°å·¦å³ä¸¤ä¸ªæ±‚å’Œç¬¦å·éƒ½å®¹æ˜“å†™æˆå·ç§¯çš„å½¢å¼ï¼Œä¸å¦¨å¯¹äºæ¯ä¸ª$x+y$å–$x=y$ä»£å…¥è®¡ç®—ï¼Œè¿™æ ·ç”¨å€å¢NTTå°±å¯ä»¥ã€‚</p>
<p>ä½†æ˜¯æ±‚$dp<em>{x+y}$æ—¶è¿˜è¦çŸ¥é“$dp</em>{x-1}$å’Œ$dp<em>{y-1}$ï¼Œæ‰€ä»¥å†è®¾$F</em>{t,0 \le l \le 2}(x)$è¡¨ç¤ºåŸæ¥çš„$dp_{2^t-l,x}$çš„ç”Ÿæˆå‡½æ•°ï¼Œæœ‰ä»¥ä¸‹è½¬ç§»æ–¹ç¨‹</p>
<script type="math/tex; mode=display">
\begin{aligned}
F_{t,0}(x) &= F_{t-1,0}(x) \times F_{t-1,0}(x) + F_{t-1,1}(x) \times F_{t-1,1}(x) \\
F_{t,1}(x) &= F_{t-1,0}(x) \times F_{t-1,1}(x) + F_{t-1,1}(x) \times F_{t-1,2}(x) \\
F_{t,2}(x) &= F_{t-1,1}(x) \times F_{t-1,1}(x) + F_{t-1,2}(x) \times F_{t-1,2}(x)
\end{aligned}</script><p>æ—¶é—´å¤æ‚åº¦$O(k \log n \log k)$ï¼Œå¯é€šè¿‡ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF755G.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF755G</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">1</span> &lt;&lt; <span class="number">17</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">30</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x += y;</span><br><span class="line">        <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x -= y;</span><br><span class="line">        <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + MOD : x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % p)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = ret * x % p;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXK];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span>* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                    f[k] = <span class="built_in">add</span>(u, t), f[k + h / <span class="number">2</span>] = <span class="built_in">sub</span>(u, t);</span><br><span class="line">                    g = g * gn % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] = f[i] * inv % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">knap</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">        <span class="type">int</span> dp[MAXK];</span><br><span class="line">        <span class="built_in">node</span>() &#123; <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="built_in">sizeof</span>(dp)); &#125;</span><br><span class="line">        <span class="built_in">node</span>(<span class="type">const</span> node&amp; o) &#123; <span class="built_in">memcpy</span>(dp, o.dp, <span class="built_in">sizeof</span>(dp)); &#125;</span><br><span class="line">        node <span class="keyword">operator</span>+(<span class="type">const</span> node&amp; rhs) <span class="type">const</span> &#123;</span><br><span class="line">            node ret;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= k; ++i)</span><br><span class="line">                ret.dp[i] = <span class="built_in">add</span>(dp[i], rhs.dp[i]);</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        node <span class="keyword">operator</span>*(<span class="type">const</span> node&amp; rhs) <span class="type">const</span> &#123;</span><br><span class="line">            <span class="type">static</span> <span class="type">int</span> f1[MAXK], f2[MAXK];</span><br><span class="line">            node ret;</span><br><span class="line">            <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (len &lt; k + k + <span class="number">2</span>)</span><br><span class="line">                len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f1[i] = dp[i], f2[i] = rhs.dp[i];</span><br><span class="line">            <span class="built_in">ntt</span>(f1, len, <span class="number">1</span>), <span class="built_in">ntt</span>(f2, len, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f1[i] = f1[i] * f2[i] % MOD;</span><br><span class="line">            <span class="built_in">ntt</span>(f1, len, <span class="number">-1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= k; ++i)</span><br><span class="line">                ret.dp[i] = f1[i];</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        node <span class="keyword">operator</span>&lt;&lt;(<span class="type">int</span> rhs) <span class="type">const</span> &#123;</span><br><span class="line">            node ret;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = rhs; i &lt;= k; ++i)</span><br><span class="line">                ret.dp[i] = dp[i - rhs];</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; dp[<span class="number">3</span>];</span><br><span class="line">    knap <span class="keyword">operator</span>*(<span class="type">const</span> knap&amp; rhs) <span class="type">const</span> &#123;</span><br><span class="line">        knap ret;</span><br><span class="line">        ret.dp[<span class="number">0</span>] = dp[<span class="number">0</span>] * rhs.dp[<span class="number">0</span>] + ((dp[<span class="number">1</span>] * rhs.dp[<span class="number">1</span>]) &lt;&lt; <span class="number">1</span>);</span><br><span class="line">        ret.dp[<span class="number">1</span>] = dp[<span class="number">0</span>] * rhs.dp[<span class="number">1</span>] + ((dp[<span class="number">1</span>] * rhs.dp[<span class="number">2</span>]) &lt;&lt; <span class="number">1</span>);</span><br><span class="line">        ret.dp[<span class="number">2</span>] = dp[<span class="number">1</span>] * rhs.dp[<span class="number">1</span>] + ((dp[<span class="number">2</span>] * rhs.dp[<span class="number">2</span>]) &lt;&lt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">knap dp[LOGN], ans;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k);</span><br><span class="line">    ans.dp[<span class="number">0</span>].dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    dp[<span class="number">0</span>].dp[<span class="number">0</span>].dp[<span class="number">0</span>] = dp[<span class="number">0</span>].dp[<span class="number">0</span>].dp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    dp[<span class="number">0</span>].dp[<span class="number">1</span>].dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; LOGN; ++i)</span><br><span class="line">        dp[i] = dp[i - <span class="number">1</span>] * dp[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; LOGN; ++i)</span><br><span class="line">        <span class="keyword">if</span>  ((n &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            ans = ans * dp[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans.dp[<span class="number">0</span>].dp[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == k]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF1613F Tree Coloring</title>
    <url>/2022/01/03/sol-cf1613f/</url>
    <content><![CDATA[<h2 id="CF1613F-Tree-Coloring"><a href="#CF1613F-Tree-Coloring" class="headerlink" title="CF1613F Tree Coloring"></a>CF1613F Tree Coloring</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF1613F">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä¸æ˜“ç›´æ¥è®¡ç®—ç¬¦åˆæ¡ä»¶çš„æ–¹æ¡ˆæ•°ï¼Œæ‰€ä»¥åˆ©ç”¨å®¹æ–¥è®¡ç®—ä¸ç¬¦åˆæ¡ä»¶çš„æ–¹æ¡ˆæ•°ã€‚å‡è®¾æœ‰$i$ä¸ªç‚¹çš„$c<em>k=c</em>{fa<em>k}-1$ï¼Œæ•´æ£µæ ‘å°±è¢«åˆ†æˆäº†$n-i$æ¡é“¾ï¼Œæ¯æ¡é“¾åªè¦æœ‰ä¸€ä¸ªç‚¹ç¡®å®šäº†åˆ™å…¶ä»–ç‚¹éƒ½èƒ½ç¡®å®šï¼Œæ’åˆ—æ•°ä¸º$(n-i)!$ã€‚è®¾æœ‰$i$ä¸ªç‚¹çš„$c_k=c</em>{fa_k}-1$å…±æœ‰$f(i)$ç§æ–¹æ¡ˆï¼Œåˆ™</p>
<script type="math/tex; mode=display">ans=\sum_{i=0}^{n-1}{(-1)^i(n-i)!f(i)}</script><p>è€ƒè™‘å¦‚ä½•è®¡ç®—$f(i)$ã€‚å¯¹äºèŠ‚ç‚¹$u$ï¼Œè¦ä¹ˆä¸å’Œå­èŠ‚ç‚¹ç›¸å·®ä¸º$1$ï¼Œè¦ä¹ˆåªèƒ½å’Œå…¶ä¸­ä¸€ä¸ªå­èŠ‚ç‚¹ç›¸å·®ä¸º$1$ï¼Œæ‰€ä»¥å…¶ç”Ÿæˆå‡½æ•°ä¸º</p>
<script type="math/tex; mode=display">F_u(x) = deg_ux + 1</script><p>$f(i)$çš„ç”Ÿæˆå‡½æ•°æ˜¾ç„¶æ˜¯æ¯ä¸ª$u$çš„ç”Ÿæˆå‡½æ•°ä¹˜èµ·æ¥ï¼š</p>
<script type="math/tex; mode=display">F(x) = \prod_{u=1}^{n}{(deg_ux + 1)}</script><p>æ‰€ä»¥æ±‚å‡º$f(i)$å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">f(i) = [x^i]\prod_{u=1}^{n}{(deg_ux + 1)}</script><p>ä½¿ç”¨åˆ†æ²»NTTè®¡ç®—ï¼Œæ—¶é—´å¤æ‚åº¦$O(n \log^2 n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF1613F.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF1613F</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">19</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x += y;</span><br><span class="line">        <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x -= y;</span><br><span class="line">        <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + MOD : x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % p)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = ret * x % p;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span>* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                    f[k] = <span class="built_in">add</span>(u, t), f[k + h / <span class="number">2</span>] = <span class="built_in">sub</span>(u, t);</span><br><span class="line">                    g = g * gn % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] = f[i] * inv % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="type">int</span> n, fa[MAXN], deg[MAXN], fac[MAXN];</span><br><span class="line"><span class="type">int</span> f[MAXN], f1[MAXN], f2[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    fa[u] = f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u])</span><br><span class="line">        <span class="keyword">if</span> (v != f)</span><br><span class="line">            <span class="built_in">build</span>(v, u), ++deg[u];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (r - l == <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, len = r - l;</span><br><span class="line">    <span class="built_in">solve</span>(l, mid), <span class="built_in">solve</span>(mid, r);</span><br><span class="line">    <span class="built_in">copy</span>(f + l, f + mid, f1);</span><br><span class="line">    <span class="built_in">fill</span>(f1 + len / <span class="number">2</span>, f1 + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">copy</span>(f + mid, f + r, f2);</span><br><span class="line">    <span class="built_in">fill</span>(f2 + len / <span class="number">2</span>, f2 + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(f1, len, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(f2, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        f1[i] = f1[i] * f2[i] % MOD;</span><br><span class="line">    <span class="built_in">ntt</span>(f1, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">copy</span>(f1, f1 + len, f + l);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt;= n + n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i += <span class="number">2</span>)</span><br><span class="line">        f[i] = <span class="number">1</span>, f[i + <span class="number">1</span>] = deg[i &gt;&gt; <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">solve</span>(<span class="number">0</span>, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = fac[<span class="number">0</span>] = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            ans = <span class="built_in">sub</span>(ans, fac[n - i] * f[i] % MOD);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ans = <span class="built_in">add</span>(ans, fac[n - i] * f[i] % MOD);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF986D Perfect Encoding</title>
    <url>/2022/01/02/sol-cf986d/</url>
    <content><![CDATA[<h2 id="CF986D-Perfect-Encoding"><a href="#CF986D-Perfect-Encoding" class="headerlink" title="CF986D Perfect Encoding"></a>CF986D Perfect Encoding</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF986D">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä¸€é“æ€ç»´éš¾åº¦ä½ä½†ç é‡æå¤§ä¸”åŠå…¶å¡å¸¸çš„çƒ‚é¢˜ã€‚</p>
<p>é¦–å…ˆæ ¹æ®å°å­¦å¥¥æ•°å­¦è¿‡çš„ä¸œè¥¿ï¼Œå¯ä»¥çŸ¥é“åˆ†è§£å‡ºè®¸å¤š$3$ï¼Œå‰©ä¸‹æ— æ³•åˆ†è§£çš„å‡‘æˆ$1$åˆ°$2$ä¸ª$2$ï¼Œè¿™æ ·å¾—åˆ°çš„ç§¯ä¸€å®šæ˜¯æœ€å¤§çš„ã€‚</p>
<p>ç­”æ¡ˆæ˜æ˜¾æ˜¯å•è°ƒçš„ï¼Œå¯ä»¥è€ƒè™‘äºŒåˆ†+åˆ¤æ–­ã€‚$n$çš„èŒƒå›´å·¨å¤§ï¼Œéœ€è¦ç”¨é«˜ç²¾åº¦+FFT+å¿«é€Ÿå¹‚ï¼Œæ—¶é—´å¤æ‚åº¦ä¸€ä¸‹å­$O(n \log^3 n)$çº§åˆ«ï¼Œæ— æ³•é€šè¿‡ã€‚</p>
<p>è¿›ä¸€æ­¥æ€è€ƒï¼Œç­”æ¡ˆåº”è¯¥æ¥è¿‘$\log_3n$ï¼Œä¸å¦¨ä»$\lfloor \log_3n \rfloor$å¼€å§‹æšä¸¾ç­”æ¡ˆï¼Œåªéœ€è¦æšä¸¾å¤§çº¦$6$ä¸ªå°±å¯ä»¥æ‰¾åˆ°ç­”æ¡ˆï¼Œä¼˜åŒ–æˆ$O(n \log^2 n)$ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦æ— æ³•è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œäºæ˜¯è®¾æ³•å¼€å§‹å¡å¸¸ã€‚é¦–å…ˆè¿™ä¸ªé«˜ç²¾åº¦å¿…é¡»å¾—å‹ä½ï¼Œè€Œä¸”ä¸ºäº†é˜²æ­¢MLEåˆä¸èƒ½å¼€<code>long long</code>ï¼Œæ‰€ä»¥å‡è®¾å‹$x$ä½ï¼Œå°±è¦æ±‚FFTæ—¶$(10^x)^2 \times \frac{1.5 \times 10^6}{10^x} \le$ <code>INT_MAX</code>ï¼Œäºæ˜¯$x$æœ€å¤§å–åˆ°$3$ï¼Œå‹$3$ä½ã€‚</p>
<p>å…¶æ¬¡åœ¨è¿›è¡Œå¿«é€Ÿå¹‚æ—¶ï¼Œå˜é‡$x$éœ€è¦ä¸€ç›´ä¹˜ä¸Šè‡ªå·±ï¼Œå¯ä»¥çœç•¥ä¸€æ¬¡FFTã€‚ç”±äºå¿«é€Ÿå¹‚åˆšå¼€å§‹æ—¶æ•°å­—ä¸æ˜¯å¾ˆå¤§ï¼Œæˆ‘ä»¬é€‰æ‹©ç”¨<code>vector</code>å‚¨å­˜é«˜ç²¾åº¦è€Œä¸æ˜¯ä½¿ç”¨å®šé•¿æ•°ç»„ï¼Œè¿™æ ·åˆå¯ä»¥æé«˜ä¸€äº›å˜é‡æ‹·è´çš„æ•ˆç‡ã€‚è‡³æ­¤æˆ‘å°±æ²¡æœ‰å†æƒ³åˆ°èƒ½å¤Ÿè¿›ä¸€æ­¥ä¼˜åŒ–çš„æ–¹æ³•äº†ï¼Œä½†æ˜¯ä¹Ÿè¶³ä»¥åœ¨æ—¶é™å†…é€šè¿‡äº†ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF986D.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF986D</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// åŠ å¤§ç«è½¦</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXB = <span class="number">1000</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">3</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> LOG3_10 = <span class="built_in">log</span>(<span class="number">10</span>) / <span class="built_in">log</span>(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">namespace</span> bignum &#123;</span><br><span class="line">    <span class="keyword">using</span> comp = complex&lt;<span class="type">double</span>&gt;;</span><br><span class="line">    comp flhs[MAXN], frhs[MAXN];</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> tmp[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(comp *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">fft</span><span class="params">(comp *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="function">comp <span class="title">wn</span><span class="params">(cos(<span class="number">2</span> * PI / h), sin(<span class="number">2</span> * PI / h))</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="function">comp <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    comp u = f[k], t = w * f[k + h / <span class="number">2</span>];</span><br><span class="line">                    f[k] = u + t;</span><br><span class="line">                    f[k + h / <span class="number">2</span>] = u - t;</span><br><span class="line">                    w = w * wn;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] /= len;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt;&amp; <span class="title">polymul</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; lhs, <span class="type">int</span> rhs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lhs.<span class="built_in">size</span>(); ++i)</span><br><span class="line">            lhs[i] *= rhs;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lhs.<span class="built_in">size</span>() - <span class="number">1</span>; ++i)</span><br><span class="line">            lhs[i + <span class="number">1</span>] += lhs[i] / MAXB, lhs[i] %= MAXB;</span><br><span class="line">        <span class="type">int</span> len = lhs.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">while</span> (lhs[len - <span class="number">1</span>] &gt;= MAXB)</span><br><span class="line">            lhs.<span class="built_in">push_back</span>(lhs[len - <span class="number">1</span>] / MAXB), lhs[len - <span class="number">1</span>] %= MAXB, ++len;</span><br><span class="line">        <span class="keyword">return</span> lhs;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt;&amp; <span class="title">polymul</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; lhs)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (len &lt; lhs.<span class="built_in">size</span>() * <span class="number">2</span>)</span><br><span class="line">            len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lhs.<span class="built_in">size</span>(); ++i)</span><br><span class="line">            flhs[i] = lhs[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = lhs.<span class="built_in">size</span>(); i &lt; len; ++i)</span><br><span class="line">            flhs[i] = <span class="number">0</span>;</span><br><span class="line">        lhs.<span class="built_in">resize</span>(len);</span><br><span class="line">        <span class="built_in">fft</span>(flhs, len, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            flhs[i] = flhs[i] * flhs[i];</span><br><span class="line">        <span class="built_in">fft</span>(flhs, len, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            tmp[i] = (<span class="type">long</span> <span class="type">long</span>)(flhs[i].<span class="built_in">real</span>() + <span class="number">0.5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; ++i)</span><br><span class="line">            tmp[i + <span class="number">1</span>] += tmp[i] / MAXB, tmp[i] %= MAXB;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            lhs[i] = tmp[i];</span><br><span class="line">        <span class="keyword">while</span> (*lhs.<span class="built_in">rbegin</span>() == <span class="number">0</span>)</span><br><span class="line">            lhs.<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="keyword">return</span> lhs;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt;&amp; <span class="title">polymul</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; lhs, <span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; rhs)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (len &lt; lhs.<span class="built_in">size</span>() + rhs.<span class="built_in">size</span>())</span><br><span class="line">            len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; lhs.<span class="built_in">size</span>(); ++i)</span><br><span class="line">            flhs[i] = lhs[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = lhs.<span class="built_in">size</span>(); i &lt; len; ++i)</span><br><span class="line">            flhs[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; rhs.<span class="built_in">size</span>(); ++i)</span><br><span class="line">            frhs[i] = rhs[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rhs.<span class="built_in">size</span>(); i &lt; len; ++i)</span><br><span class="line">            frhs[i] = <span class="number">0</span>;</span><br><span class="line">        lhs.<span class="built_in">resize</span>(len);</span><br><span class="line">        <span class="built_in">fft</span>(flhs, len, <span class="number">1</span>), <span class="built_in">fft</span>(frhs, len, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            flhs[i] = flhs[i] * frhs[i];</span><br><span class="line">        <span class="built_in">fft</span>(flhs, len, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            tmp[i] = (<span class="type">long</span> <span class="type">long</span>)(flhs[i].<span class="built_in">real</span>() + <span class="number">0.5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; ++i)</span><br><span class="line">            tmp[i + <span class="number">1</span>] += tmp[i] / MAXB, tmp[i] %= MAXB;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            lhs[i] = tmp[i];</span><br><span class="line">        <span class="keyword">while</span> (*lhs.<span class="built_in">rbegin</span>() == <span class="number">0</span>)</span><br><span class="line">            lhs.<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="keyword">return</span> lhs;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">is_less</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; lhs, <span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; rhs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (lhs.<span class="built_in">size</span>() != rhs.<span class="built_in">size</span>())</span><br><span class="line">            <span class="keyword">return</span> lhs.<span class="built_in">size</span>() &lt; rhs.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = lhs.<span class="built_in">size</span>() - <span class="number">1</span>; ~i; --i)</span><br><span class="line">            <span class="keyword">if</span> (lhs[i] != rhs[i])</span><br><span class="line">                <span class="keyword">return</span> lhs[i] &lt; rhs[i];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">qpow</span><span class="params">(vector&lt;<span class="type">int</span>&gt; x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; ret&#123;<span class="number">1</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, <span class="built_in">polymul</span>(x, x))</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                <span class="built_in">polymul</span>(ret, x);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> bignum;</span><br><span class="line"><span class="type">int</span> n, cur, num;</span><br><span class="line"><span class="type">char</span> buf[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; inp, now, now2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; vec)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, vec[vec.<span class="built_in">size</span>() - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vec.<span class="built_in">size</span>() - <span class="number">2</span>; ~i; --i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02d&quot;</span>, vec[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">6</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">is_less</span>(inp, vector&lt;<span class="type">int</span>&gt;&#123;n&#125;);</span><br><span class="line">    <span class="type">int</span> tx, ty;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">3</span> == <span class="number">0</span>)</span><br><span class="line">        tx = n / <span class="number">3</span> - <span class="number">1</span>, ty = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">3</span> == <span class="number">1</span>)</span><br><span class="line">        tx = n / <span class="number">3</span> - <span class="number">1</span>, ty = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">3</span> == <span class="number">2</span>)</span><br><span class="line">        tx = n / <span class="number">3</span> - <span class="number">1</span>, ty = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur &lt; tx)</span><br><span class="line">        <span class="built_in">polymul</span>(now, <span class="number">3</span>), ++cur;</span><br><span class="line">    <span class="built_in">polymul</span>(now2 = now, ty);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">is_less</span>(inp, now2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">    n = <span class="built_in">strlen</span>(buf);</span><br><span class="line">    num = <span class="built_in">floor</span>(<span class="number">3</span> * LOG3_10 * (n - <span class="number">1</span>));</span><br><span class="line">    cur = <span class="built_in">max</span>((<span class="type">int</span>)<span class="number">0</span>, num / <span class="number">3</span> - <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">reverse</span>(buf, buf + n);</span><br><span class="line">    <span class="keyword">while</span> (n % MAXK)</span><br><span class="line">        buf[n++] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i += MAXK) &#123;</span><br><span class="line">        inp.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>, x = <span class="number">1</span>; j &lt; MAXK; ++j, x *= <span class="number">10</span>)</span><br><span class="line">            *inp.<span class="built_in">rbegin</span>() += x * (buf[i + j] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    now = <span class="built_in">qpow</span>(vector&lt;<span class="type">int</span>&gt;&#123;<span class="number">3</span>&#125;, cur);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = num; ; ++i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(i))</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">write</span>(i), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4009 æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜</title>
    <url>/2021/12/31/sol-p4009/</url>
    <content><![CDATA[<h2 id="P4009-æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜"><a href="#P4009-æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜" class="headerlink" title="P4009 æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜"></a>P4009 æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p><a href="https://www.luogu.com.cn/problem/P4009">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>åˆ†å±‚å›¾è·‘dijkstraã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4009.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4009</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">150</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">15</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXV = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXE = <span class="number">4e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> DX[<span class="number">4</span>] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> DY[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">    <span class="type">int</span> v, cost;</span><br><span class="line">&#125; edge[MAXE];</span><br><span class="line"><span class="type">int</span> n, k, a, b, c, mp[MAXN][MAXN];</span><br><span class="line"><span class="type">int</span> s, t, num, pt[MAXN][MAXN][MAXK];</span><br><span class="line"><span class="type">int</span> tot, head[MAXV], nxt[MAXE], dis[MAXV];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">    edge[++tot] = &#123;v, cost&#125;;</span><br><span class="line">    nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dijkstra</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">    priority_queue&lt;pii, vector&lt;pii&gt;, greater&lt;pii&gt;&gt; que;</span><br><span class="line">    <span class="built_in">fill</span>(dis, dis + MAXV, INF);</span><br><span class="line">    dis[s] = <span class="number">0</span>, que.<span class="built_in">push</span>(&#123;dis[s], s&#125;);</span><br><span class="line">    <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> u = que.<span class="built_in">top</span>().second, d = que.<span class="built_in">top</span>().first;</span><br><span class="line">        que.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (d &gt; dis[u])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (dis[v] &gt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                que.<span class="built_in">push</span>(&#123;dis[v], v&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[t];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k), <span class="built_in">read</span>(a), <span class="built_in">read</span>(b), <span class="built_in">read</span>(c);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="built_in">read</span>(mp[i][j]);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt;= k; ++l)</span><br><span class="line">                pt[i][j][l] = ++num;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    s = pt[<span class="number">1</span>][<span class="number">1</span>][k], t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= k; ++i)</span><br><span class="line">        <span class="built_in">addedge</span>(pt[n][n][i], t, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mp[i][j]) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt;= k; ++l)</span><br><span class="line">                    <span class="built_in">addedge</span>(pt[i][j][l], pt[i][j][k], a);</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> d = <span class="number">0</span>; d &lt; <span class="number">4</span>; ++d) &#123;</span><br><span class="line">                    <span class="type">int</span> x = i + DX[d], y = j + DY[d];</span><br><span class="line">                    <span class="keyword">if</span> (x &lt; <span class="number">1</span> || y &lt; <span class="number">1</span> || x &gt; n || y &gt; n)</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="built_in">addedge</span>(pt[i][j][k], pt[x][y][k - <span class="number">1</span>], d &gt; <span class="number">1</span> ? <span class="number">0</span> : b);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> d = <span class="number">0</span>; d &lt; <span class="number">4</span>; ++d) &#123;</span><br><span class="line">                    <span class="type">int</span> x = i + DX[d], y = j + DY[d];</span><br><span class="line">                    <span class="keyword">if</span> (x &lt; <span class="number">1</span> || y &lt; <span class="number">1</span> || x &gt; n || y &gt; n)</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>; l &lt;= k; ++l)</span><br><span class="line">                        <span class="built_in">addedge</span>(pt[i][j][l], pt[x][y][l - <span class="number">1</span>], d &gt; <span class="number">1</span> ? <span class="number">0</span> : b);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">addedge</span>(pt[i][j][<span class="number">0</span>], pt[i][j][k], a + c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(<span class="built_in">dijkstra</span>(s, t)), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4015 è¿è¾“é—®é¢˜</title>
    <url>/2021/12/30/sol-p4015/</url>
    <content><![CDATA[<h2 id="P4015-è¿è¾“é—®é¢˜"><a href="#P4015-è¿è¾“é—®é¢˜" class="headerlink" title="P4015 è¿è¾“é—®é¢˜"></a>P4015 è¿è¾“é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4015">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ€ä¹ˆä¼šæœ‰è¿™ä¹ˆsbçš„é¢˜ç›®å•Šã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4015.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4015</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MINCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &gt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MAXCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, -INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &lt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXV = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXE = <span class="number">2e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m, s, t, num, a[MAXN], b[MAXN], c[MAXN][MAXN], pt[MAXN][<span class="number">2</span>];</span><br><span class="line">MINCMF&lt;MAXV, MAXE&gt; minnt;</span><br><span class="line">MAXCMF&lt;MAXV, MAXE&gt; maxnt;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]), pt[i][<span class="number">0</span>] = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">read</span>(b[i]), pt[i][<span class="number">1</span>] = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            <span class="built_in">read</span>(c[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        minnt.<span class="built_in">addedge</span>(s, pt[i][<span class="number">0</span>], a[i], <span class="number">0</span>);</span><br><span class="line">        maxnt.<span class="built_in">addedge</span>(s, pt[i][<span class="number">0</span>], a[i], <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        minnt.<span class="built_in">addedge</span>(pt[i][<span class="number">1</span>], t, b[i], <span class="number">0</span>);</span><br><span class="line">        maxnt.<span class="built_in">addedge</span>(pt[i][<span class="number">1</span>], t, b[i], <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            minnt.<span class="built_in">addedge</span>(pt[i][<span class="number">0</span>], pt[j][<span class="number">1</span>], INF, c[i][j]);</span><br><span class="line">            maxnt.<span class="built_in">addedge</span>(pt[i][<span class="number">0</span>], pt[j][<span class="number">1</span>], INF, c[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(minnt.<span class="built_in">mcmf</span>(s, t).second), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="built_in">write</span>(maxnt.<span class="built_in">mcmf</span>(s, t).second), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4014 åˆ†é…é—®é¢˜</title>
    <url>/2021/12/30/sol-p4014/</url>
    <content><![CDATA[<h2 id="P4014-åˆ†é…é—®é¢˜"><a href="#P4014-åˆ†é…é—®é¢˜" class="headerlink" title="P4014 åˆ†é…é—®é¢˜"></a>P4014 åˆ†é…é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4014">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä¸å°±æ˜¯ä¸ªäºŒåˆ†å›¾æœ€å°/æœ€å¤§æƒåŒ¹é…å—ï¼Œå°±è¿™ä¹Ÿèƒ½ç´«é¢˜ï¼Ÿ</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4014.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4014</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MINCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &gt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MAXCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, -INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &lt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXV = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXE = <span class="number">2e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, s, t, num, a[MAXN][MAXN], pt[MAXN][<span class="number">2</span>];</span><br><span class="line">MINCMF&lt;MAXV, MAXE&gt; minnt;</span><br><span class="line">MAXCMF&lt;MAXV, MAXE&gt; maxnt;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        pt[i][<span class="number">0</span>] = ++num, pt[i][<span class="number">1</span>] = ++num;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="built_in">read</span>(a[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        minnt.<span class="built_in">addedge</span>(s, pt[i][<span class="number">0</span>], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        maxnt.<span class="built_in">addedge</span>(s, pt[i][<span class="number">0</span>], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        minnt.<span class="built_in">addedge</span>(pt[i][<span class="number">1</span>], t, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        maxnt.<span class="built_in">addedge</span>(pt[i][<span class="number">1</span>], t, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            minnt.<span class="built_in">addedge</span>(pt[i][<span class="number">0</span>], pt[j][<span class="number">1</span>], <span class="number">1</span>, a[i][j]);</span><br><span class="line">            maxnt.<span class="built_in">addedge</span>(pt[i][<span class="number">0</span>], pt[j][<span class="number">1</span>], <span class="number">1</span>, a[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(minnt.<span class="built_in">mcmf</span>(s, t).second), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="built_in">write</span>(maxnt.<span class="built_in">mcmf</span>(s, t).second), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4013 æ•°å­—æ¢¯å½¢é—®é¢˜</title>
    <url>/2021/12/30/sol-p4013/</url>
    <content><![CDATA[<h2 id="P4013-æ•°å­—æ¢¯å½¢é—®é¢˜"><a href="#P4013-æ•°å­—æ¢¯å½¢é—®é¢˜" class="headerlink" title="P4013 æ•°å­—æ¢¯å½¢é—®é¢˜"></a>P4013 æ•°å­—æ¢¯å½¢é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4013">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä¸‰æ¬¡è¯¢é—®åˆ†åˆ«æ‹†ç‚¹æ„å»ºç½‘ç»œæµå³å¯ã€‚</p>
<p>è´¹ç”¨æµä¸èƒ½åœ¨æ®‹ä½™ç½‘ç»œä¸ŠåŠ è¾¹é‡æ–°è·‘ï¼Œå¦åˆ™æ— æ³•ä¿è¯æœ€å¤§/æœ€å°è´¹ç”¨ã€‚</p>
<p>æ•°ç»„åº”å½“å¼€$20 \times 40$è€Œä¸æ˜¯$20 \times 20$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4013.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4013</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, -INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &lt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">45</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXV = <span class="number">4e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXE = <span class="number">4e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> m, n, s, t, num, a[MAXN][MAXN], pt[MAXN][MAXN][<span class="number">2</span>];</span><br><span class="line">MCMF&lt;MAXV, MAXE&gt; nt[<span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(m), <span class="built_in">read</span>(n);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; m + i; ++j) &#123;</span><br><span class="line">            <span class="built_in">read</span>(a[i][j]);</span><br><span class="line">            pt[i][j][<span class="number">0</span>] = ++num;</span><br><span class="line">            pt[i][j][<span class="number">1</span>] = ++num;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">0</span>; w &lt; <span class="number">3</span>; ++w) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            nt[w].<span class="built_in">addedge</span>(s, pt[<span class="number">1</span>][i][<span class="number">0</span>], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; m + n; ++i)</span><br><span class="line">            nt[w].<span class="built_in">addedge</span>(pt[n][i][<span class="number">1</span>], t, INF, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; m + i; ++j)</span><br><span class="line">                nt[w].<span class="built_in">addedge</span>(pt[i][j][<span class="number">0</span>], pt[i][j][<span class="number">1</span>], <span class="number">1</span>, a[i][j]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; m + i; ++j) &#123;</span><br><span class="line">                nt[w].<span class="built_in">addedge</span>(pt[i][j][<span class="number">1</span>], pt[i + <span class="number">1</span>][j][<span class="number">0</span>], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">                nt[w].<span class="built_in">addedge</span>(pt[i][j][<span class="number">1</span>], pt[i + <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">0</span>], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>; w &lt; <span class="number">3</span>; ++w) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; m + i; ++j)</span><br><span class="line">                nt[w].<span class="built_in">addedge</span>(pt[i][j][<span class="number">0</span>], pt[i][j][<span class="number">1</span>], INF, a[i][j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">2</span>; w &lt; <span class="number">3</span>; ++w) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; m + i; ++j) &#123;</span><br><span class="line">                nt[w].<span class="built_in">addedge</span>(pt[i][j][<span class="number">1</span>], pt[i + <span class="number">1</span>][j][<span class="number">0</span>], INF, <span class="number">0</span>);</span><br><span class="line">                nt[w].<span class="built_in">addedge</span>(pt[i][j][<span class="number">1</span>], pt[i + <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">0</span>], INF, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">0</span>; w &lt; <span class="number">3</span>; ++w)</span><br><span class="line">        <span class="built_in">write</span>(nt[w].<span class="built_in">mcmf</span>(s, t).second), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4012 æ·±æµ·æœºå™¨äººé—®é¢˜</title>
    <url>/2021/12/30/sol-p4012/</url>
    <content><![CDATA[<h2 id="P4012-æ·±æµ·æœºå™¨äººé—®é¢˜"><a href="#P4012-æ·±æµ·æœºå™¨äººé—®é¢˜" class="headerlink" title="P4012 æ·±æµ·æœºå™¨äººé—®é¢˜"></a>P4012 æ·±æµ·æœºå™¨äººé—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4012">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å›¾è›®å¥½å»ºçš„ï¼Œè·‘MCMFã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4012.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4012</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, -INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &lt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">50</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXV = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXE = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> a, b, p, q, s, t, num, pt[MAXN][MAXN];</span><br><span class="line">MCMF&lt;MAXV, MAXE&gt; network;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(a), <span class="built_in">read</span>(b);</span><br><span class="line">    <span class="built_in">read</span>(p), <span class="built_in">read</span>(q);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= p; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= q; ++j)</span><br><span class="line">            pt[i][j] = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= p; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; q; ++j) &#123;</span><br><span class="line">            <span class="type">int</span> cost;</span><br><span class="line">            <span class="built_in">read</span>(cost);</span><br><span class="line">            network.<span class="built_in">addedge</span>(pt[i][j], pt[i][j + <span class="number">1</span>], <span class="number">1</span>, cost);</span><br><span class="line">            network.<span class="built_in">addedge</span>(pt[i][j], pt[i][j + <span class="number">1</span>], INF, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= q; ++j) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; p; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> cost;</span><br><span class="line">            <span class="built_in">read</span>(cost);</span><br><span class="line">            network.<span class="built_in">addedge</span>(pt[i][j], pt[i + <span class="number">1</span>][j], <span class="number">1</span>, cost);</span><br><span class="line">            network.<span class="built_in">addedge</span>(pt[i][j], pt[i + <span class="number">1</span>][j], INF, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= a; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> k, x, y;</span><br><span class="line">        <span class="built_in">read</span>(k), <span class="built_in">read</span>(x), <span class="built_in">read</span>(y);</span><br><span class="line">        network.<span class="built_in">addedge</span>(s, pt[x][y], k, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= b; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> k, x, y;</span><br><span class="line">        <span class="built_in">read</span>(k), <span class="built_in">read</span>(x), <span class="built_in">read</span>(y);</span><br><span class="line">        network.<span class="built_in">addedge</span>(pt[x][y], t, k, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(network.<span class="built_in">mcmf</span>(s, t).second), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3357 æœ€é•¿kå¯é‡çº¿æ®µé›†é—®é¢˜</title>
    <url>/2021/12/27/sol-p3357/</url>
    <content><![CDATA[<h2 id="P3357-æœ€é•¿kå¯é‡çº¿æ®µé›†é—®é¢˜"><a href="#P3357-æœ€é•¿kå¯é‡çº¿æ®µé›†é—®é¢˜" class="headerlink" title="P3357 æœ€é•¿kå¯é‡çº¿æ®µé›†é—®é¢˜"></a>P3357 æœ€é•¿kå¯é‡çº¿æ®µé›†é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3357">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>åœ¨<a href="/2021/12/27/sol-p3358/" title="P3358">P3358</a>çš„åŸºç¡€ä¸Šï¼Œå¤šå‡ºæ¥äº†çº¿æ®µä¸$x$è½´å‚ç›´çš„é—®é¢˜ï¼Œå¦‚æœå’Œåˆšåˆšä¸€æ ·è¿è¾¹å°±ä¼šå¯¼è‡´$i \to i$è‡ªç¯çš„é—®é¢˜ã€‚æ‰€ä»¥è¿›è¡Œæ‹†ç‚¹ï¼Œå¦‚æœ$l=r$åˆ™è¿æ¥$in(l)$å’Œ$out(r)$ï¼Œå¦åˆ™è¿æ¥$out(l)$å’Œ$in(r)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3357.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3357</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, -INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &lt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXV = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXE = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, k, m, s, t, num, a[MAXN], l[MAXN], r[MAXN], p[MAXN], pt[MAXN][<span class="number">2</span>];</span><br><span class="line">MCMF&lt;MAXV, MAXE&gt; network;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> sx, sy, tx, ty;</span><br><span class="line">        <span class="built_in">read</span>(sx), <span class="built_in">read</span>(sy);</span><br><span class="line">        <span class="built_in">read</span>(tx), <span class="built_in">read</span>(ty);</span><br><span class="line">        <span class="keyword">if</span> (sx &gt; tx)</span><br><span class="line">            <span class="built_in">swap</span>(sx, tx);</span><br><span class="line">        l[i] = sx, r[i] = tx;</span><br><span class="line">        p[++m] = l[i], p[++m] = r[i];</span><br><span class="line">        a[i] = <span class="built_in">sqrt</span>((sx - tx) * (sx - tx) + (sy - ty) * (sy - ty));</span><br><span class="line">    &#125;</span><br><span class="line">    p[++m] = -INF, p[++m] = INF;</span><br><span class="line">    <span class="built_in">sort</span>(p + <span class="number">1</span>, p + m + <span class="number">1</span>);</span><br><span class="line">    m = <span class="built_in">unique</span>(p + <span class="number">1</span>, p + m + <span class="number">1</span>) - p - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        pt[i][<span class="number">0</span>] = ++num, pt[i][<span class="number">1</span>] = ++num;</span><br><span class="line">    s = pt[<span class="number">1</span>][<span class="number">0</span>], t = pt[m][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        l[i] = <span class="built_in">lower_bound</span>(p + <span class="number">1</span>, p + m + <span class="number">1</span>, l[i]) - p;</span><br><span class="line">        r[i] = <span class="built_in">lower_bound</span>(p + <span class="number">1</span>, p + m + <span class="number">1</span>, r[i]) - p;</span><br><span class="line">        <span class="keyword">if</span> (l[i] == r[i])</span><br><span class="line">            network.<span class="built_in">addedge</span>(pt[l[i]][<span class="number">0</span>], pt[r[i]][<span class="number">1</span>], <span class="number">1</span>, a[i]);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            network.<span class="built_in">addedge</span>(pt[l[i]][<span class="number">1</span>], pt[r[i]][<span class="number">0</span>], <span class="number">1</span>, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        network.<span class="built_in">addedge</span>(pt[i][<span class="number">0</span>], pt[i][<span class="number">1</span>], k, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; m; ++i)</span><br><span class="line">        network.<span class="built_in">addedge</span>(pt[i][<span class="number">1</span>], pt[i + <span class="number">1</span>][<span class="number">0</span>], k, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">write</span>(network.<span class="built_in">mcmf</span>(s, t).second), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3358 æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜</title>
    <url>/2021/12/27/sol-p3358/</url>
    <content><![CDATA[<h2 id="P3358-æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜"><a href="#P3358-æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜" class="headerlink" title="P3358 æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜"></a>P3358 æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3358">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å…ˆç¦»æ•£åŒ–ï¼Œç„¶ååœ¨åæ ‡ä¸Šè¿æ¥$l_i \to r_i$ï¼ŒèŠ±è´¹ä¸º$r_i-l_i$ï¼Œå…¶ä»–è¾¹$i \to i+1$æµé‡ä¸º$k$ï¼Œæ˜¾ç„¶è¿™æ ·å¾—åˆ°çš„æœ€å¤§è´¹ç”¨æœ€å¤§æµå°±æ˜¯ç­”æ¡ˆã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3358.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3358</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, -INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &lt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, k, m, a[MAXN], l[MAXN], r[MAXN], p[MAXN];</span><br><span class="line">MCMF&lt;MAXN, MAXM&gt; network;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(l[i]), <span class="built_in">read</span>(r[i]);</span><br><span class="line">        p[++m] = l[i], p[++m] = r[i];</span><br><span class="line">        a[i] = r[i] - l[i];</span><br><span class="line">    &#125;</span><br><span class="line">    p[++m] = -INF, p[++m] = INF;</span><br><span class="line">    <span class="built_in">sort</span>(p + <span class="number">1</span>, p + m + <span class="number">1</span>);</span><br><span class="line">    m = <span class="built_in">unique</span>(p + <span class="number">1</span>, p + m + <span class="number">1</span>) - p - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        l[i] = <span class="built_in">lower_bound</span>(p + <span class="number">1</span>, p + m + <span class="number">1</span>, l[i]) - p;</span><br><span class="line">        r[i] = <span class="built_in">lower_bound</span>(p + <span class="number">1</span>, p + m + <span class="number">1</span>, r[i]) - p;</span><br><span class="line">        network.<span class="built_in">addedge</span>(l[i], r[i], <span class="number">1</span>, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; m; ++i)</span><br><span class="line">        network.<span class="built_in">addedge</span>(i, i + <span class="number">1</span>, k, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">write</span>(network.<span class="built_in">mcmf</span>(<span class="number">1</span>, m).second), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3356 ç«æ˜Ÿæ¢é™©é—®é¢˜</title>
    <url>/2021/12/27/sol-p3356/</url>
    <content><![CDATA[<h2 id="P3356-ç«æ˜Ÿæ¢é™©é—®é¢˜"><a href="#P3356-ç«æ˜Ÿæ¢é™©é—®é¢˜" class="headerlink" title="P3356 ç«æ˜Ÿæ¢é™©é—®é¢˜"></a>P3356 ç«æ˜Ÿæ¢é™©é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3356">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é—®é¢˜å¾ˆå®¹æ˜“è½¬åŒ–æˆæœ€å¤§è´¹ç”¨æœ€å¤§æµï¼Œæ‹†ç‚¹åˆ†åˆ«è€ƒè™‘å³å¯ã€‚</p>
<p>å¦‚ä½•è¾“å‡ºè·¯å¾„å‘¢ï¼Ÿåªéœ€è¦è·‘ä¸€æ¬¡$dfs$æˆ–$bfs$ï¼Œä»$S$åˆ°$T$èµ°åè¾¹æµé‡éé›¶çš„è¾¹å³å¯ï¼Œè®°å¾—æ¯æ¬¡èµ°å®Œå°†åè¾¹çš„æµé‡$-1$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3356.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3356</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, -INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &lt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">40</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXV = <span class="number">4e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXE = <span class="number">8e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, p, q, s, t, num, mp[MAXN][MAXN];</span><br><span class="line"><span class="type">int</span> px[MAXV], py[MAXV], pt[MAXN][MAXN][<span class="number">2</span>];</span><br><span class="line">MCMF&lt;MAXV, MAXE&gt; network;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> cnt, <span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = network.head[u]; i; i = network.nxt[i]) &#123;</span><br><span class="line">        <span class="type">int</span> v = network.edge[i].v;</span><br><span class="line">        <span class="keyword">if</span> ((i &amp; <span class="number">1</span>) == <span class="number">0</span> &amp;&amp; network.edge[i ^ <span class="number">1</span>].flow) &#123;</span><br><span class="line">            <span class="keyword">if</span> (px[u] &amp;&amp; py[u] &amp;&amp; px[v] &amp;&amp; py[v] &amp;&amp; ((px[u] ^ px[v]) || (py[u] ^ py[v])))</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, cnt, py[v] - py[u]);</span><br><span class="line">            --network.edge[i ^ <span class="number">1</span>].flow;</span><br><span class="line">            <span class="built_in">print</span>(cnt, v);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(p), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= p; ++j)</span><br><span class="line">            <span class="built_in">read</span>(mp[i][j]);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= p; ++j) &#123;</span><br><span class="line">            pt[i][j][<span class="number">0</span>] = ++num;</span><br><span class="line">            px[num] = i, py[num] = j;</span><br><span class="line">            pt[i][j][<span class="number">1</span>] = ++num;</span><br><span class="line">            px[num] = i, py[num] = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    network.<span class="built_in">addedge</span>(s, pt[<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>], n, <span class="number">0</span>);</span><br><span class="line">    network.<span class="built_in">addedge</span>(pt[q][p][<span class="number">1</span>], t, n, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= p; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mp[i][j] != <span class="number">1</span>)</span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j][<span class="number">0</span>], pt[i][j][<span class="number">1</span>], INF, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (mp[i][j] == <span class="number">2</span>)</span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j][<span class="number">0</span>], pt[i][j][<span class="number">1</span>], <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (i &lt; q)</span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j][<span class="number">1</span>], pt[i + <span class="number">1</span>][j][<span class="number">0</span>], INF, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (j &lt; p)</span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j][<span class="number">1</span>], pt[i][j + <span class="number">1</span>][<span class="number">0</span>], INF, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    network.<span class="built_in">mcmf</span>(s, t);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">print</span>(i, s);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3355 éª‘å£«å…±å­˜é—®é¢˜</title>
    <url>/2021/12/25/sol-p3355/</url>
    <content><![CDATA[<h2 id="P3355-éª‘å£«å…±å­˜é—®é¢˜"><a href="#P3355-éª‘å£«å…±å­˜é—®é¢˜" class="headerlink" title="P3355 éª‘å£«å…±å­˜é—®é¢˜"></a>P3355 éª‘å£«å…±å­˜é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3355">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ˜¾ç„¶æ˜¯ä¸€ä¸ªäºŒåˆ†å›¾æœ€å°å‰²é—®é¢˜ã€‚</p>
<p>å¦‚æœä¸è€ƒè™‘éšœç¢ï¼Œå¯ä»¥ç›´æ¥æºç‚¹åˆ°å·¦è¾¹ç‚¹ã€å³è¾¹ç‚¹åˆ°æ±‡ç‚¹è¿$1$çš„è¾¹ï¼Œè€Œå·¦å³ç‚¹ä¹‹é—´å†²çªçš„è¿$+\infty$ã€‚</p>
<p>ç°åœ¨è€ƒè™‘éšœç¢ç‰©ã€‚æ€è€ƒä¹‹å‰å»ºå›¾çš„æ„ä¹‰ï¼Œä¸€ä¸ªç‚¹å’Œæºç‚¹/æ±‡ç‚¹ä¹‹é—´çš„è¾¹è¢«å‰²æ‰ä»£è¡¨ä¸å–è¿™ä¸ªç‚¹ã€‚äºæ˜¯è¿™äº›éšœç¢ç‰©æ˜¾ç„¶ä¸èƒ½å–ï¼Œæ‰€ä»¥å¹²è„†ä¸å°†å®ƒä»¬è¿è¾¹ï¼Œæœ€åç­”æ¡ˆåœ¨$n \times n - mincut$çš„åŸºç¡€ä¸Šå†å‡å»$m$å°±å¯ä»¥äº†ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3355.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3355</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXV], lev[MAXV], cur[MAXV], nxt[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(lev, lev + MAXV, <span class="number">-1</span>);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">205</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXV = <span class="number">4e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXE = <span class="number">4e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> DX[<span class="number">8</span>] = &#123;<span class="number">-2</span>, <span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> DY[<span class="number">8</span>] = &#123;<span class="number">-1</span>, <span class="number">1</span>, <span class="number">-2</span>, <span class="number">2</span>, <span class="number">-2</span>, <span class="number">2</span>, <span class="number">-1</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">int</span> n, m, s, t, num, mp[MAXN][MAXN], pt[MAXN][MAXN];</span><br><span class="line">Dinic&lt;MAXV, MAXE&gt; network;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> x, y;</span><br><span class="line">        <span class="built_in">read</span>(x), <span class="built_in">read</span>(y);</span><br><span class="line">        mp[x][y] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            pt[i][j] = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mp[i][j])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> ((i ^ j) &amp; <span class="number">1</span>)</span><br><span class="line">                network.<span class="built_in">addedge</span>(s, pt[i][j], <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j], t, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">8</span>; ++k) &#123;</span><br><span class="line">                <span class="type">int</span> x = i + DX[k];</span><br><span class="line">                <span class="type">int</span> y = j + DY[k];</span><br><span class="line">                <span class="keyword">if</span> (x &lt; <span class="number">1</span> || y &lt; <span class="number">1</span> || x &gt; n || y &gt; n)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (mp[x][y])</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> ((i ^ j) &amp; <span class="number">1</span>)</span><br><span class="line">                    network.<span class="built_in">addedge</span>(pt[i][j], pt[x][y], INF);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans = n * n - m - network.<span class="built_in">maxflow</span>(s, t);</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3254 åœ†æ¡Œé—®é¢˜</title>
    <url>/2021/12/25/sol-p3254/</url>
    <content><![CDATA[<h2 id="P3254-åœ†æ¡Œé—®é¢˜"><a href="#P3254-åœ†æ¡Œé—®é¢˜" class="headerlink" title="P3254 åœ†æ¡Œé—®é¢˜"></a>P3254 åœ†æ¡Œé—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3254">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>è¾ƒä¸ºæ˜¾ç„¶çš„äºŒåˆ†å›¾ç½‘ç»œæµã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3254.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3254</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">550</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], lev[MAXN], cur[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(lev, lev + MAXN, <span class="number">-1</span>);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXN, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, s, t, num, r[MAXN], c[MAXN], pt[MAXN][<span class="number">2</span>];</span><br><span class="line">Dinic network;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; answ[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(m), <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">read</span>(r[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(c[i]);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        pt[i][<span class="number">0</span>] = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        pt[i][<span class="number">1</span>] = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        network.<span class="built_in">addedge</span>(s, pt[i][<span class="number">1</span>], r[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        network.<span class="built_in">addedge</span>(pt[i][<span class="number">0</span>], t, c[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">            network.<span class="built_in">addedge</span>(pt[j][<span class="number">1</span>], pt[i][<span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        sum += r[i];</span><br><span class="line">    <span class="keyword">if</span> (network.<span class="built_in">maxflow</span>(s, t) != sum)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = network.head[pt[i][<span class="number">0</span>]]; j; j = network.nxt[j])</span><br><span class="line">            <span class="keyword">if</span> (network.edge[j].flow &amp;&amp; network.edge[j].v &gt; n + <span class="number">2</span>)</span><br><span class="line">                answ[network.edge[j].v - n - <span class="number">2</span>].<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; answ[i].<span class="built_in">size</span>(); ++j)</span><br><span class="line">            <span class="built_in">write</span>(answ[i][j]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[j == answ[i].<span class="built_in">size</span>() - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2774 æ–¹æ ¼å–æ•°é—®é¢˜</title>
    <url>/2021/12/25/sol-p2774/</url>
    <content><![CDATA[<h2 id="P2774-æ–¹æ ¼å–æ•°é—®é¢˜"><a href="#P2774-æ–¹æ ¼å–æ•°é—®é¢˜" class="headerlink" title="P2774 æ–¹æ ¼å–æ•°é—®é¢˜"></a>P2774 æ–¹æ ¼å–æ•°é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2774">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä½¿ç”¨å‰²æ¨¡å‹æ¥åšã€‚ç”±äºç›¸é‚»çš„æ•°ä¸èƒ½åŒæ—¶å–ï¼Œäºæ˜¯å¾ˆå®¹æ˜“æƒ³åˆ°å»ºç«‹äºŒåˆ†å›¾ï¼ŒäºŒåˆ†å›¾ä¸¤ä¾§çš„ç‚¹ä¹‹é—´è¿$+\infty$çš„è¾¹ï¼Œå¹¶ä¸”åˆ†åˆ«å‘æºç‚¹å’Œæ±‡ç‚¹è¿è¾¹ï¼Œæµé‡ä¸ºå¯¹åº”æƒå€¼ã€‚è¿™æ ·æœ€å°å‰²ä¸€å®šåªèƒ½å‰²æ‰ä¸¤ä¾§ä¸æºç‚¹å’Œæ±‡ç‚¹çš„è¿è¾¹ï¼Œè¢«å‰²æ‰çš„è¾¹ä¸€å®šä¸å–ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2774.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2774</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp&amp; x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], lev[MAXN], cur[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(lev, lev + MAXN, <span class="number">-1</span>);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXN, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, s, t, num, a[MAXN][MAXN], pt[MAXN][MAXN];</span><br><span class="line">Dinic network;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">            <span class="built_in">read</span>(a[i][j]);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">            pt[i][j] = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((i ^ j) &amp; <span class="number">1</span>)</span><br><span class="line">                network.<span class="built_in">addedge</span>(s, pt[i][j], a[i][j]);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j], t, a[i][j]);</span><br><span class="line">            <span class="keyword">if</span> (((i ^ j) &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">1</span>)</span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j], pt[i - <span class="number">1</span>][j], INF);</span><br><span class="line">            <span class="keyword">if</span> (j &gt; <span class="number">1</span>)</span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j], pt[i][j - <span class="number">1</span>], INF);</span><br><span class="line">            <span class="keyword">if</span> (i &lt; n)</span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j], pt[i + <span class="number">1</span>][j], INF);</span><br><span class="line">            <span class="keyword">if</span> (j &lt; m)</span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[i][j], pt[i][j + <span class="number">1</span>], INF);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">            ans += a[i][j];</span><br><span class="line">    ans -= network.<span class="built_in">maxflow</span>(s, t);</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4716 ã€æ¨¡ç‰ˆã€‘æœ€å°æ ‘å½¢å›¾</title>
    <url>/2021/12/25/sol-p4716/</url>
    <content><![CDATA[<h2 id="P4716-ã€æ¨¡ç‰ˆã€‘æœ€å°æ ‘å½¢å›¾"><a href="#P4716-ã€æ¨¡ç‰ˆã€‘æœ€å°æ ‘å½¢å›¾" class="headerlink" title="P4716 ã€æ¨¡ç‰ˆã€‘æœ€å°æ ‘å½¢å›¾"></a>P4716 ã€æ¨¡ç‰ˆã€‘æœ€å°æ ‘å½¢å›¾</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4716">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ¨¡ç‰ˆé¢˜æ²¡å•¥å¥½è¯´çš„ï¼Œç”¨$zl$ç®—æ³•å³å¯ã€‚</p>
<p>æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å¯¹äºæ¯ä¸ªé™¤äº†æ ¹èŠ‚ç‚¹ä¹‹å¤–çš„èŠ‚ç‚¹ï¼Œä»¤å…¶è¾¹æƒæœ€å°çš„å…¥è¾¹ä¸º$fa_u$ï¼Œè¾¹æƒä¸º$mn_u$ã€‚</li>
<li>åˆ¤æ–­æ˜¯å¦æœ‰èŠ‚ç‚¹æ²¡æœ‰å…¥è¾¹ï¼Œè‹¥æ²¡æœ‰åˆ™æ— è§£ï¼Œç›´æ¥è¿”å›$-1$ã€‚å¦åˆ™ç­”æ¡ˆåŠ ä¸Š$mn_u$ã€‚</li>
<li>å°†å›¾ä¸­è¿™äº›è¾¹å½¢æˆçš„ç¯å…¨éƒ¨ç¼©ç‚¹ï¼Œå¹¶é‡æ–°ç¼–å·ã€‚</li>
<li>è‹¥å›¾ä¸­æ— ç¯ï¼Œç»“æŸç®—æ³•ï¼Œè¿”å›å½“å‰ç­”æ¡ˆã€‚</li>
<li>å°†ä¸åœ¨ç¯ä¸­çš„ç‚¹ä¹Ÿé‡æ–°ç¼–å·ã€‚</li>
<li>å¯¹äºæ¯æ¡è¾¹$(u,v,w)$ï¼Œå°†$w$å‡å»$mn_v$ã€‚</li>
<li>æ›´æ–°å˜é‡$n$å’Œ$rt$ï¼Œæ¸…ç©ºæœ€å¤§ç¼–å·ï¼Œé‡å¤æ­¥éª¤$1$ã€‚</li>
</ol>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4716.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4716</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">150</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">&#125; e[MAXM];</span><br><span class="line"><span class="type">int</span> n, m, r;</span><br><span class="line"><span class="type">int</span> tot, head[MAXN], nxt[MAXM];</span><br><span class="line"><span class="type">int</span> mn[MAXN], fa[MAXN], tp[MAXN], lp[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">    e[++tot] = &#123;u, v, w&#125;;</span><br><span class="line">    nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">mdst</span><span class="params">(<span class="type">int</span> rt)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">0</span>, tn = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">fill</span>(fa, fa + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(tp, tp + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(lp, lp + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(mn, mn + n + <span class="number">1</span>, INF);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            <span class="keyword">if</span> (e[i].u != e[i].v &amp;&amp; e[i].w &lt; mn[e[i].v])</span><br><span class="line">                mn[e[i].v] = e[i].w, fa[e[i].v] = e[i].u;</span><br><span class="line">        mn[rt] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            ret += mn[i];</span><br><span class="line">            <span class="keyword">if</span> (mn[i] == INF)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">1</span>; u &lt;= n; ++u) &#123;</span><br><span class="line">            <span class="type">int</span> v = u;</span><br><span class="line">            <span class="keyword">while</span> (v != rt &amp;&amp; tp[v] != u &amp;&amp; !lp[v])</span><br><span class="line">                tp[v] = u, v = fa[v];</span><br><span class="line">            <span class="keyword">if</span> (v != rt &amp;&amp; !lp[v]) &#123;</span><br><span class="line">                lp[v] = ++tn;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = fa[v]; k != v; k = fa[k])</span><br><span class="line">                    lp[k] = tn;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!tn)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (!lp[i])</span><br><span class="line">                lp[i] = ++tn;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            e[i].w -= mn[e[i].v], e[i].u = lp[e[i].u], e[i].v = lp[e[i].v];</span><br><span class="line">        n = tn, rt = lp[rt], tn = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(r);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v), <span class="built_in">read</span>(w);</span><br><span class="line">        <span class="built_in">addedge</span>(u, v, w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(<span class="built_in">mdst</span>(r)), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2770 èˆªç©ºè·¯çº¿é—®é¢˜</title>
    <url>/2021/12/24/sol-p2770/</url>
    <content><![CDATA[<h2 id="P2770-èˆªç©ºè·¯çº¿é—®é¢˜"><a href="#P2770-èˆªç©ºè·¯çº¿é—®é¢˜" class="headerlink" title="P2770 èˆªç©ºè·¯çº¿é—®é¢˜"></a>P2770 èˆªç©ºè·¯çº¿é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2770">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>$O(n^3)$çš„$dp$æ˜¾ç„¶<del>ï¼ˆbushi</del></p>
<p>è€ƒè™‘ç½‘ç»œæµçš„åšæ³•ã€‚é¦–å…ˆæ¯ä¸ªç‚¹ç»è¿‡ä¸€æ¬¡å°±æƒ³åˆ°æ‹†ç‚¹ï¼Œç„¶åæŒ‰ç…§åŸå›¾è¿è¾¹ï¼Œä»$1$åˆ°$n$çš„æœ€å¤§æµ$\ge 2$å°±æœ‰è§£ã€‚</p>
<p>éœ€è¦æ³¨æ„æµ‹è¯•ç‚¹$2$æ˜¯$1$åˆ°$n$æœ‰è¿è¾¹ä¸”åªæœ‰$1 \to n \to 1$è¿™ç§èµ°æ³•çš„ï¼Œä½†å…¶å®å¯ä»¥ä¸ç”¨ç‰¹åˆ¤è§£å†³ï¼Œè¾“å‡ºè·¯å¾„æ—¶å¦‚æœå‰©ä½™æµé‡$=+\infty-2$æ—¶å¤šè·‘ä¸€æ¬¡å³å¯ï¼ˆå…·ä½“è§ä»£ç ï¼‰ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2770.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2770</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">505</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">2e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXS = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>, cost = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], dis[MAXN], cur[MAXN];</span><br><span class="line">    <span class="type">bool</span> vis[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXN, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXN, -INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>, vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>(), vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &lt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v])</span><br><span class="line">                        que.<span class="built_in">push</span>(v), vis[v] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != -INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXN, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, s, t, num, pt[MAXN][<span class="number">2</span>];</span><br><span class="line"><span class="type">char</span> buf[MAXS], str[MAXN][MAXS];</span><br><span class="line">Dinic network;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u == n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, str[u]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">1</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, str[u]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = network.head[pt[u][<span class="number">1</span>]]; i; i = network.nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (network.edge[i].flow == INF - <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span>((network.edge[i].v - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, on);</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, str[u]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str[i]);</span><br><span class="line">        pt[i][<span class="number">0</span>] = ++num;</span><br><span class="line">        pt[i][<span class="number">1</span>] = ++num;</span><br><span class="line">    &#125;</span><br><span class="line">    network.<span class="built_in">addedge</span>(s, pt[<span class="number">1</span>][<span class="number">1</span>], <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    network.<span class="built_in">addedge</span>(pt[n][<span class="number">0</span>], t, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        network.<span class="built_in">addedge</span>(pt[i][<span class="number">0</span>], pt[i][<span class="number">1</span>], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strcmp</span>(buf, str[j]) == <span class="number">0</span>)</span><br><span class="line">                u = j;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strcmp</span>(buf, str[j]) == <span class="number">0</span>)</span><br><span class="line">                v = j;</span><br><span class="line">        <span class="keyword">if</span> (u &gt; v)</span><br><span class="line">            <span class="built_in">swap</span>(u, v);</span><br><span class="line">        network.<span class="built_in">addedge</span>(pt[u][<span class="number">1</span>], pt[v][<span class="number">0</span>], INF, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (network.<span class="built_in">mcmf</span>(s, t) != <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;No Solution!&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">write</span>(network.cost), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = network.head[pt[<span class="number">1</span>][<span class="number">1</span>]], on = <span class="number">1</span>; i; i = network.nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (network.edge[i].flow &lt; INF - <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = network.edge[i].flow; j &lt; INF; ++j, on = -on) &#123;</span><br><span class="line">            <span class="keyword">if</span> (on == <span class="number">1</span>)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, str[<span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">print</span>((network.edge[i].v - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, on);</span><br><span class="line">            <span class="keyword">if</span> (on == <span class="number">-1</span>)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, str[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2766 æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é—®é¢˜</title>
    <url>/2021/12/24/sol-p2766/</url>
    <content><![CDATA[<h2 id="P2766-æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é—®é¢˜"><a href="#P2766-æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é—®é¢˜" class="headerlink" title="P2766 æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é—®é¢˜"></a>P2766 æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2766">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ç¬¬ä¸€é—®ç›´æ¥$O(n^2)$æ±‚ã€‚</p>
<p>ç¬¬äºŒé—®æ ¹æ®ç¬¬ä¸€é—®$dp$çš„åˆæ³•è½¬ç§»å»ºç«‹$DAG$å›¾ï¼Œæ‹†ç‚¹å¹¶æ±‚å‡ºæœ€å¤§æµã€‚å³å¯¹äº$\forall a_j \le a_i, dp_i = dp_j + 1$ï¼Œè¿æ¥$j_1 \to i_0$ï¼Œæµé‡ä¸º$1$ï¼Œä¸”è¿æ¥æ¯ä¸ª$i_0 \to i_1$ã€‚å¦‚æœ$dp_i=1$åˆ™è¿æ¥$S \to i_0$ï¼Œ$dp_i=ans_1$åˆ™è¿æ¥$i_1 \to T$ã€‚è¿™æ ·å°±ä¿è¯äº†æ¯æ¬¡å¢å¹¿éƒ½æ‰¾åˆ°ä¸€ä¸ªé•¿åº¦æœ€é•¿çš„å­åºåˆ—ï¼Œå¹¶ä¸”æ¯ä¸ªç‚¹åªèƒ½å–ä¸€æ¬¡ã€‚</p>
<p>ç¬¬ä¸‰é—®ç”±äº$1$å’Œ$n$æ— é™åˆ¶ï¼Œæ‰€ä»¥å°†$S \to 1$å’Œ$n \to T$ï¼ˆå¦‚æœæœ‰ï¼‰çš„æµé‡æ”¹ä¸º$+\infty$ï¼Œå¹¶å°†$1_0 \to 1_1$å’Œ$n_0 \to n_1$ä¹Ÿæ”¹ä¸º$+\infty$å³å¯ã€‚æ³¨æ„è¦ç‰¹åˆ¤$n=1$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2766.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2766</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], lev[MAXN], cur[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(lev, <span class="number">-1</span>, <span class="built_in">sizeof</span>(lev));</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(cur, head, <span class="built_in">sizeof</span>(cur));</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, s, t, num, a[MAXN], dp[MAXN], pt[MAXN][<span class="number">2</span>];</span><br><span class="line">Dinic network;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="type">int</span> ans1 = <span class="number">0</span>, ans2 = <span class="number">0</span>, ans3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; ++j)</span><br><span class="line">            <span class="keyword">if</span> (a[j] &lt;= a[i])</span><br><span class="line">                dp[i] = <span class="built_in">max</span>(dp[i], dp[j] + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ans1 = *<span class="built_in">max_element</span>(dp + <span class="number">1</span>, dp + n + <span class="number">1</span>);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        pt[i][<span class="number">0</span>] = ++num, pt[i][<span class="number">1</span>] = ++num;</span><br><span class="line">        network.<span class="built_in">addedge</span>(pt[i][<span class="number">0</span>], pt[i][<span class="number">1</span>], <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (dp[i] == <span class="number">1</span>)</span><br><span class="line">            network.<span class="built_in">addedge</span>(s, pt[i][<span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (dp[i] == ans1)</span><br><span class="line">            network.<span class="built_in">addedge</span>(pt[i][<span class="number">1</span>], t, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; i; ++j)</span><br><span class="line">            <span class="keyword">if</span> (a[j] &lt;= a[i] &amp;&amp; dp[j] + <span class="number">1</span> == dp[i])</span><br><span class="line">                network.<span class="built_in">addedge</span>(pt[j][<span class="number">1</span>], pt[i][<span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ans2 = network.<span class="built_in">maxflow</span>(s, t);</span><br><span class="line">    <span class="keyword">if</span> (dp[<span class="number">1</span>] == <span class="number">1</span>)</span><br><span class="line">        network.<span class="built_in">addedge</span>(s, pt[<span class="number">1</span>][<span class="number">0</span>], INF - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (dp[n] == ans1)</span><br><span class="line">        network.<span class="built_in">addedge</span>(pt[n][<span class="number">1</span>], t, INF - <span class="number">1</span>);</span><br><span class="line">    network.<span class="built_in">addedge</span>(pt[<span class="number">1</span>][<span class="number">0</span>], pt[<span class="number">1</span>][<span class="number">1</span>], INF - <span class="number">1</span>);</span><br><span class="line">    network.<span class="built_in">addedge</span>(pt[n][<span class="number">0</span>], pt[n][<span class="number">1</span>], INF - <span class="number">1</span>);</span><br><span class="line">    ans3 = (n == <span class="number">1</span>) ? <span class="number">1</span> : network.<span class="built_in">maxflow</span>(s, t);</span><br><span class="line">    <span class="built_in">write</span>(ans1), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="built_in">write</span>(ans2), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="built_in">write</span>(ans3), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2765 é­”æœ¯çƒé—®é¢˜</title>
    <url>/2021/12/24/sol-p2765/</url>
    <content><![CDATA[<h2 id="P2765-é­”æœ¯çƒé—®é¢˜"><a href="#P2765-é­”æœ¯çƒé—®é¢˜" class="headerlink" title="P2765 é­”æœ¯çƒé—®é¢˜"></a>P2765 é­”æœ¯çƒé—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2765">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><a href="/2021/12/24/sol-p2764/" title="P2764">P2764</a>å€’è¿‡æ¥ã€‚

å°†å’Œä¸ºå®Œå…¨å¹³æ–¹æ•°çš„æ•°å¯¹$(a,b)$ä¹‹é—´è¿æœ‰å‘è¾¹ï¼Œå¤§çš„è¿å‘å°çš„ï¼Œç­”æ¡ˆå°±æ˜¯æœ€é•¿è·¯å¾„è¦†ç›–ã€‚

æšä¸¾ç­”æ¡ˆåˆ¤æ–­å³å¯ã€‚

### ACä»£ç 

<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2765.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2765</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], lev[MAXN], cur[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(lev, <span class="number">-1</span>, <span class="built_in">sizeof</span>(lev));</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(cur, head, <span class="built_in">sizeof</span>(cur));</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, s, t, num, cnt, pre[MAXN], col[MAXN], pt[MAXN][<span class="number">2</span>];</span><br><span class="line">Dinic maxflow;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; answ[MAXN];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">issqrt</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">sqrt</span>(x);</span><br><span class="line">    <span class="keyword">return</span> t * t == x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>; ; ++w) &#123;</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fill</span>(col, col + w, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(pre, pre + w, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">1</span>; u &lt; w; ++u) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = maxflow.head[pt[u][<span class="number">0</span>]]; i; i = maxflow.nxt[i])</span><br><span class="line">                <span class="keyword">if</span> (maxflow.edge[i].flow == INF - <span class="number">1</span>)</span><br><span class="line">                    pre[(maxflow.edge[i].v - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>] = u;</span><br><span class="line">        &#125;</span><br><span class="line">        pt[w][<span class="number">0</span>] = ++num, pt[w][<span class="number">1</span>] = ++num;</span><br><span class="line">        maxflow.<span class="built_in">addedge</span>(s, pt[w][<span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">        maxflow.<span class="built_in">addedge</span>(pt[w][<span class="number">1</span>], t, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; w; ++i)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">issqrt</span>(i + w))</span><br><span class="line">                maxflow.<span class="built_in">addedge</span>(pt[w][<span class="number">0</span>], pt[i][<span class="number">1</span>], INF);</span><br><span class="line">        <span class="type">int</span> tmp = w - maxflow.<span class="built_in">maxflow</span>(s, t);</span><br><span class="line">        <span class="keyword">if</span> (tmp &gt; n) &#123;</span><br><span class="line">            <span class="built_in">write</span>(w - <span class="number">1</span>), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = w - <span class="number">1</span>; i; --i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!pre[i])</span><br><span class="line">                    col[i] = ++cnt;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    col[i] = col[pre[i]];</span><br><span class="line">                answ[col[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i) &#123;</span><br><span class="line">                <span class="built_in">reverse</span>(answ[i].<span class="built_in">begin</span>(), answ[i].<span class="built_in">end</span>());</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; answ[i].<span class="built_in">size</span>(); ++j)</span><br><span class="line">                    <span class="built_in">write</span>(answ[i][j]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[j == answ[i].<span class="built_in">size</span>() - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2764 æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜</title>
    <url>/2021/12/24/sol-p2764/</url>
    <content><![CDATA[<h2 id="P2764-æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜"><a href="#P2764-æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜" class="headerlink" title="P2764 æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜"></a>P2764 æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2764">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä¸å¦¨å…ˆå‡è®¾æ¯ä¸ªç‚¹éƒ½å•ç‹¬è¢«ä¸€æ¡è·¯å¾„è¦†ç›–ï¼Œæˆ‘ä»¬æƒ³è¦è®©æœ€å¤šçš„è·¯å¾„ç›¸è¿æ¥ã€‚</p>
<p>å¯¹äºæ¯ä¸ªç‚¹åªèƒ½æœ‰æœ€å¤šä¸€æ¡å…¥è¾¹å’Œæœ€å¤šä¸€æ¡å‡ºè¾¹ï¼Œè€ŒåŸå›¾ä¸­æœ‰è¾¹çš„å¯ä»¥ç›¸è¿ï¼Œå»ºå›¾æ–¹å¼æ˜¾ç„¶ï¼Œç±»ä¼¼äºŒåˆ†å›¾ï¼Œæºç‚¹è¿å‘å·¦è¾¹çš„ç‚¹ï¼Œå³è¾¹çš„ç‚¹è¿å‘æ±‡ç‚¹ï¼Œæµé‡ä¸º$1$ï¼ŒåŸå›¾ä¸­çš„è¾¹$(u,v)$åœ¨ç½‘ç»œä¸­ä¸º$v$å³è¾¹çš„è¿å‘$u$å·¦è¾¹çš„ï¼Œä¸ºä¾¿äºè¾“å‡ºæ–¹æ¡ˆæµé‡è®¾ä¸º$+\infty$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2764.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2764</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">505</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">2e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], lev[MAXN], cur[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(lev, <span class="number">-1</span>, <span class="built_in">sizeof</span>(lev));</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(cur, head, <span class="built_in">sizeof</span>(cur));</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, s, t, num, cnt, pre[MAXN], col[MAXN], pt[MAXN][<span class="number">2</span>];</span><br><span class="line">Dinic maxflow;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; answ[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        pt[i][<span class="number">0</span>] = ++num, pt[i][<span class="number">1</span>] = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        maxflow.<span class="built_in">addedge</span>(s, pt[i][<span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">        maxflow.<span class="built_in">addedge</span>(pt[i][<span class="number">1</span>], t, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        maxflow.<span class="built_in">addedge</span>(pt[u][<span class="number">0</span>], pt[v][<span class="number">1</span>], INF);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans = n - maxflow.<span class="built_in">maxflow</span>(s, t);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">1</span>; u &lt;= n; ++u) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = maxflow.head[pt[u][<span class="number">0</span>]]; i; i = maxflow.nxt[i])</span><br><span class="line">            <span class="keyword">if</span> (maxflow.edge[i].flow == INF - <span class="number">1</span>)</span><br><span class="line">                pre[(maxflow.edge[i].v - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>] = u;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!pre[i])</span><br><span class="line">            col[i] = ++cnt;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            col[i] = col[pre[i]];</span><br><span class="line">        answ[col[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; answ[i].<span class="built_in">size</span>(); ++j)</span><br><span class="line">            <span class="built_in">write</span>(answ[i][j]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[j == answ[i].<span class="built_in">size</span>() - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2763 è¯•é¢˜åº“é—®é¢˜</title>
    <url>/2021/12/23/sol-p2763/</url>
    <content><![CDATA[<h2 id="P2763-è¯•é¢˜åº“é—®é¢˜"><a href="#P2763-è¯•é¢˜åº“é—®é¢˜" class="headerlink" title="P2763 è¯•é¢˜åº“é—®é¢˜"></a>P2763 è¯•é¢˜åº“é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2763">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>è¿™é“æ¯”è¾ƒå®¹æ˜“å»ºå›¾äº†ã€‚</p>
<p>æºç‚¹è¿å‘æ¯ç±»è¯•é¢˜ï¼Œæµé‡ä¸ºè¦é€‰å‡ºçš„é¢˜ç›®æ•°é‡ã€‚æ¯ç±»è¯•é¢˜å‘é¢˜åº“ä¸­çš„è¯•é¢˜è¿è¾¹ï¼Œæµé‡$+\infty$ã€‚æœ€åæ¯é“é¢˜å‘æ±‡ç‚¹è¿è¾¹ï¼Œæµé‡ä¸º$1$å³å¯ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2763.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2763</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], lev[MAXN], cur[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(lev, <span class="number">-1</span>, <span class="built_in">sizeof</span>(lev));</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(cur, head, <span class="built_in">sizeof</span>(cur));</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> k, n, m, s, t, num, a[MAXN];</span><br><span class="line">Dinic maxflow;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(k), <span class="built_in">read</span>(n);</span><br><span class="line">    s = ++num, t = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">        m += a[i];</span><br><span class="line">        maxflow.<span class="built_in">addedge</span>(s, ++num, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> p, x;</span><br><span class="line">        <span class="built_in">read</span>(p);</span><br><span class="line">        ++num;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= p; ++j) &#123;</span><br><span class="line">            <span class="built_in">read</span>(x);</span><br><span class="line">            maxflow.<span class="built_in">addedge</span>(x + <span class="number">2</span>, num, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        maxflow.<span class="built_in">addedge</span>(num, t, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (maxflow.<span class="built_in">maxflow</span>(s, t) != m)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;No Solution!&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld: &quot;</span>, i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = maxflow.head[i + <span class="number">2</span>], c = <span class="number">0</span>; j; j = maxflow.nxt[j])</span><br><span class="line">            <span class="keyword">if</span> (maxflow.edge[j].flow == INF - <span class="number">1</span>)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld%c&quot;</span>, maxflow.edge[j].v - k - <span class="number">2</span>, <span class="string">&quot; \n&quot;</span>[++c == a[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2762 å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜</title>
    <url>/2021/12/22/sol-p2762/</url>
    <content><![CDATA[<h2 id="P2762-å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜"><a href="#P2762-å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜" class="headerlink" title="P2762 å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜"></a>P2762 å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2762">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å‘æ¥å‘å»æœ€åè¢«è¯»å…¥ç»™å‘åˆ°äº†ã€‚</p>
<p>ä½¿ç”¨å‰²æ¨¡å‹ï¼Œä»æºç‚¹è¿è¾¹åˆ°å®éªŒï¼Œæµé‡ä¸ºè¯¥å®éªŒå¯è·å¾—çš„é’±$p_i$ï¼Œå†ä»ä»ªå™¨è¿è¾¹é“æ±‡ç‚¹ï¼Œæµé‡ä¸ºè¯¥ä»ªå™¨çš„ä»·æ ¼$c_i$ï¼Œæœ€åå°†å®éªŒå’Œä»ªå™¨ä¹‹é—´è¿è¾¹ï¼Œæµé‡ä¸º$+\infty$ã€‚</p>
<p>æ€è€ƒè¿™ç§è¿è¾¹æ–¹å¼çš„å«ä¹‰ã€‚æœ€å°å‰²åçš„æ®‹ä½™ç½‘ç»œä¸­ï¼Œä¸æºç‚¹ç›¸è¿çš„ç‚¹éƒ½æ˜¯è¦å–çš„ï¼Œä¸æ±‡ç‚¹ç›¸è¿çš„ç‚¹éƒ½æ˜¯ä¸å–çš„ï¼Œåˆ†åˆ«å¯¹åº”$S$é›†åˆå’Œ$T$é›†åˆã€‚åŸç½‘ç»œæ‰€ä»£è¡¨çš„çŠ¶æ€æ˜¯$m$ä¸ªå®éªŒéƒ½åšï¼Œä½†è¿™æ˜¾ç„¶æ˜¯ä¸åˆæ³•çš„ï¼Œæ‰€ä»¥è·‘ä¸€éæœ€å°å‰²åï¼Œå°±èƒ½ä¿è¯ä¸å‡ºç°å®éªŒåœ¨$S$é›†åˆè€Œå¯¹åº”ä»ªå™¨åœ¨$T$é›†åˆä¸­çš„æƒ…å†µï¼ˆå› ä¸ºæ— æ³•å‰²æ–­å®éªŒå’Œä»ªå™¨ä¹‹é—´çš„è¿è¾¹ï¼‰ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®éªŒåœ¨$T$é›†åˆè€Œå¯¹åº”ä»ªå™¨åœ¨$S$é›†åˆçš„æ–¹æ¡ˆæ˜¯åˆæ³•çš„ã€‚è€Œæ‰€æ±‚çš„æœ€å°å‰²å°±æ˜¯ä½¿å¾—æ–¹æ¡ˆåˆæ³•çš„æœ€å°ä»£ä»·ã€‚</p>
<p>äºæ˜¯ç­”æ¡ˆä¸º$\sum\limits_{i=1}^{m}{p_i} - mincut$ã€‚</p>
<h4 id="æ¶å¿ƒçš„è¯»å…¥"><a href="#æ¶å¿ƒçš„è¯»å…¥" class="headerlink" title="æ¶å¿ƒçš„è¯»å…¥"></a>æ¶å¿ƒçš„è¯»å…¥</h4><p>å› ä¸ºä¸å–œæ¬¢ç”¨<code>cin</code>æ‰€ä»¥ç ”ç©¶å¦‚ä½•ç”¨<code>scanf</code>ä¼˜é›…åœ°è¯»å…¥æ•´è¡Œï¼Œäºæ˜¯å‘ç°ï¼š</p>
<ul>
<li><code>scanf(&quot;%[^\n]&quot;, buf)</code>å¯ä»¥è¯»å…¥æ•´è¡Œï¼Œå…¶ä¸­<code>buf</code>æ˜¯<code>char</code>æ•°ç»„ã€‚</li>
</ul>
<p>æ‰€ä»¥ç”¨<code>buf</code>è¿›è¡Œæ‰‹å†™å¿«è¯»ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä»å­—ç¬¦ä¸²`s`ä¸­è¯»å…¥æ•°å­—åˆ°`x`ï¼Œå¹¶è¿”å›`s`ä¸­å½“å‰æ•°å­—ä¸‹ä¸€ä½çš„æŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span>* <span class="title">sread</span><span class="params">(<span class="type">char</span> *s, _Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = *s++;</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = *s++)</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = *s++)</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = *s++; <span class="built_in">isdigit</span>(ch); ch = *s++)</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (sign)</span><br><span class="line">        x = -x;</span><br><span class="line">    <span class="keyword">return</span> --s; <span class="comment">// è¿”å›ä¸Šä¸€ä¸ªä½ç½®çš„åŸå› æ˜¯å¿«è¯»ä¼šåˆ¤æ–­æ•°å­—åä¸€ä½å¹¶ä¸”å°†æŒ‡é’ˆ`s`ç§»åˆ°æ•°å­—åä¸¤ä½ï¼Œè¿™æ ·æ— æ³•åˆ¤æ–­å­—ç¬¦ä¸²ç»“æŸ`&#x27;\0&#x27;`</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(m), <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(p[i]);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%[^\n]%c&quot;</span>, buf, &amp;chr);</span><br><span class="line">        <span class="type">char</span> *pos = buf;</span><br><span class="line">        <span class="keyword">for</span> (k[i] = <span class="number">0</span>; (*pos) &amp;&amp; ++k[i];)</span><br><span class="line">            pos = <span class="built_in">sread</span>(pos, a[i][k[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(c[i]);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2762.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2762</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span>* <span class="title">sread</span><span class="params">(<span class="type">char</span> *s, _Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = *s++;</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = *s++)</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = *s++)</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = *s++; <span class="built_in">isdigit</span>(ch); ch = *s++)</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (sign)</span><br><span class="line">        x = -x;</span><br><span class="line">    <span class="keyword">return</span> --s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">150</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">3e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXS = <span class="number">1</span> &lt;&lt; <span class="number">15</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], lev[MAXN], cur[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(lev, <span class="number">-1</span>, <span class="built_in">sizeof</span>(lev));</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(cur, head, <span class="built_in">sizeof</span>(cur));</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, p[MAXN], c[MAXN], k[MAXN], a[MAXN][MAXN];</span><br><span class="line"><span class="type">char</span> chr, buf[MAXS];</span><br><span class="line"><span class="type">bool</span> use1[MAXN], use2[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; ans1, ans2;</span><br><span class="line">Dinic mincut;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(m), <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(p[i]);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%[^\n]%c&quot;</span>, buf, &amp;chr);</span><br><span class="line">        <span class="type">char</span> *pos = buf;</span><br><span class="line">        <span class="keyword">for</span> (k[i] = <span class="number">0</span>; (*pos) &amp;&amp; ++k[i];)</span><br><span class="line">            pos = <span class="built_in">sread</span>(pos, a[i][k[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(c[i]);</span><br><span class="line">    <span class="type">int</span> ss = <span class="number">1</span>, tt = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        mincut.<span class="built_in">addedge</span>(i + <span class="number">2</span>, tt, c[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        mincut.<span class="built_in">addedge</span>(ss, i + n + <span class="number">2</span>, p[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= k[i]; ++j)</span><br><span class="line">            mincut.<span class="built_in">addedge</span>(i + n + <span class="number">2</span>, a[i][j] + <span class="number">2</span>, INF);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        ans += p[i];</span><br><span class="line">    ans -= mincut.<span class="built_in">maxflow</span>(ss, tt);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="keyword">if</span> (mincut.lev[i + n + <span class="number">2</span>] != <span class="number">-1</span>)</span><br><span class="line">            ans1.<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (mincut.lev[i + <span class="number">2</span>] != <span class="number">-1</span>)</span><br><span class="line">            ans2.<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ans1.<span class="built_in">size</span>(); ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans1[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == ans1.<span class="built_in">size</span>() - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ans2.<span class="built_in">size</span>(); ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans2[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == ans2.<span class="built_in">size</span>() - <span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2754 æ˜Ÿé™…è½¬ç§»é—®é¢˜</title>
    <url>/2021/12/22/sol-p2754/</url>
    <content><![CDATA[<h2 id="P2754-æ˜Ÿé™…è½¬ç§»é—®é¢˜"><a href="#P2754-æ˜Ÿé™…è½¬ç§»é—®é¢˜" class="headerlink" title="P2754 æ˜Ÿé™…è½¬ç§»é—®é¢˜"></a>P2754 æ˜Ÿé™…è½¬ç§»é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2754">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å¥—è·¯åœ°æ‹†ç‚¹ã€‚$pt_{u,t}$è¡¨ç¤ºèŠ‚ç‚¹$u$åœ¨æ—¶é—´ä¸º$t$æ—¶çš„çŠ¶æ€ã€‚æŒ‰ç…§å¤ªç©ºèˆ¹åœ¨$t$æ—¶çš„ä½ç½®è¿è¾¹ï¼Œè·‘æœ€å¤§æµåˆ¤æ–­æ˜¯å¦å¯è¡Œã€‚</p>
<p>ä¸€ç§æ–¹æ³•ä¸ºäºŒåˆ†ç­”æ¡ˆï¼Œä½†æ˜¯æ¯æ¬¡éœ€è¦é‡æ–°å»ºå›¾ï¼›å¦ä¸€ç§åˆ™æ˜¯ç›´æ¥æšä¸¾ç­”æ¡ˆï¼Œæ¯æ¬¡åªè¿æ–°åŠ å…¥çš„è¾¹ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ®‹ä½™ç½‘ç»œä¸Šç»§ç»­è·‘$maxflow$ã€‚æ®è¯´äºŒåˆ†åè€Œè·‘çš„æ¯”æšä¸¾æ…¢ä¸€äº›ã€‚</p>
<h4 id="G-V-E-ä¸­-V-å’Œ-E-çš„èŒƒå›´"><a href="#G-V-E-ä¸­-V-å’Œ-E-çš„èŒƒå›´" class="headerlink" title="$G(V,E)$ä¸­$|V|$å’Œ$|E|$çš„èŒƒå›´"></a>$G(V,E)$ä¸­$|V|$å’Œ$|E|$çš„èŒƒå›´</h4><p><strong>ä»¤$n=n+2$</strong>ï¼Œå…ˆè®¡ç®—æœ€é•¿å¯èƒ½çš„æ—¶é—´$T$ã€‚æœ€åçš„å¯èƒ½æ€§æ˜¯åªæœ‰ä¸€è‰˜å¤ªç©ºèˆ¹ä¸”å®¹é‡ä¸º$1$ï¼Œå¹¶ä¸”è¿™è‰˜å¤ªç©ºèˆ¹åœ¨$n$ä¸ªç‚¹ä¹‹é—´å‘¨è½¬ã€‚æ­¤æ—¶æœ€é•¿æ—¶é—´$T \le k \times n \le 750$ï¼ˆå¾ˆå¤šé¢˜è§£éƒ½è¯´æ˜¯$500$ï¼Œå…¶å®æ˜¯é”™çš„ï¼Œæ´›è°·è®¨è®ºåŒºé‡Œæœ‰$hack$ï¼‰ã€‚</p>
<p>æ¯æ¬¡æšä¸¾æ–°çš„æ—¶é—´ï¼Œæœ€å¤šå¢åŠ $n$ä¸ªç‚¹ï¼Œæ‰€ä»¥ç‚¹é›†å¤§å°$|V| \le n \times T \le 11250$ï¼Œå¼€åˆ°$2 \times 10^4$å³å¯ã€‚</p>
<p>è€Œåœ¨æ¯æ¬¡æ·»åŠ è·¯å¾„æ—¶ï¼Œ$pt<em>{u,t-1}$è¿å‘$pt</em>{u,t}$ï¼Œå¹¶ä¸”æ¯è‰˜å¤ªç©ºèˆ¹å¢åŠ ä¸€æ¡è¾¹ï¼Œè€ƒè™‘<strong>ç½‘ç»œæµå»ºåè¾¹éœ€è¦$\times 2$</strong>ï¼Œåˆ™æ¯æ¬¡æœ€å¤šæ·»åŠ $(n + m) \times 2 \le 80$æ¡è¾¹ï¼Œæ‰€ä»¥è¾¹é›†å¤§å°$|E| \le T \times 80 \le 60000$ï¼Œå¼€$10^5$ç®¡å¤Ÿã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2754.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2754</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXS = <span class="number">800</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXT = <span class="number">55</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], lev[MAXN], cur[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(lev, <span class="number">-1</span>, <span class="built_in">sizeof</span>(lev));</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(cur, head, <span class="built_in">sizeof</span>(cur));</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, k, sx, tx, ss, tt, num;</span><br><span class="line"><span class="type">int</span> h[MAXT], r[MAXT], s[MAXT][MAXT], pt[MAXT][MAXS];</span><br><span class="line">Dinic maxflow;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(k);</span><br><span class="line">    sx = n + <span class="number">1</span>, tx = n + <span class="number">2</span>;</span><br><span class="line">    ss = ++num, tt = ++num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(h[i]), <span class="built_in">read</span>(r[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; r[i]; ++j) &#123;</span><br><span class="line">            <span class="built_in">read</span>(s[i][j]);</span><br><span class="line">            <span class="keyword">if</span> (s[i][j] == <span class="number">0</span>)</span><br><span class="line">                s[i][j] = sx;</span><br><span class="line">            <span class="keyword">if</span> (s[i][j] == <span class="number">-1</span>)</span><br><span class="line">                s[i][j] = tx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">0</span>; w &lt;= <span class="number">750</span>; ++w) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">2</span>; ++i)</span><br><span class="line">            pt[i][w] = ++num;</span><br><span class="line">        maxflow.<span class="built_in">addedge</span>(ss, pt[sx][w], INF);</span><br><span class="line">        maxflow.<span class="built_in">addedge</span>(pt[tx][w], tt, INF);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; w &amp;&amp; i &lt;= n + <span class="number">2</span>; ++i)</span><br><span class="line">            maxflow.<span class="built_in">addedge</span>(pt[i][w - <span class="number">1</span>], pt[i][w], INF);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; w &amp;&amp; i &lt;= m; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> u = s[i][(w - <span class="number">1</span>) % r[i]];</span><br><span class="line">            <span class="type">int</span> v = s[i][w % r[i]];</span><br><span class="line">            maxflow.<span class="built_in">addedge</span>(pt[u][w - <span class="number">1</span>], pt[v][w], h[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (maxflow.<span class="built_in">maxflow</span>(ss, tt) &gt;= k)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">write</span>(w), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>), <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P1251 é¤å·¾è®¡åˆ’é—®é¢˜</title>
    <url>/2021/12/22/sol-p1251/</url>
    <content><![CDATA[<h2 id="P1251-é¤å·¾è®¡åˆ’é—®é¢˜"><a href="#P1251-é¤å·¾è®¡åˆ’é—®é¢˜" class="headerlink" title="P1251 é¤å·¾è®¡åˆ’é—®é¢˜"></a>P1251 é¤å·¾è®¡åˆ’é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P1251">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¢˜ç›®ä¸­å·²ç»æš—ç¤ºäº†è¦ç”¨è´¹ç”¨æµã€‚</p>
<p>ä½¿ç”¨æµæ¨¡å‹ï¼Œæµè¡¨ç¤ºé¤å·¾çš„æ•°é‡ã€‚ä½†æ˜¯ä¸æ˜“å¤„ç†é¤å·¾å¹²å‡€ä¸å¦ï¼Œæ‰€ä»¥æ‹†ç‚¹ï¼Œå°†ä¸€å¤©æ‹†æˆä¸¤ä¸ªç‚¹ï¼Œåˆ†åˆ«è¡¨ç¤ºè¿™å¤©æ‹¥æœ‰çš„å¹²å‡€é¤å·¾æ•°é‡å’Œè„çš„é¤å·¾æ•°é‡ã€‚ä¸ºæ–¹ä¾¿è¡¨è¿°ï¼Œåˆ†åˆ«è®¾ä¸º$used<em>{i,0}$å’Œ$used</em>{i,1}$ã€‚</p>
<p>ç”±äºæ¯å¤©éœ€è¦ä½¿ç”¨$r<em>i$å—é¤å·¾ï¼Œæ‰€ä»¥è®©$used</em>{i,0}$è¿å‘æ±‡ç‚¹$T$ï¼Œè´¹ç”¨ä¸º$0$ï¼Œæµé‡ä¸º$r<em>i$ï¼Œè¡¨ç¤ºè¿™å¤©è‡³å°‘éœ€è¦æ‹¥æœ‰$r_i$å—å¹²å‡€é¤å·¾ã€‚åŒæ—¶è®©æºç‚¹$S$è¿å‘$used</em>{i,1}$ï¼Œè´¹ç”¨ä¸º$0$ï¼Œæµé‡ä¸º$r_i$ï¼Œè¡¨ç¤ºè¿™å¤©è¿‡åä¼šå¤šå‡º$r_i$å—è„çš„é¤å·¾ã€‚</p>
<p>æ¥ä¸‹æ¥è€ƒè™‘è´­ä¹°é¤å·¾ï¼Œæ˜¾ç„¶å¯ä»¥ç›´æ¥ä»$S$è¿å‘$used<em>{i,0}$ï¼Œè´¹ç”¨ä¸º$p$ï¼Œæµé‡ä¸º$+\infty$ã€‚è€Œä½¿ç”¨å¿«æ´—éƒ¨åˆ™ä»$used</em>{i,1}$è¿å‘$used<em>{i+m,0}$ï¼Œè´¹ç”¨ä¸º$f$ï¼Œæµé‡ä¸º$+\infty$ã€‚åŒç†ï¼Œæ…¢æ´—éƒ¨$used</em>{i,1}$è¿å‘$used<em>{i+n,0}$ï¼Œè´¹ç”¨ä¸º$s$ï¼Œæµé‡ä¸º$+\infty$ã€‚å¦ä¸€ç§ä¿ç•™é¤å·¾åˆ™$used</em>{i,1}$è¿å‘$used_{i+1,1}$ï¼Œè´¹ç”¨ä¸º$0$ï¼Œæµé‡ä¸º$+\infty$ã€‚</p>
<p>å½¢å¼åŒ–åœ°ï¼Œå®šä¹‰å‡½æ•°<code>addedge(u, v, cost, flow)</code>ï¼Œåˆ™éœ€è¦</p>
<ol>
<li><code>addedge(used[i][0], T, 0, r[i])</code></li>
<li><code>addedge(S, used[i][1], 0, r[i])</code></li>
<li><code>addedge(S, used[i][0], p, INF)</code></li>
<li><code>if (i + 1 &lt;= N) addedge(used[i][1], used[i + 1][1], 0, INF)</code></li>
<li><code>if (i + m &lt;= N) addedge(used[i][1], used[i + m][0], f, INF)</code></li>
<li><code>if (i + n &lt;= N) addedge(used[i][1], used[i + n][0], s, INF)</code></li>
</ol>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P1251.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P1251</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, cost, flow;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, cost = <span class="number">0</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], dis[MAXN], cur[MAXN];</span><br><span class="line">    <span class="type">bool</span> vis[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> cost, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, cost, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, -cost, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis));</span><br><span class="line">        <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>, vis[s] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>(), vis[u] = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &gt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="literal">true</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[u] + edge[i].cost != dis[v])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            cost += edge[i].cost * tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(cur, head, <span class="built_in">sizeof</span>(cur));</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, qp, qm, qf, qn, qs;</span><br><span class="line"><span class="type">int</span> a[MAXN], used[MAXN][<span class="number">2</span>];</span><br><span class="line">Dinic mcmf;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">read</span>(qp), <span class="built_in">read</span>(qm), <span class="built_in">read</span>(qf), <span class="built_in">read</span>(qn), <span class="built_in">read</span>(qs);</span><br><span class="line">    <span class="type">int</span> s = <span class="number">1</span>, t = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        used[i][<span class="number">0</span>] = i * <span class="number">2</span> + <span class="number">1</span>, used[i][<span class="number">1</span>] = i * <span class="number">2</span> + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        mcmf.<span class="built_in">addedge</span>(used[i][<span class="number">0</span>], t, <span class="number">0</span>, a[i]);</span><br><span class="line">        mcmf.<span class="built_in">addedge</span>(s, used[i][<span class="number">1</span>], <span class="number">0</span>, a[i]);</span><br><span class="line">        mcmf.<span class="built_in">addedge</span>(s, used[i][<span class="number">0</span>], qp, INF);</span><br><span class="line">        <span class="keyword">if</span> (i + <span class="number">1</span> &lt;= n)</span><br><span class="line">            mcmf.<span class="built_in">addedge</span>(used[i][<span class="number">1</span>], used[i + <span class="number">1</span>][<span class="number">1</span>], <span class="number">0</span>, INF);</span><br><span class="line">        <span class="keyword">if</span> (i + qm &lt;= n)</span><br><span class="line">            mcmf.<span class="built_in">addedge</span>(used[i][<span class="number">1</span>], used[i + qm][<span class="number">0</span>], qf, INF);</span><br><span class="line">        <span class="keyword">if</span> (i + qn &lt;= n)</span><br><span class="line">            mcmf.<span class="built_in">addedge</span>(used[i][<span class="number">1</span>], used[i + qn][<span class="number">0</span>], qs, INF);</span><br><span class="line">    &#125;</span><br><span class="line">    mcmf.<span class="built_in">mcmf</span>(s, t);</span><br><span class="line">    <span class="built_in">write</span>(mcmf.cost), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4016 è´Ÿè½½å¹³è¡¡é—®é¢˜</title>
    <url>/2021/12/21/sol-p4016/</url>
    <content><![CDATA[<h2 id="P4016-è´Ÿè½½å¹³è¡¡é—®é¢˜"><a href="#P4016-è´Ÿè½½å¹³è¡¡é—®é¢˜" class="headerlink" title="P4016 è´Ÿè½½å¹³è¡¡é—®é¢˜"></a>P4016 è´Ÿè½½å¹³è¡¡é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ˜¾ç„¶æœ‰è´ªå¿ƒè§£æ³•ï¼Œä½†ä¸ºäº†ç»ƒä¹ è´¹ç”¨æµé€‰æ‹©ä½¿ç”¨ç½‘ç»œæµè§£æ³•ã€‚</p>
<p>ç¬¬ä¸€æ¬¡å†™$spfa$å’Œè´¹ç”¨æµï¼Œæ²¡æƒ³åˆ°ä¼šå‡ºç°è¿™ä¹ˆå¤šé—®é¢˜ã€‚ã€‚ã€‚</p>
<p>æœ‰å‡ ä¸ªè¦æ³¨æ„çš„ç‚¹ï¼š</p>
<ol>
<li>è´¹ç”¨æµå»ºåè¾¹çš„$cost$æ˜¯åŸæ¥çš„$cost$çš„<strong>ç›¸åæ•°</strong>ï¼Œå³éœ€è¦<code>add(u, v, c, f), add(v, u, -c, 0);</code></li>
<li>è®¡ç®—æµé‡çš„æ–¹å¼å’Œæ™®é€šç½‘ç»œæµç›¸åŒï¼Œä½†æ˜¯è®¡ç®—æ€»$cost$æ˜¯æ¯æ¬¡åŠ ä¸Š<code>edge.cost * flow</code>ï¼Œ<strong>ä¸è¦å¿˜è®°ä¹˜ä¸Š$cost$</strong>ï¼Œç”¨å…¨å±€å˜é‡å­˜$cost$ä¼šå¥½å†™ä¸€äº›ã€‚</li>
<li>ç”±äºè´¹ç”¨æµçš„è¾¹æƒå¯èƒ½$\le 0$ï¼Œæ‰€ä»¥<strong>å¿…é¡»</strong>ç”¨$spfa$è€Œæ— æ³•ä½¿ç”¨$dijkstra$ï¼Œå¹¶ä¸”$dfs$<strong>å¢å¹¿æ—¶å¿…é¡»å¼€$vis$æ•°ç»„é˜²æ­¢æ— é™é€’å½’</strong>ã€‚</li>
<li>ï¼ˆè¿™åº”è¯¥ç®—æ˜¯ä¸ªå°$tip$ï¼‰ç½‘ç»œæµ$tot$ä¸€å¼€å§‹æ¸…ç©ºæˆ$1$å¯ä»¥ä¸éœ€è¦å†è°ƒç”¨<code>init</code>å‡½æ•°ï¼Œä¹Ÿä¸éœ€è¦å†æŠŠ$head$æ¸…ç©ºæˆ$-1$ã€‚</li>
</ol>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4016.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4016</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">150</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>, cost = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], dis[MAXN], cur[MAXN];</span><br><span class="line">    <span class="type">bool</span> vis[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXN, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXN, INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>, vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>(), vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &gt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v])</span><br><span class="line">                        que.<span class="built_in">push</span>(v), vis[v] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXN, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, a[MAXN];</span><br><span class="line">Dinic nf;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]), num += a[i];</span><br><span class="line">    num /= n;</span><br><span class="line">    <span class="type">int</span> s = n + <span class="number">1</span>, t = n + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] &gt; num)</span><br><span class="line">            nf.<span class="built_in">addedge</span>(s, i, a[i] - num, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (a[i] &lt; num)</span><br><span class="line">            nf.<span class="built_in">addedge</span>(i, t, num - a[i], <span class="number">0</span>);</span><br><span class="line">        nf.<span class="built_in">addedge</span>(i, i % n + <span class="number">1</span>, INF, <span class="number">1</span>);</span><br><span class="line">        nf.<span class="built_in">addedge</span>(i % n + <span class="number">1</span>, i, INF, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    nf.<span class="built_in">mcmf</span>(s, t);</span><br><span class="line">    <span class="built_in">write</span>(nf.cost), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4011 å­¤å²›è¥æ•‘é—®é¢˜</title>
    <url>/2021/12/21/sol-p4011/</url>
    <content><![CDATA[<h2 id="P4011-å­¤å²›è¥æ•‘é—®é¢˜"><a href="#P4011-å­¤å²›è¥æ•‘é—®é¢˜" class="headerlink" title="P4011 å­¤å²›è¥æ•‘é—®é¢˜"></a>P4011 å­¤å²›è¥æ•‘é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4011">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ˜¾ç„¶çš„çŠ¶å‹åˆ†å±‚$BFS$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4011.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4011</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">15</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">1</span> &lt;&lt; <span class="number">11</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> DX[<span class="number">4</span>] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> DY[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> x, y, s;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, p, k, s, a[MAXN][MAXN], dis[MAXN][MAXN][MAXK], g[MAXN][MAXN][MAXN][MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(p);</span><br><span class="line">    <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> tx1, ty1, tx2, ty2, tg;</span><br><span class="line">        <span class="built_in">read</span>(tx1), <span class="built_in">read</span>(ty1), <span class="built_in">read</span>(tx2), <span class="built_in">read</span>(ty2), <span class="built_in">read</span>(tg);</span><br><span class="line">        g[tx1][ty1][tx2][ty2] |= <span class="number">1</span> &lt;&lt; tg;</span><br><span class="line">        g[tx2][ty2][tx1][ty1] |= <span class="number">1</span> &lt;&lt; tg;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">read</span>(s);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= s; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> tx, ty, tq;</span><br><span class="line">        <span class="built_in">read</span>(tx), <span class="built_in">read</span>(ty), <span class="built_in">read</span>(tq);</span><br><span class="line">        a[tx][ty] |= <span class="number">1</span> &lt;&lt; tq;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    queue&lt;node&gt; que;</span><br><span class="line">    que.<span class="built_in">push</span>(&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;);</span><br><span class="line">    dis[<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ans = INF;</span><br><span class="line">    <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        node t = que.<span class="built_in">front</span>();</span><br><span class="line">        que.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="type">int</span> x = t.x, y = t.y, s = t.s;</span><br><span class="line">        <span class="keyword">if</span> (x == n &amp;&amp; y == m)</span><br><span class="line">            ans = <span class="built_in">min</span>(ans, dis[x][y][s]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> tx = x + DX[i];</span><br><span class="line">            <span class="type">int</span> ty = y + DY[i];</span><br><span class="line">            <span class="keyword">if</span> (tx &lt; <span class="number">1</span> || ty &lt; <span class="number">1</span> || tx &gt; n || ty &gt; m)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> ((g[x][y][tx][ty] &amp; s) != g[x][y][tx][ty])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> ts = s | a[tx][ty];</span><br><span class="line">            <span class="keyword">if</span> (dis[tx][ty][ts] != <span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            dis[tx][ty][ts] = dis[x][y][s] + <span class="number">1</span>;</span><br><span class="line">            que.<span class="built_in">push</span>(&#123;tx, ty, ts&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(ans == INF ? <span class="number">-1</span> : ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P276 è½¯ä»¶è¡¥ä¸é—®é¢˜</title>
    <url>/2021/12/20/sol-p2761/</url>
    <content><![CDATA[<h2 id="P276-è½¯ä»¶è¡¥ä¸é—®é¢˜"><a href="#P276-è½¯ä»¶è¡¥ä¸é—®é¢˜" class="headerlink" title="P276 è½¯ä»¶è¡¥ä¸é—®é¢˜"></a>P276 è½¯ä»¶è¡¥ä¸é—®é¢˜</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2761">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>è¿™é¢˜<strong>ä¸æ˜¯ç½‘ç»œæµï¼</strong></p>
<p>çŠ¶å‹+æœ€çŸ­è·¯å³å¯ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2761.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2761</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">200</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> u, dis;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dis &gt; o.dis;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">bugfix</span> &#123;</span><br><span class="line">    <span class="type">int</span> c, b1, b2, f1, f2;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, dis[MAXM];</span><br><span class="line">bugfix g[MAXN];</span><br><span class="line"><span class="type">char</span> buf[MAXN];</span><br><span class="line">priority_queue&lt;node&gt; que;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="built_in">read</span>(g[i].c);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (buf[j] == <span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">                g[i].b1 |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">            <span class="keyword">if</span> (buf[j] == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">                g[i].b2 |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (buf[j] == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">                g[i].f1 |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">            <span class="keyword">if</span> (buf[j] == <span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">                g[i].f2 |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    dis[(<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    que.<span class="built_in">push</span>(&#123;(<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>, <span class="number">0ll</span>&#125;);</span><br><span class="line">    <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        node t = que.<span class="built_in">top</span>();</span><br><span class="line">        que.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (dis[t.u] &lt; t.dis)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> u = t.u, d = t.dis;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">            bugfix&amp; b = g[i];</span><br><span class="line">            <span class="keyword">if</span> ((u &amp; b.b1) == b.b1 &amp;&amp; (u &amp; b.b2) == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="type">int</span> v = (u &amp; (~b.f1)) | b.f2;</span><br><span class="line">                <span class="keyword">if</span> (dis[v] &gt; dis[u] + b.c) &#123;</span><br><span class="line">                    dis[v] = dis[u] + b.c;</span><br><span class="line">                    que.<span class="built_in">push</span>(&#123;v, dis[v]&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dis[<span class="number">0</span>] == INF)</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">write</span>(dis[<span class="number">0</span>]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2756 é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜</title>
    <url>/2021/12/20/sol-p2756/</url>
    <content><![CDATA[<h2 id="P2756-é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜"><a href="#P2756-é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜" class="headerlink" title="P2756 é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜"></a>P2756 é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜</h2><span id="more"></span>
<p>åšäº†å‡ é“è“è‰²çš„æ°´é¢˜</p>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2756">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>äºŒåˆ†å›¾ç½‘ç»œæµæ¿å­ï¼Œç”¨æ¥å¼ºè¿«è‡ªå·±æ•²ä¸€é$dinic$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2756.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2756</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">350</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">edges</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, w, next;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> n, tot, head[MAXN];</span><br><span class="line">    <span class="type">int</span> cur[MAXN], lev[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n, tot = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fill</span>(head, head + n + <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        edge[tot] = &#123;v, w, head[u]&#125;;</span><br><span class="line">        head[u] = tot++;</span><br><span class="line">        edge[tot] = &#123;u, <span class="number">0</span>, head[v]&#125;;</span><br><span class="line">        head[v] = tot++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(lev, lev + n + <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s), lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; ~i; i = edge[i].next) &#123;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].w &amp;&amp; lev[edge[i].v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[edge[i].v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(edge[i].v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; ~i; i = edge[i].next) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v, w = edge[i].w;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">dfs</span>(v, t, <span class="built_in">min</span>(mx, w));</span><br><span class="line">            edge[i].w -= tmp, edge[i ^ <span class="number">1</span>].w += tmp;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + n + <span class="number">1</span>, cur);</span><br><span class="line">            ret += <span class="built_in">dfs</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, s, t;</span><br><span class="line">dinic nf;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(m), <span class="built_in">read</span>(n);</span><br><span class="line">    s = n + <span class="number">1</span>, t = n + <span class="number">2</span>;</span><br><span class="line">    nf.<span class="built_in">init</span>(n + <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        nf.<span class="built_in">addedge</span>(s, i, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = m + <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        nf.<span class="built_in">addedge</span>(i, t, <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;u, &amp;v), u != <span class="number">-1</span> &amp;&amp; v != <span class="number">-1</span>)</span><br><span class="line">        nf.<span class="built_in">addedge</span>(u, v, INF);</span><br><span class="line">    <span class="built_in">write</span>(nf.<span class="built_in">maxflow</span>(s, t)), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nf.tot; i += <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> (nf.edge[i].w == INF - <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, nf.edge[i ^ <span class="number">1</span>].v, nf.edge[i].v);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3181 [HAOI2016] æ‰¾ç›¸åŒå­—ç¬¦ä¸²</title>
    <url>/2021/12/19/sol-p3181/</url>
    <content><![CDATA[<h2 id="P3181-HAOI2016-æ‰¾ç›¸åŒå­—ç¬¦ä¸²"><a href="#P3181-HAOI2016-æ‰¾ç›¸åŒå­—ç¬¦ä¸²" class="headerlink" title="P3181 [HAOI2016] æ‰¾ç›¸åŒå­—ç¬¦ä¸²"></a>P3181 [HAOI2016] æ‰¾ç›¸åŒå­—ç¬¦ä¸²</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3181">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å‡è®¾æˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•è®¡ç®—å•ä¸€ä¸²çš„ç­”æ¡ˆï¼Œä¹‹åå¯ä»¥å°†ä¸¤ä¸ªä¸²æ‹¼æ¥ï¼Œä¸­é—´é—´éš”å­—ç¬¦<code>$</code>ï¼Œç®—å‡ºæ–°ä¸²çš„ç­”æ¡ˆã€‚ä½†æ˜¯è¿™æ ·ä¼šé‡å¤è®¡ç®—ä¸¤ä¸ªå­ä¸²åœ¨åŒä¸€ä¸ªåŸä¸²ï¼Œæ‰€ä»¥è¿˜éœ€å‡å»ä¸¤ä¸ªåŸä¸²çš„ç­”æ¡ˆã€‚å³$ans=ans<em>s-ans</em>{s1}-ans_{s2}$ã€‚</p>
<p>ç°åœ¨åªéœ€è€ƒè™‘å¦‚ä½•ç®—å‡ºä¸€ä¸ªå•ä¸€ä¸²çš„ç­”æ¡ˆã€‚æ ¹æ®åç¼€æ•°ç»„çš„æ€§è´¨ï¼Œæ˜¾ç„¶ç­”æ¡ˆä¸º</p>
<script type="math/tex; mode=display">
\begin{aligned}
ans_s &= \sum_{1 \le i \lt j \le n}{|lcp(suf_i, suf_j)|} \\
&= \sum_{1 \le i \lt j \le n}{\min_{i \lt sa_k \le j}{height(k)}}
\end{aligned}</script><p>ç®—å‡ºæ¯ä¸ª$height$å¯¹$ans$çš„è´¡çŒ®$(i - pre_i) \times (nxt_i - i) \times height(i)$ï¼Œå…¶ä¸­$pre_i$è¡¨ç¤ºå‰ä¸€ä¸ª<strong>å°äº</strong>$height(i)$çš„ä½ç½®ï¼Œ$nxt_i$è¡¨ç¤ºåä¸€ä¸ª<strong>å°äºç­‰äº</strong>$height_i$çš„ä½ç½®ã€‚å•è°ƒæ ˆç»´æŠ¤ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \log n)$ï¼Œä½†æ˜¾ç„¶å¯ä»¥é€šè¿‡ä½¿ç”¨æ›´é«˜çº§çš„$SA$ä¼˜åŒ–åˆ°$O(n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3181.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3181</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">4e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">suffix_array</span> &#123;</span><br><span class="line">    <span class="type">char</span> *str;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buk[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buk[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] += buk[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buk[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;str = s;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">128</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">0</span>, w = <span class="number">1</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">calc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>, top;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> pre[MAXN], nxt[MAXN], sta[MAXN];</span><br><span class="line">        sta[top = <span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">while</span> (top &amp;&amp; ht[sa[sta[top]]] &gt;= ht[sa[i]])</span><br><span class="line">                --top;</span><br><span class="line">            pre[i] = i - sta[top];</span><br><span class="line">            sta[++top] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        sta[top = <span class="number">0</span>] = n + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i) &#123;</span><br><span class="line">            <span class="keyword">while</span> (top &amp;&amp; ht[sa[sta[top]]] &gt; ht[sa[i]])</span><br><span class="line">                --top;</span><br><span class="line">            nxt[i] = sta[top] - i;</span><br><span class="line">            sta[++top] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            ret += pre[i] * nxt[i] * ht[sa[i]];</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n0, n1, n2;</span><br><span class="line"><span class="type">char</span> s0[MAXN], s1[MAXN], s2[MAXN];</span><br><span class="line">suffix_array sa0, sa1, sa2;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%s&quot;</span>, s1 + <span class="number">1</span>, s2 + <span class="number">1</span>);</span><br><span class="line">    n1 = <span class="built_in">strlen</span>(s1 + <span class="number">1</span>);</span><br><span class="line">    n2 = <span class="built_in">strlen</span>(s2 + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">copy</span>(s1 + <span class="number">1</span>, s1 + n1 + <span class="number">1</span>, s0 + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">copy</span>(s2 + <span class="number">1</span>, s2 + n2 + <span class="number">1</span>, s0 + n1 + <span class="number">2</span>);</span><br><span class="line">    s0[n1 + <span class="number">1</span>] = <span class="string">&#x27;$&#x27;</span>, n0 = n1 + n2 + <span class="number">1</span>;</span><br><span class="line">    sa0.<span class="built_in">build</span>(s0, n0);</span><br><span class="line">    sa1.<span class="built_in">build</span>(s1, n1);</span><br><span class="line">    sa2.<span class="built_in">build</span>(s2, n2);</span><br><span class="line">    <span class="type">int</span> ans = sa0.<span class="built_in">calc</span>() - sa1.<span class="built_in">calc</span>() - sa2.<span class="built_in">calc</span>();</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>[AHOI2013] å·®å¼‚ é¢˜è§£</title>
    <url>/2021/12/17/sol-p4248/</url>
    <content><![CDATA[<h2 id="AHOI2013-å·®å¼‚-é¢˜è§£"><a href="#AHOI2013-å·®å¼‚-é¢˜è§£" class="headerlink" title="[AHOI2013] å·®å¼‚ é¢˜è§£"></a>[AHOI2013] å·®å¼‚ é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4248">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ä½¿ç”¨åç¼€æ•°ç»„æ±‚å‡º$height$æ•°ç»„ï¼ˆç®€å†™ä¸º$ht$ï¼‰ï¼Œç­”æ¡ˆå˜æˆäº†</p>
<script type="math/tex; mode=display">ans = \sum\limits_{1 \le i \lt j \le n}{len(T_i) + len(T_j) - 2 \times \min\limits_{k=i+1}^{j}{ht_k}}</script><p>åŒ–ç®€ï¼Œå¾—</p>
<script type="math/tex; mode=display">ans = \frac{n \times (n + 1) \times (n - 1)}{2} - 2\times\sum\limits_{1 \le i \lt j \le n}{\min\limits_{k=i+1}^{j}{ht_k}}</script><p>æ±‚å’Œç¬¦å·é‡Œçš„ç”¨å•è°ƒæ ˆç»´æŠ¤ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \log n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4248.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4248</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">suffix_array</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buk[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buk[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] += buk[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buk[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">0</span>, w = <span class="number">1</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, top;</span><br><span class="line">pii sta[MAXN];</span><br><span class="line"><span class="type">char</span> s[MAXN];</span><br><span class="line">suffix_array sa;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    sa.<span class="built_in">init</span>(s, n);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">    sta[top = <span class="number">1</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> p = sa.sa[i];</span><br><span class="line">        <span class="keyword">while</span> (top &amp;&amp; sta[top].fi &gt;= sa.ht[p])</span><br><span class="line">            sum -= sta[top].fi * (sta[top].se - sta[top - <span class="number">1</span>].se), --top;</span><br><span class="line">        sta[++top] = &#123;sa.ht[p], i&#125;, sum += sta[top].fi * (sta[top].se - sta[top - <span class="number">1</span>].se);</span><br><span class="line">        ans += sum;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = (n * (n + <span class="number">1</span>) * (n - <span class="number">1</span>)) / <span class="number">2</span> - ans * <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4051 [JSOI2007] å­—ç¬¦åŠ å¯† é¢˜è§£</title>
    <url>/2021/12/17/sol-p4051/</url>
    <content><![CDATA[<h2 id="P4051-JSOI2007-å­—ç¬¦åŠ å¯†-é¢˜è§£"><a href="#P4051-JSOI2007-å­—ç¬¦åŠ å¯†-é¢˜è§£" class="headerlink" title="P4051 [JSOI2007] å­—ç¬¦åŠ å¯† é¢˜è§£"></a>P4051 [JSOI2007] å­—ç¬¦åŠ å¯† é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4051">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ˜¾ç„¶ç›´æ¥æ±‚åç¼€æ•°ç»„çæã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4051.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4051</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">suffix_array</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buk[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buk[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] += buk[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buk[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">128</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">0</span>, w = <span class="number">1</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">char</span> s[MAXN];</span><br><span class="line">suffix_array sa;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        s[i + n] = s[i];</span><br><span class="line">    sa.<span class="built_in">init</span>(s, n + n);</span><br><span class="line">    <span class="type">int</span> pos = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n + n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (sa.sa[i] &lt;= n)</span><br><span class="line">            <span class="built_in">putchar</span>(s[sa.sa[i] + n - <span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2408 ä¸åŒå­ä¸²ä¸ªæ•° é¢˜è§£</title>
    <url>/2021/12/17/sol-p2408/</url>
    <content><![CDATA[<h2 id="P2408-ä¸åŒå­ä¸²ä¸ªæ•°-é¢˜è§£"><a href="#P2408-ä¸åŒå­ä¸²ä¸ªæ•°-é¢˜è§£" class="headerlink" title="P2408 ä¸åŒå­ä¸²ä¸ªæ•° é¢˜è§£"></a>P2408 ä¸åŒå­ä¸²ä¸ªæ•° é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2408">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ ¹æ®<a href="/2021/12/17/top-suffixarray/" title="åç¼€æ•°ç»„">åç¼€æ•°ç»„</a>çš„å®šä¹‰ï¼Œ$ans = \frac{n \times (n + 1)}{2} - \sum\limits_{i=1}^{n}{ht_i}$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2408.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2408</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">suffix_array</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buk[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buk[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] += buk[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buk[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">0</span>, w = <span class="number">1</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">char</span> s[MAXN];</span><br><span class="line">suffix_array sa;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    sa.<span class="built_in">init</span>(s, n);</span><br><span class="line">    <span class="type">int</span> ans = n * (n + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ans -= sa.ht[i];</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>sol-loj6184</title>
    <url>/2021/12/17/sol-loj6184/</url>
    <content><![CDATA[<h2 id=""><a href="#" class="headerlink" title=" "></a> </h2><span id="more"></span>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ä¸“é¢˜ã€‘å¤šé¡¹å¼</title>
    <url>/2021/12/17/top-poly/</url>
    <content><![CDATA[<h2 id="ã€ä¸“é¢˜ã€‘å¤šé¡¹å¼"><a href="#ã€ä¸“é¢˜ã€‘å¤šé¡¹å¼" class="headerlink" title="ã€ä¸“é¢˜ã€‘å¤šé¡¹å¼"></a>ã€ä¸“é¢˜ã€‘å¤šé¡¹å¼</h2><p>ä¸»è¦ä¸º$FFT$ï¼Œ$NTT$ï¼Œå¤šé¡¹å¼æ±‚é€†ç­‰å˜æ¢ï¼Œå¯ä»¥å’Œç”Ÿæˆå‡½æ•°ç»“åˆèµ·æ¥è€ƒè®¡æ•°é¢˜ã€‚<a href="/2021/11/28/sol-p3803/" title="è¿™ç¯‡é¢˜è§£">è¿™ç¯‡é¢˜è§£</a>ä¸­æœ‰å¯¹å¤šé¡¹å¼ä¹˜æ³•çš„è¾ƒè¯¦ç»†è¯æ˜è¿‡ç¨‹ã€‚</p>
<p>å¯¹äºä½¿ç”¨ç”Ÿæˆå‡½æ•°åˆ¤æ–­æ–¹æ¡ˆæ˜¯å¦åˆæ³•ï¼ˆè€Œä¸æ˜¯ç»Ÿè®¡æ–¹æ¡ˆçš„æ•°é‡ï¼‰ï¼Œä½¿ç”¨å•æ¨¡æ•°å®¹æ˜“è¢«å¡ï¼Œå»ºè®®åœ¨$998244353$ï¼Œ$1004535809$å’Œ$469762049$ä¸­é€‰å–ä¸¤ä¸ªï¼Œå…¶åŸæ ¹éƒ½ä¸º$3$ã€‚</p>
<p>è‹¥é¢˜ç›®ä¸­è¦æ±‚å¯¹å¥‡æ€ªçš„æ•°å–æ¨¡ï¼Œä¸€å®šè®°å¾—è®¡ç®—æ¨¡æ•°çš„åŸæ ¹ï¼Œæœ‰å¯èƒ½ä¸æ˜¯$3$ï¼</p>
<span id="more"></span>
<h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><a href="/2021/11/28/sol-p3803/" title="P3803 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼ä¹˜æ³•ï¼ˆFFTï¼‰">P3803 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼ä¹˜æ³•ï¼ˆFFTï¼‰</a> </br>

<a href="/2021/12/05/sol-p4245/" title="P4245 ã€æ¨¡ç‰ˆã€‘ä»»æ„æ¨¡æ•°å¤šé¡¹å¼ä¹˜æ³•">P4245 ã€æ¨¡ç‰ˆã€‘ä»»æ„æ¨¡æ•°å¤šé¡¹å¼ä¹˜æ³•</a> </br>

<a href="/2021/12/05/sol-p4721/" title="P4721 ã€æ¨¡ç‰ˆã€‘åˆ†æ²»FFT é¢˜è§£">P4721 ã€æ¨¡ç‰ˆã€‘åˆ†æ²»FFT é¢˜è§£</a> </br>

<a href="/2021/12/05/sol-p4238/" title="P4238 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æ±‚é€† é¢˜è§£">P4238 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æ±‚é€† é¢˜è§£</a> </br>

<a href="/2021/12/05/sol-cf632e/" title="CF632E Thief in a Shop é¢˜è§£">CF632E Thief in a Shop é¢˜è§£</a> </br>

<a href="/2022/01/02/sol-cf986d/" title="CF986D Perfect Encoding">CF986D Perfect Encoding</a> </br>

<a href="/2022/01/03/sol-cf1613f/" title="CF1613F Tree Coloring">CF1613F Tree Coloring</a> </br>

<a href="/2022/01/03/sol-cf755g/" title="CF755G PolandBall and Many Other Balls">CF755G PolandBall and Many Other Balls</a> </br>

<a href="/2022/01/05/sol-cf623e/" title="CF623E Transforming Sequence">CF623E Transforming Sequence</a> </br>

<a href="/2022/01/07/sol-cf773f/" title="CF773F Test Data Generation">CF773F Test Data Generation</a> </br>

<a href="/2022/01/09/sol-cf553e/" title="CF553E Kyoya and Train">CF553E Kyoya and Train</a> </br>

<a href="/2022/01/18/sol-p4725/" title="P4725 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼lnï¼‰">P4725 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼lnï¼‰</a> </br>

<a href="/2022/01/18/sol-p4726/" title="P4726 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼expï¼‰">P4726 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼expï¼‰</a> </br>

<a href="/2022/01/17/sol-p4002/" title="P4002 ç”Ÿæˆæ ‘è®¡æ•°">P4002 ç”Ÿæˆæ ‘è®¡æ•°</a> </br>

<a href="/2022/01/20/sol-p5850/" title="P5850 calc">P5850 calc</a> </br>

<a href="/2022/01/25/sol-p4491/" title="P4491 [HAOI] æŸ“è‰²">P4491 [HAOI] æŸ“è‰²</a>
<h3 id="æ¨¡ç‰ˆä»£ç "><a href="#æ¨¡ç‰ˆä»£ç " class="headerlink" title="æ¨¡ç‰ˆä»£ç "></a>æ¨¡ç‰ˆä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">double</span> MPI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="comment">// const int MOD = 1004535809; // å¤‡ç”¨</span></span><br><span class="line"><span class="comment">// const int MOD = 469762049; // å¤‡ç”¨</span></span><br><span class="line"><span class="keyword">namespace</span> polynomial &#123;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x -= y;</span><br><span class="line">    <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = MOD)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % p)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x % p;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(_Tp* f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> rev[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span>* f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">change</span>(f, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">            <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                f[k] = <span class="built_in">add</span>(u, t), f[k + h / <span class="number">2</span>] = <span class="built_in">sub</span>(u, t);</span><br><span class="line">                g = g * gn % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">        <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            f[i] = f[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">polymul</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">const</span> <span class="type">int</span>* g, <span class="type">int</span> m, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN] = &#123;&#125;, tg[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n + m - <span class="number">1</span>)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">copy</span>(f, f + n, tf);</span><br><span class="line">    <span class="built_in">fill</span>(tf + n, tf + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">copy</span>(g, g + m, tg);</span><br><span class="line">    <span class="built_in">fill</span>(tg + m, tg + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(tf, len, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(tg, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        tf[i] = tf[i] * tg[i] % MOD;</span><br><span class="line">    <span class="built_in">ntt</span>(tf, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">copy</span>(tf, tf + n + m - <span class="number">1</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> n + m - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">polyinv</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tmp[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fill</span>(ans, ans + len + len, <span class="number">0</span>);</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="built_in">qpow</span>(f[<span class="number">0</span>], MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">copy</span>(f, f + h, tmp);</span><br><span class="line">        <span class="built_in">fill</span>(tmp + h, tmp + h + h, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">ntt</span>(tmp, h + h, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">ntt</span>(ans, h + h, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h + h; ++i)</span><br><span class="line">            ans[i] = ans[i] * (<span class="number">2</span> - ans[i] * tmp[i] % MOD + MOD) % MOD;</span><br><span class="line">        <span class="built_in">ntt</span>(ans, h + h, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(ans + h, ans + h + h, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">derivation</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i)</span><br><span class="line">        ans[i] = f[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">    <span class="keyword">return</span> ans[n - <span class="number">1</span>] = <span class="number">0</span>, n - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">integral</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        ans[i] = f[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, MOD - <span class="number">2</span>) % MOD;</span><br><span class="line">    <span class="keyword">return</span> ans[<span class="number">0</span>] = <span class="number">0</span>, n + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ln</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tf[MAXN] = &#123;&#125;, tg[MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="built_in">derivation</span>(f, n, tf);</span><br><span class="line">    <span class="built_in">polyinv</span>(f, n, tg);</span><br><span class="line">    <span class="built_in">polymul</span>(tf, n - <span class="number">1</span>, tg, n, ans);</span><br><span class="line">    <span class="built_in">integral</span>(ans, n - <span class="number">1</span>, ans);</span><br><span class="line">    <span class="built_in">fill</span>(ans + n, ans + n + n, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exp</span><span class="params">(<span class="type">const</span> <span class="type">int</span>* f, <span class="type">int</span> n, <span class="type">int</span>* ans)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tmp[MAXN] = &#123;&#125;;</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">1</span>, ans[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= (n &lt;&lt; <span class="number">1</span>); h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">ln</span>(ans, h, tmp);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; h; ++i)</span><br><span class="line">            tmp[i] = <span class="built_in">add</span>(i == <span class="number">0</span>, <span class="built_in">sub</span>(f[i], tmp[i]));</span><br><span class="line">        <span class="built_in">polymul</span>(ans, h, tmp, h, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;  <span class="comment">// namespace polynomial</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>ä¸“é¢˜</category>
      </categories>
      <tags>
        <tag>topics</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ä¸“é¢˜ã€‘è™šæ ‘</title>
    <url>/2021/12/17/top-virtualtree/</url>
    <content><![CDATA[<h2 id="ã€ä¸“é¢˜ã€‘è™šæ ‘"><a href="#ã€ä¸“é¢˜ã€‘è™šæ ‘" class="headerlink" title="ã€ä¸“é¢˜ã€‘è™šæ ‘"></a>ã€ä¸“é¢˜ã€‘è™šæ ‘</h2><p>è¿™ç§ä¸œè¥¿æƒ³åˆ°è¦ç”¨å¾ˆå®¹æ˜“ï¼Œå…³é”®æ˜¯å»ºå®Œè™šæ ‘åæ€ä¹ˆåšã€‚</p>
<p>è™šæ ‘é¢˜çš„ç‰¹å¾ä¸º<strong>å¤šæ¬¡è¯¢é—®ä¸”å‡ºç°$\sum M \le 10^5$ä¸€ç±»çš„æ•°æ®èŒƒå›´</strong>ã€‚</p>
<p>å¦‚æœé¢˜ç›®ç»™å‡ºçš„æ˜¯ä¸€å¼ å›¾è€Œä¸æ˜¯ä¸€æ£µæ ‘ï¼Œå¯ä»¥æ€è€ƒæ˜¯å¦èƒ½å¤Ÿç»“åˆåœ†æ–¹æ ‘ç­‰ç®—æ³•è½¬åŒ–ä¸ºè™šæ ‘ã€‚</p>
<p>å¯¹äºæ¯æ¬¡è¯¢é—®ï¼Œå°†è¯¢é—®çš„èŠ‚ç‚¹å’Œå…¶åœ¨åŸæ ‘ä¸Šçš„$LCA$å•ç‹¬å»ºå‡ºæ¥$dp$å³å¯ã€‚</p>
<span id="more"></span>
<h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><a href="/2021/11/27/sol-p2495/" title="P2495 æ¶ˆè€—æˆ˜ é¢˜è§£">P2495 æ¶ˆè€—æˆ˜ é¢˜è§£</a> </br>

<a href="/2021/11/29/sol-p4606/" title="P4606 æˆ˜ç•¥æ¸¸æˆ é¢˜è§£">P4606 æˆ˜ç•¥æ¸¸æˆ é¢˜è§£</a> </br>

<a href="/2021/11/27/sol-p3233/" title="P3233 ä¸–ç•Œæ ‘ é¢˜è§£">P3233 ä¸–ç•Œæ ‘ é¢˜è§£</a> </br>

<a href="/2021/12/01/sol-cf1320e/" title="CF1320E Treeland and Viruses é¢˜è§£">CF1320E Treeland and Viruses é¢˜è§£</a> </br>

<a href="/2021/12/03/sol-cf639f/" title="CF639F Bear and Chemistry é¢˜è§£">CF639F Bear and Chemistry é¢˜è§£</a> </br>

<a href="/2021/12/17/sol-loj6184/" title="sol-loj6184">sol-loj6184</a>
<h3 id="æ¨¡ç‰ˆä»£ç "><a href="#æ¨¡ç‰ˆä»£ç " class="headerlink" title="æ¨¡ç‰ˆä»£ç "></a>æ¨¡ç‰ˆä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_vtr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(s + <span class="number">1</span>, s + k + <span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">        <span class="keyword">return</span> id[x] &lt; id[y];</span><br><span class="line">    &#125;);</span><br><span class="line">    sta[top = <span class="number">1</span>] = <span class="number">1</span>, vtr.head[<span class="number">1</span>] = <span class="number">-1</span>, vtr.tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> l = <span class="built_in">lca</span>(sta[top], s[i]);</span><br><span class="line">        <span class="keyword">if</span> (l &lt; <span class="number">1</span> || l &gt; bcc)</span><br><span class="line">            <span class="built_in">lca</span>(sta[top], s[i]);</span><br><span class="line">        <span class="keyword">while</span> (id[l] &lt;= id[sta[top - <span class="number">1</span>]])</span><br><span class="line">            <span class="built_in">add_vedge</span>(sta[top - <span class="number">1</span>], sta[top]), --top;</span><br><span class="line">        <span class="keyword">if</span> (sta[top] != l)</span><br><span class="line">            vtr.head[l] = <span class="number">-1</span>, <span class="built_in">add_vedge</span>(l, sta[top]), sta[top] = l;</span><br><span class="line">        vtr.head[s[i]] = <span class="number">-1</span>, sta[++top] = s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; top; ++i)</span><br><span class="line">        <span class="built_in">add_vedge</span>(sta[i], sta[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ä¸“é¢˜</category>
      </categories>
      <tags>
        <tag>topics</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ä¸“é¢˜ã€‘ç½‘ç»œæµ</title>
    <url>/2021/12/17/top-networkflow/</url>
    <content><![CDATA[<h2 id="ã€ä¸“é¢˜ã€‘ç½‘ç»œæµ"><a href="#ã€ä¸“é¢˜ã€‘ç½‘ç»œæµ" class="headerlink" title="ã€ä¸“é¢˜ã€‘ç½‘ç»œæµ"></a>ã€ä¸“é¢˜ã€‘ç½‘ç»œæµ</h2><p>ç½‘ç»œæµçš„è¯ï¼Œå…ˆå£ç³Šå¥½æ€ä¹ˆå»ºå›¾ï¼Œç„¶å<del>å¤åˆ¶</del>é»˜å†™ä¸€ä¸‹æ¿å­å°±å¥½äº†ã€‚</p>
<p>éš¾ç‚¹å…¶å®æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯å¦‚ä½•å»ºå›¾ï¼Œå¦ä¸€ä¸ªæ˜¯è¾“å‡ºè·¯å¾„ã€‚</p>
<p>å¦‚æœä¸€é“é¢˜æœ‰è®¸å¤šå¥‡æ€ªçš„é™åˆ¶ï¼Œå¹¶ä¸”$n$å’Œ$m$å¾ˆå°ï¼Œå¯¼è‡´$O(n^2m)$å¯ä»¥é€šè¿‡ï¼Œå°±å¯ä»¥å¾€ç½‘ç»œæµæ–¹é¢å»æƒ³ã€‚</p>
<p><del>å…¶å®ç½‘ç»œæµ24é¢˜çš„å…¨ç§°å«ç½‘ç»œæµå’Œçº¿æ€§è§„åˆ’24é¢˜ï¼Ÿ</del></p>
<span id="more"></span>
<h3 id="è´¹ç”¨æµéœ€è¦æ³¨æ„çš„åœ°æ–¹"><a href="#è´¹ç”¨æµéœ€è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="è´¹ç”¨æµéœ€è¦æ³¨æ„çš„åœ°æ–¹"></a>è´¹ç”¨æµéœ€è¦æ³¨æ„çš„åœ°æ–¹</h3><ol>
<li>è´¹ç”¨æµå»ºåè¾¹çš„$cost$æ˜¯åŸæ¥çš„$cost$çš„<strong>ç›¸åæ•°</strong>ï¼Œå³éœ€è¦<code>add(u, v, c, f), add(v, u, -c, 0);</code></li>
<li>è®¡ç®—æµé‡çš„æ–¹å¼å’Œæ™®é€šç½‘ç»œæµç›¸åŒï¼Œä½†æ˜¯è®¡ç®—æ€»$cost$æ˜¯æ¯æ¬¡åŠ ä¸Š<code>edge.cost * flow</code>ï¼Œ<strong>ä¸è¦å¿˜è®°ä¹˜ä¸Š$cost$</strong>ï¼Œç”¨å…¨å±€å˜é‡å­˜$cost$ä¼šå¥½å†™ä¸€äº›ã€‚</li>
<li>ç”±äºè´¹ç”¨æµçš„è¾¹æƒå¯èƒ½$\le 0$ï¼Œæ‰€ä»¥<strong>å¿…é¡»</strong>ç”¨$spfa$è€Œæ— æ³•ä½¿ç”¨$dijkstra$ï¼Œå¹¶ä¸”$dfs$<strong>å¢å¹¿æ—¶å¿…é¡»å¼€$vis$æ•°ç»„é˜²æ­¢æ— é™é€’å½’</strong>ã€‚</li>
<li>ï¼ˆè¿™åº”è¯¥ç®—æ˜¯ä¸ªå°$tip$ï¼‰ç½‘ç»œæµ$tot$ä¸€å¼€å§‹æ¸…ç©ºæˆ$1$å¯ä»¥ä¸éœ€è¦å†è°ƒç”¨<code>init</code>å‡½æ•°ï¼Œä¹Ÿä¸éœ€è¦å†æŠŠ$head$æ¸…ç©ºæˆ$-1$ã€‚</li>
</ol>
<h3 id="æµæ¨¡å‹"><a href="#æµæ¨¡å‹" class="headerlink" title="æµæ¨¡å‹"></a>æµæ¨¡å‹</h3><a href="/2021/12/20/sol-p2756/" title="P2756 é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜">P2756 é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆé—®é¢˜</a> </br>

<a href="/2021/12/21/sol-p4016/" title="P4016 è´Ÿè½½å¹³è¡¡é—®é¢˜">P4016 è´Ÿè½½å¹³è¡¡é—®é¢˜</a> </br>

<a href="/2021/12/22/sol-p1251/" title="P1251 é¤å·¾è®¡åˆ’é—®é¢˜">P1251 é¤å·¾è®¡åˆ’é—®é¢˜</a> </br>

<a href="/2021/12/22/sol-p2754/" title="P2754 æ˜Ÿé™…è½¬ç§»é—®é¢˜">P2754 æ˜Ÿé™…è½¬ç§»é—®é¢˜</a> </br>

<a href="/2021/12/23/sol-p2763/" title="P2763 è¯•é¢˜åº“é—®é¢˜">P2763 è¯•é¢˜åº“é—®é¢˜</a> </br>

<a href="/2021/12/24/sol-p2764/" title="P2764 æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜">P2764 æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜</a> </br>

<a href="/2021/12/24/sol-p2765/" title="P2765 é­”æœ¯çƒé—®é¢˜">P2765 é­”æœ¯çƒé—®é¢˜</a> </br>

<a href="/2021/12/24/sol-p2766/" title="P2766 æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é—®é¢˜">P2766 æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é—®é¢˜</a> </br>

<a href="/2021/12/24/sol-p2770/" title="P2770 èˆªç©ºè·¯çº¿é—®é¢˜">P2770 èˆªç©ºè·¯çº¿é—®é¢˜</a> </br>

<a href="/2021/12/25/sol-p3254/" title="P3254 åœ†æ¡Œé—®é¢˜">P3254 åœ†æ¡Œé—®é¢˜</a> </br>

<a href="/2021/12/27/sol-p3356/" title="P3356 ç«æ˜Ÿæ¢é™©é—®é¢˜">P3356 ç«æ˜Ÿæ¢é™©é—®é¢˜</a> </br>

<a href="/2021/12/27/sol-p3357/" title="P3357 æœ€é•¿kå¯é‡çº¿æ®µé›†é—®é¢˜">P3357 æœ€é•¿kå¯é‡çº¿æ®µé›†é—®é¢˜</a> </br>

<a href="/2021/12/27/sol-p3358/" title="P3358 æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜">P3358 æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜</a> </br>

<a href="/2021/12/30/sol-p4012/" title="P4012 æ·±æµ·æœºå™¨äººé—®é¢˜">P4012 æ·±æµ·æœºå™¨äººé—®é¢˜</a> </br>

<a href="/2021/12/30/sol-p4013/" title="P4013 æ•°å­—æ¢¯å½¢é—®é¢˜">P4013 æ•°å­—æ¢¯å½¢é—®é¢˜</a> </br>

<a href="/2021/12/30/sol-p4014/" title="P4014 åˆ†é…é—®é¢˜">P4014 åˆ†é…é—®é¢˜</a> </br>

<a href="/2021/12/30/sol-p4015/" title="P4015 è¿è¾“é—®é¢˜">P4015 è¿è¾“é—®é¢˜</a>
<h3 id="å‰²æ¨¡å‹"><a href="#å‰²æ¨¡å‹" class="headerlink" title="å‰²æ¨¡å‹"></a>å‰²æ¨¡å‹</h3><a href="/2021/12/22/sol-p2762/" title="P2762 å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜">P2762 å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜</a> </br>

<a href="/2021/12/25/sol-p2774/" title="P2774 æ–¹æ ¼å–æ•°é—®é¢˜">P2774 æ–¹æ ¼å–æ•°é—®é¢˜</a> </br>

<a href="/2021/12/25/sol-p3355/" title="P3355 éª‘å£«å…±å­˜é—®é¢˜">P3355 éª‘å£«å…±å­˜é—®é¢˜</a>
<h3 id="éæ¨¡å‹"><a href="#éæ¨¡å‹" class="headerlink" title="éæ¨¡å‹"></a>éæ¨¡å‹</h3><a href="/2021/12/20/sol-p2761/" title="P276 è½¯ä»¶è¡¥ä¸é—®é¢˜">P276 è½¯ä»¶è¡¥ä¸é—®é¢˜</a> </br>

<a href="/2021/12/21/sol-p4011/" title="P4011 å­¤å²›è¥æ•‘é—®é¢˜">P4011 å­¤å²›è¥æ•‘é—®é¢˜</a> </br>

<a href="/2021/12/31/sol-p4009/" title="P4009 æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜">P4009 æ±½è½¦åŠ æ²¹è¡Œé©¶é—®é¢˜</a>
<h3 id="æ¨¡ç‰ˆä»£ç "><a href="#æ¨¡ç‰ˆä»£ç " class="headerlink" title="æ¨¡ç‰ˆä»£ç "></a>æ¨¡ç‰ˆä»£ç </h3><h4 id="ç½‘ç»œæµ-dinic"><a href="#ç½‘ç»œæµ-dinic" class="headerlink" title="ç½‘ç»œæµ(dinic)"></a>ç½‘ç»œæµ(dinic)</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow;</span><br><span class="line">    &#125; edge[MAXM * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, flow = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM * <span class="number">2</span>], lev[MAXN], cur[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(lev, lev + MAXN, <span class="number">-1</span>);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        lev[s] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; lev[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    lev[v] = lev[u] + <span class="number">1</span>;</span><br><span class="line">                    que.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lev[t] != <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (lev[v] != lev[u] + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXN, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; network;</span><br></pre></td></tr></table></figure>
<h4 id="ç½‘ç»œæµ-HLPP"><a href="#ç½‘ç»œæµ-HLPP" class="headerlink" title="ç½‘ç»œæµ (HLPP)"></a>ç½‘ç»œæµ (HLPP)</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">HLPP</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v; ll flow;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> n, s, t, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> head[MAXV], nxt[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> h[MAXV], gap[MAXV * <span class="number">2</span>], inq[MAXV];</span><br><span class="line">    ll e[MAXV];</span><br><span class="line">    priority_queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; pq;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">this</span>-&gt;n = n; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, ll f)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, f&#125;, nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>&#125;, nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> fr = <span class="number">0</span>, bk = <span class="number">0</span>;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> que[MAXN];</span><br><span class="line">        <span class="built_in">fill</span>(h + <span class="number">1</span>, h + n + <span class="number">1</span>, INF);</span><br><span class="line">        h[t] = <span class="number">0</span>, que[++bk] = t;</span><br><span class="line">        <span class="keyword">while</span> (fr &lt; bk) &#123;</span><br><span class="line">            <span class="type">int</span> u = que[++fr];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i])</span><br><span class="line">                <span class="keyword">if</span> (h[edge[i].v] &gt; h[u] + <span class="number">1</span> &amp;&amp; edge[i ^ <span class="number">1</span>].flow)</span><br><span class="line">                    h[edge[i].v] = h[u] + <span class="number">1</span>, que[++bk] = edge[i].v;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> h[s] != INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i])</span><br><span class="line">            <span class="keyword">if</span> (h[edge[i].v] + <span class="number">1</span> == h[u] &amp;&amp; edge[i].flow) &#123;</span><br><span class="line">                ll tmp = <span class="built_in">min</span>(edge[i].flow, e[u]);</span><br><span class="line">                edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">                e[u] -= tmp, e[edge[i].v] += tmp;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].v != s &amp;&amp; edge[i].v != t &amp;&amp; !inq[edge[i].v])</span><br><span class="line">                    pq.<span class="built_in">push</span>(&#123;h[edge[i].v], edge[i].v&#125;), inq[edge[i].v] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (!e[u]) <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">relabel</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">        h[u] = INF;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i])</span><br><span class="line">            <span class="keyword">if</span> (h[u] &gt; h[edge[i].v] + <span class="number">1</span> &amp;&amp; edge[i].flow)</span><br><span class="line">                h[u] = h[edge[i].v] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">maxflow</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;s = s, <span class="keyword">this</span>-&gt;t = t;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">bfs</span>()) <span class="keyword">return</span> e[t];</span><br><span class="line">        h[s] = n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (h[i] &lt; INF) ++gap[h[i]];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[s]; i; i = nxt[i])</span><br><span class="line">            <span class="keyword">if</span> (ll d = edge[i].flow) &#123;</span><br><span class="line">                edge[i].flow -= d, edge[i ^ <span class="number">1</span>].flow += d;</span><br><span class="line">                e[s] -= d, e[edge[i].v] += d;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].v != s &amp;&amp; edge[i].v != t &amp;&amp; !inq[edge[i].v])</span><br><span class="line">                    pq.<span class="built_in">push</span>(&#123;h[edge[i].v], edge[i].v&#125;), inq[edge[i].v] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">while</span> (pq.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = pq.<span class="built_in">top</span>().second; pq.<span class="built_in">pop</span>();</span><br><span class="line">            inq[u] = <span class="number">0</span>, <span class="built_in">push</span>(u);</span><br><span class="line">            <span class="keyword">if</span> (e[u]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (h[u] != INF &amp;&amp; !--gap[h[u]]) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                        <span class="keyword">if</span> (i != s &amp;&amp; i != t &amp;&amp; h[u] &lt; h[i] &amp;&amp; h[i] &lt; n + <span class="number">1</span>)</span><br><span class="line">                            h[i] = n + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">relabel</span>(u), ++gap[h[u]], pq.<span class="built_in">push</span>(&#123;h[u], u&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> e[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; network;</span><br></pre></td></tr></table></figure>
<h4 id="æœ€å°è´¹ç”¨æœ€å¤§æµ-dinic"><a href="#æœ€å°è´¹ç”¨æœ€å¤§æµ-dinic" class="headerlink" title="æœ€å°è´¹ç”¨æœ€å¤§æµ(dinic)"></a>æœ€å°è´¹ç”¨æœ€å¤§æµ(dinic)</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="type">const</span> <span class="type">int</span> MAXV, <span class="type">const</span> <span class="type">int</span> MAXE&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MCMF</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, flow, cost;</span><br><span class="line">    &#125; edge[MAXE * <span class="number">2</span>];</span><br><span class="line">    <span class="type">int</span> tot = <span class="number">1</span>, head[MAXV], nxt[MAXE];</span><br><span class="line">    <span class="type">int</span> flow, cost, cur[MAXV], dis[MAXV];</span><br><span class="line">    <span class="type">bool</span> vis[MAXV];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> flow, <span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        edge[++tot] = &#123;v, flow, cost&#125;;</span><br><span class="line">        nxt[tot] = head[u], head[u] = tot;</span><br><span class="line">        edge[++tot] = &#123;u, <span class="number">0</span>, -cost&#125;;</span><br><span class="line">        nxt[tot] = head[v], head[v] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(vis, vis + MAXV, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(dis, dis + MAXV, INF);</span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        que.<span class="built_in">push</span>(s);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        vis[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            vis[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = edge[i].v;</span><br><span class="line">                <span class="keyword">if</span> (edge[i].flow &amp;&amp; dis[v] &gt; dis[u] + edge[i].cost) &#123;</span><br><span class="line">                    dis[v] = dis[u] + edge[i].cost;</span><br><span class="line">                    <span class="keyword">if</span> (!vis[v]) &#123;</span><br><span class="line">                        que.<span class="built_in">push</span>(v);</span><br><span class="line">                        vis[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[t] != INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">augment</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t, <span class="type">int</span> mx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u == t || mx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> mx;</span><br><span class="line">        vis[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;i = cur[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (vis[v] || dis[v] != dis[u] + edge[i].cost)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = <span class="built_in">augment</span>(v, t, <span class="built_in">min</span>(mx, edge[i].flow));</span><br><span class="line">            cost += tmp * edge[i].cost;</span><br><span class="line">            mx -= tmp, ret += tmp;</span><br><span class="line">            edge[i].flow -= tmp, edge[i ^ <span class="number">1</span>].flow += tmp;</span><br><span class="line">            <span class="keyword">if</span> (mx == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">mcmf</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">spfa</span>(s, t)) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(head, head + MAXV, cur);</span><br><span class="line">            flow += <span class="built_in">augment</span>(s, t, INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make_pair</span>(flow, cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ä¸“é¢˜</category>
      </categories>
      <tags>
        <tag>topics</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ä¸“é¢˜ã€‘åç¼€æ•°ç»„ SA</title>
    <url>/2021/12/17/top-suffixarray/</url>
    <content><![CDATA[<h2 id="ã€ä¸“é¢˜ã€‘åç¼€æ•°ç»„-SA"><a href="#ã€ä¸“é¢˜ã€‘åç¼€æ•°ç»„-SA" class="headerlink" title="ã€ä¸“é¢˜ã€‘åç¼€æ•°ç»„ SA"></a>ã€ä¸“é¢˜ã€‘åç¼€æ•°ç»„ SA</h2><p><strong>è­¦å‘Šï¼šSAå¤šæ¬¡ä½¿ç”¨ä¸€å®šè¦æ¸…ç©ºï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚</strong></p>
<p><del>è™½ç„¶æœ‰ä¸å°‘æ­¤ç±»é¢˜ç›®å¯ä»¥ç”¨å­—ç¬¦ä¸²hashçæ</del></p>
<p>è®°ä½ä»£ç ä¸­æ¯ä¸ªæ•°ç»„çš„å«ä¹‰ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">æ•°ç»„</th>
<th style="text-align:center">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$sa_i$</td>
<td style="text-align:center">æ’åä¸º$i$çš„åç¼€çš„èµ·å§‹ä½ç½®</td>
</tr>
<tr>
<td style="text-align:center">$rk_i$</td>
<td style="text-align:center">åç¼€$s_{i \cdots n}$çš„æ’å</td>
</tr>
<tr>
<td style="text-align:center">$tp_i$</td>
<td style="text-align:center">ä¸´æ—¶æ•°ç»„ï¼Œç”¨æ¥åœ¨åŸºæ•°æ’åºä¸­è®°å½•ä¸´æ—¶æ’å</td>
</tr>
<tr>
<td style="text-align:center">$ht_i$</td>
<td style="text-align:center">ç¬¬$rk<em>i$ä¸ªåç¼€å’Œç¬¬$rk</em>{i-1}$ä¸ªåç¼€çš„$LCP$</td>
</tr>
</tbody>
</table>
</div>
<span id="more"></span>
<h3 id="ä¸€äº›æ€§è´¨"><a href="#ä¸€äº›æ€§è´¨" class="headerlink" title="ä¸€äº›æ€§è´¨"></a>ä¸€äº›æ€§è´¨</h3><h4 id="å¯é‡å æœ€é•¿é‡å¤å­ä¸²"><a href="#å¯é‡å æœ€é•¿é‡å¤å­ä¸²" class="headerlink" title="å¯é‡å æœ€é•¿é‡å¤å­ä¸²"></a>å¯é‡å æœ€é•¿é‡å¤å­ä¸²</h4><p>å³$ht$æ•°ç»„çš„æœ€å¤§å€¼ã€‚</p>
<h4 id="ä¸åŒå­ä¸²ä¸ªæ•°"><a href="#ä¸åŒå­ä¸²ä¸ªæ•°" class="headerlink" title="ä¸åŒå­ä¸²ä¸ªæ•°"></a>ä¸åŒå­ä¸²ä¸ªæ•°</h4><p>å³$\frac{n \times (n + 1)}{2} - \sum\limits_{i=1}^{n}{ht_i}$ï¼ˆæ˜“è¯ï¼‰ã€‚</p>
<h4 id="ä»»æ„ä¸¤ä¸ªåç¼€çš„-LCP"><a href="#ä»»æ„ä¸¤ä¸ªåç¼€çš„-LCP" class="headerlink" title="ä»»æ„ä¸¤ä¸ªåç¼€çš„$LCP$"></a>ä»»æ„ä¸¤ä¸ªåç¼€çš„$LCP$</h4><p>è®¾åˆ†åˆ«ä¸ºåç¼€$s<em>{i \cdots n}$å’Œ$s</em>{j \cdots n}$ï¼Œå…¶ä¸­$i \lt j$ï¼Œ$LCP = \min\limits_{k=i+1}^{j}{ht_k}$ï¼Œç”¨$RMQ$è§£å†³ã€‚</p>
<h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><a href="/2021/12/17/sol-p2408/" title="P2408 ä¸åŒå­ä¸²ä¸ªæ•° é¢˜è§£">P2408 ä¸åŒå­ä¸²ä¸ªæ•° é¢˜è§£</a> </br>

<a href="/2021/12/17/sol-p4051/" title="P4051 [JSOI2007] å­—ç¬¦åŠ å¯† é¢˜è§£">P4051 [JSOI2007] å­—ç¬¦åŠ å¯† é¢˜è§£</a> </br>

<a href="/2021/12/17/sol-p4248/" title="[AHOI2013] å·®å¼‚ é¢˜è§£">[AHOI2013] å·®å¼‚ é¢˜è§£</a> </br>

<a href="/2021/12/19/sol-p3181/" title="P3181 [HAOI2016] æ‰¾ç›¸åŒå­—ç¬¦ä¸²">P3181 [HAOI2016] æ‰¾ç›¸åŒå­—ç¬¦ä¸²</a> </br>

<a href="/2022/01/26/sol-uva11107/" title="UVA11107 Life Forms">UVA11107 Life Forms</a> </br>

<a href="/2022/02/02/sol-p2336/" title="P2336 [SCOI2012] å–µæ˜Ÿçƒä¸Šçš„ç‚¹å">P2336 [SCOI2012] å–µæ˜Ÿçƒä¸Šçš„ç‚¹å</a> </br>

<a href="/2022/02/03/sol-p4341/" title="P4341 [BJWC2010] å¤–æ˜Ÿè”ç»œ">P4341 [BJWC2010] å¤–æ˜Ÿè”ç»œ</a> </br>

<a href="/2022/02/03/sol-p4070/" title="P4070 [SDOI2016] ç”Ÿæˆé­”å’’">P4070 [SDOI2016] ç”Ÿæˆé­”å’’</a> </br>

<a href="/2022/02/03/sol-p5028/" title="P5028 Annihilate">P5028 Annihilate</a> </br>

<a href="/2022/02/03/sol-p4081/" title="P4081 [USACO17DEC] Standing Out from the Herd P">P4081 [USACO17DEC] Standing Out from the Herd P</a> </br>

<a href="/2022/02/04/sol-p4094/" title="P4094 [HEOI2016&#x2F;TJOI2016] å­—ç¬¦ä¸²">P4094 [HEOI2016&#x2F;TJOI2016] å­—ç¬¦ä¸²</a> </br>

<a href="/2022/02/04/sol-p1117/" title="P1117 [NOI2016] ä¼˜ç§€çš„æ‹†åˆ†">P1117 [NOI2016] ä¼˜ç§€çš„æ‹†åˆ†</a> </br>

<a href="/2022/02/05/sol-p3900/" title="P3900 [æ¹–å—é›†è®­] å›¾æ£®">P3900 [æ¹–å—é›†è®­] å›¾æ£®</a> </br>

<a href="/2022/02/05/sol-p4770/" title="P4770 [NOI2018] ä½ çš„åå­—">P4770 [NOI2018] ä½ çš„åå­—</a> </br>

<a href="/2022/02/05/sol-p6095/" title="P6095 [JSOI2015] ä¸²åˆ†å‰²">P6095 [JSOI2015] ä¸²åˆ†å‰²</a>
<h3 id="æ¨¡ç‰ˆä»£ç "><a href="#æ¨¡ç‰ˆä»£ç " class="headerlink" title="æ¨¡ç‰ˆä»£ç "></a>æ¨¡ç‰ˆä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SuffixArray</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN], he[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">fill</span>(sa, sa + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(rk, rk + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(tp, tp + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(ht, ht + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(he, he + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        n = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buc[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buc[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buc[i] += buc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span>* s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">200</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> w = <span class="number">1</span>, p = <span class="number">0</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = he[rk[i]] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ä¸“é¢˜</category>
      </categories>
      <tags>
        <tag>topics</tag>
      </tags>
  </entry>
  <entry>
    <title>P3809 ã€æ¨¡ç‰ˆã€‘åç¼€æ’åº é¢˜è§£</title>
    <url>/2021/12/16/sol-p3809/</url>
    <content><![CDATA[<h2 id="P3809-ã€æ¨¡ç‰ˆã€‘åç¼€æ’åº-é¢˜è§£"><a href="#P3809-ã€æ¨¡ç‰ˆã€‘åç¼€æ’åº-é¢˜è§£" class="headerlink" title="P3809 ã€æ¨¡ç‰ˆã€‘åç¼€æ’åº é¢˜è§£"></a>P3809 ã€æ¨¡ç‰ˆã€‘åç¼€æ’åº é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3809">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ¨¡ç‰ˆé¢˜ä¸å¤šè¯´</p>
<p>è®°ä½ä»£ç ä¸­æ¯ä¸ªæ•°ç»„çš„å«ä¹‰ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">æ•°ç»„</th>
<th style="text-align:center">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$sa_i$</td>
<td style="text-align:center">æ’åä¸º$i$çš„åç¼€çš„èµ·å§‹ä½ç½®</td>
</tr>
<tr>
<td style="text-align:center">$rk_i$</td>
<td style="text-align:center">åç¼€$s_{i \cdots n}$çš„æ’å</td>
</tr>
<tr>
<td style="text-align:center">$tp_i$</td>
<td style="text-align:center">ä¸´æ—¶æ•°ç»„ï¼Œç”¨æ¥åœ¨åŸºæ•°æ’åºä¸­è®°å½•ä¸´æ—¶æ’å</td>
</tr>
<tr>
<td style="text-align:center">$ht_i$</td>
<td style="text-align:center">ç¬¬$rk<em>i$ä¸ªåç¼€å’Œç¬¬$rk</em>{i-1}$ä¸ªåç¼€çš„$LCP$</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">suffix_array</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buk[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buk[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] += buk[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buk[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">0</span>, w = <span class="number">1</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3809.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3809</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">suffix_array</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, sa[MAXN], rk[MAXN], tp[MAXN], ht[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">radix_sort</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> buk[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            buk[rk[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            buk[i] += buk[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">            sa[buk[rk[tp[i]]]--] = tp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            rk[i] = s[i] - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>, tp[i] = i;</span><br><span class="line">        <span class="built_in">radix_sort</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">0</span>, w = <span class="number">1</span>; p &lt; n; m = p, w &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            p = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= w; ++i)</span><br><span class="line">                tp[++p] = n - w + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">if</span> (sa[i] &gt; w)</span><br><span class="line">                    tp[++p] = sa[i] - w;</span><br><span class="line">            <span class="built_in">radix_sort</span>(m);</span><br><span class="line">            <span class="built_in">copy</span>(rk + <span class="number">1</span>, rk + n + <span class="number">1</span>, tp + <span class="number">1</span>);</span><br><span class="line">            rk[sa[<span class="number">1</span>]] = p = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tp[sa[i - <span class="number">1</span>]] == tp[sa[i]] &amp;&amp; tp[sa[i - <span class="number">1</span>] + w] == tp[sa[i] + w])</span><br><span class="line">                    rk[sa[i]] = p;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rk[sa[i]] = ++p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k)</span><br><span class="line">                k--;</span><br><span class="line">            <span class="keyword">while</span> (s[i + k] == s[sa[rk[i] - <span class="number">1</span>] + k])</span><br><span class="line">                k++;</span><br><span class="line">            ht[i] = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">char</span> s[MAXN];</span><br><span class="line">suffix_array sa;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    sa.<span class="built_in">init</span>(s, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">write</span>(sa.sa[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2056 [ZJOI2007] æ‰è¿·è— é¢˜è§£</title>
    <url>/2021/12/15/sol-p2056/</url>
    <content><![CDATA[<h2 id="P2056-ZJOI2007-æ‰è¿·è—-é¢˜è§£"><a href="#P2056-ZJOI2007-æ‰è¿·è—-é¢˜è§£" class="headerlink" title="P2056 [ZJOI2007] æ‰è¿·è— é¢˜è§£"></a>P2056 [ZJOI2007] æ‰è¿·è— é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2056">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æƒ³åˆ°æ˜¯ç‚¹åˆ†æ ‘å°±æ¯”è¾ƒå¥½åšäº†ã€‚</p>
<p>çœ‹åˆ°æ ‘ä¸Šè·¯å¾„æƒ³åˆ°$LCA$æˆ–ç‚¹åˆ†æ ‘ã€‚å…ˆè€ƒè™‘å•æ¬¡æŸ¥è¯¢çš„ç‚¹åˆ†æ²»åšæ³•ï¼Œ$dp1_u$è¡¨ç¤º$u$ä¸ºé‡å¿ƒçš„å—ä¸­åˆ°$fa_u$çš„æœ€é•¿è·ç¦»ï¼Œ$dp0_u$è¡¨ç¤º$u$ä¸ºé‡å¿ƒçš„å—ä¸­ç»è¿‡$u$çš„æœ€é•¿è·¯å¾„ï¼Œæ˜¾ç„¶$dp0_u$ä¸ºæ¯ä¸ªå„¿å­$v$çš„$dp1_v$æœ€å¤§å€¼ä¸æ¬¡å¤§å€¼ä¹‹å’Œã€‚</p>
<p>å°†æ­¤æ–¹æ³•æ‹“å±•åˆ°ç‚¹åˆ†æ ‘ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸¤ä¸ªå¯åˆ å †ï¼Œåˆ†åˆ«å°±è¡¨ç¤º$dp0_u$å’Œ$dp1_u$çš„å€¼ï¼Œæœ€åç»Ÿè®¡åˆ°ç­”æ¡ˆä¸­ã€‚</p>
<p>ç©ºé—´å¤æ‚åº¦$O(n \log n)$ï¼Œæ—¶é—´å¤æ‚åº¦$O(n \log^2 n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2056.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;Ofast&quot;, &quot;inline&quot;, &quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">// #pragma GCC target (&quot;avx,sse2,sse3,sse4,mmx&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">18</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">heap</span> &#123;</span><br><span class="line">    priority_queue&lt;<span class="type">int</span>&gt; q, p;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        q.<span class="built_in">push</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        p.<span class="built_in">push</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (p.<span class="built_in">size</span>() &amp;&amp; q.<span class="built_in">size</span>() &amp;&amp; p.<span class="built_in">top</span>() == q.<span class="built_in">top</span>())</span><br><span class="line">            p.<span class="built_in">pop</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">return</span> q.<span class="built_in">top</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (p.<span class="built_in">size</span>() &amp;&amp; q.<span class="built_in">size</span>() &amp;&amp; p.<span class="built_in">top</span>() == q.<span class="built_in">top</span>())</span><br><span class="line">            p.<span class="built_in">pop</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> q.<span class="built_in">size</span>() - p.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sectop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> t = <span class="built_in">top</span>();</span><br><span class="line">        <span class="built_in">pop</span>();</span><br><span class="line">        <span class="type">int</span> r = <span class="built_in">top</span>();</span><br><span class="line">        <span class="built_in">push</span>(t);</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, q, fa[MAXN], dep[MAXN], fq[MAXN][LOGN];</span><br><span class="line"><span class="type">int</span> scnt, siz[MAXN], mxsiz[MAXN];</span><br><span class="line"><span class="type">bool</span> vis[MAXN], opn[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[MAXN];</span><br><span class="line">heap shp, hp[MAXN][<span class="number">2</span>];</span><br><span class="line"><span class="type">char</span> buf[<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getroot</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f, <span class="type">int</span> sz)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    siz[u] = <span class="number">1</span>, mxsiz[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f || vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> tmp = <span class="built_in">getroot</span>(v, u, sz);</span><br><span class="line">        <span class="keyword">if</span> (mxsiz[tmp] &lt; mxsiz[ret])</span><br><span class="line">            ret = tmp;</span><br><span class="line">        siz[u] += siz[v];</span><br><span class="line">        mxsiz[u] = <span class="built_in">max</span>(mxsiz[u], siz[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    mxsiz[u] = <span class="built_in">max</span>(mxsiz[u], sz - siz[u]);</span><br><span class="line">    <span class="keyword">if</span> (mxsiz[u] &lt; mxsiz[ret])</span><br><span class="line">        ret = u;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    fq[u][<span class="number">0</span>] = f, dep[u] = dep[f] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; LOGN; ++i)</span><br><span class="line">        fq[u][i] = fq[fq[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u])</span><br><span class="line">        <span class="keyword">if</span> (v != f)</span><br><span class="line">            <span class="built_in">build1</span>(v, u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f, <span class="type">int</span> sz)</span> </span>&#123;</span><br><span class="line">    vis[u] = <span class="literal">true</span>, fa[u] = f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f || vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> ns = (siz[u] &gt; siz[v]) ? siz[v] : sz - siz[u];</span><br><span class="line">        <span class="type">int</span> rt = <span class="built_in">getroot</span>(v, u, ns);</span><br><span class="line">        <span class="built_in">build2</span>(rt, u, ns);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v])</span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">    <span class="type">int</span> t = dep[u] - dep[v];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((t &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            u = fq[u][i];</span><br><span class="line">    <span class="keyword">if</span> (u == v)</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> (fq[u][i] != fq[v][i])</span><br><span class="line">            u = fq[u][i], v = fq[v][i];</span><br><span class="line">    <span class="keyword">return</span> fq[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dist</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dep[u] + dep[v] - (dep[<span class="built_in">lca</span>(u, v)] &lt;&lt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (hp[x][<span class="number">0</span>].<span class="built_in">size</span>() &gt;= <span class="number">2</span>)</span><br><span class="line">        shp.<span class="built_in">erase</span>(hp[x][<span class="number">0</span>].<span class="built_in">top</span>() + hp[x][<span class="number">0</span>].<span class="built_in">sectop</span>());</span><br><span class="line">    <span class="keyword">if</span> (opn[x])</span><br><span class="line">        hp[x][<span class="number">0</span>].<span class="built_in">push</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        hp[x][<span class="number">0</span>].<span class="built_in">erase</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (hp[x][<span class="number">0</span>].<span class="built_in">size</span>() &gt;= <span class="number">2</span>)</span><br><span class="line">        shp.<span class="built_in">push</span>(hp[x][<span class="number">0</span>].<span class="built_in">top</span>() + hp[x][<span class="number">0</span>].<span class="built_in">sectop</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> u = x; fa[u]; u = fa[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hp[fa[u]][<span class="number">0</span>].<span class="built_in">size</span>() &gt;= <span class="number">2</span>)</span><br><span class="line">            shp.<span class="built_in">erase</span>(hp[fa[u]][<span class="number">0</span>].<span class="built_in">top</span>() + hp[fa[u]][<span class="number">0</span>].<span class="built_in">sectop</span>());</span><br><span class="line">        <span class="keyword">if</span> (hp[u][<span class="number">1</span>].<span class="built_in">size</span>())</span><br><span class="line">            hp[fa[u]][<span class="number">0</span>].<span class="built_in">erase</span>(hp[u][<span class="number">1</span>].<span class="built_in">top</span>());</span><br><span class="line">        <span class="keyword">if</span> (opn[x])</span><br><span class="line">            hp[u][<span class="number">1</span>].<span class="built_in">push</span>(<span class="built_in">dist</span>(fa[u], x));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            hp[u][<span class="number">1</span>].<span class="built_in">erase</span>(<span class="built_in">dist</span>(fa[u], x));</span><br><span class="line">        <span class="keyword">if</span> (hp[u][<span class="number">1</span>].<span class="built_in">size</span>())</span><br><span class="line">            hp[fa[u]][<span class="number">0</span>].<span class="built_in">push</span>(hp[u][<span class="number">1</span>].<span class="built_in">top</span>());</span><br><span class="line">        <span class="keyword">if</span> (hp[fa[u]][<span class="number">0</span>].<span class="built_in">size</span>() &gt;= <span class="number">2</span>)</span><br><span class="line">            shp.<span class="built_in">push</span>(hp[fa[u]][<span class="number">0</span>].<span class="built_in">top</span>() + hp[fa[u]][<span class="number">0</span>].<span class="built_in">sectop</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> shp.<span class="built_in">size</span>() ? shp.<span class="built_in">top</span>() : (scnt ? <span class="number">0</span> : <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        g[u].<span class="built_in">emplace_back</span>(v);</span><br><span class="line">        g[v].<span class="built_in">emplace_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    mxsiz[<span class="number">0</span>] = INF;</span><br><span class="line">    <span class="built_in">build1</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">build2</span>(<span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>, n), <span class="number">0</span>, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        opn[i] = <span class="literal">true</span>, <span class="built_in">update</span>(i), ++scnt;</span><br><span class="line">    <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        <span class="keyword">if</span> (buf[<span class="number">0</span>] == <span class="string">&#x27;G&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">write</span>(<span class="built_in">query</span>()), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> x;</span><br><span class="line">            <span class="built_in">read</span>(x);</span><br><span class="line">            opn[x] ? --scnt : ++scnt;</span><br><span class="line">            opn[x] = !opn[x];</span><br><span class="line">            <span class="built_in">update</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€äº›æœ‰è¶£çš„äº‹æƒ…</title>
    <url>/2021/12/13/interesting/</url>
    <content><![CDATA[<h2 id="ä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼ˆå¯ä»¥è®©è¿™ä¸ªåšå®¢å……æ»¡æ´»è·ƒçš„æ°”æ°›ï¼‰"><a href="#ä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼ˆå¯ä»¥è®©è¿™ä¸ªåšå®¢å……æ»¡æ´»è·ƒçš„æ°”æ°›ï¼‰" class="headerlink" title="ä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼ˆå¯ä»¥è®©è¿™ä¸ªåšå®¢å……æ»¡æ´»è·ƒçš„æ°”æ°›ï¼‰"></a>ä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼ˆå¯ä»¥è®©è¿™ä¸ªåšå®¢<del>å……æ»¡</del>æ´»è·ƒ<del>çš„æ°”æ°›</del>ï¼‰</h2><span id="more"></span>
<h3 id="2021-12-13"><a href="#2021-12-13" class="headerlink" title="2021.12.13"></a>2021.12.13</h3><p>ä¸Šå‘¨å…­æ‰å–è¿‡ $H_2CO_3$ï¼ˆæŒ‡å¯ä¹ï¼‰å¹¶ä¸”è¢«æŸå·¨ä½¬æé†’ $H_2O+CO_2=H_2CO_3$ </p>
<p>äºæ˜¯åŒ–å­¦è€ƒè¯•<strong>çŒœ</strong>å‡º $C$ å’Œ $CuO$ ï¼Œ<strong>çŒœ</strong>å‡º $H_2CO_3 $ï¼Œ<strong>çŒœ</strong>å‡º $CO_2$ å’Œ $H_2O$ çš„ä½ç½®ï¼Œ<strong>çŒœ</strong>å‡ºå’Œ $Fe_2O_3$ ååº”çš„æ˜¯ $H_2$ å¹¶ä¸”<strong>çŒœ</strong>å¯¹äº†æˆ‘ç‹¬ç«‹åšå‡ºæ¥çš„ç¬¬ä¸€é“ç‰©è´¨æ¨æ–­é¢˜ï¼ˆçœŸå°±å…¨æ˜¯çŒœå¯¹çš„ï¼‰</p>
<p>æ‰€ä»¥è¯´å‘¨å…­é›†è®­ä¸€å®šè¦ä¹°å¯ä¹ã€‚<del>å¯ä»¥è®©ä½ åŒ–å­¦è€ƒè¯•åŠ åˆ†</del></p>
]]></content>
  </entry>
  <entry>
    <title>P6329 ã€æ¨¡ç‰ˆã€‘ç‚¹åˆ†æ ‘ï½œéœ‡æ³¢</title>
    <url>/2021/12/10/sol-p6329/</url>
    <content><![CDATA[<h2 id="P6329-ã€æ¨¡ç‰ˆã€‘ç‚¹åˆ†æ ‘ï½œéœ‡æ³¢"><a href="#P6329-ã€æ¨¡ç‰ˆã€‘ç‚¹åˆ†æ ‘ï½œéœ‡æ³¢" class="headerlink" title="P6329 ã€æ¨¡ç‰ˆã€‘ç‚¹åˆ†æ ‘ï½œéœ‡æ³¢"></a>P6329 ã€æ¨¡ç‰ˆã€‘ç‚¹åˆ†æ ‘ï½œéœ‡æ³¢</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P6329">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p><del>é¢˜ç›®é‡Œéƒ½è¯´äº†æ˜¯ç‚¹åˆ†æ ‘</del></p>
<p>å‘ç°è‡ªå·±å­¦è¿‡çš„ç‚¹åˆ†æ ‘ç°åœ¨å·²ç»ä¸ä¼šå†™äº†ï¼Œ<strong>æ”¹å¤©</strong>æ¥è¡¥ä¸ªç‚¹åˆ†æ ‘çš„é¢˜è§£å§ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P6329.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P6329</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">binary_indexed_tree</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; c;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ##sb-mistakes## å¼€`vector`å½“åŠ¨æ€å¼€ç‚¹æ ‘çŠ¶æ•°ç»„`resize`æ—¶æ²¡æœ‰$+1$</span></span><br><span class="line">        <span class="comment">// c.resize(n = m);</span></span><br><span class="line">        c.<span class="built_in">resize</span>((n = m) + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = x; i &lt;= n; i += (i &amp; -i))</span><br><span class="line">            c[i] += v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        x = <span class="built_in">min</span>(x, n);</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = x; i; i -= (i &amp; -i))</span><br><span class="line">            ret += c[i];</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, q, a[MAXN], fa[MAXN], dep[MAXN], fq[MAXN][LOGN];</span><br><span class="line"><span class="type">int</span> cur[MAXN], siz[MAXN], mxsiz[MAXN];</span><br><span class="line">bitset&lt;MAXN&gt; vis;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[MAXN];</span><br><span class="line">binary_indexed_tree bit[MAXN][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getroot</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f, <span class="type">int</span> sz)</span> </span>&#123;</span><br><span class="line">    siz[u] = <span class="number">1</span>;</span><br><span class="line">    mxsiz[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f || vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> tmp = <span class="built_in">getroot</span>(v, u, sz);</span><br><span class="line">        siz[u] += siz[v];</span><br><span class="line">        mxsiz[u] = <span class="built_in">max</span>(mxsiz[u], siz[v]);</span><br><span class="line">        <span class="keyword">if</span> (mxsiz[tmp] &lt; mxsiz[ret])</span><br><span class="line">            ret = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    mxsiz[u] = <span class="built_in">max</span>(mxsiz[u], sz - siz[u]);</span><br><span class="line">    <span class="keyword">if</span> (mxsiz[u] &lt; mxsiz[ret])</span><br><span class="line">        ret = u;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f, <span class="type">int</span> sz)</span> </span>&#123;</span><br><span class="line">    fa[u] = f, vis[u] = <span class="literal">true</span>;</span><br><span class="line">    bit[u][<span class="number">0</span>].<span class="built_in">init</span>(sz + <span class="number">2</span>);</span><br><span class="line">    bit[u][<span class="number">1</span>].<span class="built_in">init</span>(sz + <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[v])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> nsz = (siz[u] &gt; siz[v]) ? siz[v] : (sz - siz[u]);</span><br><span class="line">        <span class="type">int</span> nrt = <span class="built_in">getroot</span>(v, <span class="number">0</span>, nsz);</span><br><span class="line">        <span class="built_in">build1</span>(nrt, u, nsz);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    fq[u][<span class="number">0</span>] = f, dep[u] = dep[f] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; LOGN; ++i)</span><br><span class="line">        fq[u][i] = fq[fq[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u])</span><br><span class="line">        <span class="keyword">if</span> (v != f)</span><br><span class="line">            <span class="built_in">build2</span>(v, u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v])</span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">    <span class="type">int</span> t = dep[u] - dep[v];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((t &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            u = fq[u][i];</span><br><span class="line">    <span class="keyword">if</span> (u == v)</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> (fq[u][i] != fq[v][i])</span><br><span class="line">            u = fq[u][i], v = fq[v][i];</span><br><span class="line">    <span class="keyword">return</span> fq[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getdis</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="built_in">lca</span>(x, y);</span><br><span class="line">    <span class="keyword">return</span> dep[x] + dep[y] - <span class="number">2</span> * dep[l];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> u = x; u; u = fa[u]) &#123;</span><br><span class="line">        bit[u][<span class="number">0</span>].<span class="built_in">add</span>(<span class="built_in">getdis</span>(u, x) + <span class="number">1</span>, v - cur[x]);</span><br><span class="line">        <span class="keyword">if</span> (fa[u])</span><br><span class="line">            bit[u][<span class="number">1</span>].<span class="built_in">add</span>(<span class="built_in">getdis</span>(fa[u], x) + <span class="number">1</span>, v - cur[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    cur[x] = v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> u = x; u; u = fa[u]) &#123;</span><br><span class="line">        <span class="type">int</span> d = k - <span class="built_in">getdis</span>(u, x);</span><br><span class="line">        <span class="keyword">if</span> (d &gt;= <span class="number">0</span>)</span><br><span class="line">            ret += bit[u][<span class="number">0</span>].<span class="built_in">sum</span>(d + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (fa[u]) &#123;</span><br><span class="line">            d = k - <span class="built_in">getdis</span>(fa[u], x);</span><br><span class="line">            <span class="keyword">if</span> (d &gt;= <span class="number">0</span>)</span><br><span class="line">                ret -= bit[u][<span class="number">1</span>].<span class="built_in">sum</span>(d + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    mxsiz[<span class="number">0</span>] = INFL;</span><br><span class="line">    <span class="built_in">build1</span>(<span class="built_in">getroot</span>(<span class="number">1</span>, <span class="number">0</span>, n), <span class="number">0</span>, n);</span><br><span class="line">    <span class="built_in">build2</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> tt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">modify</span>(i, a[i]);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> op, x, y;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(x), <span class="built_in">read</span>(y);</span><br><span class="line">        x ^= tt, y ^= tt;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">write</span>(tt = <span class="built_in">query</span>(x, y));</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">modify</span>(x, y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2664 æ ‘ä¸Šæ¸¸æˆ é¢˜è§£</title>
    <url>/2021/12/10/sol-p2664/</url>
    <content><![CDATA[<h2 id="P2664-æ ‘ä¸Šæ¸¸æˆ-é¢˜è§£"><a href="#P2664-æ ‘ä¸Šæ¸¸æˆ-é¢˜è§£" class="headerlink" title="P2664 æ ‘ä¸Šæ¸¸æˆ é¢˜è§£"></a>P2664 æ ‘ä¸Šæ¸¸æˆ é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2664">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>åˆ†åˆ«è€ƒè™‘æ¯ç§é¢œè‰²ï¼Œå¯¹äºé¢œè‰²$col$ï¼Œå°†æ‰€æœ‰$c_u=col$çš„$u$åˆ å»å°±å¾—åˆ°è‹¥å¹²è¿é€šå—ï¼Œé¢œè‰²$col$å¯¹$sum_v$çš„è´¡çŒ®æ˜¯$n-num_v$ï¼Œ$num_v$ä¸º$v$æ‰€åœ¨è¿é€šå—å¤§å°ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬ä»¤$c_u=col$æ—¶$num_u=0$ã€‚</p>
<p>æ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„æ˜¯ç»™æ¯ç§é¢œè‰²åˆ†åˆ«å»ºç«‹è™šæ ‘è®¡ç®—è´¡çŒ®ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(n \log n)$ã€‚</p>
<p>ä½†æ˜¯è¿™é“é¢˜æ˜¯æœ‰$O(n)$çš„åšæ³•æ»´ã€‚åšæ³•ä¸ºä¸¤é$dfs$ï¼Œç¬¬ä¸€éé¢„å¤„ç†å‡ºæ¯ä¸ª$col=c_{fa_u}$å¯¹åº”çš„$num_u$ã€‚$num_u$å°±æ˜¯$siz_u$å‡å»å­æ ‘$u$ä¸­ä¸ç»è¿‡å…¶ä»–é¢œè‰²ä¸º$c_u$çš„èŠ‚ç‚¹ç›´æ¥ä¸$u$è¿æ¥çš„é¢œè‰²ä¸º$c_u$çš„ç‚¹çš„$siz$ä¹‹å’Œã€‚$dfs$æ—¶é¡ºä¾¿é¢„å¤„ç†å‡º$col_i$è¡¨ç¤ºæ ¹èŠ‚ç‚¹å‘¨å›´çš„é¢œè‰²ä¸º$i$è¿é€šå—å¤§å°ã€‚ç¬¬äºŒéç›´æ¥ç»Ÿè®¡ç­”æ¡ˆã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2664.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2664</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, c[MAXN], son[MAXN], cnt[MAXN], col[MAXN], cur[MAXN];</span><br><span class="line"><span class="type">int</span> sum, len, siz[MAXN], num[MAXN], ans[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> tmp = cur[c[u]];</span><br><span class="line">    siz[u] = <span class="number">1</span>;</span><br><span class="line">    cur[c[u]] = u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        son[u] = v;</span><br><span class="line">        <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">        siz[u] += siz[v];</span><br><span class="line">    &#125;</span><br><span class="line">    cur[c[u]] = tmp;</span><br><span class="line">    num[u] += siz[u];</span><br><span class="line">    <span class="keyword">if</span> (son[cur[c[u]]])</span><br><span class="line">        num[son[cur[c[u]]]] -= siz[u];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        col[c[u]] -= siz[u];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (son[cur[c[u]]])</span><br><span class="line">        sum -= num[son[cur[c[u]]]];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        sum -= col[c[u]];</span><br><span class="line">    sum += num[u];</span><br><span class="line">    ans[u] = n * len - sum;</span><br><span class="line">    <span class="type">int</span> tmp = cur[c[u]];</span><br><span class="line">    cur[c[u]] = u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        son[u] = v;</span><br><span class="line">        <span class="built_in">dfs2</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    cur[c[u]] = tmp;</span><br><span class="line">    sum -= num[u];</span><br><span class="line">    <span class="keyword">if</span> (son[cur[c[u]]])</span><br><span class="line">        sum += num[son[cur[c[u]]]];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        sum += col[c[u]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(c[i]), ++cnt[c[i]];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXN; ++i)</span><br><span class="line">        <span class="keyword">if</span> (cnt[i])</span><br><span class="line">            ++len, col[i] = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXN; ++i)</span><br><span class="line">        sum += col[i];</span><br><span class="line">    num[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans[i]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF1096G Lucky Tickets é¢˜è§£</title>
    <url>/2021/12/08/sol-cf1096g/</url>
    <content><![CDATA[<h2 id="CF1096G-Lucky-Tickets-é¢˜è§£"><a href="#CF1096G-Lucky-Tickets-é¢˜è§£" class="headerlink" title="CF1096G Lucky Tickets é¢˜è§£"></a>CF1096G Lucky Tickets é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF1096G">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p><del>ç¬¬ä¸€æ¬¡è¿™ä¹ˆè½»æ¾åœ°åšè®¡æ•°é¢˜</del></p>
<p>æœ‰äº†<a href="/2021/12/05/sol-cf632e/" title="CF632E">CF632E</a>çš„ç»éªŒï¼Œè¿™é¢˜$10$ç§’ä»¥å†…å°±èƒ½åˆ‡ã€‚</p>
<p>å…ˆæ„é€ ç”Ÿæˆå‡½æ•°$f(x) = \sum\limits_{i \in K}{x^i}$ï¼Œå–å…¶ä¸­$\frac{n}{2}$ä¸ªæ•°å­—çš„å’Œç›¸å½“äº$f^\frac{n}{2}(x)$ã€‚$NTT$è®¡ç®—å³å¯ï¼Œç­”æ¡ˆå¾ˆå¥½ç»Ÿè®¡ã€‚</p>
<p>$5$åˆ†é’Ÿå°±åšæ‰äº†ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF1096G.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF1096G</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> G0 = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> n, k, f[MAXN];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % MOD)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            ret = ret * x % MOD;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">            <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">change</span>(f, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> gn = <span class="built_in">qpow</span>(G0, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">            <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                f[k] = (u + t + MOD) % MOD;</span><br><span class="line">                f[k + h / <span class="number">2</span>] = (u - t + MOD) % MOD;</span><br><span class="line">                g = g * gn % MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">        <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            f[i] = f[i] * inv % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n) /= <span class="number">2</span>, <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= k; ++i)</span><br><span class="line">        <span class="built_in">read</span>(x), f[x] = <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt;= n * <span class="number">9</span>)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(f, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        f[i] = <span class="built_in">qpow</span>(f[i], n);</span><br><span class="line">    <span class="built_in">ntt</span>(f, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        (ans += f[i] * f[i]) %= MOD;</span><br><span class="line">    <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>AT2064 Many Easy Problems é¢˜è§£</title>
    <url>/2021/12/06/sol-at2064/</url>
    <content><![CDATA[<h2 id="AT2064-Many-Easy-Problems-é¢˜è§£"><a href="#AT2064-Many-Easy-Problems-é¢˜è§£" class="headerlink" title="AT2064 Many Easy Problems é¢˜è§£"></a>AT2064 Many Easy Problems é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/AT2064">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å¯¹äºæ¯ä¸ªèŠ‚ç‚¹$u$ï¼Œè€ƒè™‘å…¶å¯¹$f(i)$çš„è´¡çŒ®ã€‚</p>
<p>æ­£é¢çš„è´¡çŒ®ä¸å¥½è®¡ç®—ï¼Œè€ƒè™‘ç”¨æ€»æ–¹æ¡ˆæ•°å‡å»ä¸ç»è¿‡$u$çš„æ•°é‡ï¼Œåˆ™</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(i) &= \sum\limits_{u=1}^{n}{\left(\binom{n}{i} - \binom{n-siz_u}{i} - \sum\limits_{v \in son_u}{\binom{siz_v}{i}}\right)} \\
&= n\binom{n}{i} - \sum\limits_{u=1}^{n}{\left(\binom{n-siz_u}{i} + \sum\limits_{v \in son_u}{\binom{siz_v}{i}}\right)}
\end{aligned}</script><p>è®¾$cnt_i$è¡¨ç¤ºå­æ ‘å¤§å°ä¸º$i$çš„èŠ‚ç‚¹æ•°é‡ã€‚ä¸ºäº†ä¾¿äºä¹‹åçš„è®¡ç®—ï¼Œæˆ‘ä»¬å°†ä¸åœ¨èŠ‚ç‚¹$u$å­æ ‘ä¸­çš„èŠ‚ç‚¹å®šä¹‰ä¸ºä¸€æ£µæ–°çš„å­æ ‘å¹¶åŠ å…¥$son_u$ã€‚å½¢å¼åŒ–åœ°ï¼Œå³å¯¹äºæ¯ä¸ªèŠ‚ç‚¹$u\neq 1$ï¼Œå°†$n-siz_u$åŠ å…¥$cnt$æ•°ç»„ä¸­ã€‚å¼å­ç®€åŒ–å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(i) &= n\binom{n}{i} - \sum\limits_{u=1}^{n}{\sum\limits_{v \in son_u}{\binom{siz_v}{i}}} \\
&= n\binom{n}{i} - \sum\limits_{j=i}^{n}{cnt_j \cdot \binom{j}{i}}
\end{aligned}</script><p>å±•å¼€ç»„åˆæ•°å¾—åˆ°</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(i) &= n\binom{n}{i} - \sum\limits_{j=i}^{n}{cnt_j \cdot \binom{j}{i}} \\
&= n\binom{n}{i} - \sum\limits_{j=i}^{n}{\frac{cnt_j \cdot j!}{i! (j - i)!}} \\
&= n\binom{n}{i} - \frac{1}{i!}\sum\limits_{j=i}^{n}{\frac{cnt_j \cdot j!}{(j - i)!}}
\end{aligned}</script><p>ç”±äºåé¢çš„æ±‚å’Œç¬¦å·ä¸­æ—¢æœ‰$j$åˆæœ‰$i-j$ï¼Œæƒ³åŠæ³•å°†å…¶åŒ–ä¸ºå·ç§¯çš„å½¢å¼ã€‚</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(i) &= n\binom{n}{i} - \frac{1}{i!}\sum\limits_{j=i}^{n}{\frac{cnt_j \cdot j!}{(j - i)!}} \\
&= n\binom{n}{i} - \frac{1}{i!}\sum\limits_{j=0}^{n-i}{\frac{cnt_{n - j} \cdot (n - j)!}{(n - i - j)!}}
\end{aligned}</script><p>æ‰€ä»¥ä»¤$F<em>j = cnt</em>{n - j} \cdot (n - j)!$ï¼Œ$G_j = \frac{1}{j!}$ï¼Œæœ€ç»ˆå¼å­æˆäº†</p>
<script type="math/tex; mode=display">
f(i) = n\binom{n}{i} - \frac{1}{i!}\sum\limits_{j=0}^{n-i}{F_j \cdot G_{n - i - j}}</script><p>ä½¿ç”¨$NTT$ä¼˜åŒ–å³å¯ã€‚æ³¨æ„$924844033$çš„åŸæ ¹æ˜¯$5$è€Œä¸æ˜¯$3$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           AT2064.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/AT2064</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">924844033</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> G0 = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % MOD)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = ret * x % MOD;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> gn = <span class="built_in">qpow</span>(G0, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                    f[k] = (u + t + MOD) % MOD;</span><br><span class="line">                    f[k + h / <span class="number">2</span>] = (u - t + MOD) % MOD;</span><br><span class="line">                    g = g * gn % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] = f[i] * inv % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, fa[MAXN], siz[MAXN], cnt[MAXN], ans[MAXN];</span><br><span class="line"><span class="type">int</span> fac[MAXN], inv[MAXN], f[MAXN], g[MAXN], res[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; tr[MAXN];</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    fa[u] = f, siz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : tr[u])</span><br><span class="line">        <span class="keyword">if</span> (v != f)</span><br><span class="line">            <span class="built_in">build</span>(v, u), siz[u] += siz[v];</span><br><span class="line">    ++cnt[siz[u]], ++cnt[n - siz[u]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = fac[<span class="number">0</span>] = <span class="number">1</span>; i &lt; MAXN; ++i)</span><br><span class="line">        fac[i] = fac[i - <span class="number">1</span>] * i % MOD;</span><br><span class="line">    inv[MAXN - <span class="number">1</span>] = <span class="built_in">qpow</span>(fac[MAXN - <span class="number">1</span>], MOD - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXN - <span class="number">2</span>; ~i; --i)</span><br><span class="line">        inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">binom</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fac[x] * inv[y] % MOD * inv[x - y] % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        tr[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        tr[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>), cnt[<span class="number">0</span>] = cnt[n] = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// ##sb-mistakes## è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬FFT/NTTåšå·ç§¯ä¸€å®šè¦å¼€ä¸¤å€é•¿åº¦</span></span><br><span class="line">    <span class="comment">// while (len &lt;= n)</span></span><br><span class="line">    <span class="keyword">while</span> (len &lt;= n + n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        f[i] = cnt[n - i] * fac[n - i] % MOD;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        g[i] = inv[i];</span><br><span class="line">    <span class="built_in">ntt</span>(f, len, <span class="number">1</span>), <span class="built_in">ntt</span>(g, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        res[i] = f[i] * g[i] % MOD;</span><br><span class="line">    <span class="built_in">ntt</span>(res, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ans[i] = (n * <span class="built_in">binom</span>(n, i) % MOD - inv[i] * res[n - i] % MOD + MOD) % MOD;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans[i]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4245 ã€æ¨¡ç‰ˆã€‘ä»»æ„æ¨¡æ•°å¤šé¡¹å¼ä¹˜æ³•</title>
    <url>/2021/12/05/sol-p4245/</url>
    <content><![CDATA[<h2 id="P4245-ã€æ¨¡ç‰ˆã€‘ä»»æ„æ¨¡æ•°å¤šé¡¹å¼ä¹˜æ³•"><a href="#P4245-ã€æ¨¡ç‰ˆã€‘ä»»æ„æ¨¡æ•°å¤šé¡¹å¼ä¹˜æ³•" class="headerlink" title="P4245 ã€æ¨¡ç‰ˆã€‘ä»»æ„æ¨¡æ•°å¤šé¡¹å¼ä¹˜æ³•"></a>P4245 ã€æ¨¡ç‰ˆã€‘ä»»æ„æ¨¡æ•°å¤šé¡¹å¼ä¹˜æ³•</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4245">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å¯¹äºä»»æ„æ¨¡æ•°çš„å¤šé¡¹å¼ä¹˜æ³•æ˜¾ç„¶æ— æ³•ç›´æ¥å¥—ç”¨$NTT$ã€‚è€Œç”±äºæ•°é‡çº§è¿‡å¤§ï¼Œé‡‡ç”¨<code>std::complex&lt;long double&gt;</code>çš„$FFT$ä¹Ÿä¼šäº§ç”Ÿæ¯”è¾ƒå¤šçš„ç²¾åº¦ä¸¢å¤±ã€‚</p>
<h4 id="æ–¹æ³•1-NTT-åˆå¹¶"><a href="#æ–¹æ³•1-NTT-åˆå¹¶" class="headerlink" title="æ–¹æ³•1: $NTT$åˆå¹¶"></a>æ–¹æ³•1: $NTT$åˆå¹¶</h4><p>ç”±äº$a_i,b_i \le 10^9$ä¸”$n \le 10^5$ï¼Œæ‰€ä»¥ç­”æ¡ˆçš„æ•°é‡çº§ä¸è¶…è¿‡$10^9 \times 10^9 \times 10^5 = 10^{23}$ï¼Œè¿™æ ·å°±å¯ä»¥æ‰¾$3$ä¸ª$10^8$å·¦å³çš„æ¨¡æ•°åˆ†åˆ«ç”¨$NTT$ç®—å‡ºå¯¹å…¶å–æ¨¡çš„ç­”æ¡ˆï¼Œç”¨ä¸­å›½å‰©ä½™å®šç†åˆå¹¶ã€‚</p>
<p>è¿™é‡Œæ¯”è¾ƒå¸¸ç”¨çš„$3$ä¸ªæ¨¡æ•°åˆ†åˆ«æ˜¯</p>
<script type="math/tex; mode=display">
\begin{aligned}
p_1 &= 998244353 = 7 \times 17 \times 2^{23} + 1, &g &= 3 \\
p_2 &= 1004535809 = 479 \times 2^{21} + 1, &g &= 3 \\
p_3 &= 469762049 = 7 \times 2^{26} + 1, &g &= 3
\end{aligned}</script><p>ä¸‹é¢å‡è®¾æˆ‘ä»¬æ±‚å‡ºäº†å¯¹è¿™$3$ä¸ªæ¨¡æ•°çš„ç­”æ¡ˆåˆ†åˆ«ä¸º$x_1,x_2,x_3$ï¼Œå¾—åˆ°åŒä½™æ–¹ç¨‹å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\begin{cases}
x \equiv x_1 \pmod{p_1} \\
x \equiv x_2 \pmod{p_2} \\
x \equiv x_3 \pmod{p_3} \\
\end{cases}</script><p>ç”±äºä¹˜ç§¯è¿‡å¤§æ— æ³•ç”¨<code>long long</code>å‚¨å­˜ï¼Œæ‰€ä»¥æ­£å¸¸çš„$CRT$ä¸èƒ½åœ¨æ­¤ä½¿ç”¨ï¼ˆå½“ç„¶å¦‚æœä½ å†™é«˜ç²¾åº¦å°±å½“æˆ‘æ²¡è¯´ï¼‰ï¼Œäºæ˜¯è€ƒè™‘æ‰‹åŠ¨åˆå¹¶ã€‚å…ˆæŠŠå‰ä¸¤ä¸ªåˆå¹¶ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
x_1 + k_1 p_1 &= x_2 + k_2 p_2 \\
x_1 + k_1 p_1 &\equiv x_2 &\pmod{p_2} \\
k_1 &\equiv \frac{x_2 - x_1}{p_1} &\pmod{p_2} \\
\end{aligned}</script><p>è¿™æ ·ä¾¿æ±‚å‡ºäº†$k_1$ï¼ŒåŒæ—¶å¾—åˆ°æ–°çš„æ–¹ç¨‹$x \equiv x_1 + k_1 p_1 \pmod{p_1 p_2}$ã€‚è®°$x_4  = x_1 + k_1 p_1$ã€‚</p>
<script type="math/tex; mode=display">
\begin{aligned}
x_4 + k_4 p_1 p_2 &= x_3 + k_3 p_3 \\
x_4 + k_4 p_1 p_2 &\equiv x_3 &\pmod{p_3} \\
k_4 &\equiv \frac{x_3 - x_4}{p_1 p_2} &\pmod{p_3} \\
\end{aligned}</script><p>æ±‚å‡º$k_4$åï¼Œå¾—åˆ°$x \equiv x_4 + k_4 p_1 p_2 \pmod{p_3}$ã€‚ç”±äº$x \lt p_1 p_2 p_3$ï¼Œæ‰€ä»¥$x = x_4 + k_4 p_1 p_2$ã€‚</p>
<p>å…±éœ€è¦è·‘$3 \times 3 = 9$æ¬¡$NTT$ï¼Œå¸¸æ•°è¾ƒå¤§ã€‚</p>
<h4 id="æ–¹æ³•2-æ‹†ç³»æ•°-FFT"><a href="#æ–¹æ³•2-æ‹†ç³»æ•°-FFT" class="headerlink" title="æ–¹æ³•2: æ‹†ç³»æ•°$FFT$"></a>æ–¹æ³•2: æ‹†ç³»æ•°$FFT$</h4><p>æŠŠä¸€ä¸ªæ•°æ‹†åˆ†æˆ$a \times 2^{15} + b$çš„å½¢å¼ï¼Œåˆ™$a, b \lt 2^{15}$</p>
<p>å°†$a$å’Œ$b$åˆ†åˆ«åšå¤šé¡¹å¼ï¼Œç›¸ä¹˜çš„å€¼åŸŸæ˜¯$2^{15} \times 2^{15} \times 10^5 \approx 10^{14}$ï¼Œå¯ä»¥æ¥å—ã€‚äºæ˜¯</p>
<script type="math/tex; mode=display">
\begin{aligned}
c_1 \times c_2 &= (a_1 \times 2^{15} + b_1) \times (a_2 \times 2^{15} + b_2) \\
&= a_1 a_2 \times 2^{30} + (a_1 b_2 + a_2 b_1) \times 2^{15} + b_1 b_2
\end{aligned}</script><p>ä¹ä¸€çœ‹å¥½åƒéœ€è¦ç®—$4$æ¬¡ä¹˜æ³•ï¼Œå…±$12$æ¬¡$FFT$ï¼Œé‚£å²‚ä¸æ˜¯æ¯”æ–¹æ³•1æ›´åŠ£ï¼Ÿ</p>
<p>å¼€å§‹æ¨å¼å­å§ã€‚å‡è®¾æœ‰$4$ä¸ªå¤šé¡¹å¼$A_1,A_2,B_1,B_2$ï¼Œå¦‚ä½•æ±‚ä»–ä»¬çš„ä¸¤ä¸¤ä¹˜ç§¯ã€‚</p>
<p>ç”±äº$(a+bi) \times (c+di) = (ac-bd) + (ad+bc)i$ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾å¤å¤šé¡¹å¼$P = A_1 + iB_1$ï¼Œ$Q = A_2 + iB_2$ï¼ˆè¿™æ˜¯å“ªä½ç¥ä»™æƒ³å‡ºæ¥çš„å•Šï¼‰ï¼Œè€Œ$FFT$æœ¬èº«å°±æ˜¯ä½¿ç”¨å¤æ•°è®¡ç®—æ‰€ä»¥ç›´æ¥ä¼ å…¥å¤æ•°ä¹Ÿæ²¡å…³ç³»ã€‚</p>
<p>è®¾$T_1 = P \times Q = A_1 A_2 - B_1 B_2 + (A_1 B_2 + A_2 B_1)i$ï¼Œ</p>
<p>åˆè®¾$Pâ€™ = A_1 - iB_1$ï¼Œ</p>
<p>é‚£$T_2 = Pâ€™ \times Q = A_1 A_2 + B_1 B_2 + (A_1 B_2 - A_2 B_1)i$ï¼Œ</p>
<p>ä¸¤è€…$T_1$å’Œ$T_2$è¿›è¡Œå’Œå·®å°±å¾—åˆ°äº†å¤šé¡¹å¼çš„ä¸¤ä¸¤ä¹˜ç§¯ï¼ˆå¦™å•Šï¼‰ã€‚</p>
<p>æ€»çš„$FFT$æ¬¡æ•°ä¸º$3$æ¬¡DFT$+2$æ¬¡IDFT$=5$æ¬¡ã€‚</p>
<p>çªç„¶å‘ç°å€¼åŸŸå…¶å®åº”è¯¥æ˜¯$10^{19}$è€Œä¸æ˜¯$10^{14}$ï¼Œå› ä¸º$IDFT$ä¹‹å‰è¿˜å¾—é™¤ä»¥$n$â€¦â€¦</p>
<p>çœ‹æ•°æ®å¼ºåº¦è·‘å§ï¼Œä»£ç å€’æ˜¯æŒºå¥½å†™çš„ã€‚</p>
<p><strong>è®¡ç®—$\pi$ä¸è¦ç”¨å¸¸é‡<code>M_PI</code>è€Œæ˜¯è¦ç”¨<code>acos(-1)</code>!!!!ä¸ç„¶è¿™é¢˜ä¸¢å¤±ç²¾åº¦åªèƒ½è¿‡å‰$10$ä¸ªç‚¹!!!!</strong></p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4245.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4245</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> comp = complex&lt;<span class="type">long</span> <span class="type">double</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">double</span> MPI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="comment">// å¯¹åº”æ–¹æ³•1</span></span><br><span class="line"><span class="keyword">namespace</span> solve1 &#123;</span><br><span class="line">    <span class="type">int</span> mod;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> mod)</span> </span>&#123;</span><br><span class="line">        solve1::mod = mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qmul</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = mod)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = (x + x) % p)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = (ret + x) % p;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> p = mod)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = <span class="built_in">qmul</span>(x, x, p))</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = <span class="built_in">qmul</span>(ret, x, p);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (mod - <span class="number">1</span>) / h);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % mod;</span><br><span class="line">                    f[k] = (u + t + mod) % mod;</span><br><span class="line">                    f[k + h / <span class="number">2</span>] = (u - t + mod) % mod;</span><br><span class="line">                    g = g * gn % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, mod - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] = f[i] * inv % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> MODS[<span class="number">3</span>] = &#123;<span class="number">998244353</span>, <span class="number">1004535809</span>, <span class="number">469762049</span>&#125;;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INV1 = <span class="built_in">qpow</span>(MODS[<span class="number">0</span>], MODS[<span class="number">1</span>] - <span class="number">2</span>, MODS[<span class="number">1</span>]);</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> INV2 = <span class="built_in">qpow</span>(MODS[<span class="number">0</span>] * MODS[<span class="number">1</span>] % MODS[<span class="number">2</span>], MODS[<span class="number">2</span>] - <span class="number">2</span>, MODS[<span class="number">2</span>]);</span><br><span class="line">    <span class="type">int</span> n, m, p, a[<span class="number">3</span>][MAXN], b[<span class="number">3</span>][MAXN], ans[<span class="number">3</span>][MAXN];</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">crt</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> t = (a2 - a1 + MODS[<span class="number">1</span>]) % MODS[<span class="number">1</span>] * INV1 % MODS[<span class="number">1</span>] * MODS[<span class="number">0</span>] + a1;</span><br><span class="line">        <span class="keyword">return</span> ((a3 - t % MODS[<span class="number">2</span>] + MODS[<span class="number">2</span>]) % MODS[<span class="number">2</span>] * INV2 % MODS[<span class="number">2</span>] * (MODS[<span class="number">0</span>] * MODS[<span class="number">1</span>] % p) % p + t) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(p);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">read</span>(x) %= p, a[<span class="number">0</span>][i] = a[<span class="number">1</span>][i] = a[<span class="number">2</span>][i] = x;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x; i &lt;= m; ++i)</span><br><span class="line">            <span class="built_in">read</span>(x) %= p, b[<span class="number">0</span>][i] = b[<span class="number">1</span>][i] = b[<span class="number">2</span>][i] = x;</span><br><span class="line">        <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (len &lt; n + m + <span class="number">1</span>)</span><br><span class="line">            len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">3</span>; ++k) &#123;</span><br><span class="line">            <span class="built_in">init</span>(MODS[k]);</span><br><span class="line">            <span class="built_in">ntt</span>(a[k], len, <span class="number">1</span>), <span class="built_in">ntt</span>(b[k], len, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                ans[k][i] = a[k][i] * b[k][i] % mod;</span><br><span class="line">            <span class="built_in">ntt</span>(ans[k], len, <span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n + m; ++i)</span><br><span class="line">            <span class="built_in">write</span>(<span class="built_in">crt</span>(ans[<span class="number">0</span>][i], ans[<span class="number">1</span>][i], ans[<span class="number">2</span>][i])), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == n + m]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¯¹åº”æ–¹æ³•2</span></span><br><span class="line"><span class="keyword">namespace</span> solve2 &#123;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(comp *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">fft</span><span class="params">(comp *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="function">comp <span class="title">wn</span><span class="params">(cos(<span class="number">2</span> * MPI / h), sin(<span class="number">2</span> * MPI / h))</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="function">comp <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    comp u = f[k], t = w * f[k + h / <span class="number">2</span>];</span><br><span class="line">                    f[k] = u + t;</span><br><span class="line">                    f[k + h / <span class="number">2</span>] = u - t;</span><br><span class="line">                    w *= wn;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] /= len;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> BLOC = <span class="number">1</span> &lt;&lt; <span class="number">15</span>;</span><br><span class="line">    <span class="type">int</span> n, m, p, a[MAXN], b[MAXN], ans[MAXN];</span><br><span class="line">    comp p1[MAXN], p2[MAXN], q[MAXN], t1[MAXN], t2[MAXN];</span><br><span class="line">    <span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(p);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">read</span>(a[i]) %= p;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            <span class="built_in">read</span>(b[i]) %= p;</span><br><span class="line">        <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (len &lt; n + m + <span class="number">1</span>)</span><br><span class="line">            len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            p1[i] = <span class="built_in">comp</span>(a[i] / BLOC, a[i] % BLOC);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            p2[i] = <span class="built_in">comp</span>(a[i] / BLOC, -a[i] % BLOC);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            q[i] = <span class="built_in">comp</span>(b[i] / BLOC, b[i] % BLOC);</span><br><span class="line">        <span class="built_in">fft</span>(p1, len, <span class="number">1</span>), <span class="built_in">fft</span>(p2, len, <span class="number">1</span>), <span class="built_in">fft</span>(q, len, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            t1[i] = p1[i] * q[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            t2[i] = p2[i] * q[i];</span><br><span class="line">        <span class="built_in">fft</span>(t1, len, <span class="number">-1</span>), <span class="built_in">fft</span>(t2, len, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> a1a2 = ((<span class="type">int</span>)((t1[i].<span class="built_in">real</span>() + t2[i].<span class="built_in">real</span>()) / <span class="number">2</span> + <span class="number">0.5</span>)) % p;</span><br><span class="line">            <span class="type">int</span> a1b2 = ((<span class="type">int</span>)((t2[i].<span class="built_in">imag</span>() + t1[i].<span class="built_in">imag</span>()) / <span class="number">2</span> + <span class="number">0.5</span>)) % p;</span><br><span class="line">            <span class="type">int</span> a2b1 = ((<span class="type">int</span>)((t1[i].<span class="built_in">imag</span>() - t2[i].<span class="built_in">imag</span>()) / <span class="number">2</span> + <span class="number">0.5</span>)) % p;</span><br><span class="line">            <span class="type">int</span> b1b2 = ((<span class="type">int</span>)((t2[i].<span class="built_in">real</span>() - t1[i].<span class="built_in">real</span>()) / <span class="number">2</span> + <span class="number">0.5</span>)) % p;</span><br><span class="line">            ans[i] = (a1a2 * (<span class="number">1ll</span> &lt;&lt; <span class="number">30</span>) % p + (a1b2 + a2b1) * (<span class="number">1ll</span> &lt;&lt; <span class="number">15</span>) % p + b1b2) % p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n + m; ++i)</span><br><span class="line">            <span class="built_in">write</span>(ans[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == n + m]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// return solve1::main();</span></span><br><span class="line">    <span class="keyword">return</span> solve2::<span class="built_in">main</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF632E Thief in a Shop é¢˜è§£</title>
    <url>/2021/12/05/sol-cf632e/</url>
    <content><![CDATA[<h2 id="CF632E-Thief-in-a-Shop-é¢˜è§£"><a href="#CF632E-Thief-in-a-Shop-é¢˜è§£" class="headerlink" title="CF632E Thief in a Shop é¢˜è§£"></a>CF632E Thief in a Shop é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF632E">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p><del>å…¶å®è¿™é¢˜å¯ä»¥ç›´æ¥æš´åŠ›åšçš„</del></p>
<p>è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹<a href="https://oi-wiki.org/math/gen-func/ogf/">ç”Ÿæˆå‡½æ•°</a>å§ã€‚</p>
<p>å¯¹äºæ‰€æœ‰ç‰©å“æ„é€ ç”Ÿæˆå‡½æ•°$f(x) = \sum\limits_{i\in S}{x^i}$</p>
<p>å–å‡º$k$ä¸ªç‰©å“ç›¸å½“äº$f^k(x)$ã€‚</p>
<p>ä½†æ˜¯é¢˜è§£é‡Œè¯´æ¨¡æ•°$998244353$å’Œ$1004535809$éƒ½è¢«å¡äº†ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©ä½¿ç”¨åŒæ¨¡æ•°é˜²æ­¢è¢«$hack$ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(N \log N)$ï¼Œå…¶ä¸­$N$æ˜¯$10^6$çº§åˆ«çš„ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF632E.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF632E</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line">    <span class="type">int</span> mod;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> mod)</span> </span>&#123;</span><br><span class="line">        maths::mod = mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % mod)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = ret * x % mod;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (mod - <span class="number">1</span>) / h);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % mod;</span><br><span class="line">                    f[k] = (u + t + mod) % mod;</span><br><span class="line">                    f[k + h / <span class="number">2</span>] = (u - t + mod) % mod;</span><br><span class="line">                    g = g * gn % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, mod - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] = f[i] * inv % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, k, cnt, a[MAXN], b[MAXN], answ[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="built_in">read</span>(x);</span><br><span class="line">        a[x] = b[x] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line">    maths::<span class="built_in">init</span>(<span class="number">998244353</span>);</span><br><span class="line">    maths::<span class="built_in">ntt</span>(a, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = maths::<span class="built_in">qpow</span>(a[i], k);</span><br><span class="line">    maths::<span class="built_in">ntt</span>(a, len, <span class="number">-1</span>);</span><br><span class="line">    maths::<span class="built_in">init</span>(<span class="number">1004535809</span>);</span><br><span class="line">    maths::<span class="built_in">ntt</span>(b, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        b[i] = maths::<span class="built_in">qpow</span>(b[i], k);</span><br><span class="line">    maths::<span class="built_in">ntt</span>(b, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        <span class="keyword">if</span> (a[i] || b[i])</span><br><span class="line">            answ[++cnt] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">        <span class="built_in">write</span>(answ[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == cnt]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4721 ã€æ¨¡ç‰ˆã€‘åˆ†æ²»FFT é¢˜è§£</title>
    <url>/2021/12/05/sol-p4721/</url>
    <content><![CDATA[<h2 id="P4721-ã€æ¨¡ç‰ˆã€‘åˆ†æ²»FFT-é¢˜è§£"><a href="#P4721-ã€æ¨¡ç‰ˆã€‘åˆ†æ²»FFT-é¢˜è§£" class="headerlink" title="P4721 ã€æ¨¡ç‰ˆã€‘åˆ†æ²»FFT é¢˜è§£"></a>P4721 ã€æ¨¡ç‰ˆã€‘åˆ†æ²»FFT é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4721">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>ç”±äº$f_i$ä¾èµ–äº$f_j(1\le j\lt i)$ï¼Œæ‰€ä»¥è€ƒè™‘åˆ†æ²»è®¡ç®—ï¼Œæ¯æ¬¡å…ˆè®¡ç®—å·¦åŠæ®µï¼Œå°†è´¡çŒ®åŠ åˆ°å³åŠæ®µåç»§ç»­é€’å½’è®¡ç®—å³åŠæ®µã€‚</p>
<p>æ€è€ƒå¦‚ä½•è®¡ç®—è´¡çŒ®ã€‚å‘ç°é¢˜ç›®ä¸­$f<em>i=\sum\limits</em>{j=1}^{i}{f_{i-j}g_j}$çš„æ–¹å¼å¾ˆåƒå¤šé¡¹å¼ä¹˜æ³•ï¼ŒåŒºé—´$[l,mid]$å¯¹$f_i(mid \lt i \le r)$çš„è´¡çŒ®å°±æ˜¯$F(x) = f(x) \times g(x)$çš„$F(i)$ï¼Œç”¨$NTT$è¿›è¡Œè®¡ç®—å³å¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \log^2 n)$ï¼ˆä¼¼ä¹æ¯”å¤šé¡¹å¼æ±‚é€†è¦æ…¢ä¸å°‘ï¼‰ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4721.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4721</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">18</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> G0 = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % MOD)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = ret * x % MOD;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> gn = <span class="built_in">qpow</span>(G0, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                    f[k] = (u + t + MOD) % MOD;</span><br><span class="line">                    f[k + h / <span class="number">2</span>] = (u - t + MOD) % MOD;</span><br><span class="line">                    g = g * gn % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] = f[i] * inv % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> maths::ntt;</span><br><span class="line"><span class="type">int</span> n, a[MAXN], b[MAXN], f[MAXN], g[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> len = r - l + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">solve</span>(l, mid);</span><br><span class="line">    <span class="built_in">copy</span>(f + l, f + mid + <span class="number">1</span>, a);</span><br><span class="line">    <span class="built_in">copy</span>(g, g + len, b);</span><br><span class="line">    <span class="built_in">fill</span>(a + len / <span class="number">2</span>, a + len, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">ntt</span>(a, len, <span class="number">1</span>), <span class="built_in">ntt</span>(b, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = a[i] * b[i] % MOD;</span><br><span class="line">    <span class="built_in">ntt</span>(a, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = mid + <span class="number">1</span>; i &lt;= r; ++i)</span><br><span class="line">        f[i] = (f[i] + a[i - l]) % MOD;</span><br><span class="line">    <span class="built_in">solve</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(g[i]);</span><br><span class="line">    <span class="type">int</span> len = f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">solve</span>(<span class="number">0</span>, len - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">write</span>(f[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == n - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4238 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æ±‚é€† é¢˜è§£</title>
    <url>/2021/12/05/sol-p4238/</url>
    <content><![CDATA[<h2 id="P4238-ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æ±‚é€†-é¢˜è§£"><a href="#P4238-ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æ±‚é€†-é¢˜è§£" class="headerlink" title="P4238 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æ±‚é€† é¢˜è§£"></a>P4238 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼æ±‚é€† é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4238">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å‡è®¾æˆ‘ä»¬è¦æ±‚</p>
<script type="math/tex; mode=display">f(x) \cdot g(x) \equiv 1 \pmod{x^n}</script><p>å¦‚æœå·²ç»çŸ¥é“</p>
<script type="math/tex; mode=display">f(x) \cdot h(x) \equiv 1 \pmod{x^\frac{n}{2}}</script><p>é‚£ä¹ˆç›¸å‡å¯å¾—</p>
<script type="math/tex; mode=display">f(x) \cdot (g(x) - h(x)) \equiv 0 \pmod{x^\frac{n}{2}}</script><script type="math/tex; mode=display">g(x) - h(x) \equiv 0 \pmod{x^\frac{n}{2}}</script><p>ä¸¤è¾¹åŒæ—¶å¹³æ–¹å¾—åˆ°</p>
<script type="math/tex; mode=display">g^2(x) - 2 \cdot g(x) \cdot h(x) + h^2(x) \equiv 0 \pmod{x^n}</script><p>ä¹˜ä¸Š$f(x)$å¾—åˆ°</p>
<script type="math/tex; mode=display">g(x) - 2 \cdot h(x) + f(x) \cdot h^2(x) \equiv 0 \pmod{x^n}</script><p>ç§»é¡¹å¾—åˆ°</p>
<script type="math/tex; mode=display">g(x) \equiv h(x) \cdot (2 - f(x) \cdot h(x)) \pmod{x^n}</script><p>é€’å½’è®¡ç®—å³å¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦</p>
<script type="math/tex; mode=display">T(n) = T\left(\frac{n}{2}\right) + O(n \log n) = O(n \log n)</script><h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4238.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4238</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">18</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">namespace</span> maths &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % MOD)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = ret * x % MOD;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> rev[MAXN];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = rev[<span class="number">0</span>] = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                    f[k] = (u + t + MOD) % MOD;</span><br><span class="line">                    f[k + h / <span class="number">2</span>] = (u - t + MOD) % MOD;</span><br><span class="line">                    g = g * gn % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] = f[i] * inv % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">polyinv</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len, <span class="type">int</span> *g)</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> tmp[MAXN];</span><br><span class="line">        <span class="built_in">fill</span>(tmp, tmp + len + len, <span class="number">0</span>);</span><br><span class="line">        g[<span class="number">0</span>] = <span class="built_in">qpow</span>(f[<span class="number">0</span>], MOD - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> t = <span class="number">2</span>; t &lt;= len; t &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">copy</span>(f, f + t, tmp);</span><br><span class="line">            <span class="built_in">fill</span>(tmp + t, tmp + t + t, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">ntt</span>(g, t + t, <span class="number">1</span>), <span class="built_in">ntt</span>(tmp, t + t, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; t + t; ++i)</span><br><span class="line">                g[i] = g[i] * (<span class="number">2</span> - tmp[i] * g[i] % MOD + MOD) % MOD;</span><br><span class="line">            <span class="built_in">ntt</span>(g, t + t, <span class="number">-1</span>);</span><br><span class="line">            <span class="built_in">fill</span>(g + t, g + t + t, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> maths;</span><br><span class="line"><span class="type">int</span> n, f[MAXN], g[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(f[i]);</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; n)</span><br><span class="line">        len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">polyinv</span>(f, len, g);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">write</span>(g[i]), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == n - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF526G Spiders Evil Plan é¢˜è§£</title>
    <url>/2021/12/04/sol-cf526g/</url>
    <content><![CDATA[<h2 id="CF526G-Spiders-Evil-Plan-é¢˜è§£"><a href="#CF526G-Spiders-Evil-Plan-é¢˜è§£" class="headerlink" title="CF526G Spiders Evil Plan é¢˜è§£"></a>CF526G Spiders Evil Plan é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF526G">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æœ‰æ„æ€ï¼Œå¾ˆæœ‰æ„æ€ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æš‚æ—¶å¿½ç•¥è·¯å¾„å¿…é¡»ç»è¿‡$x$çš„é™åˆ¶è¿›è¡Œæ€è€ƒã€‚å®¹æ˜“æƒ³åˆ°æœ€é•¿çš„ä¸€æ¡è·¯å¾„æ˜¯æ ‘çš„ç›´å¾„ï¼Œä¸”å…¶ä»–è·¯å¾„éƒ½æ˜¯ä¸€ä¸ªå¶å­åˆ°å¦ä¸€ä¸ªå¶å­çš„ç±»å‹ï¼Œæ¥ç€å‘ç°å¦‚æœè·¯å¾„å¿…é¡»ç»è¿‡$x$ä¹Ÿéœ€è¦ä¿è¯æœ€é•¿è·¯å¾„ç»è¿‡ç›´å¾„çš„å…¶ä¸­ä¸€ä¸ªç«¯ç‚¹ï¼ˆæ˜¾ç„¶æœ€ä¼˜ï¼‰ã€‚äºæ˜¯æƒ³åˆ°ä»¥ç›´å¾„ä¸¤ä¸ªç«¯ç‚¹ä¸ºæ ¹åˆ†åˆ«å»ºä¸€æ£µæ ‘ï¼Œåˆ†åˆ«æ±‚æ ¹ç»è¿‡$x$åˆ°ä¸€ä¸ªå¶å­ç»“ç‚¹çš„æœ€é•¿è·¯å¾„å$\max$ï¼Œå¯é€šè¿‡$y=1$ã€‚</p>
<p>å°†æ¯æ¡è·¯å¾„æ‹†åˆ†ä¸º$2$ä¸ªå¶å­ç»“ç‚¹çš„è·¯å¾„ã€‚å¦‚æœæ— éœ€ç»è¿‡èŠ‚ç‚¹$x$ï¼Œé‚£ä¹ˆé™¤å»åˆ°æ ¹çš„è·¯å¾„ä¹‹å¤–è¿˜éœ€è¦å–å‡º$2y-1$ä¸ªå¶å­ç»“ç‚¹è·¯å¾„ã€‚ç„¶åéœ€è¦ç”¨åˆ°ä¸€ä¸ª<strong>é•¿é“¾å‰–åˆ†</strong>å°$trick$ï¼ˆä¹Ÿæ˜¯è¿™é¢˜æœ€å¦™çš„åœ°æ–¹ï¼‰ï¼Œå¯¹äºæ¯æ¡é•¿é“¾ï¼Œå®šä¹‰å…¶å¸¦æƒé•¿åº¦ä¸º<strong>é“¾å¤´çš„çˆ¶èŠ‚ç‚¹åˆ°é“¾å°¾çš„è·ç¦»</strong>ï¼Œå³<code>sdep[u] - sdep[fa[top[u]]]</code>ï¼Œå¯ä»¥è¯æ˜<strong>æ›´é•¿çš„é“¾ä¸€å®šä¼šæ¯”æ›´çŸ­çš„é“¾å…ˆè¢«å–åˆ°ï¼Œä¸”è´¡çŒ®å³ä¸ºé“¾çš„å¸¦æƒé•¿åº¦</strong>ã€‚äºæ˜¯å–å‡ºæ ‘ä¸Šçš„æ‰€æœ‰é•¿é“¾å¹¶ä»å¤§åˆ°å°æ’åºï¼Œå–å¾—å‰$2y-1$ä¸ªå¸¦æƒé•¿åº¦ä¹‹å’Œå³ä¸ºä¸ç»è¿‡$x$çš„$y$ä¸ªæœ€é•¿è·¯å¾„é•¿åº¦ä¹‹å’Œã€‚</p>
<p><img src="sol-cf526g-tree1.png" alt=""></p>
<p>å¦‚å›¾æ‰€ç¤ºçš„ä¸€æ£µæ ‘ï¼Œé»‘è‰²è¾¹ä¸ºå…¶ç›´å¾„ï¼Œå°†å…¶<strong>æŒ‰è¾¹æƒ</strong>é•¿é“¾å‰–åˆ†åå¾—åˆ°å‡ æ¡é“¾ï¼Œæ˜¾ç„¶è¦å…ˆå–é»‘è‰²é“¾ï¼Œå†æŒ‰é¡ºåºå–è“è‰²ã€ç²‰è‰²å’Œæ©™è‰²é“¾ï¼Œè€Œæ¯åŠ å…¥ä¸€æ¡é“¾åå¯¹ç­”æ¡ˆçš„è´¡çŒ®å°±æ˜¯é“¾çš„å¸¦æƒé•¿åº¦ã€‚</p>
<p>ç°åœ¨è€ƒè™‘å¿…é¡»ç»è¿‡$x$çš„å–æ³•ã€‚åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œè‹¥å‰$2y-1$æ¡é“¾ç»è¿‡$x$ç›´æ¥å–å‰ç¼€å’Œè®¡ç®—ï¼ˆè‡³äºå¦‚ä½•åˆ¤æ–­å¯ä½¿ç”¨æ ‘ä¸Š$dp$ç»´æŠ¤å­æ ‘å†…å¶å­èŠ‚ç‚¹æ‰€åœ¨é“¾çš„æœ€é å‰æ’åï¼‰ã€‚å¦åˆ™æˆ‘ä»¬è¦æ‰¾åˆ°ç¬¬$1$åˆ°$2y-1$ä¸­çš„ä¸€æ¡é“¾ï¼ˆå‡å®šä¸º$k$ï¼‰ï¼Œå°†å…¶ç§»é™¤å¹¶åŠ å…¥ç»è¿‡$x$çš„æœ€é•¿é“¾ã€‚</p>
<p>æŸ¥æ‰¾å¹¶åˆ é™¤ä¸€æ¡é“¾æ—¶ï¼Œä»å¯ä»¥åˆ†ä¸¤ç§æƒ…å†µã€‚è‹¥ç¬¬$k$æ¡é“¾çš„$top_k$ä¸æ˜¯$x$çš„ç¥–å…ˆï¼Œåˆ™å…¶åˆ é™¤çš„ä»£ä»·ä¸º$len_k$ï¼Œæ˜¾ç„¶$k=2y-1$æ—¶æœ€ä¼˜ã€‚å¦ä¸€ç§$top_k$ä¸º$x$çš„ç¥–å…ˆï¼Œä»$u$å¾€ä¸Šå€å¢æ‰¾åˆ°ç¬¬ä¸€æ¡$k\le 2y-1$çš„é“¾ï¼Œå…¶å¶å­ç»“ç‚¹ä¸$x$çš„$lca$ä¸º$s$ï¼Œåˆ é™¤çš„ä»£ä»·ä¸º$sdep_k - dep_s$ï¼ŒäºŒè€…å–$\min$å³å¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O((n+q)\log n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF526G.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF526G</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">18</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">tree</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">edges</span> &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> n, rt, head[MAXN], nxt[MAXM], tot;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> _n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = _n;</span><br><span class="line">        rt = tot = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(head));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        edge[tot] = &#123;u, v, w&#125;;</span><br><span class="line">        nxt[tot] = head[u];</span><br><span class="line">        head[u] = tot++; </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="type">int</span> dis[MAXN], pre[MAXN];</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maxdis</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f, <span class="type">int</span> d)</span> </span>&#123;</span><br><span class="line">        dis[u] = d, pre[u] = u;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v, w = edge[i].w;</span><br><span class="line">            <span class="keyword">if</span> (v != f &amp;&amp; dis[<span class="built_in">maxdis</span>(v, u, d + w)] &gt; dis[pre[u]])</span><br><span class="line">                pre[u] = pre[v];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pre[u];</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="type">int</span> dfc, sfa[MAXN], dfn[MAXN], len[MAXN], wson[MAXN];</span><br><span class="line">    <span class="type">int</span> dep[MAXN], sdep[MAXN], fa[MAXN][LOGN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">        len[u] = wson[u] = <span class="number">0</span>, fa[u][<span class="number">0</span>] = f;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; LOGN; ++i)</span><br><span class="line">            fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v, w = edge[i].w;</span><br><span class="line">            <span class="keyword">if</span> (v != f) &#123;</span><br><span class="line">                dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">                sdep[v] = sdep[u] + w;</span><br><span class="line">                <span class="built_in">build1</span>(v, u);</span><br><span class="line">                <span class="keyword">if</span> (len[v] + w &gt; len[u])</span><br><span class="line">                    len[u] = len[v] + w, wson[u] = v;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> sf)</span> </span>&#123;</span><br><span class="line">        sfa[u] = sf, dfn[u] = ++dfc;</span><br><span class="line">        <span class="keyword">if</span> (wson[u])</span><br><span class="line">            <span class="built_in">build2</span>(wson[u], sf);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (v != fa[u][<span class="number">0</span>] &amp;&amp; v != wson[u])</span><br><span class="line">                <span class="built_in">build2</span>(v, v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="type">int</span> dp[MAXN], rnk[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">        dp[u] = rnk[u] ? rnk[u] : INFL;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="type">int</span> v = edge[i].v;</span><br><span class="line">            <span class="keyword">if</span> (v != f) &#123;</span><br><span class="line">                <span class="built_in">dfs</span>(v, u);</span><br><span class="line">                dp[u] = <span class="built_in">min</span>(dp[u], dp[v]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getlca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">            <span class="keyword">if</span> (dp[fa[u][i]] &gt; k)</span><br><span class="line">                u = fa[u][i];</span><br><span class="line">        <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="type">int</span> lef, id[MAXN], sum[MAXN * <span class="number">2</span>];</span><br><span class="line">    pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; leaf[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _rt)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;rt = _rt, lef = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">build1</span>(rt, <span class="number">0</span>), <span class="built_in">build2</span>(rt, rt);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (!wson[i])</span><br><span class="line">                leaf[++lef] = &#123;sdep[i] - sdep[fa[sfa[i]][<span class="number">0</span>]], i&#125;;</span><br><span class="line">        <span class="built_in">sort</span>(leaf + <span class="number">1</span>, leaf + lef + <span class="number">1</span>, greater&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;());</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lef; ++i)</span><br><span class="line">            rnk[leaf[i].second] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= lef; ++i)</span><br><span class="line">            id[i] = leaf[i].second;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            sum[i] = sum[i - <span class="number">1</span>] + leaf[i].first;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            sum[i + n] = sum[i + n - <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">dfs</span>(rt, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> k = <span class="number">2</span> * y - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (dp[x] &lt;= k)</span><br><span class="line">            <span class="keyword">return</span> sum[k];</span><br><span class="line">        <span class="type">int</span> s = <span class="built_in">getlca</span>(x, k);</span><br><span class="line">        <span class="keyword">return</span> sum[k] + sdep[id[dp[x]]] - sdep[s] - <span class="built_in">min</span>(leaf[k].first, sdep[id[dp[s]]] - sdep[s]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; tr1, tr2;</span><br><span class="line"><span class="type">int</span> n, q;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">    tr1.<span class="built_in">clear</span>(n), tr2.<span class="built_in">clear</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v), <span class="built_in">read</span>(w);</span><br><span class="line">        tr1.<span class="built_in">addedge</span>(u, v, w);</span><br><span class="line">        tr1.<span class="built_in">addedge</span>(v, u, w);</span><br><span class="line">        tr2.<span class="built_in">addedge</span>(u, v, w);</span><br><span class="line">        tr2.<span class="built_in">addedge</span>(v, u, w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> rt1 = tr1.<span class="built_in">maxdis</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> rt2 = tr1.<span class="built_in">maxdis</span>(rt1, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    tr1.<span class="built_in">init</span>(rt1), tr2.<span class="built_in">init</span>(rt2);</span><br><span class="line">    <span class="type">int</span> lastans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> x, y;</span><br><span class="line">        <span class="built_in">read</span>(x), <span class="built_in">read</span>(y);</span><br><span class="line">        x = (x + lastans - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">        y = (y + lastans - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">        lastans = <span class="built_in">max</span>(tr1.<span class="built_in">solve</span>(x, y), tr2.<span class="built_in">solve</span>(x, y));</span><br><span class="line">        <span class="built_in">write</span>(lastans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF639F Bear and Chemistry é¢˜è§£</title>
    <url>/2021/12/03/sol-cf639f/</url>
    <content><![CDATA[<h2 id="CF639F-Bear-and-Chemistry-é¢˜è§£"><a href="#CF639F-Bear-and-Chemistry-é¢˜è§£" class="headerlink" title="CF639F Bear and Chemistry é¢˜è§£"></a>CF639F Bear and Chemistry é¢˜è§£</h2><span id="more"></span>
<p>åˆä¸€é“é»‘</p>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF639F">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æ€è·¯å¾ˆå¥½æƒ³ï¼Œé¢„å¤„ç†ä¸€éè¾¹åŒç¼©ç‚¹å¾—åˆ°ä¸€æ£µæ ‘ï¼Œè¯¢é—®å»ºå®Œè™šæ ‘å†ä¸€éè¾¹åŒç¼©ç‚¹è·‘å‡ºæ¥$V$é›†åˆä¸­çš„ç‚¹æ˜¯å¦å…¨åœ¨ä¸€ä¸ªè¾¹åŒä¸­ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \log n)$ï¼Œå¸¸æ•°å·¨å¤§ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><p>è°ƒäº†ä¸¤å¤©åå‘ç°æ˜¯å› ä¸º<del>tarjané€€æ ˆçš„æ—¶å€™æŠŠ<code>ins</code>æ ‡è®°æ”¹æˆäº†<code>true</code></del></p>
<p><del>å†™é¢˜ä¸æ³¨æ„ï¼Œå¯¹æ‹ä¸¤å°æ—¶ï¼ˆå…³é”®è¿˜$^{TM}$æ²¡æ‹å‡ºé”™è¯¯ï¼Ÿï¼‰</del></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF639F.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF639F</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="type">int</span> n, m, q, k, h, cnt, len, is[MAXN], iu[MAXN], iv[MAXN], s[MAXN], nd[MAXN];</span><br><span class="line"><span class="type">int</span> idn, top, rt[MAXN], id[MAXN], dep[MAXN], fa[MAXN][LOGN], sta[MAXN];</span><br><span class="line"><span class="type">int</span> dfc1, bcc1, top1, sta1[MAXN], sfa1[MAXN], dfn1[MAXN], low1[MAXN], col1[MAXN];</span><br><span class="line"><span class="type">int</span> dfc2, bcc2, top2, sta2[MAXN], sfa2[MAXN], dfn2[MAXN], low2[MAXN], col2[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[MAXN], tr[MAXN], vtr[MAXN];</span><br><span class="line"><span class="type">bool</span> ins1[MAXN], ins2[MAXN];</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    sfa1[u] = f;</span><br><span class="line">    dfn1[u] = low1[u] = ++dfc1;</span><br><span class="line">    sta1[++top1] = u, ins1[u] = <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> cntf = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f) &#123;</span><br><span class="line">            ++cntf;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!dfn1[v]) &#123;</span><br><span class="line">            <span class="built_in">tarjan1</span>(v, u);</span><br><span class="line">            low1[u] = <span class="built_in">min</span>(low1[u], low1[v]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ins1[v]) &#123;</span><br><span class="line">            low1[u] = <span class="built_in">min</span>(low1[u], dfn1[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (f &amp;&amp; cntf &gt; <span class="number">1</span>)</span><br><span class="line">        low1[u] = <span class="built_in">min</span>(low1[u], dfn1[f]);</span><br><span class="line">    <span class="keyword">if</span> (dfn1[u] == low1[u]) &#123;</span><br><span class="line">        ++bcc1;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">int</span> v = sta1[top1--];</span><br><span class="line">            ins1[v] = <span class="literal">false</span>;</span><br><span class="line">            col1[v] = bcc1;</span><br><span class="line">            <span class="keyword">if</span> (u == v)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    sfa2[u] = f;</span><br><span class="line">    dfn2[u] = low2[u] = ++dfc2;</span><br><span class="line">    sta2[++top2] = u, ins2[u] = <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> cntf = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : vtr[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v == f) &#123;</span><br><span class="line">            ++cntf;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!dfn2[v]) &#123;</span><br><span class="line">            <span class="built_in">tarjan2</span>(v, u);</span><br><span class="line">            low2[u] = <span class="built_in">min</span>(low2[u], low2[v]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ins2[v]) &#123;</span><br><span class="line">            low2[u] = <span class="built_in">min</span>(low2[u], dfn2[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (f &amp;&amp; cntf &gt; <span class="number">1</span>)</span><br><span class="line">        low2[u] = <span class="built_in">min</span>(low2[u], dfn2[f]);</span><br><span class="line">    <span class="keyword">if</span> (dfn2[u] == low2[u]) &#123;</span><br><span class="line">        ++bcc2;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">int</span> v = sta2[top2--];</span><br><span class="line">            ins2[v] = <span class="literal">false</span>;</span><br><span class="line">            col2[v] = bcc2;</span><br><span class="line">            <span class="keyword">if</span> (u == v)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addvedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    vtr[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">    vtr[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    id[u] = ++idn, rt[u] = (f ? rt[f] : u);</span><br><span class="line">    dep[u] = dep[f] + <span class="number">1</span>, fa[u][<span class="number">0</span>] = f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; LOGN; ++i)</span><br><span class="line">        fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : tr[u])</span><br><span class="line">        <span class="keyword">if</span> (v != f)</span><br><span class="line">            <span class="built_in">build1</span>(v, u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v])</span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">    <span class="type">int</span> t = dep[u] - dep[v];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((t &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            u = fa[u][i];</span><br><span class="line">    <span class="keyword">if</span> (u == v)</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> (fa[u][i] != fa[v][i])</span><br><span class="line">            u = fa[u][i], v = fa[v][i];</span><br><span class="line">    <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build2</span><span class="params">(<span class="type">int</span> rtx, <span class="type">int</span> cl)</span> </span>&#123;</span><br><span class="line">    sta[top = <span class="number">1</span>] = rtx, vtr[rtx].<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = cl; i &lt;= cnt &amp;&amp; rt[s[i]] == rtx; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == rtx)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> l = <span class="built_in">lca</span>(s[i], sta[top]);</span><br><span class="line">        <span class="keyword">while</span> (id[l] &lt;= id[sta[top - <span class="number">1</span>]])</span><br><span class="line">            <span class="built_in">addvedge</span>(sta[top - <span class="number">1</span>], sta[top]), --top;</span><br><span class="line">        <span class="keyword">if</span> (l != sta[top])</span><br><span class="line">            vtr[l].<span class="built_in">clear</span>(), <span class="built_in">addvedge</span>(l, sta[top]), sta[top] = nd[++len] = l;</span><br><span class="line">        vtr[s[i]].<span class="built_in">clear</span>(), sta[++top] = s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; top; ++i)</span><br><span class="line">        <span class="built_in">addvedge</span>(sta[i], sta[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        <span class="keyword">if</span> (u == v)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        g[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (!dfn1[i])</span><br><span class="line">            <span class="built_in">tarjan1</span>(i, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (sfa1[i] &amp;&amp; col1[i] != col1[sfa1[i]]) &#123;</span><br><span class="line">            tr[col1[sfa1[i]]].<span class="built_in">push_back</span>(col1[i]);</span><br><span class="line">            tr[col1[i]].<span class="built_in">push_back</span>(col1[sfa1[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= bcc1; ++i)</span><br><span class="line">        <span class="keyword">if</span> (!id[i])</span><br><span class="line">            <span class="built_in">build1</span>(i, <span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> rnd = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> tt = <span class="number">1</span>; tt &lt;= q; ++tt) &#123;</span><br><span class="line">        <span class="type">bool</span> answ = <span class="literal">true</span>;</span><br><span class="line">        <span class="built_in">read</span>(k), <span class="built_in">read</span>(h), cnt = bcc2 = dfc2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">            <span class="built_in">read</span>(is[i]), is[i] = (is[i] + rnd - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= h; ++i) &#123;</span><br><span class="line">            <span class="built_in">read</span>(iu[i]), iu[i] = (iu[i] + rnd - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">read</span>(iv[i]), iv[i] = (iv[i] + rnd - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">            s[++cnt] = col1[is[i]];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= h; ++i)</span><br><span class="line">            s[++cnt] = col1[iu[i]], s[++cnt] = col1[iv[i]];</span><br><span class="line">        <span class="built_in">sort</span>(s + <span class="number">1</span>, s + cnt + <span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">            <span class="keyword">return</span> id[x] &lt; id[y];</span><br><span class="line">        &#125;);</span><br><span class="line">        len = cnt = <span class="built_in">unique</span>(s + <span class="number">1</span>, s + cnt + <span class="number">1</span>) - s - <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">copy</span>(s + <span class="number">1</span>, s + cnt + <span class="number">1</span>, nd + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">            <span class="keyword">if</span> (rt[s[i]] != rt[s[i - <span class="number">1</span>]])</span><br><span class="line">                <span class="built_in">build2</span>(rt[s[i]], i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= h; ++i)</span><br><span class="line">            <span class="keyword">if</span> (col1[iu[i]] != col1[iv[i]])</span><br><span class="line">                <span class="built_in">addvedge</span>(col1[iu[i]], col1[iv[i]]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">            dfn2[nd[i]] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (!dfn2[nd[i]])</span><br><span class="line">                <span class="built_in">tarjan2</span>(nd[i], <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">            <span class="keyword">if</span> (col2[col1[is[i]]] != col2[col1[is[<span class="number">1</span>]]])</span><br><span class="line">                answ = <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">puts</span>(answ ? <span class="string">&quot;YES&quot;</span> : <span class="string">&quot;NO&quot;</span>), (rnd += answ ? tt : <span class="number">0</span>) %= n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF1320E Treeland and Viruses é¢˜è§£</title>
    <url>/2021/12/01/sol-cf1320e/</url>
    <content><![CDATA[<h2 id="CF1320E-Treeland-and-Viruses-é¢˜è§£"><a href="#CF1320E-Treeland-and-Viruses-é¢˜è§£" class="headerlink" title="CF1320E Treeland and Viruses é¢˜è§£"></a>CF1320E Treeland and Viruses é¢˜è§£</h2><span id="more"></span>
<p><del>æ°´é»‘</del></p>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF1320E">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å»ºè™šæ ‘ï¼Œè·‘$dijkstra$ã€‚</p>
<p><del>æ‰€ä»¥è¿™é¢˜ä¸ºä»€ä¹ˆèƒ½è¯„é»‘</del></p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><p><strong><code>nd</code>æ•°ç»„åˆ«å¼€å°äº†ï¼Œè¦å¼€$4 \times 10^5$</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF1320E.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF1320E</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">4e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFI = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">graph</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">edges</span> &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], tot;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        tot = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(head));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">        edge[tot] = &#123;u, v, w&#125;;</span><br><span class="line">        nxt[tot] = head[u];</span><br><span class="line">        head[u] = tot++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">distant</span> &#123;</span><br><span class="line">    <span class="type">int</span> id, fr, ve, dis; <span class="comment">// from, velocity, distance</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">calc</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ##sb-mistakes## `(0 - 1) / x + 1 == 1`ï¼Œè¦ç‰¹åˆ¤æˆ–è€…å†™æˆ`(? + x - 1) / x`</span></span><br><span class="line">        <span class="keyword">return</span> (dis + ve - <span class="number">1</span>) / ve;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> distant &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="type">int</span> cx = <span class="built_in">calc</span>(), cy = o.<span class="built_in">calc</span>();</span><br><span class="line">        <span class="keyword">return</span> cx == cy ? id &lt; o.id : cx &lt; cy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&gt;(<span class="type">const</span> distant &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="type">int</span> cx = <span class="built_in">calc</span>(), cy = o.<span class="built_in">calc</span>();</span><br><span class="line">        <span class="keyword">return</span> cx == cy ? id &lt; o.id : cx &lt; cy;</span><br><span class="line">    &#125;</span><br><span class="line">    distant <span class="keyword">operator</span>+(<span class="type">int</span> x) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> distant&#123;id, fr, ve, dis + x&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, q, k, m, cnt, idn, id[MAXN], nd[MAXM];</span><br><span class="line"><span class="type">int</span> top, sta[MAXN], dep[MAXN], fa[MAXN][LOGN];</span><br><span class="line"><span class="type">int</span> iv[MAXN], iu[MAXN], is[MAXN];</span><br><span class="line"><span class="comment">// ##sb-mistakes## `std::priority_queue`é»˜è®¤æ˜¯`std::less&lt;_Tp&gt;`ï¼Œè‡ªå®šä¹‰ç±»å‹è¦ä¹ˆæŒ‰ç…§`\gt`çš„é€»è¾‘é‡è½½`operator&lt;()`ï¼Œè¦ä¹ˆæŒ‰ç…§`\gt`çš„é€»è¾‘é‡è½½`operator&gt;()`å¹¶ä¸”ä¿®æ”¹é»˜è®¤å‚æ•°</span></span><br><span class="line">priority_queue&lt;pair&lt;distant, <span class="type">int</span>&gt;, vector&lt;pair&lt;distant, <span class="type">int</span>&gt;&gt;, greater&lt;pair&lt;distant, <span class="type">int</span>&gt;&gt;&gt; que;</span><br><span class="line">distant dis[MAXN];</span><br><span class="line">graph tr, vtr;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    id[u] = ++idn, fa[u][<span class="number">0</span>] = f, dep[u] = dep[f] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; LOGN; ++i)</span><br><span class="line">        fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = tr.head[u]; ~i; i = tr.nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (tr.edge[i].v != f)</span><br><span class="line">            <span class="built_in">build</span>(tr.edge[i].v, u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v])</span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">    <span class="type">int</span> t = dep[u] - dep[v];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((t &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            u = fa[u][i];</span><br><span class="line">    <span class="keyword">if</span> (u == v)</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> (fa[u][i] != fa[v][i])</span><br><span class="line">            u = fa[u][i], v = fa[v][i];</span><br><span class="line">    <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_vedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> w = dep[v] - dep[u];</span><br><span class="line">    vtr.<span class="built_in">addedge</span>(u, v, w);</span><br><span class="line">    vtr.<span class="built_in">addedge</span>(v, u, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_vtr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(nd + <span class="number">1</span>, nd + cnt + <span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">        <span class="keyword">return</span> id[x] &lt; id[y];</span><br><span class="line">    &#125;);</span><br><span class="line">    cnt = <span class="built_in">unique</span>(nd + <span class="number">1</span>, nd + cnt + <span class="number">1</span>) - nd - <span class="number">1</span>;</span><br><span class="line">    sta[top = <span class="number">1</span>] = <span class="number">1</span>, vtr.head[<span class="number">1</span>] = <span class="number">-1</span>, vtr.tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nd[i] == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> l = <span class="built_in">lca</span>(sta[top], nd[i]);</span><br><span class="line">        <span class="keyword">while</span> (id[l] &lt;= id[sta[top - <span class="number">1</span>]])</span><br><span class="line">            <span class="built_in">add_vedge</span>(sta[top - <span class="number">1</span>], sta[top]), --top;</span><br><span class="line">        <span class="keyword">if</span> (sta[top] != l)</span><br><span class="line">            vtr.head[l] = <span class="number">-1</span>, <span class="built_in">add_vedge</span>(l, sta[top]), sta[top] = l;</span><br><span class="line">        vtr.head[nd[i]] = <span class="number">-1</span>, sta[++top] = nd[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; top; ++i)</span><br><span class="line">        <span class="built_in">add_vedge</span>(sta[i], sta[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear_dis</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    dis[u] = &#123;INFI, INFI, <span class="number">1</span>, INFI&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; ~i; i = vtr.nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (vtr.edge[i].v != f)</span><br><span class="line">            <span class="built_in">clear_dis</span>(vtr.edge[i].v, u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    tr.<span class="built_in">clear</span>(), vtr.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        tr.<span class="built_in">addedge</span>(u, v);</span><br><span class="line">        tr.<span class="built_in">addedge</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="built_in">read</span>(k), <span class="built_in">read</span>(m), cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">            <span class="built_in">read</span>(iv[i]), <span class="built_in">read</span>(is[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            <span class="built_in">read</span>(iu[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">            nd[++cnt] = iv[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            nd[++cnt] = iu[i];</span><br><span class="line">        <span class="built_in">build_vtr</span>(), <span class="built_in">clear_dis</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>())</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">            dis[iv[i]] = &#123;i, iv[i], is[i], <span class="number">0</span>&#125;;</span><br><span class="line">            que.<span class="built_in">push</span>(&#123;dis[iv[i]], iv[i]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            distant d = que.<span class="built_in">top</span>().first;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">top</span>().second;</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (dis[u] &lt; d)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; ~i; i = vtr.nxt[i]) &#123;</span><br><span class="line">                <span class="type">int</span> v = vtr.edge[i].v, w = vtr.edge[i].w;</span><br><span class="line">                <span class="keyword">if</span> (d + w &lt; dis[v]) &#123;</span><br><span class="line">                    dis[v] = d + w;</span><br><span class="line">                    que.<span class="built_in">push</span>(&#123;dis[v], v&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            <span class="built_in">write</span>(dis[iu[i]].id), <span class="built_in">putchar</span>(<span class="string">&quot; \n&quot;</span>[i == m]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4606 æˆ˜ç•¥æ¸¸æˆ é¢˜è§£</title>
    <url>/2021/11/29/sol-p4606/</url>
    <content><![CDATA[<h2 id="P4606-æˆ˜ç•¥æ¸¸æˆ-é¢˜è§£"><a href="#P4606-æˆ˜ç•¥æ¸¸æˆ-é¢˜è§£" class="headerlink" title="P4606 æˆ˜ç•¥æ¸¸æˆ é¢˜è§£"></a>P4606 æˆ˜ç•¥æ¸¸æˆ é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4606">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><blockquote>
<p>åœ†æ–¹æ ‘ä¸Šåœ†æ–¹æœ</p>
<p>åœ†æ–¹æ ‘ä¸‹ä½ å’Œæˆ‘</p>
<p>åœ†æ–¹æ ‘å‰å»ºè™šæ ‘</p>
<p>æ¬¢ä¹å¤šåˆå¤š <del>/kk</del></p>
</blockquote>
<p>çœ‹åˆ°$\sum|S|$äºæ˜¯å¼€å§‹å¥—è·¯åœ°æƒ³åˆ°è™šæ ‘ã€‚</p>
<p>ä½†æ˜¯ç»™å®šçš„æ˜¯ä¸€ä¸ªæ— å‘å›¾ä¸æ˜¯ä¸€æ£µæ ‘å•Šâ€¦â€¦</p>
<p>æ‰€ä»¥è¦æƒ³åŠæ³•æŠŠå›¾è½¬åŒ–æˆä¸€æ£µæ ‘ï¼Œè¿™æ ·çš„æ•°æ®ç»“æ„å«åš<a href="https://oi-wiki.org/graph/block-forest/">åœ†æ–¹æ ‘</a>ã€‚</p>
<p><del><strong>è¿™é‡Œå‡è®¾ä½ å·²ç»å­¦ä¼šåœ†æ–¹æ ‘äº†</strong></del></p>
<p>è€ƒè™‘åœ†æ–¹æ ‘çš„æ€§è´¨ã€‚æ˜¾ç„¶å¯¹äºä¸€å¯¹èŠ‚ç‚¹$(u, v)$ï¼Œå®ƒä»¬åœ¨åœ†æ–¹æ ‘ä¸Šçš„è·¯å¾„ä¸­çš„åœ†ç‚¹ï¼ˆä¸åŒ…æ‹¬è‡ªèº«ï¼‰å°±æ˜¯åˆ æ‰åèƒ½ä½¿å¾—$u$å’Œ$v$ä¸è¿é€šçš„ç‚¹ã€‚å› ä¸ºæ ¹æ®åœ†æ–¹æ ‘çš„æ€§è´¨ï¼Œæ‰€æœ‰å’ŒåŒä¸€ä¸ªæ–¹ç‚¹è¿è¾¹çš„åœ†ç‚¹éƒ½åœ¨åŒä¸€ä¸ªåŒè”é€šåˆ†é‡é‡Œï¼Œå»æ‰ä¸€ä¸ªæ–¹ç‚¹ä¸ä¼šæ”¹å˜å›¾çš„è¿é€šæ€§ã€‚è€Œé‚£äº›å’Œå¤šä¸ªæ–¹ç‚¹è¿è¾¹çš„åœ†ç‚¹éƒ½å¯ä»¥æˆä¸ºè¿™äº›æ–¹ç‚¹çš„å‰²ç‚¹ï¼Œå»æ‰åå›¾çš„è¿é€šæ€§å°±æ”¹å˜äº†ã€‚</p>
<p>äºæ˜¯ç­”æ¡ˆå°±æ˜¯æ‰€æœ‰ç‰¹æ®ŠèŠ‚ç‚¹ä¹‹é—´çš„è·¯å¾„å¹¶ä¸Šåœ†ç‚¹æ•°é‡å‡å»$|S|$ã€‚</p>
<p>æ€è·¯è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œä¸»è¦æ˜¯ä»£ç ä¸­çš„<del>äº¿ç‚¹ç‚¹</del>ç»†èŠ‚ã€‚æ¯”å¦‚è¯´<code>MAXN</code>è¦å¼€ä¸¤å€å¤§å°ï¼ˆå› ä¸ºæœ‰åœ†æ–¹æ ‘ï¼‰ã€ç»Ÿè®¡ç­”æ¡ˆä¸è¦æŠŠè™šæ ‘çš„æ‰€æœ‰è¾¹æƒéƒ½åŠ ä¸Šï¼ˆå› ä¸ºè™šæ ‘è¦å»ºç«‹èŠ‚ç‚¹$1$è€Œæœ‰æ—¶èŠ‚ç‚¹$1$å¹¶ä¸å‡ºç°åœ¨è·¯å¾„å¹¶ä¸­ï¼‰<del>ä»¥åŠå¤šæµ‹è¦æ¸…ç©º<code>dfn</code>æ•°ç»„</del>ç­‰ç­‰ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \log n)$ï¼ˆæ„Ÿè§‰å¸¸æ•°å·¨å¤§æ— æ¯”ï¼‰ã€‚è°ƒäº†ä¸¤å¤©ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4606.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4606</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">4e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">8e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> LOGN = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Graph</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> v, w;</span><br><span class="line">    &#125; edge[MAXM];</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], tot;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">        edge[tot] = &#123;v, w&#125;;</span><br><span class="line">        nxt[tot] = head[u];</span><br><span class="line">        head[u] = tot++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, q, k, dfc, top, bcc, idn;</span><br><span class="line"><span class="type">int</span> s[MAXN], dfn[MAXN], low[MAXN], sta[MAXN];</span><br><span class="line"><span class="type">int</span> id[MAXN], dep[MAXN], fa[MAXN][LOGN];</span><br><span class="line"><span class="type">bool</span> tag[MAXN];</span><br><span class="line">Graph g, tr, vtr;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    g.tot = tr.tot = vtr.tot = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ##sb-mistakes## å¤šæµ‹ä¸æ¸…ç©ºï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª/kk å¤šæµ‹`dfn`æ•°ç»„è®°å¾—æ¸…ç©ºå•Š</span></span><br><span class="line">    <span class="built_in">memset</span>(dfn, <span class="number">0</span>, <span class="built_in">sizeof</span>(dfn));</span><br><span class="line">    <span class="built_in">memset</span>(g.head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(g.head));</span><br><span class="line">    <span class="built_in">memset</span>(tr.head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(tr.head));</span><br><span class="line">    <span class="built_in">memset</span>(vtr.head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(vtr.head));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    dfn[u] = low[u] = ++dfc;</span><br><span class="line">    sta[++top] = u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = g.head[u]; ~i; i = g.nxt[i]) &#123;</span><br><span class="line">        <span class="type">int</span> v = g.edge[i].v;</span><br><span class="line">        <span class="keyword">if</span> (!dfn[v]) &#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(v);</span><br><span class="line">            low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">            <span class="keyword">if</span> (dfn[u] == low[v]) &#123;</span><br><span class="line">                ++bcc;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">0</span>; x != v; --top) &#123;</span><br><span class="line">                    x = sta[top];</span><br><span class="line">                    tr.<span class="built_in">addedge</span>(bcc, x);</span><br><span class="line">                    tr.<span class="built_in">addedge</span>(x, bcc);</span><br><span class="line">                &#125;</span><br><span class="line">                tr.<span class="built_in">addedge</span>(bcc, u);</span><br><span class="line">                tr.<span class="built_in">addedge</span>(u, bcc);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    id[u] = ++idn;</span><br><span class="line">    fa[u][<span class="number">0</span>] = f;</span><br><span class="line">    dep[u] = dep[f] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; LOGN; ++i)</span><br><span class="line">        fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = tr.head[u]; ~i; i = tr.nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (tr.edge[i].v != f)</span><br><span class="line">            <span class="built_in">build</span>(tr.edge[i].v, u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v])</span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">    <span class="type">int</span> t = dep[u] - dep[v];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((t &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            u = fa[u][i];</span><br><span class="line">    <span class="keyword">if</span> (u == v)</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = LOGN - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> (fa[u][i] != fa[v][i])</span><br><span class="line">            u = fa[u][i], v = fa[v][i];</span><br><span class="line">    <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_vedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> w = ((dep[v] - dep[u]) &amp; <span class="number">1</span>) ? ((dep[v] - dep[u]) / <span class="number">2</span>) : ((dep[v] - dep[u]) / <span class="number">2</span> - (v &lt;= n));</span><br><span class="line">    vtr.<span class="built_in">addedge</span>(u, v, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_vtr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(s + <span class="number">1</span>, s + k + <span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">        <span class="keyword">return</span> id[x] &lt; id[y];</span><br><span class="line">    &#125;);</span><br><span class="line">    sta[top = <span class="number">1</span>] = <span class="number">1</span>, vtr.head[<span class="number">1</span>] = <span class="number">-1</span>, vtr.tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> l = <span class="built_in">lca</span>(sta[top], s[i]);</span><br><span class="line">        <span class="keyword">if</span> (l &lt; <span class="number">1</span> || l &gt; bcc)</span><br><span class="line">            <span class="built_in">lca</span>(sta[top], s[i]);</span><br><span class="line">        <span class="keyword">while</span> (id[l] &lt;= id[sta[top - <span class="number">1</span>]])</span><br><span class="line">            <span class="built_in">add_vedge</span>(sta[top - <span class="number">1</span>], sta[top]), --top;</span><br><span class="line">        <span class="keyword">if</span> (sta[top] != l)</span><br><span class="line">            vtr.head[l] = <span class="number">-1</span>, <span class="built_in">add_vedge</span>(l, sta[top]), sta[top] = l;</span><br><span class="line">        vtr.head[s[i]] = <span class="number">-1</span>, sta[++top] = s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; top; ++i)</span><br><span class="line">        <span class="built_in">add_vedge</span>(sta[i], sta[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> u, <span class="type">bool</span> tg)</span> </span>&#123;</span><br><span class="line">    tg |= tag[u];</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">0</span>, sum = (u &lt;= n), chd = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; ~i; i = vtr.nxt[i]) &#123;</span><br><span class="line">        <span class="type">int</span> v = vtr.edge[i].v, w = vtr.edge[i].w;</span><br><span class="line">        sum += w, ret += <span class="built_in">calc</span>(v, tg), chd++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret + ((tg || chd &gt; <span class="number">1</span>) ? sum : <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    bcc = n, dfc = idn = <span class="number">0</span>, <span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        g.<span class="built_in">addedge</span>(u, v);</span><br><span class="line">        g.<span class="built_in">addedge</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    top = <span class="number">0</span>, <span class="built_in">tarjan</span>(<span class="number">1</span>), <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="built_in">read</span>(k);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">            <span class="built_in">read</span>(s[i]), tag[s[i]] = <span class="literal">true</span>;</span><br><span class="line">        <span class="built_in">build_vtr</span>();</span><br><span class="line">        <span class="built_in">write</span>(<span class="built_in">calc</span>(<span class="number">1</span>, <span class="literal">false</span>) - k), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">            tag[s[i]] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    <span class="built_in">read</span>(t);</span><br><span class="line">    <span class="keyword">while</span> (t--)</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3803 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼ä¹˜æ³•ï¼ˆFFTï¼‰</title>
    <url>/2021/11/28/sol-p3803/</url>
    <content><![CDATA[<h2 id="P3803-ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼ä¹˜æ³•ï¼ˆFFTï¼‰"><a href="#P3803-ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼ä¹˜æ³•ï¼ˆFFTï¼‰" class="headerlink" title="P3803 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼ä¹˜æ³•ï¼ˆFFTï¼‰"></a>P3803 ã€æ¨¡ç‰ˆã€‘å¤šé¡¹å¼ä¹˜æ³•ï¼ˆFFTï¼‰</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3803">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>FFT æ¨¡ç‰ˆé¢˜</p>
<p>ä¸ºäº†é˜²æ­¢è‡ªå·±å¿˜è®°å°±å†™ä¸€ä¸‹è¯æ˜å§ã€‚é¡ºä¾¿æŠŠ NTT ä¹Ÿå†™ä¸€ä¸‹ã€‚</p>
<h3 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h3><h4 id="å¤šé¡¹å¼è¡¨ç¤ºæ–¹æ³•"><a href="#å¤šé¡¹å¼è¡¨ç¤ºæ–¹æ³•" class="headerlink" title="å¤šé¡¹å¼è¡¨ç¤ºæ–¹æ³•"></a>å¤šé¡¹å¼è¡¨ç¤ºæ–¹æ³•</h4><h5 id="ç³»æ•°è¡¨ç¤ºæ³•"><a href="#ç³»æ•°è¡¨ç¤ºæ³•" class="headerlink" title="ç³»æ•°è¡¨ç¤ºæ³•"></a>ç³»æ•°è¡¨ç¤ºæ³•</h5><p>å³</p>
<script type="math/tex; mode=display">f(x) = \sum_{i=0}^{n-1}{a_ix^i}</script><h5 id="ç‚¹å€¼è¡¨ç¤ºæ³•"><a href="#ç‚¹å€¼è¡¨ç¤ºæ³•" class="headerlink" title="ç‚¹å€¼è¡¨ç¤ºæ³•"></a>ç‚¹å€¼è¡¨ç¤ºæ³•</h5><p>ä¸å¦¨å°†å¤šé¡¹å¼çœ‹æˆä¸€ä¸ª$n-1$æ¬¡å‡½æ•°ï¼Œä»ä¸Šé¢å–$n$ä¸ªç‚¹æ¥å”¯ä¸€åœ°è¡¨ç¤ºè¿™ä¸ªå‡½æ•°ã€‚</p>
<p>è®¾æƒ³ä¸€ä¸‹é«˜æ–¯æ¶ˆå…ƒæ³•ï¼Œå°±èƒ½çŸ¥é“ä¸ºä»€ä¹ˆ$n$ä¸ªä¸åŒçš„ç‚¹å°±èƒ½å”¯ä¸€ç¡®å®šè¿™ä¸ªå‡½æ•°äº†ã€‚</p>
<script type="math/tex; mode=display">f(x) = \{(x_0,y_0),(x_1,y_1),\cdots,(x_{n-1},y_{n-1})\}</script><p>è¿™æ ·çš„è¡¨ç¤ºæ³•æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯å¦‚æœè¦è®¡ç®—å¤šé¡¹å¼ä¹˜æ³•ï¼Œè®¾</p>
<script type="math/tex; mode=display">g(x) = \{(x_0,g(x_0)),(x_1,g(x_1)),\cdots,(x_{n-1},g(x_{n-1}))\}</script><script type="math/tex; mode=display">h(x) = \{(x_0,h(x_0)),(x_1,h(x_1)),\cdots,(x_{n-1},h(x_{n-1}))\}</script><p>é‚£ä¹ˆ</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(x) &= g(x) \times h(x) \\
&= \{(x_0,g(x_0)h(x_0)),(x_1,g(x_1)h(x_1)),\cdots,(x_{n-1},g(x_{n-1})h(x_{n-1}))\}
\end{aligned}</script><p>å°±å¯ä»¥$O(n)$åœ°æ±‚å‡ºå¤šé¡¹å¼ä¹˜æ³•ã€‚</p>
<p>æ‰€ä»¥FFTè¦åšçš„äº‹å°±æ˜¯å°†ç³»æ•°è¡¨ç¤ºæ³•å’Œç‚¹å€¼è¡¨ç¤ºæ³•è¿›è¡Œè½¬æ¢ã€‚</p>
<h4 id="å¤æ•°ï¼ˆè¿™ä¸ªå¤§å®¶éƒ½ä¼šï¼‰"><a href="#å¤æ•°ï¼ˆè¿™ä¸ªå¤§å®¶éƒ½ä¼šï¼‰" class="headerlink" title="å¤æ•°ï¼ˆè¿™ä¸ªå¤§å®¶éƒ½ä¼šï¼‰"></a>å¤æ•°ï¼ˆè¿™ä¸ªå¤§å®¶éƒ½ä¼šï¼‰</h4><p>ä»¤$i^2 = -1$ï¼Œå¤æ•°å¯è¢«è¡¨ç¤ºä¸º$a + bi$çš„å½¢å¼</p>
<p>è€ƒè™‘åœ¨å¤å¹³é¢ä¸Šçš„ä¸¤ä¸ªå‘é‡$(a,b)$å’Œ$(c,d)$ï¼Œå°†å…¶è¡¨ç¤ºçš„å¤æ•°ç›¸ä¹˜å¾—åˆ°$(a + bi) \times (c + di) = ac - bd + (ad + bc)i$ï¼Œå³å‘é‡$(ac - bd, ad + bc)$ã€‚</p>
<p>æˆ‘ä»¬è®¡ç®—å‡ ä¸ªå‘é‡çš„æ¨¡ï¼Œåˆ†åˆ«ä¸º$\sqrt{a^2 + b^2}$ï¼Œ$\sqrt{c^2 + d^2}$å’Œ$\sqrt{a^2c^2 + b^2d^2 + a^2d^2 + b^2c^2} = \sqrt{(a^2 + b^2) \times (c^2 + d^2)}$ï¼Œå³ä¸¤ä¸ªå‘é‡æ¨¡é•¿çš„ä¹˜ç§¯ã€‚</p>
<p>æ‰€ä»¥å¦‚æœä¸¤ä¸ªåŸå‘é‡æ¨¡é•¿éƒ½ä¸º$1$ï¼Œä¹˜ç§¯çš„å‘é‡ä¹Ÿä¸º$1$ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå¤å¹³é¢ä¸Šå•ä½åœ†ä¸Šçš„å‘é‡ï¼Œè®¾å…¶è¾è§’åˆ†åˆ«ä¸º$\alpha$å’Œ$\beta$ï¼Œåˆ™è¿™ä¸¤ä¸ªå‘é‡è¡¨ç¤ºä¸º$(\cos\alpha,\sin\alpha)$å’Œ$(\cos\beta,\sin\beta)$ï¼Œå…¶ä¹˜ç§¯ä¸º$(\cos\alpha\cos\beta-\sin\alpha\sin\beta,\cos\alpha\sin\beta+\sin\alpha\cos\beta)$ã€‚æ ¹æ®äºŒè§’å’Œå·®å…¬å¼</p>
<script type="math/tex; mode=display">\cos(\alpha + \beta) = \cos\alpha\cos\beta-\sin\alpha\sin\beta</script><script type="math/tex; mode=display">\sin(\alpha + \beta) = \sin\alpha\cos\beta+\cos\alpha\sin\beta</script><p>å¯ä»¥å‘ç°è¿™ä¸ªæ–°çš„å‘é‡çš„è¾è§’å°±ç­‰äºä¸¤ä¸ªåŸå‘é‡çš„è¾è§’ç›¸åŠ ã€‚äºæ˜¯å°†å¾—åˆ°ç»“è®ºï¼šä¸¤ä¸ªæ¨¡é•¿ä¸º$1$çš„å‘é‡ç›¸ä¹˜ï¼Œå¾—åˆ°çš„ä»æ˜¯æ¨¡é•¿ä¸º$1$çš„å‘é‡ï¼Œè¾è§’ä¸ºä¸¤ä¸ªå‘é‡è¾è§’çš„å’Œã€‚</p>
<h4 id="å•ä½å¤æ ¹"><a href="#å•ä½å¤æ ¹" class="headerlink" title="å•ä½å¤æ ¹"></a>å•ä½å¤æ ¹</h4><p>ç”±äºæˆ‘ä»¬è¦å»è®¡ç®—è‹¥å¹²ä¸ª$x_i$å¯¹åº”çš„$f(x_i)$ï¼Œæœ€å¥½çš„åŠæ³•ä¾¿æ˜¯æ‰¾ä¸€äº›ç‰¹æ®Šçš„æ•°å€¼å¸¦è¿›å»è®¡ç®—ã€‚è¿™é‡Œå¼•å…¥å•ä½å¤æ ¹çš„æ¦‚å¿µã€‚</p>
<p>æˆ‘ä»¬ç§°$x^n = 1$åœ¨å¤æ•°æ„ä¹‰ä¸‹çš„è§£æ˜¯$n$æ¬¡å¤æ ¹ã€‚æ˜¾ç„¶è¿™æ ·çš„è§£æœ‰$n$ä¸ªã€‚è®¾$\omega_n = e^{\frac{2\pi i}{n}}$ï¼Œåˆ™$x^n = 1$çš„è§£é›†è¡¨ç¤ºä¸º${\omega^k_n \mid k=0,1,\cdots,n-1}$ï¼Œç§°$w_n$ä¸º$n$æ¬¡å•ä½å¤æ ¹ã€‚æ ¹æ®å¤å¹³é¢çš„çŸ¥è¯†ï¼Œ$n$æ¬¡å•ä½å¤æ ¹æ˜¯å¤å¹³é¢æŠŠå•ä½åœ†$n$ç­‰åˆ†çš„ç¬¬ä¸€ä¸ªè§’æ‰€å¯¹åº”çš„å‘é‡ï¼Œå…¶ä»–å¤æ ¹å‡å¯ä»¥ç”¨å•ä½å¤æ ¹çš„å¹‚è¡¨ç¤ºã€‚</p>
<p>æ‰€ä»¥æ˜¾ç„¶è¿˜èƒ½å¾—åˆ°$\omega_n = e^{\frac{2\pi i}{n}} = \cos(\frac{2\pi}{n}) + i \sin(\frac{2\pi}{n})$ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œ$n=4$æ—¶ï¼Œ$w_n = i$ï¼Œå¦‚å›¾æ‰€ç¤ºï¼ˆå›¾æ¥è‡ª<a href="https://oi-wiki.org/math/poly/fft/">oi-wiki</a>ï¼‰</p>
<p><img src="fft-1.png" alt="fft-1"></p>
<p>å¹¶ä¸”å•ä½å¤æ ¹è¿˜æœ‰ä¸‰ä¸ªé‡è¦çš„æ€§è´¨å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
w^n_n &= 1 \\
w^k_n &= w^{2k}_{2n} \\
w^{k+n}_{2n} &= -w^k_{2n}
\end{aligned}</script><h4 id="ç»ˆäºå¼€å§‹è®²FFTäº†"><a href="#ç»ˆäºå¼€å§‹è®²FFTäº†" class="headerlink" title="ç»ˆäºå¼€å§‹è®²FFTäº†"></a>ç»ˆäºå¼€å§‹è®²FFTäº†</h4><p>FFTå…¶æœ¬è´¨ä¸ºåˆ†æ²»ç®—æ³•ã€‚æ¯”æ–¹è¯´å¯¹äº</p>
<script type="math/tex; mode=display">f(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + a_4x^4 + a_5x^5 + a_6x^6 + a_7x^7</script><p>æŒ‰ç…§æ¬¡æ•°çš„å¥‡å¶æ¥åˆ†ç»„å¾—åˆ°</p>
<script type="math/tex; mode=display">f(x) = (a_0 + a_2x^2 + a_4x^4 + a_6x^6) + (a_1x^1 + a_3x^3 + a_5x^5 + a_7x^7)</script><p>å³è¾¹æå–$x$å¾—åˆ°</p>
<script type="math/tex; mode=display">f(x) = (a_0 + a_2x^2 + a_4x^4 + a_6x^6) + x(a_1 + a_3x^2 + a_5x^4 + a_7x^6)</script><p>æŒ‰ç…§å¥‡å¶æ¬¡é¡¹å»ºç«‹æ–°çš„å‡½æ•°</p>
<script type="math/tex; mode=display">g(x) = a_0 + a_2x^1 + a_4x^2 + a_6x^3</script><script type="math/tex; mode=display">h(x) = a_1 + a_3x^1 + a_5x^2 + a_7x^3</script><p>åŸæ¥çš„$f(x)$å¯ä»¥è¢«è¡¨ç¤ºæˆ</p>
<script type="math/tex; mode=display">f(x) = g(x^2) + x \times h(x^2)</script><p>åˆ©ç”¨å•ä½å¤æ ¹çš„æ€§è´¨å¾—åˆ°</p>
<script type="math/tex; mode=display">\begin{aligned}
FFT(f(\omega^k_n)) &= FFT(g((\omega^k_n)^2)) + \omega^k_n \times FFT(h((\omega^k_n)^2)) \\
&= FFT(g(\omega^{2k}_n)) + \omega^k_n \times FFT(h(\omega^{2k}_n)) \\
&= FFT(g(\omega^k_{n/2})) + \omega^k_n \times FFT(h(\omega^k_{n/2}))
\end{aligned}</script><p>åŒç†å¯å¾—</p>
<script type="math/tex; mode=display">\begin{aligned}
FFT(f(\omega^{k+n/2}_n)) &= FFT(g(\omega^{2k+n}_n)) + \omega^{k+n/2}_n \times FFT(h(\omega^{2k+n}_n)) \\
&= FFT(g(\omega^{2k}_n)) - \omega^k_n \times FFT(h(\omega^{2k}_n)) \\
&= FFT(g(\omega^k_{n/2})) - \omega^k_n \times FFT(h(\omega^k_{n/2}))
\end{aligned}</script><p>è€Œç”±äº$n/2$éœ€è¦ä¸€ç›´ä¸ºæ•´æ•°ï¼Œæ‰€ä»¥$n$éœ€è¦æ˜¯$2^m$ï¼Œä¸å¦¨åœ¨ä¸€å¼€å§‹å°†å¤šé¡¹å¼çš„æ¬¡æ•°è¡¥åˆ°é•¿åº¦ä¸ºé•¿åº¦ä¸º$2^m$ï¼Œæ¬¡æ•°ä¸º$2^m-1$çš„å¤šé¡¹å¼å³å¯ã€‚</p>
<p>ä»£ç å®ç°æ–¹é¢ï¼ŒSTLæä¾›äº†å¤æ•°çš„æ¨¡ç‰ˆï¼ˆæˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡çŸ¥é“æœ‰è¿™ç§å¥½äº‹ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨<code>std::complex&lt;double&gt;</code>ã€‚</p>
<h4 id="NTT"><a href="#NTT" class="headerlink" title="NTT"></a>NTT</h4><p>æ¨¡ç‰ˆå’ŒFFTåŸºæœ¬ç›¸åŒï¼Œç”¨<a href="https://oi-wiki.org/math/number-theory/primitive-root/">åŸæ ¹</a>ä»£æ›¿å•ä½å¤æ ¹ï¼ˆæ€§è´¨åŸºæœ¬ç›¸åŒï¼‰ã€‚</p>
<script type="math/tex; mode=display">p = 998244353 = 7 \times 17 \times 2^{23} + 1, g = 3</script><script type="math/tex; mode=display">p = 1004535809 = 479 \times 2^{21} + 1, g = 3</script><script type="math/tex; mode=display">p = 469762049 = 7 \times 2^{26} + 1, g = 3</script><p>æ—¶é—´å¤æ‚åº¦$O(n \log n)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3803.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3803</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> comp = complex&lt;<span class="type">double</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">namespace</span> fft &#123;</span><br><span class="line">    <span class="type">int</span> rev[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(comp *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">fft</span><span class="params">(comp *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="function">comp <span class="title">wn</span><span class="params">(cos(<span class="number">2</span> * M_PI / h), sin(<span class="number">2</span> * M_PI / h))</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="function">comp <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    comp u = f[k], t = w * f[k + h / <span class="number">2</span>];</span><br><span class="line">                    f[k] = u + t;</span><br><span class="line">                    f[k + h / <span class="number">2</span>] = u - t;</span><br><span class="line">                    w = w * wn;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i].<span class="built_in">real</span>(f[i].<span class="built_in">real</span>() / len);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> n, m, len;</span><br><span class="line">    comp a[MAXN], b[MAXN], ans[MAXN];</span><br><span class="line">    <span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> x;</span><br><span class="line">            <span class="built_in">read</span>(x);</span><br><span class="line">            a[i].<span class="built_in">real</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> x;</span><br><span class="line">            <span class="built_in">read</span>(x);</span><br><span class="line">            b[i].<span class="built_in">real</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">        len = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (len &lt;= n + m)</span><br><span class="line">            len *= <span class="number">2</span>;</span><br><span class="line">        <span class="built_in">fft</span>(a, len, <span class="number">1</span>), <span class="built_in">fft</span>(b, len, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            ans[i] = a[i] * b[i];</span><br><span class="line">        <span class="built_in">fft</span>(ans, len, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n + m; ++i)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld%c&quot;</span>, (<span class="type">int</span>)(ans[i].<span class="built_in">real</span>() + <span class="number">0.5</span>), <span class="string">&quot; \n&quot;</span>[i == n + m]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> ntt &#123;</span><br><span class="line">    <span class="type">int</span> rev[MAXN];</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">qpow</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x % MOD)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                ret = ret * x % MOD;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">                rev[i] |= len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; rev[i])</span><br><span class="line">                <span class="built_in">swap</span>(f[i], f[rev[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ntt</span><span class="params">(<span class="type">int</span> *f, <span class="type">int</span> len, <span class="type">int</span> on)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">change</span>(f, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (MOD - <span class="number">1</span>) / h);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; len; j += h) &#123;</span><br><span class="line">                <span class="type">int</span> g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; j + h / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">                    <span class="type">int</span> u = f[k], t = g * f[k + h / <span class="number">2</span>] % MOD;</span><br><span class="line">                    f[k] = (u + t + MOD) % MOD;</span><br><span class="line">                    f[k + h / <span class="number">2</span>] = (u - t + MOD) % MOD;</span><br><span class="line">                    g = g * gn % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (on == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">reverse</span>(f + <span class="number">1</span>, f + len);</span><br><span class="line">            <span class="type">int</span> inv = <span class="built_in">qpow</span>(len, MOD - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                f[i] = f[i] * inv % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> n, m, len;</span><br><span class="line">    <span class="type">int</span> a[MAXN], b[MAXN], ans[MAXN];</span><br><span class="line">    <span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">read</span>(a[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">            <span class="built_in">read</span>(b[i]);</span><br><span class="line">        len = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (len &lt;= n + m)</span><br><span class="line">            len *= <span class="number">2</span>;</span><br><span class="line">        <span class="built_in">ntt</span>(a, len, <span class="number">1</span>), <span class="built_in">ntt</span>(b, len, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            ans[i] = a[i] * b[i] % MOD;</span><br><span class="line">        <span class="built_in">ntt</span>(ans, len, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n + m; ++i)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld%c&quot;</span>, ans[i], <span class="string">&quot; \n&quot;</span>[i == n + m]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// return fft::main();</span></span><br><span class="line">    <span class="keyword">return</span> ntt::<span class="built_in">main</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3233 ä¸–ç•Œæ ‘ é¢˜è§£</title>
    <url>/2021/11/27/sol-p3233/</url>
    <content><![CDATA[<h2 id="P3233-ä¸–ç•Œæ ‘-é¢˜è§£"><a href="#P3233-ä¸–ç•Œæ ‘-é¢˜è§£" class="headerlink" title="P3233 ä¸–ç•Œæ ‘ é¢˜è§£"></a>P3233 ä¸–ç•Œæ ‘ é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3233">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p><strong>ä»¥ä¸‹æ‰€æœ‰çš„â€œå…³é”®ç‚¹â€éƒ½è¡¨ç¤ºé¢˜ç›®ä¸­çš„è®®äº‹å¤„</strong></p>
<p>çœ‹å®Œè¿™é¢˜é¢˜è§£åå»å­¦ä¹ äº†è™šæ ‘<del>ï¼ˆç„¶åday2ä¸Šåˆæ¨¡æ‹Ÿèµ›è€ƒäº†é“ç±»ä¼¼è™šæ ‘ä½†ä¸ç”¨å»º$lca$çš„é¢˜ç›®ï¼‰</del></p>
<p>äºæ˜¯çœ‹åˆ°$\sum m \le 3 \times 10^5$ ç›´æ¥å»ºç«‹è™šæ ‘ï¼ˆç„¶è€Œå¦‚æœæ²¡å­¦è¿‡è™šæ ‘å°±çœ‹ä¸å‡ºæ¥äº†ï¼‰ã€‚</p>
<p>ç”¨<code>pair&lt;int, int&gt;</code>å‚¨å­˜æ ‘ä¸ŠèŠ‚ç‚¹åˆ°è¾¾æœ€è¿‘å…³é”®ç‚¹çš„è·ç¦»å’Œå…³é”®ç‚¹ç¼–å·ä»¥ä¾¿äºæ¯”è¾ƒã€‚å…ˆå¯¹è™šæ ‘ä¸Šçš„èŠ‚ç‚¹åšä¸€éæ¢æ ¹$dp$ï¼Œæ–¹ç¨‹æ˜¾ç„¶æ˜¯$dp<em>u = \min\limits</em>{v,w}{dp_v + w}$å…¶ä¸­$v, w$åˆ†åˆ«ä¸ºå­èŠ‚ç‚¹å’Œåˆ°å­èŠ‚ç‚¹çš„è·ç¦»ã€‚ä¹‹åä¸ºäº†æ–¹ä¾¿è¡¨è¿°è®¾<strong>$f_u$è¡¨ç¤º<code>dp[u].first</code>ï¼Œ$g_u$è¡¨ç¤º<code>dp[u].second</code></strong>ã€‚</p>
<p>æ¥ä¸‹æ¥è€ƒè™‘ä¸åœ¨è™šæ ‘ä¸Šçš„èŠ‚ç‚¹ã€‚é¦–å…ˆå¦‚æœè™šæ ‘ä¸ŠæŸèŠ‚ç‚¹çš„ä¸€ä¸ªåŸæ ‘ä¸Šå­èŠ‚ç‚¹çš„å­æ ‘ä¸­éƒ½æ²¡æœ‰è™šæ ‘ä¸Šçš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¯¥å­æ ‘ä¸­çš„çš„æ‰€æœ‰èŠ‚ç‚¹çš„æœ€è¿‘å…³é”®ç‚¹éƒ½åº”å½“ä¸è¯¥è™šæ ‘èŠ‚ç‚¹ç›¸åŒã€‚å½¢å¼åŒ–åœ°ï¼Œè‹¥å¯¹äºè™šæ ‘ä¸Šçš„èŠ‚ç‚¹$u$æœ‰èŠ‚ç‚¹$u \to v<em>{real}$ä½¿å¾—ä¸å­˜åœ¨$v</em>{real} \to \cdots \to x$åœ¨è™šæ ‘ä¸Šï¼Œé‚£ä¹ˆ$g<em>x = g_u$ï¼Œå³$cnt</em>{g<em>u} += siz</em>{v_{real}}$ã€‚å¦‚åœ¨ä¸‹å›¾ä¸­çš„èŠ‚ç‚¹ä¸­$v=6,v=7,v=10$éƒ½æ»¡è¶³è¯¥ç§æƒ…å†µï¼ˆåŠ ç²—èŠ‚ç‚¹è¡¨ç¤ºè™šæ ‘èŠ‚ç‚¹ï¼‰ã€‚</p>
<p><img src="sol-p3233-1.png" alt="è™šæ ‘"></p>
<p>å…¶æ¬¡æ˜¯åœ¨è™šæ ‘çš„é“¾ä¸Šçš„ç‚¹ã€‚ä¸å¦¨å°†ä¾‹å¦‚ä¸Šå›¾ä¸­çš„èŠ‚ç‚¹$9$è®¡ç®—åˆ°èŠ‚ç‚¹$4$ä¸­ï¼ˆå› ä¸º$g<em>4$ä¸€å®šç­‰äº$g_9$ï¼‰ï¼Œè€ƒè™‘ä¸€æ¡é“¾$fa \to u$ï¼Œè‹¥$g</em>{fa} = g<em>u$åˆ™é“¾ä¸ŠèŠ‚ç‚¹å…¨éƒ¨åŠ åˆ°$g_u$ä¸­ï¼ˆåŒæ ·è®¾$v</em>{real}$è¡¨ç¤º$fa$åœ¨åŸæ ‘ä¸­çš„$u$æ–¹å‘çš„å­èŠ‚ç‚¹ï¼Œç›¸å½“äº$cnt<em>{g_u} += siz</em>{v<em>{real}} - siz_u$ï¼‰ï¼Œå¦åˆ™å€å¢æ‰¾åˆ°æ·±åº¦æœ€å°çš„æ»¡è¶³å–$g_u$æ›´ä¼˜çš„ç‚¹$cur$ï¼Œæ˜¾ç„¶$cnt</em>{g<em>u} += siz</em>{cur} - siz<em>u$ï¼Œ$cnt</em>{g<em>{fa}} += siz</em>{v<em>{real}} - siz</em>{cur}$ã€‚</p>
<p>äºæ˜¯æœ¬é¢˜å°±ç»“æŸäº†ã€‚åªæ˜¯æœ‰å¤ªå¤šå¤ªå¤šç»†èŠ‚è¦æ³¨æ„äº†ï¼Œ<del>å†™é”™ä¸€ä¸ªè°ƒä¸€æ•´å¹´å•Š/kk</del></p>
<p>æ—¶é—´å¤æ‚åº¦$O(n \log n)$ç¨³è¿‡ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3233.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3233</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">6e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">graph</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">    &#125; e[MAXM];</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], tot;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">        e[++tot] = &#123;u, v, w&#125;;</span><br><span class="line">        nxt[tot] = head[u];</span><br><span class="line">        head[u] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, q, top, inde, h[MAXN], dfn[MAXN], dep[MAXN];</span><br><span class="line"><span class="type">int</span> fa[MAXN][MAXK], siz[MAXN], sta[MAXN], cnt[MAXN], ori[MAXN];</span><br><span class="line">pii dis[MAXN][<span class="number">2</span>], tmp[MAXN], pre[MAXN], nxt[MAXN];</span><br><span class="line"><span class="type">bool</span> tag[MAXN];</span><br><span class="line">graph tr, vtr;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_tr</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    siz[u] = <span class="number">1</span>, dfn[u] = ++inde, dep[u] = dep[f] + <span class="number">1</span>, fa[u][<span class="number">0</span>] = f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXK; ++i)</span><br><span class="line">        fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = tr.head[u]; i; i = tr.nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (tr.e[i].v != f)</span><br><span class="line">            <span class="built_in">build_tr</span>(tr.e[i].v, u), siz[u] += siz[tr.e[i].v];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v])</span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">    <span class="type">int</span> t = dep[u] - dep[v];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXK - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((t &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            u = fa[u][i];</span><br><span class="line">    <span class="keyword">if</span> (u == v)</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXK - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> (fa[u][i] != fa[v][i])</span><br><span class="line">            u = fa[u][i], v = fa[v][i];</span><br><span class="line">    <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">jump</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> d)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXK - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((d &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            u = fa[u][i];</span><br><span class="line">    <span class="keyword">return</span> u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_vedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// debug(&quot;virtual tree: %lld -&gt; %lld, w = %lld&quot;, u, v, dep[v] - dep[u]);</span></span><br><span class="line">    vtr.<span class="built_in">addedge</span>(u, v, dep[v] - dep[u]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_vtr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(h + <span class="number">1</span>, h + m + <span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">        <span class="keyword">return</span> dfn[x] &lt; dfn[y];</span><br><span class="line">    &#125;);</span><br><span class="line">    sta[top = <span class="number">1</span>] = <span class="number">1</span>, vtr.head[<span class="number">1</span>] = <span class="number">0</span>, vtr.tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (h[i] == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> l = <span class="built_in">lca</span>(sta[top], h[i]);</span><br><span class="line">        <span class="keyword">while</span> (dfn[l] &lt;= dfn[sta[top - <span class="number">1</span>]])</span><br><span class="line">            <span class="built_in">add_vedge</span>(sta[top - <span class="number">1</span>], sta[top]), --top;</span><br><span class="line">        <span class="keyword">if</span> (sta[top] != l)</span><br><span class="line">            vtr.head[l] = <span class="number">0</span>, <span class="built_in">add_vedge</span>(l, sta[top]), sta[top] = l;</span><br><span class="line">        vtr.head[h[i]] = <span class="number">0</span>, sta[++top] = h[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; top; ++i)</span><br><span class="line">        <span class="built_in">add_vedge</span>(sta[i], sta[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs0</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    dis[u][<span class="number">0</span>] = tag[u] ? pii&#123;<span class="number">0</span>, u&#125; : pii&#123;INFL, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; i; i = vtr.nxt[i]) &#123;</span><br><span class="line">        <span class="type">int</span> v = vtr.e[i].v, w = vtr.e[i].w;</span><br><span class="line">        <span class="built_in">dfs0</span>(v), dis[u][<span class="number">0</span>] = <span class="built_in">min</span>(dis[u][<span class="number">0</span>], &#123;dis[v][<span class="number">0</span>].fi + w, dis[v][<span class="number">0</span>].se&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// debug(&quot;dis of dfs0(%lld) = &#123;%lld, %lld&#125;&quot;, u, dis[u][0].fi, dis[u][0].se);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; i; i = vtr.nxt[i]) &#123;</span><br><span class="line">        <span class="type">int</span> v = vtr.e[i].v, w = vtr.e[i].w;</span><br><span class="line">        tmp[++len] = &#123;dis[v][<span class="number">0</span>].fi + w, dis[v][<span class="number">0</span>].se&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tag[u])</span><br><span class="line">        dis[u][<span class="number">1</span>] = &#123;<span class="number">0</span>, u&#125;;</span><br><span class="line">    pre[<span class="number">0</span>] = nxt[len + <span class="number">1</span>] = dis[u][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">        pre[i] = <span class="built_in">min</span>(pre[i - <span class="number">1</span>], tmp[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = len; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        nxt[i] = <span class="built_in">min</span>(nxt[i + <span class="number">1</span>], tmp[i]);</span><br><span class="line">    len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; i; i = vtr.nxt[i]) &#123;</span><br><span class="line">        ++len;</span><br><span class="line">        pii t = <span class="built_in">min</span>(pre[len - <span class="number">1</span>], nxt[len + <span class="number">1</span>]);</span><br><span class="line">        <span class="comment">// ##sb-mistakes## æ¢æ ¹$dp$ä¸è¦åœ¨ç»Ÿè®¡$pre$å’Œ$nxt$æ•°ç»„æ—¶å°±å†™$dfs$!!!æ•°ç»„æ•´ä¸ªæ”¹å˜!!!ä¸ç„¶ä¼šæ­»å¾—å¾ˆæƒ¨ï¼ˆæŒ‡å¯¹ç€n=1000,m=100çš„å¤§æ ·ä¾‹è°ƒ1hï¼‰</span></span><br><span class="line">        dis[vtr.e[i].v][<span class="number">1</span>] = &#123;t.fi + vtr.e[i].w, t.se&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; i; i = vtr.nxt[i])</span><br><span class="line">        <span class="built_in">dfs1</span>(vtr.e[i].v);</span><br><span class="line">    <span class="comment">// debug(&quot;dis of dfs1(%lld) = &#123;%lld, %lld&#125;&quot;, u, dis[u][1].fi, dis[u][1].se);</span></span><br><span class="line">    dis[u][<span class="number">1</span>] = <span class="built_in">min</span>(dis[u][<span class="number">0</span>], dis[u][<span class="number">1</span>]);</span><br><span class="line">    ++cnt[dis[u][<span class="number">1</span>].se];</span><br><span class="line">    <span class="comment">// debug(&quot;dis of dfs1(%lld) = &#123;%lld, %lld&#125;&quot;, u, dis[u][1].fi, dis[u][1].se);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; i; i = vtr.nxt[i])</span><br><span class="line">        <span class="built_in">dfs2</span>(vtr.e[i].v, u);</span><br><span class="line">    <span class="keyword">if</span> (f) &#123;</span><br><span class="line">        <span class="comment">// debug(&quot;calculate chain %lld -&gt; %lld&quot;, f, u);</span></span><br><span class="line">        <span class="keyword">if</span> (dis[f][<span class="number">1</span>].se == dis[u][<span class="number">1</span>].se) &#123;</span><br><span class="line">            <span class="type">int</span> cx = siz[<span class="built_in">jump</span>(u, dep[u] - dep[f] - <span class="number">1</span>)] - siz[u];</span><br><span class="line">            <span class="comment">// debug(&quot;same color, add %lld to cnt[%lld]&quot;, cx, dis[u][1].se);</span></span><br><span class="line">            cnt[dis[u][<span class="number">1</span>].se] += cx;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> cur = u;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = MAXK - <span class="number">1</span>; ~i; --i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dep[fa[cur][i]] &lt;= dep[f])</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                pii up&#123;dep[fa[cur][i]] - dep[f] + dis[f][<span class="number">1</span>].fi, dis[f][<span class="number">1</span>].se&#125;;</span><br><span class="line">                pii dn&#123;dep[u] - dep[fa[cur][i]] + dis[u][<span class="number">1</span>].fi, dis[u][<span class="number">1</span>].se&#125;;</span><br><span class="line">                <span class="keyword">if</span> (dn &lt; up)</span><br><span class="line">                    cur = fa[cur][i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// debug(&quot;vertex is %lld&quot;, cur);</span></span><br><span class="line">            <span class="type">int</span> c1 = siz[cur] - siz[u];</span><br><span class="line">            <span class="type">int</span> c2 = siz[<span class="built_in">jump</span>(u, dep[u] - dep[f] - <span class="number">1</span>)] - siz[cur];</span><br><span class="line">            <span class="comment">// debug(&quot;%lld&quot;, siz[jump(u, dep[u] - dep[f] - 1)]);</span></span><br><span class="line">            <span class="comment">// debug(&quot;diff color, add %lld to cnt[%lld]&quot;, c1, dis[u][1].se);</span></span><br><span class="line">            <span class="comment">// debug(&quot;diff color, add %lld to cnt[%lld]&quot;, c2, dis[f][1].se);</span></span><br><span class="line">            cnt[dis[u][<span class="number">1</span>].se] += c1;</span><br><span class="line">            cnt[dis[f][<span class="number">1</span>].se] += c2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// debug(&quot;calculate subtree of %lld&quot;, u);</span></span><br><span class="line">    <span class="type">int</span> rem = siz[u] - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; i; i = vtr.nxt[i])</span><br><span class="line">        rem -= siz[<span class="built_in">jump</span>(vtr.e[i].v, dep[vtr.e[i].v] - dep[u] - <span class="number">1</span>)];</span><br><span class="line">    <span class="comment">// debug(&quot;add %lld to cnt[%lld]&quot;, rem, dis[u][1].se);</span></span><br><span class="line">    cnt[dis[u][<span class="number">1</span>].se] += rem;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v);</span><br><span class="line">        tr.<span class="built_in">addedge</span>(u, v);</span><br><span class="line">        tr.<span class="built_in">addedge</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build_tr</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="built_in">read</span>(m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            ori[i] = <span class="built_in">read</span>(h[i]), tag[h[i]] = <span class="literal">true</span>, cnt[h[i]] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">build_vtr</span>();</span><br><span class="line">        dis[<span class="number">1</span>][<span class="number">0</span>] = dis[<span class="number">1</span>][<span class="number">1</span>] = &#123;INFL, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="built_in">dfs0</span>(<span class="number">1</span>), <span class="built_in">dfs1</span>(<span class="number">1</span>), <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            <span class="built_in">write</span>(cnt[ori[i]]), <span class="built_in">putchar</span>(i == m ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            tag[h[i]] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P2495 æ¶ˆè€—æˆ˜ é¢˜è§£</title>
    <url>/2021/11/27/sol-p2495/</url>
    <content><![CDATA[<h2 id="P2495-æ¶ˆè€—æˆ˜-é¢˜è§£"><a href="#P2495-æ¶ˆè€—æˆ˜-é¢˜è§£" class="headerlink" title="P2495 æ¶ˆè€—æˆ˜ é¢˜è§£"></a>P2495 æ¶ˆè€—æˆ˜ é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P2495">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>è™šæ ‘æ¨¡ç‰ˆé¢˜ï¼Œä¸å¤šè¯´ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P2495.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P2495</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">graph</span> &#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">    &#125; e[MAXM];</span><br><span class="line">    <span class="type">int</span> head[MAXN], nxt[MAXM], tot;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">        e[++tot] = &#123;u, v, w&#125;;</span><br><span class="line">        nxt[tot] = head[u];</span><br><span class="line">        head[u] = tot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, k, inde, h[MAXN], dfn[MAXN], dep[MAXN];</span><br><span class="line"><span class="type">int</span> fa[MAXN][MAXK], mn[MAXN][MAXK], dp[MAXN], sta[MAXN], top;</span><br><span class="line"><span class="type">bool</span> tag[MAXN];</span><br><span class="line">graph tr, vtr;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_tr</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">    dfn[u] = ++inde, dep[u] = dep[f] + <span class="number">1</span>;</span><br><span class="line">    fa[u][<span class="number">0</span>] = f, mn[u][<span class="number">0</span>] = w;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXK; ++i)</span><br><span class="line">        fa[u][i] = fa[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXK; ++i)</span><br><span class="line">        mn[u][i] = <span class="built_in">min</span>(mn[u][i - <span class="number">1</span>], mn[fa[u][i - <span class="number">1</span>]][i - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = tr.head[u]; i; i = tr.nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (tr.e[i].v != f)</span><br><span class="line">            <span class="built_in">build_tr</span>(tr.e[i].v, u, tr.e[i].w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[u] &lt; dep[v])</span><br><span class="line">        <span class="built_in">swap</span>(u, v);</span><br><span class="line">    <span class="type">int</span> t = dep[u] - dep[v];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXK - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((t &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            u = fa[u][i];</span><br><span class="line">    <span class="keyword">if</span> (u == v)</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXK - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> (fa[u][i] != fa[v][i])</span><br><span class="line">            u = fa[u][i], v = fa[v][i];</span><br><span class="line">    <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">minpath</span><span class="params">(<span class="type">int</span> f, <span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t = dep[f] - dep[u];</span><br><span class="line">    <span class="type">int</span> ret = INFL;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = MAXK - <span class="number">1</span>; ~i; --i)</span><br><span class="line">        <span class="keyword">if</span> ((t &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">            ret = <span class="built_in">min</span>(ret, mn[u][i]), u = fa[u][i];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_vedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    vtr.<span class="built_in">addedge</span>(u, v, <span class="built_in">minpath</span>(u, v));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_vtr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(h + <span class="number">1</span>, h + k + <span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">        <span class="keyword">return</span> dfn[x] &lt; dfn[y];</span><br><span class="line">    &#125;);</span><br><span class="line">    sta[top = <span class="number">1</span>] = <span class="number">1</span>, vtr.tot = <span class="number">0</span>, vtr.head[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (h[i] == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> l = <span class="built_in">lca</span>(sta[top], h[i]);</span><br><span class="line">        <span class="keyword">if</span> (l != sta[top]) &#123;</span><br><span class="line">            <span class="keyword">while</span> (dfn[sta[top - <span class="number">1</span>]] &gt; dfn[l])</span><br><span class="line">                <span class="built_in">add_vedge</span>(sta[top - <span class="number">1</span>], sta[top]), --top;</span><br><span class="line">            <span class="keyword">if</span> (sta[top - <span class="number">1</span>] == l)</span><br><span class="line">                <span class="built_in">add_vedge</span>(l, sta[top]), --top;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                vtr.head[l] = <span class="number">-1</span>, <span class="built_in">add_vedge</span>(l, sta[top]), sta[top] = l;</span><br><span class="line">        &#125;</span><br><span class="line">        vtr.head[h[i]] = <span class="number">0</span>, sta[++top] = h[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; top; ++i)</span><br><span class="line">        <span class="built_in">add_vedge</span>(sta[i], sta[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    dp[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = vtr.head[u]; i; i = vtr.nxt[i]) &#123;</span><br><span class="line">        <span class="type">int</span> v = vtr.e[i].v, w = vtr.e[i].w;</span><br><span class="line">        <span class="built_in">dfs</span>(v);</span><br><span class="line">        <span class="keyword">if</span> (tag[v])</span><br><span class="line">            dp[u] += w;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            dp[u] += <span class="built_in">min</span>(dp[v], w);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v), <span class="built_in">read</span>(w);</span><br><span class="line">        tr.<span class="built_in">addedge</span>(u, v, w);</span><br><span class="line">        tr.<span class="built_in">addedge</span>(v, u, w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fill</span>(mn[<span class="number">0</span>], mn[<span class="number">0</span>] + MAXK, INFL);</span><br><span class="line">    <span class="built_in">build_tr</span>(<span class="number">1</span>, <span class="number">0</span>, INFL);</span><br><span class="line">    <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="built_in">read</span>(k);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">            <span class="built_in">read</span>(h[i]), tag[h[i]] = <span class="literal">true</span>;</span><br><span class="line">        <span class="built_in">build_vtr</span>();</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">write</span>(dp[<span class="number">1</span>]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">            tag[h[i]] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P7155 Spaceship P é¢˜è§£</title>
    <url>/2021/11/26/sol-p7155/</url>
    <content><![CDATA[<h2 id="P7155-Spaceship-P-é¢˜è§£"><a href="#P7155-Spaceship-P-é¢˜è§£" class="headerlink" title="P7155 Spaceship P é¢˜è§£"></a>P7155 Spaceship P é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P7155">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>è€ƒè™‘åˆ°ä¸€ä¸ªåˆæ³•çš„æŒ‰é’®åºåˆ—ä¸­ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæœ€å¤§çš„æŒ‰é’®ç¼–å·ã€‚å› ä¸ºå¦‚æœè¯¥æœ€å¤§ç¼–å·ä¸º$mx$çš„æŒ‰é’®èƒ½è¢«æŒ‰ä¸‹å¤šæ¬¡ï¼Œåˆ™å¿…é¡»è¦æŒ‰ä¸‹å¦ä¸€ä¸ªæŒ‰é’®ç¼–å·$\gt mx$ä»¥ä½¿æŒ‰é’®$mx$å˜å¾—åˆæ³•ï¼Œä¸æ»¡è¶³$mx$ç¼–å·æœ€å¤§ï¼Œæ•…å‡è®¾ä¸æˆç«‹ã€‚</p>
<p>æœ‰äº†è¿™ä¸ªæ€§è´¨ï¼Œå°±ç¡®å®šäº†åˆæ³•åºåˆ—æ•°é‡çš„ä¸Šç•Œï¼Œå¹¶ä¸”ç”±äºç¼–å·æœ€å¤§çš„æŒ‰é’®å°†åºåˆ—åˆ†æˆä¸¤æ®µï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥$dp$æ±‚è§£ã€‚è®¾$dp<em>{u,v,c,0/1,0/1}$è¡¨ç¤ºä»$u$èµ°åˆ°$v$çš„è·¯å¾„ä¸­æœ€å¤§æŒ‰é’®çš„ç¼–å·ä¸è¶…è¿‡$c$ï¼Œç¬¬ä¸€æ­¥æ˜¯å¦æœ‰é™åˆ¶å’Œæœ€åä¸€æ­¥æ˜¯å¦æœ‰é™åˆ¶çš„æ–¹æ¡ˆæ•°ï¼Œç­”æ¡ˆå°±æ˜¯$dp</em>{s,t,K,1,1}$ï¼Œäºæ˜¯$O(qn^5)$åšæ³•æ˜¾ç„¶ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•ä¼˜åŒ–ï¼ˆå…¶å®ä¹ŸæŒºå¥½æƒ³ï¼‰ã€‚ä»¤$f<em>{u,x,c,0/1}=\sum\limits</em>{(t,u)}{dp<em>{u,t,c-1,0/1,0}}$ï¼Œ$g</em>{x,v,c,0/1}=\sum\limits<em>{(v,t)}{dp</em>{t,v,c-1,0,0/1}}$ï¼Œåˆ™$dp<em>{u,v,c,k1,k2}=\sum\limits</em>{t}{f<em>{u,t,c,k1} \times g</em>{t,v,c,k2}}$ï¼Œä¸€ä¸‹å­å°‘æšä¸¾å¾ˆå¤šä¸œè¥¿äº†ã€‚</p>
<p>å…·ä½“ç»†èŠ‚å°±çœ‹ä»£ç å§ï¼Œæ—¶é—´å¤æ‚åº¦$O(n^4 + qn^3)$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P7155.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P7155</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">65</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, k, q;</span><br><span class="line"><span class="type">char</span> buf[MAXN];</span><br><span class="line"><span class="type">bool</span> mp[MAXN][MAXN];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">2</span>][<span class="number">2</span>][MAXN][MAXN][MAXN], f[<span class="number">2</span>][MAXN][MAXN][MAXN], g[<span class="number">2</span>][MAXN][MAXN][MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">uadd</span><span class="params">(<span class="type">int</span> &amp;x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= MOD)</span><br><span class="line">        x -= MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t, <span class="type">int</span> bs, <span class="type">int</span> bt)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(f[<span class="number">1</span>], <span class="number">0</span>, <span class="built_in">sizeof</span>(f[<span class="number">1</span>]));</span><br><span class="line">    <span class="built_in">memset</span>(g[<span class="number">1</span>], <span class="number">0</span>, <span class="built_in">sizeof</span>(g[<span class="number">1</span>]));</span><br><span class="line">    <span class="built_in">memset</span>(dp[<span class="number">0</span>][<span class="number">1</span>], <span class="number">0</span>, <span class="built_in">sizeof</span>(dp[<span class="number">0</span>][<span class="number">1</span>]));</span><br><span class="line">    <span class="built_in">memset</span>(dp[<span class="number">1</span>][<span class="number">0</span>], <span class="number">0</span>, <span class="built_in">sizeof</span>(dp[<span class="number">1</span>][<span class="number">0</span>]));</span><br><span class="line">    <span class="built_in">memset</span>(dp[<span class="number">1</span>][<span class="number">1</span>], <span class="number">0</span>, <span class="built_in">sizeof</span>(dp[<span class="number">1</span>][<span class="number">1</span>]));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> c = <span class="number">1</span>; c &lt;= k; ++c) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">1</span>; y &lt;= n; ++y)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">1</span>; v &lt;= n; ++v)</span><br><span class="line">                <span class="keyword">if</span> (mp[v][y]) <span class="built_in">uadd</span>(f[<span class="number">1</span>][s][y][c], dp[<span class="number">1</span>][<span class="number">0</span>][s][v][c - <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x &lt;= n; ++x)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">1</span>; v &lt;= n; ++v)</span><br><span class="line">                <span class="keyword">if</span> (mp[x][v]) <span class="built_in">uadd</span>(g[<span class="number">1</span>][x][t][c], dp[<span class="number">0</span>][<span class="number">1</span>][v][t][c - <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (c == bs) <span class="built_in">uadd</span>(f[<span class="number">1</span>][s][s][c], <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (c == bt) <span class="built_in">uadd</span>(g[<span class="number">1</span>][t][t][c], <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">1</span>; v &lt;= n; ++v) &#123;</span><br><span class="line">            dp[<span class="number">1</span>][<span class="number">0</span>][s][v][c] = dp[<span class="number">1</span>][<span class="number">0</span>][s][v][c - <span class="number">1</span>];</span><br><span class="line">            dp[<span class="number">0</span>][<span class="number">1</span>][v][t][c] = dp[<span class="number">0</span>][<span class="number">1</span>][v][t][c - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>; l &lt;= n; ++l) &#123;</span><br><span class="line">                <span class="built_in">uadd</span>(dp[<span class="number">1</span>][<span class="number">0</span>][s][v][c], f[<span class="number">1</span>][s][l][c] * g[<span class="number">0</span>][l][v][c] % MOD);</span><br><span class="line">                <span class="built_in">uadd</span>(dp[<span class="number">0</span>][<span class="number">1</span>][v][t][c], f[<span class="number">0</span>][v][l][c] * g[<span class="number">1</span>][l][t][c] % MOD);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        dp[<span class="number">1</span>][<span class="number">1</span>][s][t][c] = dp[<span class="number">1</span>][<span class="number">1</span>][s][t][c - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">1</span>; v &lt;= n; ++v)</span><br><span class="line">            <span class="built_in">uadd</span>(dp[<span class="number">1</span>][<span class="number">1</span>][s][t][c], f[<span class="number">1</span>][s][v][c] * g[<span class="number">1</span>][v][t][c] % MOD);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[<span class="number">1</span>][<span class="number">1</span>][s][t][k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            mp[i][j] = buf[j] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> c = <span class="number">1</span>; c &lt;= k; ++c) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x &lt;= n; ++x)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">1</span>; y &lt;= n; ++y)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> t = <span class="number">1</span>; t &lt;= n; ++t)</span><br><span class="line">                    <span class="keyword">if</span> (mp[t][y]) <span class="built_in">uadd</span>(f[<span class="number">0</span>][x][y][c], dp[<span class="number">0</span>][<span class="number">0</span>][x][t][c - <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x &lt;= n; ++x)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">1</span>; y &lt;= n; ++y)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> t = <span class="number">1</span>; t &lt;= n; ++t)</span><br><span class="line">                    <span class="keyword">if</span> (mp[x][t]) <span class="built_in">uadd</span>(g[<span class="number">0</span>][x][y][c], dp[<span class="number">0</span>][<span class="number">0</span>][t][y][c - <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">uadd</span>(f[<span class="number">0</span>][i][i][c], <span class="number">1</span>), <span class="built_in">uadd</span>(g[<span class="number">0</span>][i][i][c], <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x &lt;= n; ++x)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">1</span>; y &lt;= n; ++y)</span><br><span class="line">                <span class="built_in">uadd</span>(dp[<span class="number">0</span>][<span class="number">0</span>][x][y][c], dp[<span class="number">0</span>][<span class="number">0</span>][x][y][c - <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x &lt;= n; ++x)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">1</span>; y &lt;= n; ++y)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> t = <span class="number">1</span>; t &lt;= n; ++t)</span><br><span class="line">                    <span class="built_in">uadd</span>(dp[<span class="number">0</span>][<span class="number">0</span>][x][y][c], f[<span class="number">0</span>][x][t][c] * g[<span class="number">0</span>][t][y][c] % MOD);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="type">int</span> bs, s, bt, t;</span><br><span class="line">        <span class="built_in">read</span>(bs), <span class="built_in">read</span>(s), <span class="built_in">read</span>(bt), <span class="built_in">read</span>(t);</span><br><span class="line">        <span class="built_in">write</span>(<span class="built_in">query</span>(s, t, bs, bt)), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>BZOJ2720 åˆ—é˜Ÿæ˜¥æ¸¸ é¢˜è§£</title>
    <url>/2021/11/26/sol-bzoj2720/</url>
    <content><![CDATA[<h2 id="BZOJ2720-åˆ—é˜Ÿæ˜¥æ¸¸-é¢˜è§£"><a href="#BZOJ2720-åˆ—é˜Ÿæ˜¥æ¸¸-é¢˜è§£" class="headerlink" title="BZOJ2720 åˆ—é˜Ÿæ˜¥æ¸¸ é¢˜è§£"></a>BZOJ2720 åˆ—é˜Ÿæ˜¥æ¸¸ é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://darkbzoj.tk/problem/2720">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å¯¹äºè¿™ç§å…¨æ’åˆ—çš„é¢˜ç›®å‘ç°ä¸å¤ªå¥½ç”¨$dp$ã€‚ä»”ç»†è§‚å¯Ÿå‘ç°å¯¹äºæ¯ä¸ªäººçš„æœŸæœ›è§†é‡éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¯ä»¥ç›´æ¥ç›¸åŠ ï¼Œæ‰€ä»¥ç›´æ¥ç®—$E(c)$è¡¨ç¤ºæœ‰$c$ä¸ªäººçš„é«˜åº¦å°äºè¯¥åŒå­¦æ—¶è¯¥åŒå­¦çš„æœŸæœ›è§†é‡ã€‚ç­”æ¡ˆæ˜¾ç„¶$\sum\limits_{i=1}^{n}{E(c_i)}$ã€‚</p>
<p>è€ƒè™‘å¦‚ä½•æ±‚$E(c)$ã€‚æ ¹æ®æœŸæœ›å…¬å¼æ˜“å¾—$E(c) = \sum\limits_{i=1}^{c}{i \cdot P(i)}$ã€‚</p>
<p>ä½†æ˜¯$P(i)$ä¸å¥½æ±‚è€Œ$P(\ge i)$ç›¸å¯¹å¥½æ±‚ï¼Œäºæ˜¯ç»§ç»­è§‚å¯Ÿè¿™ä¸ªç­‰å¼ï¼Œå‘ç°æ¯ä¸ª$P(i)$éƒ½è¢«è®¡ç®—äº†æ°å¥½$i$æ¬¡ï¼Œæ‰€ä»¥$E(c)$å°±å¯ä»¥è¡¨ç¤ºä¸ºå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
    E(c) = \sum_{i=1}^{c}{P(\ge i)}</script><p>è¿™æ ·å°±åªéœ€è¦è€ƒè™‘æ¦‚ç‡è€Œä¸éœ€è¦è€ƒè™‘æœŸæœ›äº†ã€‚</p>
<p>æ¥ä¸‹æ¥è€ƒè™‘$P(\ge i)$ã€‚æ—¢ç„¶è§†é‡$\ge i$ï¼Œé‚£ä¹ˆè‡³å°‘è¦æœ‰$i-1$ä¸ªé«˜åº¦$\lt h$çš„äººç«™åœ¨å‰é¢ï¼Œäºæ˜¯$P(\ge i)$è¡¨ç¤ºå¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
\begin{align}
        P(\ge i) &= \frac{n-i+1}{n} \cdot \frac{c^{\underline{i-1}}}{(n-1)^{\underline{i-1}}} \\
        &= \frac{n-i+1}{n} \cdot \frac{c!(n-i)!}{(n-1)!(c-i+1)!} \\
        &= \frac{c!}{n!} \cdot \frac{(n-i+1)!}{(c-i+1)!}
    \end{align}</script><p>äºæ˜¯å°†è¯¥å¼ä»£å…¥åˆ°$E(c)$ä¸­å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
    \begin{align}
        E(c) &= \sum_{i=1}^{c}{i \cdot P(i)} \\
        &= \sum_{i=1}^{c}{P(\ge i)} \\
        &= \sum_{i=1}^{c}{\frac{c!}{n!} \cdot \frac{(n-i+1)!}{(c-i+1)!}} \\
        &= \frac{c!}{n!}\sum_{i=1}^{c}{\frac{(n-i+1)!}{(c-i+1)!}} \\
        &= \frac{c!(n-c)!}{n!}\sum_{i=1}^{c}{\binom{n-i+1}{c-i+1}} \\
        &= \frac{c!(n-c)!}{n!}\sum_{i=0}^{c-1}{\binom{n-c+i+1}{i+1}}
    \end{align}</script><p>ç”±äº$\sum\limits_{i=0}^{k}{\binom{n+i}{m+i}} = \binom{n+k+1}{m+k}$ï¼ˆæ˜“è¯ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥è¿›ä¸€æ­¥å°†$E(c)$çš„$\Sigma$ä¼˜åŒ–æ‰ã€‚</p>
<script type="math/tex; mode=display">
    \begin{align}
        E(c) &= \frac{c!(n-c)!}{n!}\sum_{i=0}^{c-1}{\binom{n-c+i+1}{i+1}} \\
        &= \frac{c!(n-c)!}{n!} \cdot \binom{n+1}{c} \\
        &= \frac{c!(n-c)!}{n!} \cdot \frac{(n+1)!}{c!(n-c+1)!} \\
        &= \frac{n+1}{n-c+1}
    \end{align}</script><p>æ‰€ä»¥å¾—åˆ°ç»“è®º</p>
<script type="math/tex; mode=display">
    E(c) = \frac{n+1}{n-c+1}</script><p>äºæ˜¯æœ€ç»ˆçš„ç­”æ¡ˆå°±å˜æˆäº†</p>
<script type="math/tex; mode=display">
    ans = \sum_{i=1}^{n}{\frac{n+1}{n-c+1}}</script><p>$O(n)$æ±‚è§£å³å¯ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           BZOJ2720.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://darkbzoj.tk/problem/2720</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">using</span> ldb = <span class="type">long</span> <span class="type">double</span>;</span><br><span class="line"><span class="type">int</span> n, h[MAXN], cnt[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ++cnt[<span class="built_in">read</span>(h[i])];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">1000</span>; ++i)</span><br><span class="line">        cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">    ldb ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ans += (ldb)(n + <span class="number">1</span>) / (n - cnt[h[i] - <span class="number">1</span>] + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2Lf\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P3715 é­”æ³•å’’è¯­ é¢˜è§£</title>
    <url>/2021/11/25/sol-p3715/</url>
    <content><![CDATA[<h2 id="P3715-é­”æ³•å’’è¯­-é¢˜è§£"><a href="#P3715-é­”æ³•å’’è¯­-é¢˜è§£" class="headerlink" title="P3715 é­”æ³•å’’è¯­ é¢˜è§£"></a>P3715 é­”æ³•å’’è¯­ é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P3715">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å¤šæ¨¡å¼å­—ç¬¦ä¸²åŒ¹é…é¦–å…ˆæƒ³åˆ°ACè‡ªåŠ¨æœºï¼Œé‚£ä¹ˆå°†å¿Œè®³è¯è¯­å»ºç«‹ACè‡ªåŠ¨æœºï¼Œæ•´ä¸ª$dp$å°±æœ‰ä¸€ç»´çŠ¶æ€è®¾ä¸ºACè‡ªåŠ¨æœºçš„çŠ¶æ€ï¼Œå¦ä¸€ç»´å°±ç”¨å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå¾—åˆ°$dp_{i,s}$è¡¨ç¤ºé•¿åº¦ä¸º$i$ï¼ŒåŒ¹é…åˆ°ACè‡ªåŠ¨æœºçš„çŠ¶æ€ä¸º$s$çš„å­—ç¬¦ä¸²ä¸ªæ•°ã€‚è½¬ç§»æ—¶æšä¸¾åŸºæœ¬è¯æ±‡ï¼Œåœ¨ACè‡ªåŠ¨æœºä¸Šè·‘å‡ºä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œåˆ¤æ–­æ˜¯å¦åˆæ³•ç„¶åå‘åè½¬ç§»ã€‚æ—¶é—´å¤æ‚åº¦$O(Ln \Sigma)$ï¼Œ$\Sigma$ä¸ºå¿Œè®³è¯è¯­çš„æ€»é•¿åº¦ï¼Œå¯é€šè¿‡æµ‹è¯•ç‚¹$1-6$ã€‚</p>
<p>æ¥ä¸‹æ¥åˆ†æå¦‚ä½•åšæµ‹è¯•ç‚¹$7-10$ã€‚å‘ç°æµ‹è¯•ç‚¹$7-10$æœ‰$|S<em>i| \le 2$çš„æ€§è´¨ï¼ˆ$|S_i|$ä¸ºåŸºæœ¬è¯æ±‡é•¿åº¦ï¼‰ï¼Œè€Œ$L \le 10^8$åˆç»™æˆ‘ä»¬ä¸€ä¸ªæç¤ºï¼Œå³æ­£è§£å¤æ‚åº¦å¸¦æœ‰$\log L$ï¼Œäºæ˜¯æƒ³åˆ°ç”¨çŸ©é˜µå¿«é€Ÿå¹‚æ¥ä¼˜åŒ–$dp$ã€‚è€ƒè™‘åˆ°å› ä¸ºæœ‰$|S_1| \le 2$ï¼Œæ‰€ä»¥$dp</em>{i,s}$åªä¾èµ–äº$dp_{i-2,t}$ï¼Œå°±å¯ä»¥å‚è€ƒæ–æ³¢é‚£å¥‘æ•°åˆ—çš„çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–æ¥è®¾å®šä¸€ä¸ª$(tot \times 2) \times (tot \times 2)$ï¼Œ$tot$è¡¨ç¤ºACè‡ªåŠ¨æœºçŠ¶æ€æ€»æ•°ï¼ˆæ˜¾ç„¶$tot \le \Sigma \le 100$ï¼‰çš„è½¬ç§»çŸ©é˜µå¤„ç†å³å¯ã€‚æ—¶é—´å¤æ‚åº¦$O((\Sigma)^3 \log L)$ï¼Œå¯é€šè¿‡æµ‹è¯•ç‚¹$7-10$ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(\min(Ln \Sigma, \Sigma^3 \log L))$ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P3715.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P3715</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">205</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">uadd</span><span class="params">(<span class="type">int</span> &amp;x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= MOD)</span><br><span class="line">        x -= MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">matrix</span> &#123;</span><br><span class="line">    <span class="type">int</span> a[MAXN][MAXN], n;</span><br><span class="line">    <span class="built_in">matrix</span>(<span class="type">int</span> m) &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = m;</span><br><span class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));</span><br><span class="line">    &#125;</span><br><span class="line">    matrix <span class="keyword">operator</span>*(<span class="type">const</span> matrix &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="function">matrix <span class="title">ret</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; ++k)</span><br><span class="line">                    <span class="built_in">uadd</span>(ret.a[i][j], a[i][k] * o.a[k][j] % MOD);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ac_automaton</span> &#123;</span><br><span class="line">    <span class="type">int</span> nxt[MAXN][<span class="number">26</span>], fail[MAXN], cnt[MAXN], tot;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">char</span> *s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> rt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; s[i]; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!nxt[rt][s[i] - <span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">                nxt[rt][s[i] - <span class="string">&#x27;a&#x27;</span>] = ++tot;</span><br><span class="line">            rt = nxt[rt][s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        ++cnt[rt];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>())</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i)</span><br><span class="line">            <span class="keyword">if</span> (nxt[<span class="number">0</span>][i])</span><br><span class="line">                que.<span class="built_in">push</span>(nxt[<span class="number">0</span>][i]);</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nxt[u][i]) &#123;</span><br><span class="line">                    fail[nxt[u][i]] = nxt[fail[u]][i];</span><br><span class="line">                    que.<span class="built_in">push</span>(nxt[u][i]);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    nxt[u][i] = nxt[fail[u]][i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, k, sum, len[MAXN];</span><br><span class="line"><span class="type">int</span> dp[MAXN][MAXN];</span><br><span class="line"><span class="type">char</span> s[MAXN][MAXN], t[MAXN][MAXN];</span><br><span class="line">ac_automaton ac;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">posi</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> l)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sum * l + x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">matrix <span class="title">qpow</span><span class="params">(matrix x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="function">matrix <span class="title">ret</span><span class="params">(x.n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= x.n; ++i)</span><br><span class="line">        ret.a[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x)</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>) ret = ret * x;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s[i] + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, t[i] + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        len[i] = <span class="built_in">strlen</span>(s[i] + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        ac.<span class="built_in">insert</span>(t[i] + <span class="number">1</span>);</span><br><span class="line">    ac.<span class="built_in">build</span>();</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= <span class="number">100</span>) &#123;</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= ac.tot; ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (ac.cnt[j])</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x &lt;= n; ++x) &#123;</span><br><span class="line">                    <span class="type">int</span> p = j;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>; l &lt;= len[x]; ++l) &#123;</span><br><span class="line">                        p = ac.nxt[p][s[x][l] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">                        <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">int</span> o = p; o; o = ac.fail[o]) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (ac.cnt[o]) &#123;</span><br><span class="line">                                cnt += ac.cnt[o];</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (cnt) &#123;</span><br><span class="line">                            p = <span class="number">-1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (~p &amp;&amp; i + len[x] &lt;= k)</span><br><span class="line">                        <span class="built_in">uadd</span>(dp[i + len[x]][p], dp[i][j]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= ac.tot; ++i)</span><br><span class="line">            <span class="keyword">if</span> (!ac.cnt[i])</span><br><span class="line">                <span class="built_in">uadd</span>(ans, dp[k][i]);</span><br><span class="line">        <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        sum = ac.tot + <span class="number">1</span>;</span><br><span class="line">        <span class="function">matrix <span class="title">base</span><span class="params">(sum * <span class="number">2</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= ac.tot; ++i)</span><br><span class="line">            base.a[<span class="built_in">posi</span>(i, <span class="number">1</span>)][<span class="built_in">posi</span>(i, <span class="number">0</span>)] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= ac.tot; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ac.cnt[i])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x &lt;= n; ++x) &#123;</span><br><span class="line">                <span class="type">int</span> p = i;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>; l &lt;= len[x]; ++l) &#123;</span><br><span class="line">                    p = ac.nxt[p][s[x][l] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">                    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">                    <span class="comment">// ##sb-mistakes## ACè‡ªåŠ¨æœºåœ¨åšå¤šæ¨¡å¼åŒ¹é…çš„æ—¶å€™**ä¸€å®šè¦è·³failæŒ‡é’ˆ**ä¸ç„¶ä¼š**æ¼éå†å¾ˆå¤šä¸œè¥¿**ï¼ˆACè‡ªåŠ¨æœºç™½å­¦äº†ï¼‰ï¼ï¼ï¼</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> o = p; o; o = ac.fail[o]) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (ac.cnt[o]) &#123;</span><br><span class="line">                            cnt += ac.cnt[o];</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (cnt) &#123;</span><br><span class="line">                        p = <span class="number">-1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (p == <span class="number">-1</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (len[x] == <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="built_in">uadd</span>(base.a[<span class="built_in">posi</span>(i, <span class="number">0</span>)][<span class="built_in">posi</span>(p, <span class="number">0</span>)], <span class="number">1</span>);</span><br><span class="line">                    <span class="comment">// ##sb-mistakes## å†™çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–dpï¼ˆå°¤å…¶æ˜¯dp[i]ä¾èµ–äºdp[i-2]è¿™ç§ï¼‰çš„æ—¶å€™ä¸€å®šè¦ç®—å¥½ï¼Œä¸èƒ½é‡å¤åŠ äº†</span></span><br><span class="line">                    <span class="comment">// uadd(base.a[posi(i, 1)][posi(p, 1)], 1);</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="built_in">uadd</span>(base.a[<span class="built_in">posi</span>(i, <span class="number">0</span>)][<span class="built_in">posi</span>(p, <span class="number">1</span>)], <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">matrix <span class="title">tmp</span><span class="params">(sum * <span class="number">2</span>)</span></span>;</span><br><span class="line">        tmp.a[<span class="number">1</span>][<span class="built_in">posi</span>(<span class="number">0</span>, <span class="number">0</span>)] = <span class="number">1</span>;</span><br><span class="line">        tmp = tmp * <span class="built_in">qpow</span>(base, k);</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= ac.tot; ++i)</span><br><span class="line">            <span class="keyword">if</span> (!ac.cnt[i])</span><br><span class="line">                <span class="built_in">uadd</span>(ans, tmp.a[<span class="number">1</span>][<span class="built_in">posi</span>(i, <span class="number">0</span>)]);</span><br><span class="line">        <span class="built_in">write</span>(ans), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P7154 Sleeping Cows P é¢˜è§£</title>
    <url>/2021/11/25/sol-p7154/</url>
    <content><![CDATA[<h2 id="P7154-Sleeping-Cows-P-é¢˜è§£"><a href="#P7154-Sleeping-Cows-P-é¢˜è§£" class="headerlink" title="P7154 Sleeping Cows P é¢˜è§£"></a>P7154 Sleeping Cows P é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P7154">é¢˜ç›®é“¾æ¥</a></p>
<h2 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h2><p>å…ˆåˆ†ææ€§è´¨ã€‚é¦–å…ˆæ’åºä¸å½±å“ç­”æ¡ˆæ‰€ä»¥å°†å…¶æ’åºã€‚è‹¥$t_i$æ‰€èƒ½åŒ¹é…åˆ°çš„æœ€å¤§$s$çš„ä¸‹æ ‡ä¸º$x$ï¼Œåˆ™å¦‚æœæ”¾å¼ƒ$t_i$å°±æ„å‘³ç€$s_1$åˆ°$s_x$éƒ½è¦è¢«åŒ¹é…ã€‚æ‰€ä»¥åœ¨æ­¤æ€è·¯ä¸Š$dp$åˆ™éœ€è¦ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«æŒ‡å‘æœ€å°çš„è¿˜æ²¡è€ƒè™‘çš„$s$å’Œ$t$ï¼Œæ¯æ¬¡é€‰æ‹©è¾ƒå°çš„ä¸€è¾¹è¿›è¡Œæ›´æ–°ã€‚ä¸å¦¨å°†ä¸¤ä¸ªæ•°ç»„åˆå¹¶é¡ºåºå»åšã€‚</p>
<p>è€ƒè™‘$dp$ï¼Œè®¾$dp_{i,j,0/1}$è¡¨ç¤ºè€ƒè™‘åˆ°æ–°æ•°ç»„çš„ç¬¬$i$ä¸ªæ•°ï¼Œç›®å‰æœ‰$j$ä¸ª$s$è¢«é€‰å…¥åŒ¹é…ä½†è¿˜æ²¡ç¡®å®šåŒ¹é…è°ï¼Œ$1$åˆ°$i-1$ä¸­æ˜¯å¦éƒ½å·²ç»è¢«é€‰å…¥çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆå¾—åˆ°è½¬ç§»æ–¹ç¨‹ï¼š</p>
<p>è‹¥å…ƒç´ $i$åœ¨$s$ä¸­ï¼Œåˆ™</p>
<script type="math/tex; mode=display">
    \begin{align}
    dp_{i,j,0} &= dp_{i-1,j-1,0} + dp_{i-1,j,0} + dp_{i-1,j,1} \\
    dp_{i,j,1} &= dp_{i-1,j-1,1}
    \end{align}</script><p>è‹¥å…ƒç´ $i$åœ¨$t$ä¸­ï¼Œåˆ™</p>
<script type="math/tex; mode=display">
    \begin{align}
    dp_{i,j,0} &= (j+1)dp_{i-1,j+1,0} \\
    dp_{i,j,1} = dp_{i-1,j,1} + (j+1)dp_{i-1,j+1,1}
    \end{align}</script><p>æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ $dp<em>{n,0,0} + dp</em>{n,0,1}$ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n^2)$ã€‚</p>
<h2 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P7154.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/solution/P7154</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">6e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> x, op;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x == o.x ? op &lt; o.op : x &lt; o.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, s[MAXN], t[MAXN], dp[<span class="number">2</span>][MAXN][<span class="number">2</span>];</span><br><span class="line">node a[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= MOD)</span><br><span class="line">        x -= MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(s[i]), a[++m] = &#123;s[i], <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(t[i]), a[++m] = &#123;t[i], <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + m + <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> u = <span class="number">0</span>;</span><br><span class="line">    dp[u ^ <span class="number">1</span>][<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i, u ^= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(dp[u], <span class="number">0</span>, <span class="built_in">sizeof</span>(dp[u]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i].op == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">add</span>(dp[u][j][<span class="number">0</span>], dp[u ^ <span class="number">1</span>][j][<span class="number">0</span>]);</span><br><span class="line">                <span class="built_in">add</span>(dp[u][j][<span class="number">0</span>], dp[u ^ <span class="number">1</span>][j][<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">if</span> (j) &#123;</span><br><span class="line">                    <span class="built_in">add</span>(dp[u][j][<span class="number">0</span>], dp[u ^ <span class="number">1</span>][j - <span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">                    <span class="built_in">add</span>(dp[u][j][<span class="number">1</span>], dp[u ^ <span class="number">1</span>][j - <span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">add</span>(dp[u][j][<span class="number">0</span>], dp[u ^ <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">0</span>] * (j + <span class="number">1</span>) % MOD);</span><br><span class="line">                <span class="built_in">add</span>(dp[u][j][<span class="number">1</span>], dp[u ^ <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">1</span>] * (j + <span class="number">1</span>) % MOD);</span><br><span class="line">                <span class="built_in">add</span>(dp[u][j][<span class="number">1</span>], dp[u ^ <span class="number">1</span>][j][<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">add</span>(sum, dp[u ^ <span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="built_in">add</span>(sum, dp[u ^ <span class="number">1</span>][<span class="number">0</span>][<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">write</span>(sum), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF575A Fibonotci é¢˜è§£</title>
    <url>/2021/11/24/sol-cf575a/</url>
    <content><![CDATA[<h2 id="CF575A-Fibonotci-é¢˜è§£"><a href="#CF575A-Fibonotci-é¢˜è§£" class="headerlink" title="CF575A Fibonotci é¢˜è§£"></a>CF575A Fibonotci é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF575A">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>$K \le 10^{18}$ æ˜¾ç„¶çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–ã€‚çŸ©é˜µè½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
    \begin{bmatrix}
        f_i & f_{i-1}
    \end{bmatrix}
    =
    \begin{bmatrix}
        f_{i-1} & f_{i-2}
    \end{bmatrix}
    \begin{pmatrix}
        s_{i-1} & 1 \\
        s_{i-2} & 0
    \end{pmatrix}</script><p>å¹¶å¥—è·¯åœ°è®¾</p>
<script type="math/tex; mode=display">
    M_i =
    \begin{pmatrix}
        s_{i-1} & 1 \\
        s_{i-2} & 0
    \end{pmatrix}</script><p>æœ€ç»ˆç­”æ¡ˆå³ä¸º</p>
<script type="math/tex; mode=display">
    \begin{bmatrix}
        1 & 0
    \end{bmatrix}
    \times
    \prod_{i=1}^{k}{
        \begin{pmatrix}
            s_{i-1} & 1 \\
            s_{i-2} & 0
        \end{pmatrix}
    }
    =
    \begin{bmatrix}
        1 & 0
    \end{bmatrix}
    \times
    \prod_{i=1}^{k}{M_i}</script><p>ç”±äºå‡½æ•°å¤§éƒ¨åˆ†å…·æœ‰å‘¨æœŸæ€§ï¼Œä¸å¦¨å…ˆæŒ‰ç…§åˆ†æˆè‹¥å¹²ä¸ªç±»ä¼¼$[i\cdot n, (i+1)\cdot n)$çš„åŒºé—´åˆ†åˆ«å¤„ç†ã€‚</p>
<p>å¯¹äºæœªä¿®æ”¹è¿‡çš„åŒºé—´ç›´æ¥é¢„å¤„ç†$[0,n)$çš„çŸ©é˜µä¹˜ç§¯å¹¶å¿«é€Ÿå¹‚è®¡ç®—ã€‚</p>
<p>è€ƒè™‘ä¿®æ”¹çš„åŒºé—´ã€‚ä¸ºäº†é¿å…å¯¹ä¸€ä¸ª$s<em>i$çš„ä¿®æ”¹å½±å“åˆ°ä¸¤ä¸ªä¸åŒçš„åŒºé—´ï¼Œå¯ä»¥å…ˆå°†å¯¹$s_i$çš„ä¿®æ”¹æ˜ å°„åˆ°å¯¹çŸ©é˜µ$M</em>{i+1}$å’Œ$M_{i+2}$çš„ä¿®æ”¹ã€‚ç„¶åå‘ç°å¤„ç†ä¸€ä¸ªåŒºé—´æ—¶éœ€è¦å¤šæ¬¡å•ç‚¹ä¿®æ”¹å’Œä¸€æ¬¡åŒºé—´æŸ¥è¯¢ï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤å³å¯ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸€äº›ç‰¹åˆ¤ï¼ˆåŸºæœ¬ä¸Šæ˜¯$k \lt n$çš„æƒ…å†µï¼‰ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O((n + m) (\log{n} + \log{k}))$ã€‚</p>
<p><del>ç‰¹åˆ¤ä¸å–æ¨¡ï¼Œçˆ†é›¶ä¸¤è¡Œæ³ª/kk</del></p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF575A.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF575A</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> t, s1, s2;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, k, p, s[MAXN];</span><br><span class="line">pii a[MAXN];</span><br><span class="line">node b[MAXN * <span class="number">2</span>];</span><br><span class="line">unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= p ? x - p : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">matrix</span> &#123;</span><br><span class="line">    <span class="type">int</span> a[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">matrix</span>() &#123; a[<span class="number">0</span>][<span class="number">0</span>] = a[<span class="number">0</span>][<span class="number">1</span>] = a[<span class="number">1</span>][<span class="number">0</span>] = a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="built_in">matrix</span>(<span class="type">int</span> x) &#123; a[<span class="number">0</span>][<span class="number">0</span>] = a[<span class="number">1</span>][<span class="number">1</span>] = x, a[<span class="number">0</span>][<span class="number">1</span>] = a[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="built_in">matrix</span>(<span class="type">int</span> s1, <span class="type">int</span> s2) &#123; a[<span class="number">0</span>][<span class="number">0</span>] = s2, a[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>, a[<span class="number">1</span>][<span class="number">0</span>] = s1, a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>; &#125;</span><br><span class="line">    matrix <span class="keyword">operator</span>*(<span class="type">const</span> matrix &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        matrix ret;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; ++j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span>; ++k)</span><br><span class="line">                    ret.a[i][j] = <span class="built_in">add</span>(ret.a[i][j], a[i][k] * o.a[k][j] % p);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> matrix <span class="keyword">operator</span>^(matrix x, <span class="type">int</span> y) &#123;</span><br><span class="line">        matrix ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = x * x)</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>) ret = ret * x;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> li (i &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ri (i &lt;&lt; 1) | 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lson li, l, mid</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rson ri, mid + 1, r</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">segment_tree</span> &#123;</span><br><span class="line">    matrix nd[MAXN * <span class="number">4</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">        nd[i] = nd[li] * nd[ri];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> p, matrix v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">void</span>(nd[i] = v);</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (p &lt;= mid)</span><br><span class="line">            <span class="built_in">update</span>(lson, p, v);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">update</span>(rson, p, v);</span><br><span class="line">        <span class="built_in">pushup</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">matrix <span class="title">query</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">            <span class="keyword">return</span> nd[i];</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        matrix ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            ret = ret * <span class="built_in">query</span>(lson, ql, qr);</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            ret = ret * <span class="built_in">query</span>(rson, ql, qr);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">segment_tree tr;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(k), <span class="built_in">read</span>(p);</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(s[i]);</span><br><span class="line">    <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i].first), <span class="built_in">read</span>(a[i].second);</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + m + <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">1</span> &amp;&amp; a[i].first + <span class="number">1</span> == a[i - <span class="number">1</span>].first + <span class="number">2</span>)</span><br><span class="line">            b[++cnt] = &#123;a[i].first + <span class="number">1</span>, a[i - <span class="number">1</span>].second, a[i].second&#125;;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">1</span> || a[i].first + <span class="number">1</span> != a[i - <span class="number">1</span>].first + <span class="number">2</span>)</span><br><span class="line">            b[++cnt] = &#123;a[i].first + <span class="number">1</span>, s[(a[i].first - <span class="number">1</span>) % n], a[i].second&#125;;</span><br><span class="line">        <span class="keyword">if</span> (i == m || a[i].first + <span class="number">2</span> != a[i + <span class="number">1</span>].first + <span class="number">1</span>)</span><br><span class="line">            b[++cnt] = &#123;a[i].first + <span class="number">2</span>, a[i].second, s[(a[i].first + <span class="number">1</span>) % n]&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (cnt &amp;&amp; b[cnt].t &gt; k)</span><br><span class="line">        --cnt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        tr.<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, i, <span class="built_in">matrix</span>(s[(i + n - <span class="number">2</span>) % n], s[(i + n - <span class="number">1</span>) % n]));</span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">0</span> || k == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">write</span>(k % p), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>), <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (k &lt; n) &#123;</span><br><span class="line">        matrix ret;</span><br><span class="line">        ret.a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">write</span>((ret * tr.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, <span class="number">2</span>, k)).a[<span class="number">0</span>][<span class="number">0</span>]), <span class="built_in">putchar</span>(<span class="string">&#x27;\0&#x27;</span>), <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    matrix sum = tr.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">    matrix base = tr.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, <span class="number">2</span>, n - <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> pos = <span class="number">1</span>, pre = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (pos &lt;= cnt) &#123;</span><br><span class="line">        <span class="type">int</span> cur = b[pos].t / n;</span><br><span class="line">        base = base * (sum ^ (cur - pre - <span class="number">1</span>)), pre = cur;</span><br><span class="line">        <span class="type">int</span> cl = <span class="built_in">max</span>(<span class="number">2ll</span>, cur * n), cr = <span class="built_in">min</span>(k, cur * n + n - <span class="number">1</span>), lst = pos;</span><br><span class="line">        <span class="keyword">while</span> (pos &lt;= cnt &amp;&amp; cl &lt;= b[pos].t &amp;&amp; b[pos].t &lt;= cr) &#123;</span><br><span class="line">            tr.<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, b[pos].t % n, <span class="built_in">matrix</span>(b[pos].s1, b[pos].s2));</span><br><span class="line">            ++pos;</span><br><span class="line">        &#125;</span><br><span class="line">        base = base * tr.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, cl % n, cr % n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = lst; j &lt; pos; ++j)</span><br><span class="line">            tr.<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>, b[j].t % n, <span class="built_in">matrix</span>(s[(b[j].t - <span class="number">2</span>) % n], s[(b[j].t - <span class="number">1</span>) % n]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> cur = k / n;</span><br><span class="line">    <span class="keyword">if</span> (pre &lt; cur) &#123;</span><br><span class="line">        base = base * (sum ^ (cur - pre - <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = cur * n; i &lt;= k; ++i)</span><br><span class="line">            base = base * <span class="built_in">matrix</span>(s[(i - <span class="number">2</span>) % n], s[(i - <span class="number">1</span>) % n]);</span><br><span class="line">    &#125;</span><br><span class="line">    matrix ret;</span><br><span class="line">    ret.a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    ret = ret * base;</span><br><span class="line">    <span class="built_in">write</span>(ret.a[<span class="number">0</span>][<span class="number">0</span>]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P6144 Help Yourself é¢˜è§£</title>
    <url>/2021/11/23/sol-p6144/</url>
    <content><![CDATA[<h2 id="P6144-Help-Yourself-é¢˜è§£"><a href="#P6144-Help-Yourself-é¢˜è§£" class="headerlink" title="P6144 Help Yourself é¢˜è§£"></a>P6144 Help Yourself é¢˜è§£</h2><span id="more"></span>
<p><del>åº”è¯¥æ˜¯ç¬¬ä¸€æ¬¡åœ¨å­¦æ ¡åˆè‡ªä¹ æ—¶å·OIï¼ˆç„¶åsxyèµ°è¿›æ¥çœ‹äº†æˆ‘ä¸€çœ¼å•¥ä¹Ÿæ²¡è¯´ï¼‰</del></p>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P6144">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>å¯¹äºè¿™ç§è‹¥å¹²åŒºé—´æ±‚å€¼çš„é¢˜ç›®ï¼Œè‚¯å®šå…ˆæŒ‰ç…§å·¦ç«¯ç‚¹æˆ–è€…å³ç«¯ç‚¹æ’ä¸ªåºã€‚</p>
<p>ä¸å¦¨å…ˆæ¥è€ƒè™‘å¯¹äº$k=1$çš„æƒ…å†µdpçŠ¶æ€æ€ä¹ˆè®¾ã€‚å¥—è·¯åœ°è®¾$dp_i$è¡¨ç¤ºä»¥$i$ä¸ºå½“å‰è¦†ç›–çš„æœ€å³ç«¯ç‚¹çš„è”é€šå—æ•°ç›®ä¹‹å’Œï¼Œä¸‹é¢è¦åŠ å…¥ä¸€æ¡çº¿æ®µ$[l,r]$ï¼Œæ€è€ƒæ’å…¥è¿™æ¡çº¿æ®µå¯¹$dp$å€¼çš„å½±å“ã€‚å¯¹äº$i\lt r$çš„æ‰€æœ‰$dp_i$ä¸ä¼šè¢«å½±å“ï¼Œè€Œå¯¹æ¯ä¸ª$0 \le i \lt l$ï¼Œ$dp_r$çš„å€¼éœ€åŠ ä¸Š$dp_i + 1$ï¼Œå¯¹æ¯ä¸ª$l \le i \lt r$ï¼Œ$dp_r$çš„å€¼éœ€åŠ ä¸Š$dp_i$ã€‚æœ€åå¯¹äº$i \gt r$ï¼Œæ˜¾ç„¶æ’å…¥è¿™ä¹ˆä¸€æ¡çº¿æ®µä¸ä¼šå½±å“åˆ°å…¶å³æ–­ç‚¹ï¼Œä½†å–è¯¥çº¿æ®µå’Œä¸å–è¯¥çº¿æ®µå„æœ‰ä¸€ç§å¯èƒ½ï¼Œæ‰€ä»¥è¦å°†æ•´ä¸ªåŒºé—´ä¹˜ä¸Š2.</p>
<p>åˆ†æåˆ°è¿™é‡Œï¼Œå¦‚ä½•ç»´æŠ¤$dp$å°±ä¸€ç›®äº†ç„¶äº†ï¼šä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤å•ç‚¹åŠ æ³•å’ŒåŒºé—´ä¹˜æ³•ä»¥åŠåŒºé—´æ±‚å’Œå³å¯ã€‚</p>
<p>æ¥ä¸‹æ¥è®¡ç®—$k \neq 1$çš„æƒ…å†µã€‚ä¸éš¾å‘ç°æ¯ä¸ª$dp<em>{k,i}$éƒ½å¯ä»¥è¢«è¡¨ç¤ºæˆ$\sum\limits_i{b_i^k}$çš„å½¢å¼ï¼ˆ$b_i$æ˜¯æ¯ç§å­é›†çš„è”é€šå—æ•°ç›®ï¼‰ã€‚è€ŒåŒºé—´ä¹˜ä¸Š2ç›´æ¥åšï¼Œæ±‚å’Œä¹Ÿç›´æ¥çº¿æ®µæ ‘ï¼Œæ±‚$\sum\limits</em>{i=0}^{l-1}{(dp<em>{k,i}+1)}$ç”¨äºŒé¡¹å¼å®šç†æ‹†å¼€å¾—åˆ°$\sum\limits</em>{j=0}^{k}\sum\limits<em>{i=0}^{l-1}{\binom{k}{j} \times dp</em>{j,i}}$å³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p>
<p>æ‰€ä»¥æ—¶é—´å¤æ‚åº¦$O(k^2n\log{n})$éšä¾¿è¿‡ã€‚<del>è¿™æ¯”å‰é¢ä¸¤é“é»‘é¢˜å¥½äº›å¤šäº†</del></p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P6144.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P6144</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">11</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    x += y;</span><br><span class="line">    <span class="keyword">return</span> x &gt;= MOD ? x - MOD : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> l == o.l ? r &lt; o.r : l &lt; o.l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> li (i &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ri (i &lt;&lt; 1) | 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lson li, l, mid</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rson ri, mid + 1, r</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">segment_tree</span> &#123;</span><br><span class="line">    <span class="type">int</span> sum[MAXM * <span class="number">4</span>], tag[MAXM * <span class="number">4</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">        sum[i] = <span class="built_in">add</span>(sum[li], sum[ri]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getdown</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">        sum[i] = sum[i] * val % MOD;</span><br><span class="line">        tag[i] = tag[i] * val % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (tag[i] != <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">getdown</span>(li, tag[i]);</span><br><span class="line">            <span class="built_in">getdown</span>(ri, tag[i]);</span><br><span class="line">            tag[i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        sum[i] = <span class="number">0</span>; tag[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">void</span>(sum[i] = x);</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">build</span>(lson, x), <span class="built_in">build</span>(rson, x);</span><br><span class="line">        <span class="built_in">pushup</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> q, <span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">void</span>(sum[i] = <span class="built_in">add</span>(sum[i], val));</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">pushdown</span>(i);</span><br><span class="line">        <span class="keyword">if</span> (q &lt;= mid)</span><br><span class="line">            <span class="built_in">update</span>(lson, q, val);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">update</span>(rson, q, val);</span><br><span class="line">        <span class="built_in">pushup</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr, <span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &gt; qr)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getdown</span>(i, val);</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">pushdown</span>(i);</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            <span class="built_in">modify</span>(lson, ql, qr, val);</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            <span class="built_in">modify</span>(rson, ql, qr, val);</span><br><span class="line">        <span class="built_in">pushup</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &gt; qr)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">            <span class="keyword">return</span> sum[i];</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">pushdown</span>(i);</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            ret = <span class="built_in">add</span>(ret, <span class="built_in">query</span>(lson, ql, qr));</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            ret = <span class="built_in">add</span>(ret, <span class="built_in">query</span>(rson, ql, qr));</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, k, c[MAXK][MAXK];</span><br><span class="line">node a[MAXN];</span><br><span class="line">segment_tree tr[MAXK];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k), m = n * <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i].l), <span class="built_in">read</span>(a[i].r);</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    c[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">        c[i][<span class="number">0</span>] = c[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt; i; ++j)</span><br><span class="line">            c[i][j] = <span class="built_in">add</span>(c[i - <span class="number">1</span>][j], c[i - <span class="number">1</span>][j - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= k; ++i)</span><br><span class="line">        tr[i].<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>, m, <span class="number">0</span>);</span><br><span class="line">    tr[<span class="number">0</span>].<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, m, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = k; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt;= j; ++l)</span><br><span class="line">                sum = <span class="built_in">add</span>(sum, c[j][l] * tr[l].<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, m, <span class="number">0</span>, a[i].l - <span class="number">1</span>) % MOD);</span><br><span class="line">            sum = <span class="built_in">add</span>(sum, tr[j].<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, m, a[i].l, a[i].r));</span><br><span class="line">            tr[j].<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">0</span>, m, a[i].r, sum);</span><br><span class="line">            tr[j].<span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">0</span>, m, a[i].r + <span class="number">1</span>, m, <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(tr[k].<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, m, <span class="number">1</span>, m)), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF710F String Set Queries é¢˜è§£</title>
    <url>/2021/11/22/sol-cf710f/</url>
    <content><![CDATA[<h2 id="CF710F-String-Set-Queries-é¢˜è§£"><a href="#CF710F-String-Set-Queries-é¢˜è§£" class="headerlink" title="CF710F String Set Queries é¢˜è§£"></a>CF710F String Set Queries é¢˜è§£</h2><span id="more"></span>
<h3 id="åˆå·å‡ºæ¥ä¸€é“é»‘é¢˜å“ˆå“ˆå“ˆ"><a href="#åˆå·å‡ºæ¥ä¸€é“é»‘é¢˜å“ˆå“ˆå“ˆ" class="headerlink" title="åˆå·å‡ºæ¥ä¸€é“é»‘é¢˜å“ˆå“ˆå“ˆ"></a><del>åˆå·å‡ºæ¥ä¸€é“é»‘é¢˜å“ˆå“ˆå“ˆ</del></h3><h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF710F">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¦–å…ˆçœ‹åˆ°å¤šæ¨¡åŒ¹é…æƒ³åˆ°ACè‡ªåŠ¨æœºã€‚</p>
<p>è¿™ä¸ªå¼ºåˆ¶åœ¨çº¿çœ‹èµ·æ¥å¾ˆéº»çƒ¦çš„æ ·å­ï¼Œå› ä¸ºACè‡ªåŠ¨æœºå¿…é¡»è¦ç¦»çº¿ä¸‹æ¥æ‰èƒ½buildã€‚æ‰€ä»¥å°±å¼•å…¥ä¸€ç§æ–°çš„ç®—æ³•å«åšâ€œäºŒè¿›åˆ¶åˆ†ç»„â€ã€‚</p>
<blockquote>
<h3 id="äºŒè¿›åˆ¶åˆ†ç»„"><a href="#äºŒè¿›åˆ¶åˆ†ç»„" class="headerlink" title="äºŒè¿›åˆ¶åˆ†ç»„"></a>äºŒè¿›åˆ¶åˆ†ç»„</h3><p><del>è¿™ä¸ªç®—æ³•ä¸€çœ‹åå­—å°±å¾ˆ$\log$</del></p>
<p>ç»´æŠ¤ä¸€ä¸ªstackï¼Œé‡Œé¢çš„å€¼éƒ½æ˜¯2çš„æ¬¡å¹‚ã€‚æ¯æ¬¡æ“ä½œåœ¨æ ˆé¡¶æ’å…¥ä¸€ä¸ª1ï¼Œå¦‚æœæ ˆé¡¶çš„ä¸¤ä¸ªæ•°ç›¸åŒå°±å°†å…¶åˆå¹¶ï¼Œå¹¶æ”¹ä¸ºä¸¤ä¸ªæ•°çš„å’Œã€‚æŸ¥è¯¢çš„æ—¶å€™éå†æ•´ä¸ªstackå¯¹æ¯ä¸ªå€¼è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<p>è¿™æ ·å‡è®¾æ¯æ¬¡åˆå¹¶å’ŒæŸ¥è¯¢stackä¸­ä¸€ä¸ªå€¼çš„å¤æ‚åº¦éƒ½æ˜¯$O(x)$çš„ï¼ˆè¿™é‡Œ$x$æŒ‡çš„æ˜¯æ ˆå†…å½“å‰å€¼çš„å¤§å°ï¼‰æ˜¾ç„¶æŸ¥è¯¢çš„å¤æ‚åº¦æ˜¯$O(x)$çš„ï¼Œç„¶åæ’å…¥çš„å¤æ‚åº¦æ˜¯$O(x\log{n})$ï¼Œå› ä¸ºæ¯ä¸ªæ’å…¥çš„æ•°åªä¼šè¢«åˆå¹¶$\log{n}$æ¬¡ã€‚æ€»å¤æ‚åº¦ä¸º$O(qx\log{n})$ã€‚</p>
</blockquote>
<p>è€Œåœ¨è¿™é“é¢˜ä¸­ï¼Œ$qx = \sum{|S|} = 3 \times 10^5$ï¼Œæ‰€ä»¥æ˜¾ç„¶æ˜¯èƒ½è¿‡çš„ã€‚</p>
<p>äºæ˜¯è¿™é“é¢˜æœ¬èº«å¹¶ä¸ç®—éš¾ï¼Œä½†æ˜¯è¯„é»‘çš„åŸå› æˆ‘è®¤ä¸ºæ˜¯å®ƒ<strong>æ¯’ç˜¤å¡ç©ºé—´ï¼ï¼ï¼</strong></p>
<p>å…³äºæˆ‘ä»£ç ä¸­å¡ç©ºé—´çš„<del>å¥‡æŠ€æ·«å·§</del>å°±æ˜¯å°†ACè‡ªåŠ¨æœºçš„èŠ‚ç‚¹å¼€æˆå†…å­˜æ± ï¼ŒåŠ¨æ€åˆ†é…ï¼ˆä»£ç ä¸­<code>node* malloc_p()</code>çš„ä½œç”¨å°±åœ¨æ­¤ï¼‰ã€‚è¿˜æœ‰å°±æ˜¯æ³¨æ„ACè‡ªåŠ¨æœºåœ¨æ„å»ºçš„æ—¶å€™æŠŠ$cnt$æ•°ç»„é¢„å¤„ç†å¥½ï¼Œè¿™æ ·å°±ä¸ç”¨æ¯æ¬¡è·³$fail$æŒ‡é’ˆäº†ï¼ˆæˆ‘ä»£ç ä¸€å¼€å§‹å°±åœ¨è¿™é‡ŒTLEäº†ï¼‰ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           CF710F.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF710F</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> lli = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXK = <span class="number">22</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFI = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">bool</span> m_be;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> cnt, fail, nxt[<span class="number">26</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cnt = fail = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">fill</span>(nxt, nxt + <span class="number">26</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> ntot, ntop;</span><br><span class="line">node nnd[MAXN];</span><br><span class="line">node *buf[MAXN];</span><br><span class="line"><span class="function">node* <span class="title">malloc_p</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ntop ? buf[ntop--] : &amp;nnd[++ntot];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ac_automaton</span> &#123;</span><br><span class="line">    <span class="type">int</span> tot;</span><br><span class="line">    node *nd[MAXN];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        nd[tot = <span class="number">0</span>] = <span class="built_in">malloc_p</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= tot; ++i)</span><br><span class="line">            nd[i]-&gt;<span class="built_in">clear</span>(), buf[++ntop] = nd[i];</span><br><span class="line">        nd[tot = <span class="number">0</span>] = <span class="built_in">malloc_p</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> rt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; s[i]; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!nd[rt]-&gt;nxt[s[i] - <span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">                nd[rt]-&gt;nxt[s[i] - <span class="string">&#x27;a&#x27;</span>] = (nd[++tot] = <span class="built_in">malloc_p</span>(), tot);</span><br><span class="line">            rt = nd[rt]-&gt;nxt[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        ++nd[rt]-&gt;cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">static</span> queue&lt;<span class="type">int</span>&gt; que;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>())</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i)</span><br><span class="line">            <span class="keyword">if</span> (nd[<span class="number">0</span>]-&gt;nxt[i])</span><br><span class="line">                que.<span class="built_in">push</span>(nd[<span class="number">0</span>]-&gt;nxt[i]);</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = que.<span class="built_in">front</span>();</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            nd[u]-&gt;cnt += nd[nd[u]-&gt;fail]-&gt;cnt;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nd[u]-&gt;nxt[i]) &#123;</span><br><span class="line">                    nd[nd[u]-&gt;nxt[i]]-&gt;fail = nd[nd[u]-&gt;fail]-&gt;nxt[i];</span><br><span class="line">                    que.<span class="built_in">push</span>(nd[u]-&gt;nxt[i]);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    nd[u]-&gt;nxt[i] = nd[nd[u]-&gt;fail]-&gt;nxt[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">lli <span class="title">query</span><span class="params">(<span class="type">char</span> *s)</span> </span>&#123;</span><br><span class="line">        lli ret = <span class="number">0</span>, p = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; s[i]; ++i) &#123;</span><br><span class="line">            p = nd[p]-&gt;nxt[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            ret += nd[p]-&gt;cnt;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">group</span> &#123;</span><br><span class="line">    string dat[MAXN];</span><br><span class="line">    ac_automaton ac[MAXK];</span><br><span class="line">    <span class="type">int</span> n, top, sl[MAXK], sr[MAXK];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; MAXK; ++i)</span><br><span class="line">            ac[i].<span class="built_in">init</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">char</span> *s)</span> </span>&#123;</span><br><span class="line">        dat[++n] = s;</span><br><span class="line">        ++top, sl[top] = n, sr[top] = n;</span><br><span class="line">        ac[top].<span class="built_in">clear</span>(), ac[top].<span class="built_in">insert</span>(s), ac[top].<span class="built_in">build</span>();</span><br><span class="line">        <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; sr[top] - sl[top] == sr[top - <span class="number">1</span>] - sl[top - <span class="number">1</span>]) &#123;</span><br><span class="line">            sr[top - <span class="number">1</span>] = sr[top], ac[top--].<span class="built_in">clear</span>();</span><br><span class="line">            ac[top].<span class="built_in">clear</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = sl[top]; i &lt;= sr[top]; ++i)</span><br><span class="line">                ac[top].<span class="built_in">insert</span>(dat[i].<span class="built_in">c_str</span>());</span><br><span class="line">            ac[top].<span class="built_in">build</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">lli <span class="title">query</span><span class="params">(<span class="type">char</span> *s)</span> </span>&#123;</span><br><span class="line">        lli ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= top; ++i)</span><br><span class="line">            ret += ac[i].<span class="built_in">query</span>(s);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> m, opt;</span><br><span class="line"><span class="type">char</span> s[MAXN];</span><br><span class="line">group add, sub;</span><br><span class="line"><span class="type">bool</span> m_ed;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">debug</span>(<span class="string">&quot;memory = %.5lfMB&quot;</span>, (&amp;m_ed - &amp;m_be) / <span class="number">1024.0</span> / <span class="number">1024.0</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">    <span class="type">int</span> mm = m;</span><br><span class="line">    add.<span class="built_in">init</span>(), sub.<span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%s&quot;</span>, &amp;opt, s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (opt == <span class="number">1</span>) &#123;</span><br><span class="line">            add.<span class="built_in">insert</span>(s + <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (opt == <span class="number">2</span>) &#123;</span><br><span class="line">            sub.<span class="built_in">insert</span>(s + <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, add.<span class="built_in">query</span>(s + <span class="number">1</span>) - sub.<span class="built_in">query</span>(s + <span class="number">1</span>));</span><br><span class="line">            <span class="built_in">fflush</span>(stdout);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>P4632 New Home é¢˜è§£</title>
    <url>/2021/11/22/sol-p4632/</url>
    <content><![CDATA[<h2 id="P4632-New-Home-é¢˜è§£"><a href="#P4632-New-Home-é¢˜è§£" class="headerlink" title="P4632 New Home é¢˜è§£"></a>P4632 New Home é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/P4632">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>æŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥ï¼Œè€ƒè™‘3ç§æ“ä½œï¼šæ–°å¼€ä¸€å®¶å•†åº—ï¼Œå…³æ‰ä¸€å®¶å•†åº—ï¼ŒæŸ¥è¯¢ä¸€ä¸ªç‚¹çš„ä¸æ–¹ä¾¿æŒ‡æ•°ã€‚</p>
<p>å…ˆè€ƒè™‘æŸ¥è¯¢ã€‚æ˜¾ç„¶å…·æœ‰äºŒåˆ†æ€§ï¼Œè€ƒè™‘åˆ¤æ–­ä¸€ä¸ªåŒºé—´ $[l,r]$ æ˜¯å¦åŒ…å«äº†æ‰€æœ‰çš„é¢œè‰²ã€‚è¿™ç§åŒºé—´ç»Ÿè®¡é¢œè‰²çš„é¢˜ç›®æœ‰ä¸€ä¸ªå¥—è·¯çš„è§£æ³•ï¼Œå³å¯¹äºä¸€ä¸ªç‚¹$i$ï¼Œä¿å­˜ $pre<em>i$ è¡¨ç¤º $i$ çš„ä¸Šä¸€ä¸ªç›¸åŒé¢œè‰²å‡ºç°çš„ä½ç½®ï¼ŒåŒºé—´ $[l,r]$ çš„ç­”æ¡ˆå³ä¸º $\sum\limits</em>{i=l}^{r}{(pre_i \lt l)}$ ã€‚</p>
<p>ä½†æ˜¯è¿™æ ·ä¸å¤ªä¾¿äºç»´æŠ¤ï¼Œäºæ˜¯æ€è€ƒåˆ°$pre$æ•°ç»„çš„å¦ä¸€ä¸ªæ€§è´¨ï¼šè‹¥$\min\limits_{i=r+1}^{n}{pre_i} \lt l$ï¼Œåˆ™è¯´æ˜å¿…æœ‰ä¸€ç§é¢œè‰²æ²¡æœ‰å‡ºç°åœ¨$[l,r]$ä¸­ã€‚è€Œæˆ‘ä»¬äºŒåˆ†+åˆ¤æ–­å¹¶ä¸éœ€è¦ç»Ÿè®¡é¢œè‰²çš„<strong>ä¸ªæ•°</strong>ï¼Œè€Œæ˜¯åªéœ€è¦ç»Ÿè®¡<strong>æ˜¯å¦ä¸ºkä¸ª</strong>ã€‚</p>
<p>äºæ˜¯å°±å¾ˆå®¹æ˜“ç»´æŠ¤è¿™ä¸ª$pre$æ•°ç»„å¹¶ç»Ÿè®¡ç­”æ¡ˆï¼šå°†$pre$æ”¾åœ¨æœ€å°å€¼çº¿æ®µæ ‘ä¸Šå³å¯ã€‚æ³¨æ„å¦‚æœæŸä¸ªé¢œè‰²æ²¡æœ‰å‡ºç°åœ¨$[r+1,n]$çš„è¯ä¼šå°‘è¢«è€ƒè™‘åˆ°ï¼Œæ‰€ä»¥åœ¨æœ€å·¦è¾¹å’Œæœ€å³è¾¹å„å¼€ä¸€ä¸ªå¤§èŠ‚ç‚¹ï¼Œä½œä¸ºæ‰€æœ‰é¢œè‰²å…¬ç”¨ã€‚</p>
<p>ä½†æ˜¯è¿™é“é¢˜æœ‰ä¸ªå¾ˆæ¶å¿ƒçš„åœ°æ–¹ï¼Œåœ¨äºæ¯ä¸ªç‚¹å¯èƒ½æœ‰å¤šä¸ªä¸åŒé¢œè‰²çš„å•†åº—ã€‚æ‰€ä»¥ä¸€ç§åšæ³•ä¸ºåœ¨çº¿æ®µæ ‘çš„æ¯ä¸ªå¶å­èŠ‚ç‚¹å¼€ä¸€ä¸ªsetæš´åŠ›ç»´æŠ¤ã€‚</p>
<p>æœ€åå¯¹äºä¿®æ”¹æ“ä½œä¹Ÿåªéœ€è¦å¯¹æ¯ä¸ªé¢œè‰²æš´åŠ›ç»´æŠ¤ä¸€ä¸ªsetï¼Œæ‰¾åˆ°å‰é©±å’Œåç»§å¹¶åœ¨çº¿æ®µæ ‘ä¸Šä¿®æ”¹å³å¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n\log^3{n})$<del>ï¼ˆè·‘å¾—é£å¿«ï¼‰</del></p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           P4632.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/P4632</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> t, p, c, id;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> t &lt; o.t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">query</span> &#123;</span><br><span class="line">    <span class="type">int</span> t, p, id;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> query &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> t &lt; o.t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> li (i &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ri (i &lt;&lt; 1) | 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lson li, l, mid</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rson ri, mid + 1, r</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">segment_tree</span> &#123;</span><br><span class="line">    <span class="type">int</span> mn[MAXN * <span class="number">12</span>];</span><br><span class="line">    set&lt;pii&gt; st[MAXN * <span class="number">3</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">        mn[i] = <span class="built_in">min</span>(mn[li], mn[ri]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">        mn[i] = INFL;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">build</span>(lson), <span class="built_in">build</span>(rson);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> q, <span class="type">int</span> c, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            st[l].<span class="built_in">insert</span>(&#123;p, c&#125;);</span><br><span class="line">            mn[i] = st[l].<span class="built_in">size</span>() ? st[l].<span class="built_in">begin</span>()-&gt;first : INFL;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (q &lt;= mid)</span><br><span class="line">            <span class="built_in">insert</span>(lson, q, c, p);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">insert</span>(rson, q, c, p);</span><br><span class="line">        <span class="built_in">pushup</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> q, <span class="type">int</span> c, <span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            st[l].<span class="built_in">erase</span>(&#123;p, c&#125;);</span><br><span class="line">            mn[i] = st[l].<span class="built_in">size</span>() ? st[l].<span class="built_in">begin</span>()-&gt;first : INFL;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (q &lt;= mid)</span><br><span class="line">            <span class="built_in">erase</span>(lson, q, c, p);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">erase</span>(rson, q, c, p);</span><br><span class="line">        <span class="built_in">pushup</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">            <span class="keyword">return</span> mn[i];</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = INFL;</span><br><span class="line">        <span class="keyword">if</span> (ql &lt;= mid)</span><br><span class="line">            ret = <span class="built_in">min</span>(ret, <span class="built_in">query</span>(lson, ql, qr));</span><br><span class="line">        <span class="keyword">if</span> (qr &gt; mid)</span><br><span class="line">            ret = <span class="built_in">min</span>(ret, <span class="built_in">query</span>(rson, ql, qr));</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, k, q, sig, len;</span><br><span class="line"><span class="type">int</span> pos[MAXN * <span class="number">3</span>], answ[MAXN];</span><br><span class="line">node bd[MAXN * <span class="number">2</span>];</span><br><span class="line">query qr[MAXN];</span><br><span class="line">multiset&lt;<span class="type">int</span>&gt; col[MAXN];</span><br><span class="line">segment_tree tr;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(node x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x.id &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        col[x.c].<span class="built_in">insert</span>(x.p);</span><br><span class="line">        <span class="keyword">if</span> (col[x.c].<span class="built_in">count</span>(x.p) == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">auto</span> pre = <span class="built_in">prev</span>(col[x.c].<span class="built_in">lower_bound</span>(x.p));</span><br><span class="line">            <span class="keyword">auto</span> nxt = col[x.c].<span class="built_in">upper_bound</span>(x.p);</span><br><span class="line">            tr.<span class="built_in">erase</span>(<span class="number">1</span>, <span class="number">1</span>, sig, *nxt, x.c, *pre);</span><br><span class="line">            tr.<span class="built_in">insert</span>(<span class="number">1</span>, <span class="number">1</span>, sig, *nxt, x.c, x.p);</span><br><span class="line">            tr.<span class="built_in">insert</span>(<span class="number">1</span>, <span class="number">1</span>, sig, x.p, x.c, *pre);            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        col[x.c].<span class="built_in">erase</span>(col[x.c].<span class="built_in">find</span>(x.p));</span><br><span class="line">        <span class="keyword">if</span> (col[x.c].<span class="built_in">count</span>(x.p) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">auto</span> pre = <span class="built_in">prev</span>(col[x.c].<span class="built_in">lower_bound</span>(x.p));</span><br><span class="line">            <span class="keyword">auto</span> nxt = col[x.c].<span class="built_in">upper_bound</span>(x.p);</span><br><span class="line">            tr.<span class="built_in">erase</span>(<span class="number">1</span>, <span class="number">1</span>, sig, *nxt, x.c, x.p);</span><br><span class="line">            tr.<span class="built_in">insert</span>(<span class="number">1</span>, <span class="number">1</span>, sig, *nxt, x.c, *pre);</span><br><span class="line">            tr.<span class="built_in">erase</span>(<span class="number">1</span>, <span class="number">1</span>, sig, x.p, x.c, *pre);            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> ps, <span class="type">int</span> ln)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> u = <span class="built_in">lower_bound</span>(pos + <span class="number">1</span>, pos + sig + <span class="number">1</span>, ps - ln) - pos - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> v = <span class="built_in">upper_bound</span>(pos + <span class="number">1</span>, pos + sig + <span class="number">1</span>, ps + ln) - pos;</span><br><span class="line">    <span class="keyword">return</span> tr.<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, sig, v, sig) &gt; u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(k), <span class="built_in">read</span>(q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> x, t, a, b;</span><br><span class="line">        <span class="built_in">read</span>(x), <span class="built_in">read</span>(t), <span class="built_in">read</span>(a), <span class="built_in">read</span>(b);</span><br><span class="line">        bd[++len] = &#123;a, x, t, i&#125;;</span><br><span class="line">        bd[++len] = &#123;b + <span class="number">1</span>, x, t, -i&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i)</span><br><span class="line">        <span class="built_in">read</span>(qr[i].p), <span class="built_in">read</span>(qr[i].t), qr[i].id = i;</span><br><span class="line">    pos[++sig] = INFL;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">        pos[++sig] = bd[i].p;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i)</span><br><span class="line">        pos[++sig] = qr[i].p;</span><br><span class="line">    <span class="built_in">sort</span>(pos + <span class="number">1</span>, pos + sig + <span class="number">1</span>);</span><br><span class="line">    sig = <span class="built_in">unique</span>(pos + <span class="number">1</span>, pos + sig + <span class="number">1</span>) - pos - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">        bd[i].p = <span class="built_in">lower_bound</span>(pos + <span class="number">1</span>, pos + sig + <span class="number">1</span>, bd[i].p) - pos;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i)</span><br><span class="line">        qr[i].p = <span class="built_in">lower_bound</span>(pos + <span class="number">1</span>, pos + sig + <span class="number">1</span>, qr[i].p) - pos;</span><br><span class="line">    <span class="built_in">sort</span>(bd + <span class="number">1</span>, bd + len + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">sort</span>(qr + <span class="number">1</span>, qr + q + <span class="number">1</span>);</span><br><span class="line">    tr.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, sig);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">        col[i].<span class="built_in">insert</span>(<span class="number">0</span>), col[i].<span class="built_in">insert</span>(sig);</span><br><span class="line">        tr.<span class="built_in">insert</span>(<span class="number">1</span>, <span class="number">1</span>, sig, sig, i, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> cbd = <span class="number">1</span>, cqr = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (cqr &lt;= q) &#123;</span><br><span class="line">        <span class="keyword">while</span> (cbd &lt;= len &amp;&amp; bd[cbd].t &lt;= qr[cqr].t)</span><br><span class="line">            <span class="built_in">insert</span>(bd[cbd++]);</span><br><span class="line">        <span class="type">int</span> l = <span class="number">0</span>, r = <span class="number">0x3f3f3f3f</span>, ans = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">            <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">check</span>(pos[qr[cqr].p], mid))</span><br><span class="line">                r = mid - <span class="number">1</span>, ans = mid;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        answ[qr[cqr++].id] = ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= q; ++i)</span><br><span class="line">        <span class="built_in">write</span>(answ[i]), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
  <entry>
    <title>CF702F T-Shirts é¢˜è§£</title>
    <url>/2021/11/22/sol-cf702f/</url>
    <content><![CDATA[<h2 id="CF702F-T-Shirts-é¢˜è§£"><a href="#CF702F-T-Shirts-é¢˜è§£" class="headerlink" title="CF702F T-Shirts é¢˜è§£"></a>CF702F T-Shirts é¢˜è§£</h2><span id="more"></span>
<h3 id="é¢˜é¢"><a href="#é¢˜é¢" class="headerlink" title="é¢˜é¢"></a>é¢˜é¢</h3><p><a href="https://www.luogu.com.cn/problem/CF702F">é¢˜ç›®é“¾æ¥</a></p>
<h3 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h3><p>é¦–å…ˆä¸éš¾æƒ³åˆ°æœ´ç´ çš„åšæ³•ï¼Œå¯¹æ¯ä¸ªäººæšä¸¾æ‰€æœ‰Tæ¤ã€‚ä½†æ˜¯è¿™æ ·æ˜¾ç„¶æ— æ³•è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚</p>
<p>ä½†æ˜¯å‘ç°å¯ä»¥æŒ‰é¡ºåºæšä¸¾æ‰€æœ‰Tæ¤$i$ï¼Œå¯¹æ¯ä¸ªäºº$j$è‹¥$v_j \ge c_i$åˆ™å°†$v_j$å‡å»$c_i$ï¼ŒåŒæ—¶å°†$cnt_j$åŠ ä¸€ã€‚</p>
<p>ä¸‹é¢è€ƒè™‘å¦‚ä½•ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯ä»¥æŸ¥æ‰¾ç¬¬ä¸€ä¸ª$\ge c_i$å¹¶ä¸”èƒ½æ”¯æŒåŒºé—´å‡å»$c_i$çš„æ•°æ®ç»“æ„ï¼Œè¿™ä¸ªå¯ä»¥ç”¨å¹³è¡¡æ ‘åšåˆ°ã€‚ä¼¼ä¹å…¶ä»–äººç”¨çš„éƒ½æ˜¯FHQçš„åšæ³•ï¼Œä½†æˆ‘ä¸ä¼šFHQæ‰€ä»¥åªèƒ½ç”¨splayä»£æ›¿äº†ã€‚</p>
<p>æ¯æ¬¡æ“ä½œå¯ä»¥æŠŠæ•´ä¸ªåŒºé—´åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š$[0,c_i)$ï¼Œ$[c_i,2c_i)$å’Œ$[2c_i,+\infty)$ã€‚ç¬¬ä¸€ä¸ªåŒºé—´æ˜¾ç„¶ä¸éœ€è¦æ“ä½œï¼Œç¬¬äºŒä¸ªåŒºé—´æˆ‘ä»¬æš´åŠ›åˆ é™¤å¹¶é‡æ–°æ’å…¥ï¼Œç¬¬ä¸‰ä¸ªåŒºé—´ç»´æŠ¤ä¸€ä¸ªtagæ ‡è®°ã€‚</p>
<p>è¿™æ ·çœ‹èµ·æ¥ä¼šTé£ï¼Œç„¶è€Œæ¥è®¡ç®—ä¸€ä¸‹æ—¶é—´å¤æ‚åº¦å°±ä¼šå‘ç°ï¼Œå¯¹äºä¸€ä¸ªåœ¨$[c_i,2c_i)$ä¸­çš„æ•°æ¯æ¬¡å‡å»$c_i$ï¼Œç›¸å½“äºæœ€å°‘æ¯æ¬¡$\times \frac{1}{2}$ï¼Œæ‰€ä»¥ä¸€ä¸ªæ•°$v_i$æœ€å¤šä¼šè¢«æš´åŠ›ä¿®æ”¹$\log_2{v_i}$æ¬¡ï¼Œæ‰€ä»¥å¤æ‚åº¦æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p>
<p>å†æ¥è€ƒè™‘å¦‚ä½•åœ¨splayä¸Šæ“ä½œã€‚æˆ‘ä»¬æ‰¾åˆ°$c_i$çš„å‰é©±ï¼Œè®°ä¸ºèŠ‚ç‚¹$u$ï¼Œå†æ‰¾åˆ°$2c_i-1$çš„åç»§ï¼Œè®°ä¸ºèŠ‚ç‚¹$v$ï¼Œåªéœ€è¦å°†$u$è½¬åˆ°æ ¹èŠ‚ç‚¹ï¼Œ$v$è½¬åˆ°æ ¹èŠ‚ç‚¹çš„å³å„¿å­ï¼Œè¿™æ ·$v$å’Œ$v$çš„å³å„¿å­éƒ½åœ¨åŒºé—´$[2c_i,+\infty)$ä¸­ï¼Œç»´æŠ¤tagå¹¶æ‡’æƒ°æ›´æ–°ï¼›è€Œ$v$çš„å·¦å„¿å­å…¨éƒ½åœ¨åŒºé—´$[c_i,2c_i)$ä¸­ï¼Œåªéœ€éå†ä¸€éé‡æ–°æ’å…¥å³å¯ï¼›å…¶ä»–èŠ‚ç‚¹éƒ½ä¸éœ€è¦æ”¹åŠ¨ã€‚</p>
<p>æœ€åå°±æ˜¯æ¯æ¬¡æ“ä½œæ³¨æ„é¡ºåºï¼Œä¸€å®šè¦å…ˆæ›´æ–°$[c_i,2c_i)$å†æ›´æ–°$[2c_i,+\infty)$ï¼Œä¸ç„¶ä½ ä¼šå‘ç°æ‡’æƒ°æ ‡è®°æ‰“ä¸‹å»å¹³è¡¡æ ‘ä¸æ»¡è¶³äºŒå‰æœç´¢æ ‘çš„æ€§è´¨äº†ï¼ˆåˆ«é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„ï¼Œæˆ‘å°±å› ä¸ºè¿™ä¸ªè°ƒäº†ä¸€ä¸‹åˆï¼‰ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦$O(n\log^2{n})$ï¼Œç©ºé—´å¤æ‚åº¦å¦‚æœèŠ‚ç‚¹é‡å¤åˆ©ç”¨çš„è¯å¯ä»¥åšåˆ°$O(n)$ï¼ˆå…·ä½“è§ä»£ç ï¼‰ã€‚</p>
<h3 id="ACä»£ç "><a href="#ACä»£ç " class="headerlink" title="ACä»£ç "></a>ACä»£ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @file:           2021.11.21-1.cpp</span></span><br><span class="line"><span class="comment"> * @author:         yaoxi-std</span></span><br><span class="line"><span class="comment"> * @url:            https://www.luogu.com.cn/problem/CF702F</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// #pragma GCC optimize (&quot;O2&quot;)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> resetIO(x) \</span></span><br><span class="line"><span class="meta">    freopen(#x <span class="string">&quot;.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin), freopen(#x <span class="string">&quot;.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(fmt, ...) \</span></span><br><span class="line"><span class="meta">    fprintf(stderr, <span class="string">&quot;[%s:%d] &quot;</span> fmt <span class="string">&quot;\n&quot;</span>, __FILE__, __LINE__, ##__VA_ARGS__)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> _Tp&amp; <span class="title">read</span><span class="params">(_Tp &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="type">bool</span> sign = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        sign |= (ch == <span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">        x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">if</span> (ch == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> (ch = <span class="built_in">getchar</span>(); <span class="built_in">isdigit</span>(ch); ch = <span class="built_in">getchar</span>())</span><br><span class="line">            tmp /= <span class="number">10.0</span>, x += tmp * (ch ^ <span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> sign ? (x = -x) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Tp</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(_Tp x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>((x % <span class="number">10</span>) ^ <span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INFL = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span> &#123;</span><br><span class="line">    <span class="type">int</span> val, id, tag, cnt, tac;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> val == o.val ? id &lt; o.id : val &lt; o.val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> node &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> val == o.val &amp;&amp; id == o.id;</span><br><span class="line">    &#125;</span><br><span class="line">    node&amp; <span class="keyword">operator</span>+=(<span class="type">int</span> x) &#123;</span><br><span class="line">        val += x, tag += x, ++cnt, ++tac;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    node&amp; <span class="keyword">operator</span>+=(<span class="type">const</span> node &amp;o) &#123;</span><br><span class="line">        val += o.tag, tag += o.tag;</span><br><span class="line">        cnt += o.tac, tac += o.tac;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">splay_tree</span> &#123;</span><br><span class="line">    node val[MAXN];</span><br><span class="line">    <span class="type">int</span> rt, tot, top, buf[MAXN];</span><br><span class="line">    <span class="type">int</span> siz[MAXN], fa[MAXN], ch[MAXN][<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">maintain</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; siz[x] = siz[ch[x][<span class="number">0</span>]] + siz[ch[x][<span class="number">1</span>]] + <span class="number">1</span>; &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x == ch[fa[x]][<span class="number">1</span>]; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; siz[x] = fa[x] = ch[x][<span class="number">0</span>] = ch[x][<span class="number">1</span>] = <span class="number">0</span>; val[x] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;; <span class="keyword">if</span> (x) buf[++top] = x; &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> top ? buf[top--] : ++tot; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getdown</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span> </span>&#123; val[x] += v; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ch[x][<span class="number">0</span>]) val[ch[x][<span class="number">0</span>]] += val[x];</span><br><span class="line">        <span class="keyword">if</span> (ch[x][<span class="number">1</span>]) val[ch[x][<span class="number">1</span>]] += val[x];</span><br><span class="line">        val[x].tag = val[x].tac = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">pushdown</span>(fa[x]), <span class="built_in">pushdown</span>(x);</span><br><span class="line">        <span class="type">int</span> y = fa[x], z = fa[y], w = <span class="built_in">get</span>(x);</span><br><span class="line">        ch[y][w] = ch[x][w ^ <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (ch[x][w ^ <span class="number">1</span>]) fa[ch[x][w ^ <span class="number">1</span>]] = y;</span><br><span class="line">        ch[x][w ^ <span class="number">1</span>] = y, fa[y] = x, fa[x] = z;</span><br><span class="line">        <span class="keyword">if</span> (z) ch[z][y == ch[z][<span class="number">1</span>]] = x;</span><br><span class="line">        <span class="built_in">maintain</span>(y), <span class="built_in">maintain</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> r = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> f = fa[x]; f = fa[x], f != r; <span class="built_in">rotate</span>(x))</span><br><span class="line">            <span class="keyword">if</span> (fa[f] != r) <span class="built_in">rotate</span>(<span class="built_in">get</span>(x) == <span class="built_in">get</span>(f) ? f : x);</span><br><span class="line">        <span class="keyword">if</span> (r == <span class="number">0</span>) rt = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(node k)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = rt, f = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">            <span class="built_in">pushdown</span>(cur);</span><br><span class="line">            f = cur;</span><br><span class="line">            cur = ch[cur][val[cur] &lt; k];</span><br><span class="line">        &#125;</span><br><span class="line">        cur = <span class="built_in">newnode</span>();</span><br><span class="line">        val[cur] = k;</span><br><span class="line">        fa[cur] = f;</span><br><span class="line">        <span class="keyword">if</span> (f) ch[f][val[f] &lt; k] = cur;</span><br><span class="line">        <span class="built_in">maintain</span>(cur), <span class="built_in">maintain</span>(f);</span><br><span class="line">        <span class="built_in">splay</span>(cur);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(node k)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = rt;</span><br><span class="line">        <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">            <span class="built_in">pushdown</span>(cur);</span><br><span class="line">            <span class="keyword">if</span> (k == val[cur]) &#123;</span><br><span class="line">                <span class="built_in">splay</span>(cur);</span><br><span class="line">                <span class="keyword">return</span> cur;</span><br><span class="line">            &#125;</span><br><span class="line">            cur = ch[cur][val[cur] &lt; k];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">pre</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = ch[rt][<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">pushdown</span>(rt), <span class="built_in">pushdown</span>(cur);</span><br><span class="line">        <span class="keyword">while</span> (ch[cur][<span class="number">1</span>])</span><br><span class="line">            cur = ch[cur][<span class="number">1</span>], <span class="built_in">pushdown</span>(cur);</span><br><span class="line">        <span class="keyword">if</span> (cur) <span class="built_in">splay</span>(cur);</span><br><span class="line">        <span class="keyword">return</span> cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">nxt</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> cur = ch[rt][<span class="number">1</span>];</span><br><span class="line">        <span class="built_in">pushdown</span>(rt), <span class="built_in">pushdown</span>(cur);</span><br><span class="line">        <span class="keyword">while</span> (ch[cur][<span class="number">0</span>])</span><br><span class="line">            cur = ch[cur][<span class="number">0</span>], <span class="built_in">pushdown</span>(cur);</span><br><span class="line">        <span class="keyword">if</span> (cur) <span class="built_in">splay</span>(cur);</span><br><span class="line">        <span class="keyword">return</span> cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(node k)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">find</span>(k);</span><br><span class="line">        <span class="keyword">if</span> (!ch[rt][<span class="number">0</span>] &amp;&amp; !ch[rt][<span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="built_in">clear</span>(rt);</span><br><span class="line">            rt = <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!ch[rt][<span class="number">0</span>]) &#123;</span><br><span class="line">            <span class="type">int</span> cur = rt;</span><br><span class="line">            rt = ch[cur][<span class="number">1</span>];</span><br><span class="line">            fa[rt] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">clear</span>(cur);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!ch[rt][<span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="type">int</span> cur = rt;</span><br><span class="line">            rt = ch[cur][<span class="number">0</span>];</span><br><span class="line">            fa[rt] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">clear</span>(cur);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> cur = rt, x = <span class="built_in">pre</span>();</span><br><span class="line">            fa[ch[cur][<span class="number">1</span>]] = x;</span><br><span class="line">            ch[rt][<span class="number">1</span>] = ch[cur][<span class="number">1</span>];</span><br><span class="line">            <span class="built_in">clear</span>(cur);</span><br><span class="line">            <span class="built_in">maintain</span>(rt);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">prev</span><span class="params">(node k)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">insert</span>(k);</span><br><span class="line">        <span class="type">int</span> ret = <span class="built_in">pre</span>();</span><br><span class="line">        <span class="built_in">erase</span>(k);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">next</span><span class="params">(node k)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">insert</span>(k);</span><br><span class="line">        <span class="type">int</span> ret = <span class="built_in">nxt</span>();</span><br><span class="line">        <span class="built_in">erase</span>(k);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, node *vals, <span class="type">int</span> &amp;len)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">        <span class="built_in">pushdown</span>(x);</span><br><span class="line">        <span class="built_in">dfs</span>(ch[x][<span class="number">0</span>], vals, len);</span><br><span class="line">        vals[++len] = val[x];</span><br><span class="line">        <span class="built_in">dfs</span>(ch[x][<span class="number">1</span>], vals, len);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> cost)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">        <span class="type">static</span> node vals[MAXN];</span><br><span class="line">        <span class="type">int</span> u = <span class="built_in">prev</span>(&#123;cost, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">        <span class="type">int</span> v = <span class="built_in">next</span>(&#123;cost * <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">        <span class="built_in">splay</span>(u, <span class="number">0</span>), <span class="built_in">splay</span>(v, u);</span><br><span class="line">        <span class="built_in">dfs</span>(ch[v][<span class="number">0</span>], vals, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i) &#123;</span><br><span class="line">            <span class="built_in">erase</span>(vals[i]);</span><br><span class="line">            vals[i].val -= cost;</span><br><span class="line">            vals[i].cnt++;</span><br><span class="line">            <span class="built_in">insert</span>(vals[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        val[v].val -= cost, val[v].cnt++;</span><br><span class="line">        <span class="keyword">if</span> (ch[v][<span class="number">1</span>]) <span class="built_in">getdown</span>(ch[v][<span class="number">1</span>], -cost);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">shirt</span> &#123;</span><br><span class="line">    <span class="type">int</span> c, q;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> shirt &amp;o) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> q == o.q ? c &lt; o.c : q &gt; o.q;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n, m, b[MAXN], ans[MAXN];</span><br><span class="line">shirt a[MAXN];</span><br><span class="line">splay_tree splay;</span><br><span class="line">node tmp[MAXN];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i].c), <span class="built_in">read</span>(a[i].q);</span><br><span class="line">    <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">read</span>(b[i]);</span><br><span class="line">    splay.<span class="built_in">insert</span>(&#123;-INFL, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">    splay.<span class="built_in">insert</span>(&#123;INFL, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        splay.<span class="built_in">insert</span>(&#123;b[i], i, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        splay.<span class="built_in">solve</span>(a[i].c);</span><br><span class="line">    <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">    splay.<span class="built_in">dfs</span>(splay.rt, tmp, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">        ans[tmp[i].id] = tmp[i].cnt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">write</span>(ans[i]), <span class="built_in">putchar</span>(i == m ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>é¢˜è§£</category>
      </categories>
      <tags>
        <tag>solutions</tag>
      </tags>
  </entry>
</search>
